<!DOCTYPE html><html><head><title>Electron 桌面开发入门 [ 日升于东 ]</title><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><meta name="description" content="经验记录，资源分享，学习资料整理"><meta name="keywords" content="前端、开发、常见问题解决、资源分享、HTML5、CSS3、Javascript、C#、.NET、java、python、程序员"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><!--favicon.ico--><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><!--加载样式表--><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/search.css"><link rel="stylesheet" href="/css/oeloowu.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.2.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">日升于东</a></h3><div class="description"><p>纵有疾风起，人生不言弃</p></div></div></div><ul class="social-links"><li><a href="http://github.com/" target="_blankmailchen"><i class="fa fa-github"></i></a></li><li><a href="mailto:mailchen@126.com" target="_blank"><i class="fa fa-envelope"></i></a></li></ul><div class="footer"><!-- 新增访客统计代码 --><div class="busuanzi-count"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-uv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><!-- 新增访客统计代码 END--><span>Proudly published with Hexo&#65281;</span></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="navMobile"><i class="fa fa-bars"></i></div><div class="nav"><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/recommend">收藏</a></li><li><a href="/about">关于我</a></li><li><a href="/links">链接</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"></a></li></div><div class="avatar"><img src="/images/logo.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Electron 桌面开发入门</a></h3></div><div class="post-content"><h4 id="基于技术"><a href="#基于技术" class="headerlink" title="基于技术"></a>基于技术</h4><ul>
<li>Chromium</li>
<li>Node.js</li>
</ul>
<h4 id="运行原理"><a href="#运行原理" class="headerlink" title="运行原理"></a>运行原理</h4><p>Chromium 提供了 UI 能力<br>Electron 内置Node.js ，提供了操作系统底层API的能力，常用模块 Path、fs、Crypto<br>内置原生应用程序接口调用</p>
<h4 id="QT-对比"><a href="#QT-对比" class="headerlink" title="QT 对比"></a>QT 对比</h4><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/304286970">跨平台应用开发，QT对比</a></p>
<h4 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install @vue&#x2F;cli -g</span><br><span class="line">vue create electron-vue</span><br><span class="line">vue add electron-builder</span><br></pre></td></tr></table></figure>

<p>安装卡顿 node install.js</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ~/.npmrc 单独设置 Electron 的镜像</span><br><span class="line">electron_mirror=&quot;https://npm.taobao.org/mirrors/electron/&quot;</span><br></pre></td></tr></table></figure>

<p>启动程序</p>
<p><code>npm run electron:serve</code></p>
<blockquote>
<p>failed to install correctly</p>
</blockquote>
<ol>
<li><a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/electron/11.2.3/">https://npm.taobao.org/mirrors/electron/11.2.3/</a> 下载 electron-v11.2.3-win32-x64.zip</li>
<li>node_modules\electron\下创建dist文件夹</li>
<li>下载的压缩包解压进刚刚创建的dist文件夹</li>
<li>node_modules\electron\中创建path.txt，内容为electron.exe</li>
</ol>
<h4 id="进程、常用功能"><a href="#进程、常用功能" class="headerlink" title="进程、常用功能"></a>进程、常用功能</h4><ol>
<li>主进程<br> 处理原生应用逻辑，运行package.json的main脚本的进程被称为主进程，有且仅有一个主进程<br> 创建窗口等所有系统事件都在主进程中进行</li>
</ol>
<ul>
<li>设置渲染进程的大小、外观</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">1200</span>,</span><br><span class="line">    height: <span class="number">600</span>,</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">        webSecurity: <span class="literal">false</span>,  <span class="comment">// 是否禁用浏览器跨域安全特性</span></span><br><span class="line">        nodeIntegration: <span class="literal">true</span> <span class="comment">// 是否完整支持 node</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>设置菜单</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">// darwin 表示 macOS</span></span><br><span class="line">	<span class="keyword">if</span>(process.platform === <span class="string">&#x27;darwin&#x27;</span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> template = [</span><br><span class="line">			label: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">			submenu: [</span><br><span class="line">				&#123;</span><br><span class="line">					role: <span class="string">&#x27;about&#x27;</span></span><br><span class="line">				&#125;,</span><br><span class="line">				&#123;</span><br><span class="line">					role: <span class="string">&#x27;quit&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		]</span><br><span class="line">		<span class="keyword">const</span> menu = Menu.buildFromTemplate(template)</span><br><span class="line">		Menu.setApplicationMenu(menu)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		Menu.setApplicationMenu(<span class="literal">null</span>) <span class="comment">// windows、linux 系统</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>当应用启动后，初始化完成需要做的事情</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="keyword">async</span>() =&gt; &#123;</span><br><span class="line">	<span class="keyword">if</span>(isDevelopment &amp;&amp; !process.env.IS_TEST)&#123;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			<span class="comment">// 开发环境安装 Vue DevTools</span></span><br><span class="line">			<span class="keyword">await</span> installVueDevtools()</span><br><span class="line">		&#125; <span class="keyword">catch</span>(e)&#123;</span><br><span class="line">			<span class="comment">// vue devtools 安装失败</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 全局注册快捷键</span></span><br><span class="line">	globalShortcut.register(<span class="string">&#x27;CommandOrControl+Shift+i&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		win.webContents.openDevTools()</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="comment">// 创建渲染进程</span></span><br><span class="line">	createWindow()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>当所有窗口关闭时要做的事情</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;window-all-closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(process.platform !== <span class="string">&#x27;darwin&#x27;</span>)&#123;</span><br><span class="line">		app.quit()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>与渲染进程进行通讯</li>
</ul>
<p>ipcRenderer（渲染进程中使用的对象）<br>ipcMain（主进程中使用的对象）</p>
<ul>
<li>打开新窗口</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> winURL =</span><br><span class="line">  process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span></span><br><span class="line">    ? <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br><span class="line">    : <span class="string">`file://<span class="subst">$&#123;__dirname&#125;</span>/index.html`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 打开新窗口</span></span><br><span class="line"><span class="keyword">let</span> calendarWin</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openCalendarWindow</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  calendarWin = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">400</span>,</span><br><span class="line">    height: <span class="number">550</span>,</span><br><span class="line">    parent: win, <span class="comment">// win是主窗口</span></span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      nodeIntegration: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  calendarWin.loadURL(winURL + <span class="string">&#x27;#/Calendar&#x27;</span>)</span><br><span class="line">  calendarWin.on(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    calendarWin = <span class="literal">null</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ipcMain.on(<span class="string">&#x27;openCalendarWindow&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> openCalendarWindow())</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>渲染进程<br> 负责界面渲染<br> 每创建一个页面都会创建一个渲染进程<br> 每个页面运行在自己的渲染程序中<br> 每个渲染进程都是独立的，只关心自己所运行的页面</p>
</li>
<li><p>系统通知<br> 通知一共两种调用方式：</p>
<ol>
<li>HTML5 Notification API 渲染进程调用</li>
<li>Notification 模块 主进程调用</li>
</ol>
</li>
<li><p>设置托盘<br> 托盘属于系统级操作，主进程中设置，且必须在程序 ready 后设置</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置托盘</span></span><br><span class="line">  tray = <span class="keyword">new</span> Tray(<span class="string">&#x27;./src/assets/icon_tray.png&#x27;</span>)</span><br><span class="line">  <span class="comment">// 设置托盘菜单</span></span><br><span class="line">  <span class="keyword">const</span> trayContextMenu = Menu.buildFromTemplate([</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;打开&#x27;</span>,</span><br><span class="line">      click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        win.show()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;退出&#x27;</span>,</span><br><span class="line">      click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        app.quit()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ])</span><br><span class="line">  tray.setToolTip(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">  tray.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    win.show()</span><br><span class="line">  &#125;)</span><br><span class="line">  tray.on(<span class="string">&#x27;right-click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    tray.popUpContextMenu(trayContextMenu)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h4><ul>
<li><p>设置 appid</p>
<p>package.json （”appId”: “com.ipp.electronvue”）</p>
</li>
<li><p>vue.config.js 配置 electron-builder 参数</p>
</li>
</ul>
<h4 id="调用-C-Dll"><a href="#调用-C-Dll" class="headerlink" title="调用 C++ Dll"></a>调用 C++ Dll</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. npm install node-gyp -g</span><br><span class="line">2. npm install windows-build-tools -g</span><br><span class="line"></span><br><span class="line">npm install ffi-napi --save</span><br><span class="line">npm install electron-edge-js --save</span><br></pre></td></tr></table></figure>

<p>注意：python 版本必须 2.7</p>
<blockquote>
<p>ffi-napi</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ffi = <span class="built_in">require</span>(<span class="string">&#x27;ffi-napi&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> Dll = ffi.Library(path.resolve(<span class="string">&#x27;resources/dll/MyDLL.dll&#x27;</span>), &#123;</span><br><span class="line">  Add: [<span class="string">&#x27;float&#x27;</span>, [<span class="string">&#x27;float&#x27;</span>, <span class="string">&#x27;float&#x27;</span>]],</span><br><span class="line">  Hello: [<span class="string">&#x27;string&#x27;</span>, []],</span><br><span class="line">  StrLength: [<span class="string">&#x27;int&#x27;</span>, [<span class="string">&#x27;string&#x27;</span>]]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>electron-edge-js</p>
</blockquote>
<p>windows专属功能</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">edge = <span class="built_in">require</span>(<span class="string">&#x27;electron-edge-js&#x27;</span>)</span><br><span class="line">  invoke = edge.func(&#123;</span><br><span class="line">    assemblyFile: path.resolve(<span class="string">&#x27;resources/dll/electronedge.dll&#x27;</span>),</span><br><span class="line">    typeName: <span class="string">&#x27;electronedge.Class1&#x27;</span>,</span><br><span class="line">    methodName: <span class="string">&#x27;Invoke&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> (process.platform === <span class="string">&#x27;win32&#x27;</span>) &#123;</span><br><span class="line">    invoke(<span class="string">&#x27;这是自定义字符串&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, val</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">        <span class="built_in">console</span>.log(val)</span><br><span class="line">        <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            message: <span class="string">&#x27;dll返回的内容为：&#x27;</span> + val,</span><br><span class="line">            type: <span class="string">&#x27;success&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$notify.error(&#123;</span><br><span class="line">        title: <span class="string">&#x27;错误&#x27;</span>,</span><br><span class="line">        message: <span class="string">&#x27;此功能为windows专属功能，mac无法使用&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>报错解决方案：vue.config.js 配置 <code>externals: [&#39;electron-edge-js&#39;]</code></p>
<h4 id="集成-sqlite3"><a href="#集成-sqlite3" class="headerlink" title="集成 sqlite3"></a>集成 sqlite3</h4><p>需要安装node-gyp和windows-build-tools</p>
<pre><code>npm install sqlite3 --save
npm install （否则会出现找不到sqlite3.node）</code></pre>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sq3 <span class="keyword">from</span> <span class="string">&#x27;sqlite3&#x27;</span></span><br><span class="line"><span class="keyword">const</span> pathUtil = <span class="built_in">require</span>(<span class="string">&#x27;../utils/pathUtil.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> dbPath = pathUtil.getAppResourcePath(<span class="string">&#x27;db/data.sqlite1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sqlite3 = sq3.verbose()</span><br><span class="line"><span class="keyword">const</span> db = <span class="keyword">new</span> sqlite3.Database(dbPath)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">db.serialize(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  db.run(<span class="string">&#x27;create table test(name varchar(15))&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    db.run(<span class="string">&quot;insert into test values(&#x27;hello,word&#x27;)&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      db.all(<span class="string">&#x27;select * from test&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(res))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> db</span><br></pre></td></tr></table></figure>

<h4 id="执行-CMD"><a href="#执行-CMD" class="headerlink" title="执行 CMD"></a>执行 CMD</h4><ul>
<li>引用 child_process 模块</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; exec &#125; <span class="keyword">from</span> ‘child_process’</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 解决中文乱码问题</span><br><span class="line">npm install iconv-lite --save</span><br></pre></td></tr></table></figure>

<h4 id="electron-更新"><a href="#electron-更新" class="headerlink" title="electron 更新"></a>electron 更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-updater --save-dev</span><br></pre></td></tr></table></figure>

<h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><p> <a target="_blank" rel="noopener" href="http://newgateway.gitee.io/my/guide/messager.html">跨浏览器消息通讯</a></p>
<p><code>postMessage</code> 可以实现不同源的页面在<code>iframe</code>中通讯， 但是不能跨浏览器窗体。<br><code>localStorage</code> 存储的值发生变化时会在当前窗体window触发 storage 事件。 多个同源的页面是共享localStorage，因此浏览器同时打开多个同源页面，只要localStorage改变了，都会收到 storage 事件。</p>
<p><img src="http://newgateway.gitee.io/my/assets/img/messager.0c9f7e56.png" alt="消息传递过程"></p>
<p> <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/david-zhang-92/posts">学习资料</a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2021-02-16</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Electron/" title="Electron">Electron </a><a class="tag" href="/tags/Electron/" title="Electron">Electron </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://yoursite.com/2021/02/16/Electron/Electron 桌面开发入门/,日升于东,Electron 桌面开发入门,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2021/02/24/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89/" title="Spring Cloud微服务架构（一）">上一页</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2021/01/27/Web%20%E6%A0%87%E5%87%86/W3C%20Html/" title="W3C Html 标准">下一页</a></li></ul></div><div id="lv-container" data-id="city" data-uid="MTAyMC80NTEzNC8yMTY1MQ=="></div><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);

})(document, 'script');</script><noscript></noscript><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%8A%80%E6%9C%AF"><span class="toc-text">基于技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-text">运行原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#QT-%E5%AF%B9%E6%AF%94"><span class="toc-text">QT 对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">项目初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E3%80%81%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="toc-text">进程、常用功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%8C%85"><span class="toc-text">打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8-C-Dll"><span class="toc-text">调用 C++ Dll</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E6%88%90-sqlite3"><span class="toc-text">集成 sqlite3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C-CMD"><span class="toc-text">执行 CMD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#electron-%E6%9B%B4%E6%96%B0"><span class="toc-text">electron 更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%B1%95"><span class="toc-text">扩展</span></a></li></ol></div></div></div></div><div class="searchWrap" data-path="/search.xml"><form class="site-search-form"><i class="fa fa-search"></i><input class="st-search-input" type="text" id="local-search-input" AUTOCOMPLETE="off"></form><div class="local-search-result-cls none" id="local-search-result"></div></div></body><script src="/js/jquery.js"></script><script src="/js/search.js"></script><script src="/js/oeloowu.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></html>