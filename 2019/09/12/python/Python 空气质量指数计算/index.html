<!DOCTYPE html><html><head><title>Python 空气质量指数计算 [ 日升于东 ]</title><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><meta name="description" content="经验记录，资源分享，学习资料整理"><meta name="keywords" content="前端、开发、常见问题解决、资源分享、HTML5、CSS3、Javascript、C#、.NET、java、python、程序员"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><!--favicon.ico--><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><!--加载样式表--><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/search.css"><link rel="stylesheet" href="/css/oeloowu.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.2.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">日升于东</a></h3><div class="description"><p>纵有疾风起，人生不言弃</p></div></div></div><ul class="social-links"><li><a href="http://github.com/" target="_blankmailchen"><i class="fa fa-github"></i></a></li><li><a href="mailto:mailchen@126.com" target="_blank"><i class="fa fa-envelope"></i></a></li></ul><div class="footer"><!-- 新增访客统计代码 --><div class="busuanzi-count"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-uv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><!-- 新增访客统计代码 END--><span>Proudly published with Hexo&#65281;</span></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="navMobile"><i class="fa fa-bars"></i></div><div class="nav"><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/recommend">收藏</a></li><li><a href="/about">关于我</a></li><li><a href="/links">链接</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"></a></li></div><div class="avatar"><img src="/images/logo.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Python 空气质量指数计算</a></h3></div><div class="post-content"><h4 id="计算方法"><a href="#计算方法" class="headerlink" title="计算方法"></a>计算方法</h4><blockquote>
<p>分指数</p>
</blockquote>
<ul>
<li>IAQI<sub>p</sub> = (IAQI<sub>Hi</sub> - IAQI<sub>Lo</sub>)/(BP<sub>Hi</sub> - BP<sub>Lo</sub>)(C<sub>p</sub> - BP<sub>Lo</sub>) + IAQI<sub>Lo</sub></li>
</ul>
<style>
    .info{margin-left:2rem;}
    .info p{margin:0.25rem;}
</style>

<div class="info">
    <p>IAQI<sub>p</sub>：污染物项目P的空气质量分指数</p>
    <p>C<sub>p</sub>：污染物项目P的质量浓度值</p>
    <p>BP<sub>Hi</sub>：C<sub>p</sub>相近的污染物浓度限值的高位值</p>
    <p>BP<sub>Lo</sub>：C<sub>p</sub>相近的污染物浓度限值的低位值</p>
    <p>IAQI<sub>Hi</sub>：BP<sub>Hi</sub>对应的空气质量分指数</p>
    <p>IAQI<sub>Lo</sub>：BP<sub>Lo</sub>对应的空气质量分指数</p>
</div>

<blockquote>
<p>指数</p>
</blockquote>
<ul>
<li><p>AQI = max｛IAQI<sub>1</sub>，IAQI<sub>2</sub>，···，IAQI<sub>n</sub>｝</p>
<p>  IAQI：单项污染物的空气质量指数<br>  AQI：定量描述空气质量状况的无量纲指数</p>
<p>  本质：线性缩放</p>
</li>
</ul>
<h4 id="AQI"><a href="#AQI" class="headerlink" title="AQI"></a>AQI</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#线性缩放</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_linear</span>(<span class="params">C_p, BP_Lo, BP_Hi, IAQI_Lo, IAQI_Hi</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (IAQI_Hi-IAQI_Lo)/(BP_Hi-BP_Lo)*(C_p-BP_Lo) + IAQI_Lo</span><br><span class="line"><span class="comment">#分指数计算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_iaqi</span>(<span class="params">val, <span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;</span><br><span class="line">        <span class="string">&quot;pm&quot;</span>:[<span class="string">&quot;0-0&quot;</span>,<span class="string">&quot;35-50&quot;</span>,<span class="string">&quot;75-100&quot;</span>,<span class="string">&quot;115-150&quot;</span>,<span class="string">&quot;150-200&quot;</span>,<span class="string">&quot;250-300&quot;</span>,<span class="string">&quot;350-400&quot;</span>,<span class="string">&quot;500-500&quot;</span>],</span><br><span class="line">        <span class="string">&quot;co&quot;</span>:[<span class="string">&quot;0-0&quot;</span>,<span class="string">&quot;5-50&quot;</span>,<span class="string">&quot;10-100&quot;</span>,<span class="string">&quot;35-150&quot;</span>,<span class="string">&quot;60-200&quot;</span>,<span class="string">&quot;90-300&quot;</span>,<span class="string">&quot;120-400&quot;</span>,<span class="string">&quot;150-500&quot;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    C_p = val</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">dict</span>[<span class="built_in">type</span>]:</span><br><span class="line">        currIndex = <span class="built_in">dict</span>[<span class="built_in">type</span>].index(i)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>] != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                _lo = <span class="built_in">float</span>(i.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">                _hi = <span class="built_in">float</span>(<span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>].split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">if</span> _lo &lt;= C_p &lt; _hi:</span><br><span class="line">                    BP_Lo = _lo</span><br><span class="line">                    BP_Hi = _hi</span><br><span class="line"></span><br><span class="line">                    IAQI_Lo = <span class="built_in">float</span>(i.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">                    IAQI_Hi = <span class="built_in">float</span>(<span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>].split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">&quot;IAQI 超过 500！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> TypeError:</span><br><span class="line">            print(<span class="string">&quot;数值类型错误！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;分指数计算错误！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cal_linear(C_p, BP_Lo, BP_Hi, IAQI_Lo, IAQI_Hi)</span><br><span class="line"><span class="comment">#指数计算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_AQI</span>(<span class="params">params</span>):</span></span><br><span class="line">    </span><br><span class="line">    pm_iaqi = cal_iaqi(params[<span class="number">0</span>], <span class="string">&quot;pm&quot;</span>)</span><br><span class="line">    co_iaqi = cal_iaqi(params[<span class="number">1</span>], <span class="string">&quot;co&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(pm_iaqi,co_iaqi)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="built_in">input</span>(<span class="string">&quot;请输入以下信息，用空格分割。&quot;</span>);</span><br><span class="line">    <span class="built_in">str</span> = <span class="built_in">input</span>(<span class="string">&quot;(1)PM2.5 (2)CO:&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pmVal = <span class="built_in">float</span>(<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        coVal = <span class="built_in">float</span>(<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        params = []</span><br><span class="line">        params.append(pmVal)</span><br><span class="line">        params.append(coVal)</span><br><span class="line"></span><br><span class="line">        aqiVal = cal_AQI(params)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;空气质量指数为：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aqiVal))</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        print(<span class="string">&quot;输入参数值数量不够！&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;主程序报错！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h4 id="JSON-数据文件"><a href="#JSON-数据文件" class="headerlink" title="JSON 数据文件"></a>JSON 数据文件</h4><pre><code>轻量级数据交换格式
对复杂数据进行表达和存储，易于阅读和理解
示例：
json = &#123;
    &#39;a&#39;:[1,2,3,4,5],
    &#39;b&#39;:&quot;123&quot;
&#125;</code></pre>
<blockquote>
<p>JSON 库</p>
</blockquote>
<pre><code>import json
编码（encoding） 将 python 数据转化成 JSON 数据
解码（decoding） 将 JSON 数据解析到 python 数据类型

dumps()  //编码
loads()  //解码
dump()   //输出到文件
load()   //从文件读入</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从文件读入</span></span><br><span class="line">f = <span class="built_in">open</span>(filepath, mode = <span class="string">&quot;r&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">_list = json.load(f)</span><br><span class="line"><span class="comment"># -&gt; 输出结果为字典类型</span></span><br><span class="line"></span><br><span class="line">_list.sort(key = <span class="keyword">lambda</span> city: city[<span class="string">&#x27;api&#x27;</span>])</span><br><span class="line"><span class="comment"># 输出到文件</span></span><br><span class="line">json.dump(_list[:<span class="number">5</span>], f, ensure_ascii = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h4 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h4><pre><code>通用，简单文本文件
适用商业、科学领域
规则：
    以行为单位，每行表示一条数据，以英文逗号分割每列数据，列名通常放置在第一行

import csv
csv.writerow(list)  //将列表中的元素写入文件的一行中
csv.reader()        //将每行记录作为列表返回
with open(filepath) as somefile:
    for line in somefile:
        print(line)
*使用 with 语句，不管是否发生异常，最后都会关闭文件，不用写 close()*

示例：
api, area, pm2_5
47, 北京, 32
63, 上海, 37</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#写入CSV</span></span><br><span class="line">lines =[]</span><br><span class="line">lines.append(<span class="built_in">list</span>(_list[<span class="number">0</span>].keys()))</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> _list:</span><br><span class="line">    lines.append(<span class="built_in">list</span>(item.values()))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(csvfilepath, <span class="string">&quot;w&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>, newline = <span class="string">&quot;&quot;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines</span><br><span class="line">    csv.writerow(line)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h4 id="os-模块"><a href="#os-模块" class="headerlink" title="os 模块"></a>os 模块</h4><pre><code>os.remove()          //删除文件
os.makedirs()        //创建多层目录
os.rmdir()           //删除单级目录
os.remame()          //重命名文件
os.path.isfile()     //判断是否为文件
os.path.isdir()      //判断是否为目录
os.path.join()       //连接目录
# -&gt; os.path.join(path1,path2)
# -&gt; path1/path2
os.path.splitext()   //分割文件名和扩展名
# -&gt; os.path.splitext(tmp.txt)
# -&gt; tmp，.txt</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">os_switch</span>:</span></span><br><span class="line">    <span class="comment">#初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, params</span>):</span></span><br><span class="line">        self.funs = &#123;</span><br><span class="line">            <span class="string">&quot;json&quot;</span>: self.jsonFun,</span><br><span class="line">            <span class="string">&quot;csv&quot;</span>: self.csvFun,</span><br><span class="line">            &#125;</span><br><span class="line">        self.params = params</span><br><span class="line">        self.funs.get(self.params[<span class="string">&quot;moden&quot;</span>], self.other)()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jsonFun</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(self.params[<span class="string">&quot;filepath&quot;</span>], mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="comment"># load 方法</span></span><br><span class="line">                _list = json.load(f, strict=<span class="literal">False</span>)</span><br><span class="line">                <span class="comment"># loads 方法</span></span><br><span class="line">                <span class="comment"># data = f.read();</span></span><br><span class="line">                <span class="comment"># _list = json.loads(data)</span></span><br><span class="line">                print(_list)</span><br><span class="line">        <span class="keyword">except</span> json.decoder.JSONDecodeError:</span><br><span class="line">            print(<span class="string">&quot;jsonFun 运行 JSONDecodeError 报错！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;jsonFun 运行报错！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">csvFun</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(self.params[<span class="string">&quot;filepath&quot;</span>], mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            reader = csv.reader(f)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">                print(<span class="string">&#x27;，&#x27;</span>.join(row))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">other</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;暂不支持当前格式的文件！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">osFun</span>():</span></span><br><span class="line">    filepath = <span class="built_in">input</span>(<span class="string">&quot;请输入文件路径：&quot;</span>);</span><br><span class="line">    file_name, file_ext = os.path.splitext(filepath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;moden&#x27;</span>: file_ext[<span class="number">1</span>:],</span><br><span class="line">            <span class="string">&#x27;filepath&#x27;</span>: filepath</span><br><span class="line">            &#125;</span><br><span class="line">        os_switch(params)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;osFun 运行错误！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    osFun()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h4 id="自定义-switch"><a href="#自定义-switch" class="headerlink" title="自定义 switch"></a>自定义 switch</h4><ol>
<li>类模式</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">os_switch</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, params</span>):</span></span><br><span class="line">        self.funs = &#123;</span><br><span class="line">            <span class="string">&quot;json&quot;</span>: self.jsonFun,</span><br><span class="line">            <span class="string">&quot;csv&quot;</span>: self.csvFun,</span><br><span class="line">            &#125;</span><br><span class="line">        self.params = params</span><br><span class="line">        self.funs.get(self.params[<span class="string">&quot;moden&quot;</span>], self.other)()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">json</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">csv</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">other</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>字典模式</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">switch = &#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span> = a,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span> = b</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h4 id="requests-模块"><a href="#requests-模块" class="headerlink" title="requests 模块"></a>requests 模块</h4><pre><code>简洁、简单的处理 HTTP 请求的工具
支持丰富的链接访问功能，包括 URL 获取，HTTP 回话，Cookie 记录等
get() 
post()
status_code    // HTTP 请求的返回状态，200表示成功，400表示失败
text           // HTTP 相应内容的字符串形式，即 URL 对应的页面内容</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtmlText</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    print(r.status_code)</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> r.text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    city = <span class="built_in">input</span>(<span class="string">&quot;请输入城市拼音：&quot;</span>)</span><br><span class="line">    url = <span class="string">&#x27;http://www.86kongqi.com/city/&#x27;</span> + city + <span class="string">&#x27;.html&#x27;</span></span><br><span class="line">    text = getHtmlText(url)</span><br><span class="line"></span><br><span class="line">    print(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>中文乱码问题</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sheng-247/p/7686014.html">参考解决方案</a></li>
</ul>
<pre><code>#方法1
r = requests.get(url)
html=r.content
html_doc=str(html,&#39;utf-8&#39;)

#方法2
r=requests.get(url)
r.encoding=&#39;utf-8&#39;</code></pre>
<h4 id="beautifulsoup4"><a href="#beautifulsoup4" class="headerlink" title="beautifulsoup4"></a>beautifulsoup4</h4><pre><code>解析 HTML 或者 XML
pip install beautifulsoup4
import bs4

find       //查找第一个满足条件的节点
find_all   //查找所有满足条件的节点

bs = BeautifulSoup(
    url,
    html_parser   //指定解析器
    enoding       //编码格式，确保和网页编码格式一致
)</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;a href=&quot;a.html&quot; class=&quot;a_link&quot;&gt;next page&lt;/a&gt;</span></span><br><span class="line"><span class="comment"># 可按节点类型，属性或内容访问</span></span><br><span class="line"></span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, href = <span class="string">&#x27;a.html&#x27;</span>)</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, href = <span class="string">&#x27;a.html&#x27;</span>, string = <span class="string">&#x27;next page&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, class_ = <span class="string">&#x27;a_link&#x27;</span>)</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;a_link&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"></span><br><span class="line">r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line"></span><br><span class="line">soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> soup.find_all(<span class="string">&#x27;div&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;weilai&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;table&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>批量抓取</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAllCity</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    cities = soup.find_all(<span class="string">&#x27;dl&#x27;</span>, &#123;<span class="string">&#x27;id&#x27;</span>:<span class="string">&#x27;clist&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;dd&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> cities.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtmlText</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line"></span><br><span class="line">    soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> soup.find_all(<span class="string">&#x27;div&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;weilai&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;table&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    </span><br><span class="line">    url = <span class="string">&#x27;http://www.86kongqi.com&#x27;</span></span><br><span class="line"></span><br><span class="line">    cities = getAllCity(url)</span><br><span class="line">    <span class="keyword">for</span> city <span class="keyword">in</span> cities:</span><br><span class="line">        ciry_url = url + <span class="string">&quot;/&quot;</span> + city[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        text = getHtmlText(ciry_url)</span><br><span class="line">        print(ciry_url)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h4 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h4><pre><code>分析结构化数据的工具集
基础是 Numpy 提供了高性能的矩阵运算
应用：数据挖掘，数据分析，数据清洗功能</code></pre>
<blockquote>
<p>数据分析</p>
</blockquote>
<pre><code>ser_obj = pd.Series(range(10))  // 一维数组对象，索引自动创建，索引在左，数据在右
ser_obj.index                   // 获取索引
ser_obj.values                  // 获取值
ser_obj.head(n)                 // 预览数据，n 前几行
ser_obj.tail(n)                 // 预览数据，n 后几行
ser_obj[index]

Data.Frame
通过 ndarray，dict 创建
data[&#39;列名&#39;]                           // 获取单列数据
data[[&#39;列名1&#39;，&#39;列名2&#39;]]                // 获取多列数据
sort_values(by = [&#39;列名&#39;]).head(10)     // 获取前 10 名，降序 ascending = False

pd.to_csv(&#39;topTen.csv&#39;，index = False)  // 保存为 CSV</code></pre>
<blockquote>
<p>数据清洗</p>
</blockquote>
<pre><code>dropna()    // 丢失缺失数据
fillna()    // 填充缺失数据
df[过滤条件]</code></pre>
<blockquote>
<p>数据可视化</p>
</blockquote>
<pre><code>plot(kind，x，y，title，figsize)
plt.savefig()</code></pre>
<ul>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs">官方地址</a></li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-09-12</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Python/" title="Python">Python </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://yoursite.com/2019/09/12/python/Python 空气质量指数计算/,日升于东,Python 空气质量指数计算,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/09/12/Csharp/%E6%96%87%E4%BB%B6%E6%B5%81%E8%BD%AC%E6%8D%A2%E3%80%81zip%E5%8E%8B%E7%BC%A9/" title="文件流转换、zip压缩">上一页</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/09/11/Csharp/C%20sharp%20%E8%B0%83%E7%94%A8%20python/" title="C# 调用 python">下一页</a></li></ul></div><div id="lv-container" data-id="city" data-uid="MTAyMC80NTEzNC8yMTY1MQ=="></div><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);

})(document, 'script');</script><noscript></noscript><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95"><span class="toc-text">计算方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AQI"><span class="toc-text">AQI</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-text">JSON 数据文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSV"><span class="toc-text">CSV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#os-%E6%A8%A1%E5%9D%97"><span class="toc-text">os 模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-switch"><span class="toc-text">自定义 switch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#requests-%E6%A8%A1%E5%9D%97"><span class="toc-text">requests 模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#beautifulsoup4"><span class="toc-text">beautifulsoup4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pandas"><span class="toc-text">pandas</span></a></li></ol></div></div></div></div><div class="searchWrap" data-path="/search.xml"><form class="site-search-form"><i class="fa fa-search"></i><input class="st-search-input" type="text" id="local-search-input" AUTOCOMPLETE="off"></form><div class="local-search-result-cls none" id="local-search-result"></div></div></body><script src="/js/jquery.js"></script><script src="/js/search.js"></script><script src="/js/oeloowu.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></html>