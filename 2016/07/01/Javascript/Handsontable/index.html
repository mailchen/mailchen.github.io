<!DOCTYPE html><html><head><title>Handsontable 常用配置和方法 [ 日升于东 ]</title><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><meta name="description" content="踩坑经验记录，资源分享，学习资料整理"><meta name="keywords" content="前端、开发、踩坑经验、资源分享、HTML5、CSS3、Javascript、C#、.NET"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><!--favicon.ico--><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><!--加载样式表--><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/search.css"><link rel="stylesheet" href="/css/oeloowu.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.2.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">日升于东</a></h3><div class="description"><p>纵有疾风起，人生不言弃</p></div></div></div><ul class="social-links"><li><a href="http://github.com/" target="_blankmailchen"><i class="fa fa-github"></i></a></li><li><a href="mailto:mailchen@126.com" target="_blank"><i class="fa fa-envelope"></i></a></li></ul><div class="footer"><!-- 新增访客统计代码 --><div class="busuanzi-count"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-uv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><!-- 新增访客统计代码 END--><span>Proudly published with Hexo&#65281;</span></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="navMobile"><i class="fa fa-bars"></i></div><div class="nav"><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/recommend">收藏</a></li><li><a href="/about">关于我</a></li><li><a href="/links">链接</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"></a></li></div><div class="avatar"><img src="/images/logo.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Handsontable 常用配置和方法</a></h3></div><div class="post-content"><h4 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h4><ul>
<li>1、固定行列位置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fixedRowsTop:行数       &#x2F;&#x2F;固定顶部多少行不能垂直滚动</span><br><span class="line">fixedColumnsLeft:列数   &#x2F;&#x2F;固定左侧多少列不能水平滚动</span><br></pre></td></tr></table></figure>

<ul>
<li>2、拖拽行头或列头改变行或列的大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true时，允许拖动，当为false时禁止拖动</span><br><span class="line">manualColumnResize:true&#x2F;false</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;当值为true时，允许拖动，当为false时禁止拖动</span><br><span class="line">manualRowResize:true&#x2F;false</span><br></pre></td></tr></table></figure>

<ul>
<li>3、延伸列的宽度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;last:延伸最后一列,all:延伸所有列,none默认不延伸。</span><br><span class="line">stretchH：last&#x2F;all&#x2F;none</span><br></pre></td></tr></table></figure>

<ul>
<li>4、拖动行或列到某一行或列之后 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">当值为true时，列可拖拽移动到指定列</span><br><span class="line">manualColumnMove：true&#x2F;false </span><br><span class="line"></span><br><span class="line">当值为true时，行可拖拽至指定行</span><br><span class="line">manualRowMove:true&#x2F;false </span><br><span class="line"></span><br><span class="line">移动的时候鼠标需选中行线或列线才行。</span><br></pre></td></tr></table></figure>

<ul>
<li>5、设置当前行或列的样式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">currentRowClassName：当前行样式的名称</span><br><span class="line"></span><br><span class="line">currentColClassName：当前列样式的名称</span><br></pre></td></tr></table></figure>

<ul>
<li>6、行分组或列分组</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groups:[&#123;cols:[0,2]&#125;,&#123;cols:[3,5]&#125;,&#123;rows:[0,4]&#125;,&#123;rows:[5,7]&#125;]</span><br><span class="line"></span><br><span class="line">上面的例子介绍了4个分组，第0-2列为一组，第3-5列为第二组，第0-4行为一组，第5-7列为第二组。分组可在行头或列头看见，分组可被展开或隐藏。</span><br></pre></td></tr></table></figure>

<ul>
<li>7、允许排序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">columnSorting：true&#x2F;false&#x2F;对象 &#x2F;&#x2F;当值为true时，表示启用排序插件</span><br><span class="line"></span><br><span class="line">当值为true时，排序插件的使用可通过点击列头文字实现。当值为false时表示禁用排序。当值为对象时，该对象包含两个属性：column：列数。sortOrder：true&#x2F;false，升序或降序，true为升序排列。当用对象启动插件后可用如下方式禁用插件：</span><br><span class="line"></span><br><span class="line">hot.updateSettings(&#123;</span><br><span class="line">    columnSorting:false</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">排序的使用也可已直接调用sort()方法实现。如下操作：</span><br><span class="line"></span><br><span class="line">if(hot.sortingEnabled)&#123;</span><br><span class="line">    hot.sort(行数，true&#x2F;false); &#x2F;&#x2F;true为升序，false为降序</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>8、数据显示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data：[[第一行数据],[第二行数据],...[第n行数据]]&#x2F;对象数组</span><br><span class="line"></span><br><span class="line">获取数据的方法：hot.getData()。</span><br><span class="line"></span><br><span class="line">加载数据的方法：hot.loadData(data)。</span><br></pre></td></tr></table></figure>

<ul>
<li>9、右键菜单展示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true时，启用右键菜单，为false时禁用	</span><br><span class="line">contextMenu：true&#x2F;false&#x2F;自定义数组 </span><br></pre></td></tr></table></figure>

<ul>
<li>10、自适应列大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true且列宽未设置时，自适应列大小</span><br><span class="line">autoColumnSize：true&#x2F;false </span><br></pre></td></tr></table></figure>

<ul>
<li>11、最小，最大设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">minCols：最小列数</span><br><span class="line">minRows：最小行数</span><br><span class="line">minSpareCols：最小列空间，不足则添加空列</span><br><span class="line">maxCols：最大列数</span><br><span class="line">maxRows：最大行数</span><br><span class="line">minSpareRows：最小行空间，不足则添加空行</span><br></pre></td></tr></table></figure>

<ul>
<li>12、自定义边框设置，可以进行初始化配置，如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">customBorder:true;</span><br><span class="line">customBorders:[&#123;range:&#123;from:&#123;row:行数,col:列数&#125;,to:&#123;row:行数,col:列数&#125;,上下左右设置&#125;]</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">hot = Handsontable(container, &#123;</span><br><span class="line">    data: Handsontable.helper.createSpreadsheetData(<span class="number">200</span>, <span class="number">20</span>),</span><br><span class="line">    rowHeaders: <span class="literal">true</span>,</span><br><span class="line">    fixedColumnsLeft: <span class="number">2</span>,</span><br><span class="line">    fixedRowsTop: <span class="number">2</span>,</span><br><span class="line">    colHeaders: <span class="literal">true</span>,</span><br><span class="line">    customBorders: [</span><br><span class="line">      &#123;</span><br><span class="line">        range: &#123;<span class="comment">//多个单元格</span></span><br><span class="line">          <span class="keyword">from</span>: &#123;<span class="comment">//起始位置</span></span><br><span class="line">            row: <span class="number">1</span>,</span><br><span class="line">            col: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          to: &#123;</span><br><span class="line">            row: <span class="number">3</span>,</span><br><span class="line">            col: <span class="number">4</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        top: &#123;<span class="comment">//结束位置</span></span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;#5292F7&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        left: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;orange&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        bottom: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;red&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        right: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;magenta&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;<span class="comment">//单一单元格</span></span><br><span class="line">        row: <span class="number">2</span>,</span><br><span class="line">        col: <span class="number">2</span>,</span><br><span class="line">        left: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;red&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        right: &#123;</span><br><span class="line">          width: <span class="number">1</span>,</span><br><span class="line">          color: <span class="string">&#x27;green&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>13、单元格合并配置，如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mergeCells:true</span><br><span class="line">mergeCells: [&#123;row: 起始行数, col: 起始列数, rowspan: 合并行数, colspan:合并列数 &#125;,...]</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(key == <span class="string">&quot;merge&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(hot.mergeCells.mergedCellInfoCollection.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>; k&lt;hot.mergeCells.mergedCellInfoCollection.length; k++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(hot.mergeCells.mergedCellInfoCollection[k].row == row &amp;&amp;</span><br><span class="line">                hot.mergeCells.mergedCellInfoCollection[k].col == col) &#123;</span><br><span class="line">                    hot.mergeCells.mergedCellInfoCollection.splice(k,<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    hot.mergeCells.mergedCellInfoCollection.push(&#123;<span class="string">&quot;row&quot;</span>: row, <span class="string">&quot;col&quot;</span>: col, </span><br><span class="line">                    <span class="string">&quot;rowspan&quot;</span>: rowspan, <span class="string">&quot;colspan&quot;</span>: colspan&#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hot.mergeCells.mergedCellInfoCollection.push(&#123;<span class="string">&quot;row&quot;</span>: row, <span class="string">&quot;col&quot;</span>: col, <span class="string">&quot;rowspan&quot;</span>: rowspan, <span class="string">&quot;colspan&quot;</span>: colspan&#125;);</span><br><span class="line">｝</span><br></pre></td></tr></table></figure>

<h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><blockquote>
<p>怎样获得行标题和列标题的名称？</p>
<blockquote>
<p>getRowHeader</p>
<p>getColHeader</p>
</blockquote>
</blockquote>
<blockquote>
<p>怎么根据列名称得到列索引，根据列索引得到列名称？</p>
<blockquote>
<p>propToCol</p>
<p>colToProp</p>
</blockquote>
</blockquote>
<blockquote>
<p>表格的行数和列数？</p>
<blockquote>
<p>countRows</p>
<p>countCols</p>
</blockquote>
</blockquote>
<blockquote>
<p>操作单元格？</p>
<blockquote>
<p>getCell(1,1)  //获得单元格对象</p>
<p>selectCell(2,2)</p>
<p>getSelected() //返回坐标，如2,2,2,2</p>
</blockquote>
</blockquote>
<blockquote>
<p>获得表格中某个范围range的数据？</p>
<blockquote>
<p>getData(0,4)</p>
<p>getData(1,1,2,2)</p>
<p>getDataAtCell(1,3)    </p>
<p>getDataAtRow(row)</p>
<p>getDataAtCol(col)</p>
<p>getDataAtRowProp(row, name)</p>
<p>setDataAtCell(row, col, val)</p>
<p>getActiveEditor</p>
</blockquote>
</blockquote>
<blockquote>
<p>复制，粘贴？</p>
<blockquote>
<p>getCopyableData</p>
<p>copyPaste.triggerPaste(event, val)</p>
</blockquote>
</blockquote>
<blockquote>
<p>其他    </p>
<blockquote>
<p>$(‘#id’).handsontable(‘getInstance’);</p>
<p>$(‘#id’).handsontable(‘getData’);</p>
<p>$(‘#id’).handsontable(‘loadData’, data);</p>
<p>$(‘#id’).handsontable(‘destroy’);</p>
</blockquote>
</blockquote>
<blockquote>
<p><strong>specialSettings.afterGetColHeader</strong></p>
<p>var finialSettings = $.extend(true, initialSettings, specialSettings);</p>
<p>$(‘#id’).handsontable(finialSettings);</p>
<p><strong>beforeChange: function (changes, source) {}</strong></p>
<p><strong>beforeKeyDown: function(event, coords, td){}</strong></p>
<p><strong>afterOnCellMouseDown: function(event, coords, td){}</strong></p>
<p><strong>afterRender: function(isForced) {}</strong></p>
</blockquote>
<h4 id="自定义插件"><a href="#自定义插件" class="headerlink" title="自定义插件"></a>自定义插件</h4><ol>
<li>初始化时绑定自定义插件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">columnShift.data = data;</span><br><span class="line">columnShift.renderer = <span class="string">&#x27;html&#x27;</span>;</span><br><span class="line">columnShift.editor = <span class="string">&#x27;ShiftEditor&#x27;</span>; </span><br><span class="line">columnShift.shiftTypes = shiftTypesDictionary;</span><br><span class="line">columnShift.shiftMarks = shiftMarkInfo;</span><br><span class="line">columnShift.specialSchedule = specialScheduleNames;</span><br><span class="line">columnsDataBinding.push(columnShift);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> specialSettings = &#123;</span><br><span class="line">    colHeaders: colHeaders,</span><br><span class="line">    autoRowSize: <span class="literal">true</span>,</span><br><span class="line">    mergeCells: <span class="literal">true</span>,</span><br><span class="line">    columns: columnsDataBinding</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>自定义插件配置</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">Handsontable</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ShiftEditor = Handsontable.editors.BaseEditor.prototype.extend();</span><br><span class="line">    <span class="keyword">var</span> filter = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    ShiftEditor.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.rootElement = <span class="built_in">document</span>.createElement(<span class="string">&#x27;DIV&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.rootElement.className = <span class="string">&#x27;shiftEditorRoot&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement = <span class="built_in">document</span>.createElement(<span class="string">&#x27;TABLE&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.ULElement.className = <span class="string">&#x27;ShiftEditor&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.left = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.listStyle = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.instance.rootElement.appendChild(<span class="built_in">this</span>.ULElement);</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    ShiftEditor.prototype.prepare = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> filterWord = filter;</span><br><span class="line">        Handsontable.editors.BaseEditor.prototype.prepare.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> handsontableInstance = $(<span class="string">&#x27;#handsontable&#x27;</span>).handsontable(<span class="string">&#x27;getInstance&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> empType = handsontableInstance.getDataAtRowProp(<span class="built_in">arguments</span>[<span class="number">0</span>], <span class="string">&#x27;EmployeeWorkIdentity&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        shiftTypes = <span class="built_in">this</span>.cellProperties.shiftTypes[empType] == <span class="literal">undefined</span> ? <span class="built_in">this</span>.cellProperties.shiftTypes[<span class="string">&#x27;公共&#x27;</span>] : <span class="built_in">this</span>.cellProperties.shiftTypes[empType];</span><br><span class="line">        shiftMarks = <span class="built_in">this</span>.cellProperties.shiftMarks;</span><br><span class="line"></span><br><span class="line">        Handsontable.Dom.empty(<span class="built_in">this</span>.ULElement);</span><br><span class="line">		### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.getValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> returnString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">		### //dosomething</span><br><span class="line">		<span class="keyword">return</span> returnString;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.saveValue = <span class="function"><span class="keyword">function</span> (<span class="params">val, ctrlDown</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.instance.setDataAtCell(<span class="built_in">this</span>.row, <span class="built_in">this</span>.col, val);</span><br><span class="line">    &#125;;</span><br><span class="line">    ShiftEditor.prototype.setValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> orgVal = <span class="built_in">this</span>.originalValue;</span><br><span class="line">		### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.finishEditing = <span class="function"><span class="keyword">function</span> (<span class="params">restoreOriginalValue, ctrlDown, callback</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.state == Handsontable.EditorState.EDITING) &#123;</span><br><span class="line">            <span class="keyword">if</span> (restoreOriginalValue) &#123;</span><br><span class="line">                <span class="built_in">this</span>.cancelChanges();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> val = <span class="built_in">this</span>.getValue();</span><br><span class="line">            <span class="built_in">this</span>.state = Handsontable.EditorState.WAITING;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">this</span>.saveValue(val, ctrlDown);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.instance.getCellValidator(<span class="built_in">this</span>.cellProperties)) &#123;</span><br><span class="line">                <span class="keyword">var</span> that = <span class="built_in">this</span>;</span><br><span class="line">                <span class="built_in">this</span>.instance.addHookOnce(<span class="string">&#x27;afterValidate&#x27;</span>,</span><br><span class="line">                    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">                        that.state = Handsontable.EditorState.FINISHED;</span><br><span class="line">                        that.discardEditor(result);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.state = Handsontable.EditorState.FINISHED;</span><br><span class="line">                <span class="built_in">this</span>.discardEditor(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.focus = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line">   </span><br><span class="line">    ShiftEditor.prototype.open = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		### //dosomething</span><br><span class="line">        <span class="comment">//this.refreshDimensions();</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.close = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Handsontable.editors.ShiftEditor = ShiftEditor;</span><br><span class="line">    Handsontable.editors.registerEditor(<span class="string">&#x27;ShiftEditor&#x27;</span>, ShiftEditor);</span><br><span class="line"></span><br><span class="line">&#125;)(Handsontable);</span><br></pre></td></tr></table></figure>

<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><strong><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/924481947c30">https://www.jianshu.com/p/924481947c30</a></strong></p>
<p><strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cosyer/p/6741546.html?utm_source=itdadao&utm_medium=referral">https://www.cnblogs.com/cosyer/p/6741546.html?utm_source=itdadao&amp;utm_medium=referral</a></strong></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2016-07-01</span><i class="fa fa-tag"></i><a class="tag" href="/categories/框架/" title="框架">框架 </a><a class="tag" href="/tags/Javascript/" title="Javascript">Javascript </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://yoursite.com/2016/07/01/Javascript/Handsontable/,日升于东,Handsontable 常用配置和方法,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/07/01/HexoToGithub/" title="Hexo 环境搭建，部署 Github">上一页</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2013/07/05/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle%20%E8%A1%A8%E7%A9%BA%E9%97%B4%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%B1%A1/" title="Oracle 表空间和模式对象">下一页</a></li></ul></div><div id="lv-container" data-id="city" data-uid="MTAyMC80NTEzNC8yMTY1MQ=="></div><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);

})(document, 'script');</script><noscript></noscript><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-text">常用配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8F%92%E4%BB%B6"><span class="toc-text">自定义插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol></div></div></div></div><div class="searchWrap" data-path="/search.xml"><form class="site-search-form"><i class="fa fa-search"></i><input class="st-search-input" type="text" id="local-search-input" AUTOCOMPLETE="off"></form><div class="local-search-result-cls none" id="local-search-result"></div></div></body><script src="/js/jquery.js"></script><script src="/js/search.js"></script><script src="/js/oeloowu.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></html>