<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Spring Cloud微服务架构（一）</title>
      <link href="2021/02/24/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>2021/02/24/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/Spring%20Cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h4 id="框架演进历史"><a href="#框架演进历史" class="headerlink" title="框架演进历史"></a>框架演进历史</h4><ol><li>单体应用</li></ol><p>Spring + MyBatis/Hibernate/JDBC + Struts/SpringMVC + jsp</p><p>打包成 war包，部署到 Tomcat</p><ol start="2"><li>前后端分离</li></ol><p>SpringBoot + Jquery + ajax</p><p>nginx+jar</p><ol start="3"><li><p>负载均衡</p></li><li><p>微服务</p></li></ol><p>单一职责，一个服务只解决一个业务领域的问题<br>服务：对外提供我们能处理的业务服务</p><p>优点：<br>    服务职责小，服务间互不影响<br>    代码量小，易于维护，减少代码冲突<br>    便于迭代升级<br>    耦合度低</p><p>缺点：<br>    运维成本高<br>    架构复杂<br>    隐形问题变多，如不同服务间调用</p><h4 id="常用组件"><a href="#常用组件" class="headerlink" title="常用组件"></a>常用组件</h4><ul><li>服务注册发现 Euraka</li><li>服务网关 Gateway</li><li>客户端负载均衡 Ribbon</li><li>熔断器 Hystrix  （更换成：Sentinel）</li><li>分布式配置 Spring Cloud Config （更换成：Nacos）</li><li>服务调用 Feign</li></ul><h4 id="服务注册中心-Eureka"><a href="#服务注册中心-Eureka" class="headerlink" title="服务注册中心 Eureka"></a>服务注册中心 Eureka</h4><p>Netflix 开发的，基于 REST 服务的，服务注册和发现组件</p><ul><li><p>创建 多 module maven工程，module 间无依赖，均为单体应用</p><p>  各组件版本：</p><pre><code>spring boot：2.2.5spring cloud：Hoxton.SR3Jdk：1.8</code></pre><ol><li>新建项目</li><li>配置 maven 镜像，本地仓库，IDE 构建项目依赖 maven，安装依赖</li><li>新增 module 引入eureka 依赖</li><li>pom.xml 配置</li><li>application.properties 配置服务信息</li></ol></li></ul><h4 id="服务间调用-Feign"><a href="#服务间调用-Feign" class="headerlink" title="服务间调用 Feign"></a>服务间调用 Feign</h4><p>一个 http 请求调用的轻量级框架，可以以 java 接口注释的方式调用 Http 请求，而不需要像 java 中封装 HTTP 请求报文的方式直接调用</p><pre><code>app-order：调用方app-storage：被调用方mybatis-plus：数据处理框架lombok：简化代码，常用@Data注解，实体类省略 set、get、toString 方法注意：集成 mybatis-plus 要把mybatis、mybatis-spring去掉，避免冲突；</code></pre><h4 id="服务网关-GateWay"><a href="#服务网关-GateWay" class="headerlink" title="服务网关 GateWay"></a>服务网关 GateWay</h4><p>目的：提供简单有效的 API路由，基于 Spring Framework5、Spring Boot 2.0 构建，WebFlux 实现，取代 Zuul</p><p><a href="https://www.cnblogs.com/yizhishi/archive/2019/09/26/11588860.html">Zuul和Spring Cloud Gateway的对比</a></p><ul><li>配置文件</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 配置路由唯一 id</span><br><span class="line">spring.cloud.gateway.routes[<span class="number">0</span>].id=app-storage</span><br><span class="line"># app-storage 所在服务，lb:// 表示采用负载均衡</span><br><span class="line">spring.cloud.gateway.routes[<span class="number">0</span>].uri=lb:<span class="comment">//APP-STORAGE</span></span><br><span class="line"># 配置请求 app-storage 下所有接口的请求前缀</span><br><span class="line">spring.cloud.gateway.routes[<span class="number">0</span>].predicates[<span class="number">0</span>]=Path=/storage/v1<span class="comment">/**</span></span><br><span class="line"><span class="comment"># 配置转发请求路径需要过滤掉几层前缀</span></span><br><span class="line"><span class="comment">spring.cloud.gateway.routes[0].filters[0]=StripPrefix=2</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Electron 桌面开发入门</title>
      <link href="2021/02/16/Electron/Electron%20%E6%A1%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/"/>
      <url>2021/02/16/Electron/Electron%20%E6%A1%8C%E9%9D%A2%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="基于技术"><a href="#基于技术" class="headerlink" title="基于技术"></a>基于技术</h4><ul><li>Chromium</li><li>Node.js</li></ul><h4 id="运行原理"><a href="#运行原理" class="headerlink" title="运行原理"></a>运行原理</h4><p>Chromium 提供了 UI 能力<br>Electron 内置Node.js ，提供了操作系统底层API的能力，常用模块 Path、fs、Crypto<br>内置原生应用程序接口调用</p><h4 id="QT-对比"><a href="#QT-对比" class="headerlink" title="QT 对比"></a>QT 对比</h4><p><a href="https://zhuanlan.zhihu.com/p/304286970">跨平台应用开发，QT对比</a></p><h4 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install @vue&#x2F;cli -g</span><br><span class="line">vue create electron-vue</span><br><span class="line">vue add electron-builder</span><br></pre></td></tr></table></figure><p>安装卡顿 node install.js</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ~/.npmrc 单独设置 Electron 的镜像</span><br><span class="line">electron_mirror=&quot;https://npm.taobao.org/mirrors/electron/&quot;</span><br></pre></td></tr></table></figure><p>启动程序</p><p><code>npm run electron:serve</code></p><blockquote><p>failed to install correctly</p></blockquote><ol><li><a href="https://npm.taobao.org/mirrors/electron/11.2.3/">https://npm.taobao.org/mirrors/electron/11.2.3/</a> 下载 electron-v11.2.3-win32-x64.zip</li><li>node_modules\electron\下创建dist文件夹</li><li>下载的压缩包解压进刚刚创建的dist文件夹</li><li>node_modules\electron\中创建path.txt，内容为electron.exe</li></ol><h4 id="进程、常用功能"><a href="#进程、常用功能" class="headerlink" title="进程、常用功能"></a>进程、常用功能</h4><ol><li>主进程<br> 处理原生应用逻辑，运行package.json的main脚本的进程被称为主进程，有且仅有一个主进程<br> 创建窗口等所有系统事件都在主进程中进行</li></ol><ul><li>设置渲染进程的大小、外观</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">1200</span>,</span><br><span class="line">    height: <span class="number">600</span>,</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">        webSecurity: <span class="literal">false</span>,  <span class="comment">// 是否禁用浏览器跨域安全特性</span></span><br><span class="line">        nodeIntegration: <span class="literal">true</span> <span class="comment">// 是否完整支持 node</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>设置菜单</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">// darwin 表示 macOS</span></span><br><span class="line"><span class="keyword">if</span>(process.platform === <span class="string">&#x27;darwin&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">const</span> template = [</span><br><span class="line">label: <span class="string">&#x27;App&#x27;</span>,</span><br><span class="line">submenu: [</span><br><span class="line">&#123;</span><br><span class="line">role: <span class="string">&#x27;about&#x27;</span></span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">role: <span class="string">&#x27;quit&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> menu = Menu.buildFromTemplate(template)</span><br><span class="line">Menu.setApplicationMenu(menu)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Menu.setApplicationMenu(<span class="literal">null</span>) <span class="comment">// windows、linux 系统</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>当应用启动后，初始化完成需要做的事情</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="keyword">async</span>() =&gt; &#123;</span><br><span class="line"><span class="keyword">if</span>(isDevelopment &amp;&amp; !process.env.IS_TEST)&#123;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="comment">// 开发环境安装 Vue DevTools</span></span><br><span class="line"><span class="keyword">await</span> installVueDevtools()</span><br><span class="line">&#125; <span class="keyword">catch</span>(e)&#123;</span><br><span class="line"><span class="comment">// vue devtools 安装失败</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 全局注册快捷键</span></span><br><span class="line">globalShortcut.register(<span class="string">&#x27;CommandOrControl+Shift+i&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">win.webContents.openDevTools()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 创建渲染进程</span></span><br><span class="line">createWindow()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>当所有窗口关闭时要做的事情</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;window-all-closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(process.platform !== <span class="string">&#x27;darwin&#x27;</span>)&#123;</span><br><span class="line">app.quit()</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>与渲染进程进行通讯</li></ul><p>ipcRenderer（渲染进程中使用的对象）<br>ipcMain（主进程中使用的对象）</p><ul><li>打开新窗口</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> winURL =</span><br><span class="line">  process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span></span><br><span class="line">    ? <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br><span class="line">    : <span class="string">`file://<span class="subst">$&#123;__dirname&#125;</span>/index.html`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 打开新窗口</span></span><br><span class="line"><span class="keyword">let</span> calendarWin</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openCalendarWindow</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  calendarWin = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">400</span>,</span><br><span class="line">    height: <span class="number">550</span>,</span><br><span class="line">    parent: win, <span class="comment">// win是主窗口</span></span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      nodeIntegration: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  calendarWin.loadURL(winURL + <span class="string">&#x27;#/Calendar&#x27;</span>)</span><br><span class="line">  calendarWin.on(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    calendarWin = <span class="literal">null</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ipcMain.on(<span class="string">&#x27;openCalendarWindow&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> openCalendarWindow())</span><br></pre></td></tr></table></figure><ol start="2"><li><p>渲染进程<br> 负责界面渲染<br> 每创建一个页面都会创建一个渲染进程<br> 每个页面运行在自己的渲染程序中<br> 每个渲染进程都是独立的，只关心自己所运行的页面</p></li><li><p>系统通知<br> 通知一共两种调用方式：</p><ol><li>HTML5 Notification API 渲染进程调用</li><li>Notification 模块 主进程调用</li></ol></li><li><p>设置托盘<br> 托盘属于系统级操作，主进程中设置，且必须在程序 ready 后设置</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置托盘</span></span><br><span class="line">  tray = <span class="keyword">new</span> Tray(<span class="string">&#x27;./src/assets/icon_tray.png&#x27;</span>)</span><br><span class="line">  <span class="comment">// 设置托盘菜单</span></span><br><span class="line">  <span class="keyword">const</span> trayContextMenu = Menu.buildFromTemplate([</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;打开&#x27;</span>,</span><br><span class="line">      click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        win.show()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;退出&#x27;</span>,</span><br><span class="line">      click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        app.quit()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ])</span><br><span class="line">  tray.setToolTip(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">  tray.on(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    win.show()</span><br><span class="line">  &#125;)</span><br><span class="line">  tray.on(<span class="string">&#x27;right-click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    tray.popUpContextMenu(trayContextMenu)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><h4 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h4><ul><li><p>设置 appid</p><p>package.json （”appId”: “com.ipp.electronvue”）</p></li><li><p>vue.config.js 配置 electron-builder 参数</p></li></ul><h4 id="调用-C-Dll"><a href="#调用-C-Dll" class="headerlink" title="调用 C++ Dll"></a>调用 C++ Dll</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. npm install node-gyp -g</span><br><span class="line">2. npm install windows-build-tools -g</span><br><span class="line"></span><br><span class="line">npm install ffi-napi --save</span><br><span class="line">npm install electron-edge-js --save</span><br></pre></td></tr></table></figure><p>注意：python 版本必须 2.7</p><blockquote><p>ffi-napi</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ffi = <span class="built_in">require</span>(<span class="string">&#x27;ffi-napi&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> Dll = ffi.Library(path.resolve(<span class="string">&#x27;resources/dll/MyDLL.dll&#x27;</span>), &#123;</span><br><span class="line">  Add: [<span class="string">&#x27;float&#x27;</span>, [<span class="string">&#x27;float&#x27;</span>, <span class="string">&#x27;float&#x27;</span>]],</span><br><span class="line">  Hello: [<span class="string">&#x27;string&#x27;</span>, []],</span><br><span class="line">  StrLength: [<span class="string">&#x27;int&#x27;</span>, [<span class="string">&#x27;string&#x27;</span>]]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>electron-edge-js</p></blockquote><p>windows专属功能</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">edge = <span class="built_in">require</span>(<span class="string">&#x27;electron-edge-js&#x27;</span>)</span><br><span class="line">  invoke = edge.func(&#123;</span><br><span class="line">    assemblyFile: path.resolve(<span class="string">&#x27;resources/dll/electronedge.dll&#x27;</span>),</span><br><span class="line">    typeName: <span class="string">&#x27;electronedge.Class1&#x27;</span>,</span><br><span class="line">    methodName: <span class="string">&#x27;Invoke&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> (process.platform === <span class="string">&#x27;win32&#x27;</span>) &#123;</span><br><span class="line">    invoke(<span class="string">&#x27;这是自定义字符串&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, val</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">        <span class="built_in">console</span>.log(val)</span><br><span class="line">        <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">            message: <span class="string">&#x27;dll返回的内容为：&#x27;</span> + val,</span><br><span class="line">            type: <span class="string">&#x27;success&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$notify.error(&#123;</span><br><span class="line">        title: <span class="string">&#x27;错误&#x27;</span>,</span><br><span class="line">        message: <span class="string">&#x27;此功能为windows专属功能，mac无法使用&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>报错解决方案：vue.config.js 配置 <code>externals: [&#39;electron-edge-js&#39;]</code></p><h4 id="集成-sqlite3"><a href="#集成-sqlite3" class="headerlink" title="集成 sqlite3"></a>集成 sqlite3</h4><p>需要安装node-gyp和windows-build-tools</p><pre><code>npm install sqlite3 --savenpm install （否则会出现找不到sqlite3.node）</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sq3 <span class="keyword">from</span> <span class="string">&#x27;sqlite3&#x27;</span></span><br><span class="line"><span class="keyword">const</span> pathUtil = <span class="built_in">require</span>(<span class="string">&#x27;../utils/pathUtil.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> dbPath = pathUtil.getAppResourcePath(<span class="string">&#x27;db/data.sqlite1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sqlite3 = sq3.verbose()</span><br><span class="line"><span class="keyword">const</span> db = <span class="keyword">new</span> sqlite3.Database(dbPath)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">db.serialize(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  db.run(<span class="string">&#x27;create table test(name varchar(15))&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    db.run(<span class="string">&quot;insert into test values(&#x27;hello,word&#x27;)&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      db.all(<span class="string">&#x27;select * from test&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(res))</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> db</span><br></pre></td></tr></table></figure><h4 id="执行-CMD"><a href="#执行-CMD" class="headerlink" title="执行 CMD"></a>执行 CMD</h4><ul><li>引用 child_process 模块</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; exec &#125; <span class="keyword">from</span> ‘child_process’</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 解决中文乱码问题</span><br><span class="line">npm install iconv-lite --save</span><br></pre></td></tr></table></figure><h4 id="electron-更新"><a href="#electron-更新" class="headerlink" title="electron 更新"></a>electron 更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-updater --save-dev</span><br></pre></td></tr></table></figure><h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><p> <a href="http://newgateway.gitee.io/my/guide/messager.html">跨浏览器消息通讯</a></p><p><code>postMessage</code> 可以实现不同源的页面在<code>iframe</code>中通讯， 但是不能跨浏览器窗体。<br><code>localStorage</code> 存储的值发生变化时会在当前窗体window触发 storage 事件。 多个同源的页面是共享localStorage，因此浏览器同时打开多个同源页面，只要localStorage改变了，都会收到 storage 事件。</p><p><img src="http://newgateway.gitee.io/my/assets/img/messager.0c9f7e56.png" alt="消息传递过程"></p><p> <a href="https://www.zhihu.com/people/david-zhang-92/posts">学习资料</a></p>]]></content>
      
      
      <categories>
          
          <category> Electron </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>W3C Html 标准</title>
      <link href="2021/01/27/Web%20%E6%A0%87%E5%87%86/W3C%20Html/"/>
      <url>2021/01/27/Web%20%E6%A0%87%E5%87%86/W3C%20Html/</url>
      
        <content type="html"><![CDATA[<h4 id="历史发展"><a href="#历史发展" class="headerlink" title="历史发展"></a>历史发展</h4><p>1990-1995：CERN 托管转为 IETF</p><blockquote><p>W3C</p></blockquote><p>1995： HTML 3.0<br>1997：HTML 4.0</p><p>2000：HTML 4.0 重构成 XHTML 1.0</p><pre><code>XHTML 2.0 不兼容 HTML、XHTML 1.0</code></pre><blockquote><p>WHATWG</p></blockquote><p><a href="https://whatwg-cn.github.io/html/">HTML</a></p><blockquote><p>脚本的执行</p></blockquote><p>HTML、DOM API 使得脚本无法同时运行其他脚本<br>workers 在所有浏览环境中串行所有脚本</p><blockquote><p>扩展性</p></blockquote><ul><li>class</li><li>data-*=’’</li><li><code>&lt;meta name=&quot;&quot; content=&quot;&quot;&gt;</code></li><li>ref=’’</li><li><code>&lt;script type=&#39;&#39;&gt;</code></li><li>embed</li><li>itemscope=’’ itemprop=’’ (微数据特性)</li></ul><h4 id="HTML-使用"><a href="#HTML-使用" class="headerlink" title="HTML 使用"></a>HTML 使用</h4><blockquote><p>DOM 树节点：</p></blockquote><p>DocumentType、Element、Text、Comment、ProcessingInstruction(处理指令)</p><p>DOM 树中的每个元素表示为一个对象，对象提供 API，进行操作</p><blockquote><p>安全模型</p></blockquote><p>Web 的安全模型基于‘域’，潜在攻击方式：</p><p>不验证用户输入<br>跨站脚本 XSS<br>SQL 注入</p><pre><code>+ 编写白名单过滤器注意事项img onload 运行脚本URL scheme 滥用base 任何相对连接 script 元素都可能被劫持</code></pre><p>跨站请求伪造 CSRF<br>Clickjacking</p><blockquote><p>脚本 API 使用</p></blockquote><ul><li>事件处理程序内容属性</li><li>同一个脚本创建元素和添加事件处理程序</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;games.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Games&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;gamesLogoHasLoaded(event)&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"> <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span></span><br><span class="line"><span class="javascript"> img.src = <span class="string">&#x27;games.png&#x27;</span>;</span></span><br><span class="line"><span class="javascript"> img.alt = <span class="string">&#x27;Games&#x27;</span>;</span></span><br><span class="line"> img.onload = gamesLogoHasLoaded;</span><br><span class="line"><span class="javascript"> <span class="comment">// img.addEventListener(&#x27;load&#x27;, gamesLogoHasLoaded, false); </span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>错误检查</p></blockquote><p><a href="https://validator.whatwg.org/">验证器和一致性检查器</a></p><h4 id="公共基础措施"><a href="#公共基础措施" class="headerlink" title="公共基础措施"></a>公共基础措施</h4><blockquote><p>字符编码</p></blockquote><p>一种字节流与 Unicode 字符串的转换，定义在 Encoding 中，编码包含一个编码名称和编码标签</p>]]></content>
      
      
      <categories>
          
          <category> web 标准 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GraphQL 基础用法</title>
      <link href="2021/01/18/GraphQL/GraphQL%20%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95%20/"/>
      <url>2021/01/18/GraphQL/GraphQL%20%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95%20/</url>
      
        <content type="html"><![CDATA[<p>一个用于 API 的查询语言，使用基于类型系统来执行查询的服务端运行时<br>GraphQL 服务是通过定义类型和类型上的字段来创建的，然后给每个类型上的每个字段提供解析函数。</p><p><a href="https://graphql.cn/learn/">参考文档</a></p><h4 id="查询和变更"><a href="#查询和变更" class="headerlink" title="查询和变更"></a>查询和变更</h4><p>GraphQL 是关于请求对象上的特定字段（Fields）</p><ol><li>查询和结果保持一样的数据结构</li><li>查询可交互</li><li>可以遍历先关对象和字段</li><li>可以添加备注</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  hero &#123;</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;hero&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;R2-D2&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>查询可以给字段传递参数（Arguments）</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  human(id: &quot;1000&quot;) &#123;</span><br><span class="line">    name</span><br><span class="line">    height(unit: FOOT)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;human&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;Luke Skywalker&quot;,</span><br><span class="line">      &quot;height&quot;: 5.6430448</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>备注：GraphQL 自带默认类型，可以声明自定义类型，只要能序列化成你的传输格式即可</p><ol start="6"><li>支持别名（Aliases）使用</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  empireHero: hero(episode: EMPIRE) &#123;</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">  jediHero: hero(episode: JEDI) &#123;</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>支持片段（Fragments），复用单元</li></ol><p>片段中可以使用变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">query HeroComparison($first: Int &#x3D; 3) &#123;</span><br><span class="line">  leftComparison: hero(episode: EMPIRE) &#123;</span><br><span class="line">    ...comparisonFields</span><br><span class="line">  &#125;</span><br><span class="line">  rightComparison: hero(episode: JEDI) &#123;</span><br><span class="line">    ...comparisonFields</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fragment comparisonFields on Character &#123;</span><br><span class="line">  name</span><br><span class="line">  friendsConnection(first: $first) &#123;</span><br><span class="line">    totalCount</span><br><span class="line">    edges &#123;</span><br><span class="line">      node &#123;</span><br><span class="line">        name</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;leftComparison&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;Luke Skywalker&quot;,</span><br><span class="line">      &quot;friendsConnection&quot;: &#123;</span><br><span class="line">        &quot;totalCount&quot;: 4,</span><br><span class="line">        &quot;edges&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;Han Solo&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;Leia Organa&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;C-3PO&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;rightComparison&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;R2-D2&quot;,</span><br><span class="line">      &quot;friendsConnection&quot;: &#123;</span><br><span class="line">        &quot;totalCount&quot;: 3,</span><br><span class="line">        &quot;edges&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;Luke Skywalker&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;Han Solo&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;node&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;Leia Organa&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="操作名称"><a href="#操作名称" class="headerlink" title="操作名称"></a>操作名称</h4><blockquote><p>query、mutation、subscription：操作类型的关键字</p></blockquote><p>操作类型是必需的，除非你使用查询简写语法，简写时无法使用操作名称或变量定义</p><blockquote><p><code>HeroComparison</code>：操作名称</p></blockquote><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><p>所有声明的变量都必须是标量、枚举型或者输入对象类型</p><p>$episode: Episode：可选参数<br>$episode: Episode！：非空参数</p><blockquote><p>默认变量</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">query HeroNameAndFriends($episode: Episode &#x3D; &quot;JEDI&quot;) &#123;</span><br><span class="line">  hero(episode: $episode) &#123;</span><br><span class="line">    name</span><br><span class="line">    friends &#123;</span><br><span class="line">      name</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="指令（Directives）"><a href="#指令（Directives）" class="headerlink" title="指令（Directives）"></a>指令（Directives）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">query Hero($episode: Episode, $withFriends: Boolean!) &#123;</span><br><span class="line">  hero(episode: $episode) &#123;</span><br><span class="line">    name</span><br><span class="line">    friends @include(if: $withFriends) &#123;</span><br><span class="line">      name</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"># 查询</span><br><span class="line">&#123;</span><br><span class="line">  &quot;episode&quot;: &quot;JEDI&quot;,</span><br><span class="line">  &quot;withFriends&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>@include(if: Boolean) 仅在参数为 true 时，包含此字段</li><li>@skip(if: Boolean) 如果参数为 true，跳过此字段</li></ul><h4 id="变更（Mutations）"><a href="#变更（Mutations）" class="headerlink" title="变更（Mutations）"></a>变更（Mutations）</h4>]]></content>
      
      
      <categories>
          
          <category> GraphQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GraphQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lavas 框架</title>
      <link href="2021/01/14/PWA/Lavas%20%E6%A1%86%E6%9E%B6/"/>
      <url>2021/01/14/PWA/Lavas%20%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>npm install lavas -g</p><blockquote><p>基本命令</p></blockquote><p>lavas init</p><p>lavas build</p><p>lavas dev –port 8000</p><p>lavas start //  启动服务端渲染项目</p><blockquote><p>github</p></blockquote><p><a href="https://github.com/lavas-project/lavas-template-vue">https://github.com/lavas-project/lavas-template-vue</a><br><a href="https://github.com/lavas-project/lavas-config">https://github.com/lavas-project/lavas-config</a></p><p>npm run dev/build</p><h4 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h4><p>/assets 里的内容会被 webpack 构建到生成目录的文件中，不再会单独以文件形式存在。因此 iconfont 放置在 /assets 中<br>/static 里的内容会被原样复制到生成目录中，会以独立的文件形式存在。因此 PWA 用到的 manifest.json 和一系列图标等都放置在 /static 中</p><blockquote><p>components</p></blockquote><p>存放 vue 组件，默认组件</p><p>UpdateToast.vue 也在 /core/App.vue 中被引用，用于 Service Worker 更新时提示用户<br>ProgressBar.vue 在 /core/entry-client.js 中被引用，在页面切换时在顶部展示加载的进度条</p><blockquote><p>core</p></blockquote><p>webpack entry、全局样式框架、vue app 启动器等</p><blockquote><p>/core/middlewares.js</p></blockquote><p>中间件，可选项</p><blockquote><p>pages</p></blockquote><p>存放页面文件，lavas 会自动生成路由</p><blockquote><p>store</p></blockquote><p>存放状态管理</p><blockquote><p>lavas.config.js</p></blockquote><p>build 构建相关<br>errorHandler 错误处理相关<br>middleware 中间件相关<br>router 路由规则相关<br>serviceWorker Service Worker 相关</p><blockquote><p>.lavas</p></blockquote><h4 id="自动路由生成方法"><a href="#自动路由生成方法" class="headerlink" title="自动路由生成方法"></a>自动路由生成方法</h4><blockquote><p>普通情况</p></blockquote><p>根据 /pages/ 中的 vue 文件层级生成对应的路由规则，vue 文件都会命名为首字母大写，路由规则一般均采用小写，Lavas 会将 vue 文件名的首字母改为小写处理，但不会处理中间目录的大小写</p><blockquote><p>Index.vue 特殊处理</p></blockquote><blockquote><p>动态参数</p></blockquote><p>在需要传参的页面目录新增：_参数名.vue (下划线开头表示动态参数)</p><p>访问方式：this.$route.params.id、</p><blockquote><p>嵌套路由</p></blockquote><p>在需要嵌套的路由页面目录，新建同名目录（首字母小写），目录下新建需要嵌套的路由页面文件</p><pre class="prism-token token  language-javascript">1234567lavas<span class="token operator">-</span>project└── pages<span class="token operator">/</span>    ├── Detail<span class="token punctuation">.</span>vue // 父路由    └── detail<span class="token operator">/</span>  // 嵌套路由        ├── Product<span class="token punctuation">.</span>vue // 子路由        ├── Service<span class="token punctuation">.</span>vue        └── Mixed<span class="token punctuation">.</span>vue</pre><h4 id="构建配置"><a href="#构建配置" class="headerlink" title="构建配置"></a>构建配置</h4><p><a href="https://cloud.tencent.com/developer/section/1489945">Lavas 构建配置</a></p><h4 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h4><blockquote><p>使用方式</p></blockquote><ol><li>将编写的中间件放在项目根目录 /middlewares 文件夹下</li><li>声明所要使用的中间件名称</li></ol><blockquote><p>编写说明</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;This is my first middleware.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>context</code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lavas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>骨架屏</title>
      <link href="2021/01/14/PWA/%E9%AA%A8%E6%9E%B6%E5%B1%8F/"/>
      <url>2021/01/14/PWA/%E9%AA%A8%E6%9E%B6%E5%B1%8F/</url>
      
        <content type="html"><![CDATA[<h4 id="页面性能指标"><a href="#页面性能指标" class="headerlink" title="页面性能指标"></a>页面性能指标</h4><blockquote><p>以用户为中心</p></blockquote><p>FP：first paint<br>FCP：first contentful paint<br>FMP：first meaningful paint<br>TTI：time to interactive</p><blockquote><p>优化方式</p></blockquote><p>目的：尽快渲染出首屏、减少白屏时间</p><ul><li>优化关键渲染路径，减少阻塞渲染的js、css</li></ul><p>使用 async/defer 让浏览器下载 JavaScript 的同时不阻塞 HTML 解析<br>内联页面关键部分的样式到 HTML</p><ul><li>Service Worker 缓存 AppShell</li><li>HTTP/2 Server Push</li></ul><h4 id="webpack-插件"><a href="#webpack-插件" class="headerlink" title="webpack 插件"></a>webpack 插件</h4><p><a href="https://link.zhihu.com/?target=https://github.com/lavas-project/vue-skeleton-webpack-plugin">vue-skeleton-webpack-plugin</a></p><h4 id="PRPL-模式"><a href="#PRPL-模式" class="headerlink" title="PRPL 模式"></a>PRPL 模式</h4><p>PRPL：push\preload、render、precache、lazy-load</p><ol><li>PUSH/PRELOAD，推送/预加载初始 URL 路由所需的关键资源</li><li>RENDER，渲染初始路由，尽快让应用可被交互</li><li>PRE-CACHE，用 Service Worker 预缓存剩下的路由</li><li>LAZY-LOAD 按需懒加载、懒实例化剩下的路由</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BFF 服务前端的后端</title>
      <link href="2021/01/14/%E5%89%8D%E7%AB%AF/BFF%20%E6%9C%8D%E5%8A%A1%E5%89%8D%E7%AB%AF%E7%9A%84%E5%90%8E%E7%AB%AF/"/>
      <url>2021/01/14/%E5%89%8D%E7%AB%AF/BFF%20%E6%9C%8D%E5%8A%A1%E5%89%8D%E7%AB%AF%E7%9A%84%E5%90%8E%E7%AB%AF/</url>
      
        <content type="html"><![CDATA[<h4 id="BFF"><a href="#BFF" class="headerlink" title="BFF"></a>BFF</h4><p>Back-end for Front-end</p><blockquote><p>Web 1.0</p></blockquote><p>服务端返回 html</p><blockquote><p>Web 2.0</p></blockquote><p>服务端返回<code>json</code>,实现前后端分离</p><blockquote><p>微服务</p></blockquote><ol><li>API Gateway 网关分发请求</li></ol><p>后端有时需要准备力度很细的数据返回，这个就要求前后端频繁沟通。有一些场景，后端又需要构造各种级联表单，以致微服务之间调度频繁；<br>而微服务的本质是<code>清晰的界限上下文</code>，因此在某些场景下这种设计会导致领域建模变得较为复杂</p><ol start="2"><li>CORS 前端跨域请求</li></ol><p>前端分层和建模是最近比较流行的设计趋势</p><blockquote><p>BFF</p></blockquote><p>将组装、聚合、裁剪这部分业务单独拎出来，组成一个叫Back-end for Front-end的中间层<br>服务器设计 API 时会考虑客户端的使用情况，并在此层直接进行业务逻辑的处理和转发，又称为用户体验适配器</p><p>本质：nodejs，能做请求转发和数据转化<br>实现：Graphql的服务，对前Restful、对后RPC的实现，还可以在BFF上加cache、鉴权等等操作</p><p><img src="https://image-static.segmentfault.com/339/916/3399167535-5926cf52bd7f7_articlex" alt="BFF设计"></p><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul><li>前后端彻底分离，即便后期微服务迁移，无需改动前端代码</li><li>业务更向前靠拢，琐碎的api由前端开发决定，更适配前端框架</li><li>BFF可以自开 mock,插件可以自动生成 api 文档</li><li>后端更清晰的服务边界，只需要提供粗粒度的接口</li></ul><h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul><li>增加了系统的复杂度</li><li>中间层转发增加请求延迟</li><li>需要保证端对端的测试</li><li>必须随时准备好后端异常请求</li><li>增加开发成本</li></ul><h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><p>SSR -&gt; 同构<br>服务接口的聚合、裁剪、透传（GraphQL）</p><h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><p><strong>康威定律</strong></p><p>设计系统的组织其产生的设计等价于组织间的沟通结构<br>如果系统架构不支持，你无法建立一个高效的组织</p><ol><li><p>组织沟通方式会通过系统设计表达出来</p></li><li><p>时间再多一件事情也不可能做的完美，但总有时间做完一件事情</p></li><li><p>线型系统和线型组织架构间有潜在的异质同态特性</p></li><li><p>大的系统组织总是比小系统更倾向于分解</p><p> 自管理</p></li></ol><p><strong>奥卡姆剃刀原则</strong>：——若无必要，勿增实体</p><ol><li>需要假设最少的解释往往是越接近真相的解释。</li><li>如果有某个条件是不能被我们感知和检测到的，那么和没有这个条件根本就是等价的。</li></ol><p><strong>Airbnb规范</strong></p><p><strong>WebAssembly</strong></p><p>c/c++ 编译成 js</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BFF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PWA 应用</title>
      <link href="2021/01/14/%E5%89%8D%E7%AB%AF/PWA%20%E5%BA%94%E7%94%A8/"/>
      <url>2021/01/14/%E5%89%8D%E7%AB%AF/PWA%20%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>Progressive Web Apps</p><ul><li> Web 技术编写出一个网页应用</li><li> App Manifest 和 Service Worker 来实现 PWA 的安装和离线等功能</li><li> 本质上是 Web App</li><li> 兼具 Web App 和 Native App 的优点</li></ul><p>特点： 可靠、安全、粘性</p><h4 id="安装-http-server"><a href="#安装-http-server" class="headerlink" title="安装 http-server"></a>安装 http-server</h4><p>npm install –global http-server</p><blockquote><p>用法</p></blockquote><p>http-server [path] [options]</p><p>注意：默认情况下，缓存处于打开状态。添加-c-1为禁用缓存的选项。</p><p>http-server -c-1</p><p>默认访问地址：<code>http://localhost:8080</code></p><h4 id="安装-ngrok"><a href="#安装-ngrok" class="headerlink" title="安装 ngrok"></a>安装 ngrok</h4><p><a href="https://dashboard.ngrok.com/get-started/setup">ngrok 下载地址</a></p><h4 id="简单应用示例"><a href="#简单应用示例" class="headerlink" title="简单应用示例"></a>简单应用示例</h4><ol><li><p>index.html main.css</p></li><li><p>添加 manifest.json 文件</p></li></ol><p>定义应用的名称, 图标等信息</p><ol start="3"><li>添加 Service Worker</li></ol><p>网页已经关闭的情况下还可以运行, 用来实现页面的缓存和离线, 后台通知等等功能</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(navigator.serviceWorker != <span class="literal">null</span>)&#123;</span><br><span class="line">navigator.serviceWorker.register(<span class="string">&#x27;sw.js&#x27;</span>).then(</span><br><span class="line">(registration) =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;Registered events at scope: &#x27;</span>, registration.scope)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> Service Worker 全局变量</p></blockquote><p>self: 表示 Service Worker 作用域, 也是全局变量<br>caches: 表示缓存<br>skipWaiting: 表示强制当前处在 waiting 状态的脚本进入 activate 状态<br>clients: 表示 Service Worker 接管的页面</p><ol start="4"><li>navigator.serviceWorker.register(‘sw.js’) 注册安装 Service Worker</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册完成安装时，抓取资源写入缓存</span></span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="string">&#x27;install&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  e.waitUntil(</span><br><span class="line">    caches.open(cacheStorageKey)</span><br><span class="line">    .then(<span class="function"><span class="params">cache</span> =&gt;</span> cache.addAll(cacheList))</span><br><span class="line">    .then(<span class="function">() =&gt;</span> self.skipWaiting())</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>self.skipWaiting() 方法是为了在页面更新的过程当中, 新的 Service Worker 脚本能立即激活和生效</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="string">&#x27;activate&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;[ServiceWorker] Activate&#x27;</span>)</span><br><span class="line">e.waitUntil(</span><br><span class="line">caches.keys().then(<span class="function"><span class="keyword">function</span>(<span class="params">keyList</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Promise</span>.all(keyList.map(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (key !== cacheStorageKey) &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;[ServiceWorker] Removing old cache&#x27;</span>, key)</span><br><span class="line"><span class="keyword">return</span> caches.delete(key)</span><br><span class="line">&#125;</span><br><span class="line">&#125;))</span><br><span class="line">&#125;)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">return</span> self.clients.claim()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>调用 self.clients.claim() 取得页面的控制权, 这样之后打开页面都会使用版本更新的缓存</p><h4 id="查看-Service-Worker"><a href="#查看-Service-Worker" class="headerlink" title="查看 Service Worker"></a>查看 Service Worker</h4><p>DevTools 的 Application 标签可以看到 Service Worker</p><blockquote><p>功能和特性</p></blockquote><p>独立 worker 线程，独立于当前网页进程，有独立的 worker context<br>一旦被 install，永远存在，除非 uninstall<br>具备唤醒，待机功能（存在坑）<br>可编程拦截代理请求和返回，缓存文件，缓存的文件可以被网页进程获取（包括网络离线状态）<br>离线内容开发者可控<br>可以向客户端推送消息<br>不能直接操作Dom<br>处于完全考虑，必须 HTTPS 环境下工作<br>异步实现，通过 Promise</p><h4 id="Lavas"><a href="#Lavas" class="headerlink" title="Lavas"></a>Lavas</h4><p>基于 Vue 的 PWA (Progressive Web Apps) 完整解决方案</p><p><a href="https://cloud.tencent.com/developer/section/1489942">参考文档</a></p><h4 id="踩坑记录"><a href="#踩坑记录" class="headerlink" title="踩坑记录"></a>踩坑记录</h4><blockquote><p>navigator.onLine 只会在机器未连接到局域网或路由器时返回false，其他情况下均返回true</p></blockquote><blockquote><p>Fetch</p></blockquote><ol><li><p>Fetch 是基于promise，network error 时返回 rejected 的 promise，ftp 协议不支持 Fetch</p></li><li><p>默认情况下不包括请求中的任何cookie</p><p> fetch(‘/url’, { credentials: ‘include’ })</p></li><li><p>上传JSON时忘记设置 <code>&#123;&#39;Content-Type&#39;: &#39;application/json&#39;&#125;</code></p><p> fetch(‘/url’, {</p><pre><code>method: &#39;POST&#39;,   body: JSON.stringify(&#123;text: &#39;bacon&#39;&#125;),  headers: &#123;&#39;Content-Type&#39;: &#39;application/json&#39;&#125;&#125;).then(res =&gt; res.json()).then(console.log)</code></pre></li><li><p>字符串手动拼接一个复杂的查询参数</p></li></ol><p>应该使用 URLSearchParams 类</p><ol start="5"><li><p>获取返回值</p><p> fetch(‘./url’).then(res =&gt;{</p><pre><code> return res.json()</code></pre><p> }).then(data=&gt;{</p><pre><code> console.log(data)</code></pre><p> })</p></li><li><p>兼容性问题</p></li></ol><p>由于 IE8 是 ES3，需要引入 ES5 的 polyfill: es5-shim, es5-sham<br>引入 Promise 的 polyfill: es6-promise<br>引入 fetch 探测库：fetch-detector<br>引入 fetch 的 polyfill: fetch-ie8<br>可选：如果你还使用了 jsonp，引入 fetch-jsonp<br>可选：开启 Babel 的 runtime 模式，现在就使用 async/await</p><ol start="7"><li>不支持timeout，不支持 progress，特别是 fetch 在跨域问题上与传统跨域的处理方式的区别</li></ol><p>let myHeaders = new  Headers({<br>    ‘Access-Control-Allow-Origin’:’*’,<br>    “Content-Type”:’text/plain’<br>})</p><p>fetch(url,{<br>    method:’GET’,<br>    headers:myHeaders,<br>    mode:’cors’<br>}).then(res=&gt;{<br>    return res.text()<br>}).then(data=&gt;{<br>    console.log(data)<br>})</p><p>mode设置成：‘no-cors’ 请求时，reponse 响应中 type 显示为 opaque，则这时候该使用 jsonp 或者后端代理</p><ol start="8"><li>App Shell 模型、离线 UX 注意事项</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPC 框架</title>
      <link href="2021/01/14/%E5%89%8D%E7%AB%AF/RPC%20%E6%A1%86%E6%9E%B6/"/>
      <url>2021/01/14/%E5%89%8D%E7%AB%AF/RPC%20%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h4><p>远程过程调用 Remote Procedure Call，客户程序通过接口调用另外一台服务器内部的标准或自定义函数，获得函数返回的数据进行处理</p><blockquote><p>传输协议</p></blockquote><p>OSI 通信模型中，RPC 跨越 <code>传输层</code>、<code>应用层</code></p><p>传输层常见协议：</p><ul><li>TCP, 连接是基于字节流，一种可以保证可靠数据传输的传输层协议，如网页请求资源。</li><li>UDP, 基于报文流，一种无连接的传输层协议，它无法保证数据传输可靠性，但传输效率更高，开销更小，如视频、语言电话。</li></ul><h3 id="Node-js-net-模块"><a href="#Node-js-net-模块" class="headerlink" title="Node.js net 模块"></a>Node.js net 模块</h3><ul><li>socket</li></ul><h4 id="单工通信"><a href="#单工通信" class="headerlink" title="单工通信"></a>单工通信</h4><p>客户端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;getRandomBookId&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> socket = <span class="keyword">new</span> net.Socket();</span><br><span class="line"></span><br><span class="line">socket.connect(&#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">3000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据打包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">bookId</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;buffer&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> encode = <span class="function">(<span class="params">bookId</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> buffer = Buffer.alloc(<span class="number">2</span>);</span><br><span class="line">    buffer.write(bookId);</span><br><span class="line">    <span class="built_in">console</span>.log(buffer);</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bookId = getRandomBookId();</span><br><span class="line">socket.write(encode(bookId));</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`书籍 <span class="subst">$&#123;bookId&#125;</span>: <span class="subst">$&#123;buffer.toString()&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>服务端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;searchBookName&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = net.createServer(<span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">    socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">        socket.write(searchBookName(buffer.toString()));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h4 id="半双工通信"><a href="#半双工通信" class="headerlink" title="半双工通信"></a>半双工通信</h4><p>客户端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;getRandomBookId&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> socket = <span class="keyword">new</span> net.Socket();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentBookId = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">socket.connect(&#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">3000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据打包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">bookId</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;buffer&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> encode = <span class="function">(<span class="params">bookId</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> buffer = Buffer.alloc(<span class="number">2</span>);</span><br><span class="line">    buffer.write(bookId);</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发送请求</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> sendRequest = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    currentBookId = getRandomBookId();</span><br><span class="line">    socket.write(encode(currentBookId));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sendRequest();</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`书籍 <span class="subst">$&#123;currentBookId&#125;</span>: <span class="subst">$&#123;buffer.toString()&#125;</span>`</span>);</span><br><span class="line">    sendRequest();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>服务端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;searchBookName&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = net.createServer(<span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">    socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            socket.write(searchBookName(buffer.toString()));</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h4 id="全双工通信"><a href="#全双工通信" class="headerlink" title="全双工通信"></a>全双工通信</h4><p>TCP传输协议面向流的，没有消息保护边界，所有会出现 <code>粘包</code> 和 <code>拆包</code> </p><p>解决方案：指定协议规则（包序号1-2字节 + 包长度3-6字节 + 包主体）</p><p>客户端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;getRandomBookId&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> socket = <span class="keyword">new</span> net.Socket();</span><br><span class="line"></span><br><span class="line">socket.connect(&#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">3000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 计数器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> num;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            num += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数据包序号</span></span><br><span class="line"><span class="keyword">const</span> currentIndex = count();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 组装一个二进制包，默认协议内容为：1-2字节为包序号，3-6字节为包长度，后面是包内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;buffer&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> encode = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 内容</span></span><br><span class="line">    <span class="keyword">const</span> body = Buffer.alloc(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">const</span> bookId = getRandomBookId();</span><br><span class="line">    body.write(bookId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 头内容</span></span><br><span class="line">    <span class="keyword">const</span> header = Buffer.alloc(<span class="number">6</span>);</span><br><span class="line">    header.writeInt16BE(currentIndex.get());</span><br><span class="line">    header.writeInt32BE(body.length, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 拼接数据包</span></span><br><span class="line">    <span class="keyword">const</span> buffer = Buffer.concat([header, body]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`包<span class="subst">$&#123;currentIndex.get()&#125;</span>传输的课程 id 为<span class="subst">$&#123;bookId&#125;</span>`</span>);</span><br><span class="line">    currentIndex.add();</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 拆解一个二进制包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;buffer&#125;</span> </span>二进制数据包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> decode = <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (buffer <span class="keyword">instanceof</span> Buffer) &#123;</span><br><span class="line">        <span class="keyword">const</span> header = buffer.slice(<span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">const</span> body = buffer.slice(<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">const</span> index = header.readUInt16BE();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            success: <span class="literal">true</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                index,</span><br><span class="line">                text: body.toString(),</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        success: <span class="literal">false</span>,</span><br><span class="line">        message: <span class="string">&#x27;数据包格式不正确&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查获取一个包的长度，默认公示为：头部长度（6）+ 存储在头部的包长度</span></span><br><span class="line"><span class="comment"> * 如果长度小于6，则说明被拆包，需要与下个包数据拼接使用，故返回 0 。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;buffer&#125;</span> <span class="variable">buffer</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> checkBufferLen = <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (buffer <span class="keyword">instanceof</span> Buffer) &#123;</span><br><span class="line">        <span class="comment">// 头部信息不全时，可能是因为内容超长被拆包了</span></span><br><span class="line">        <span class="keyword">if</span> (buffer.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> length = <span class="number">6</span> + buffer.readInt32BE(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> buffer.length &gt;= length ? length : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 残留的数据</span></span><br><span class="line"><span class="keyword">let</span> residualBuffer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 拼接残留的 buffer</span></span><br><span class="line">    <span class="keyword">if</span>(residualBuffer) &#123;</span><br><span class="line">        buffer = Buffer.concat([residualBuffer, buffer]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> completeLen = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分包解析</span></span><br><span class="line">    <span class="keyword">while</span>(completeLen = checkBufferLen(buffer)) &#123;</span><br><span class="line">        <span class="keyword">const</span> package = buffer.slice(<span class="number">0</span>, completeLen);</span><br><span class="line">        buffer = buffer.slice(completeLen);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> res = decode(package);</span><br><span class="line">        <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`包<span class="subst">$&#123;res.data.index&#125;</span>, 返回值是<span class="subst">$&#123;res.data.text&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    residualBuffer = buffer;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否模拟网络波动</span></span><br><span class="line"><span class="keyword">const</span> isRandom = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 连续发出 10 个请求</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isRandom) &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            socket.write(encode());</span><br><span class="line">        &#125;, <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.random() * <span class="number">1000</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        socket.write(encode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>服务端：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">&#x27;net&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;searchBookName&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../code&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 组装一个二进制包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>index 包序号</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data 包内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;buffer&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> encode = <span class="function">(<span class="params">index, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> body = Buffer.from(data);</span><br><span class="line">    <span class="keyword">const</span> header = Buffer.alloc(<span class="number">6</span>);</span><br><span class="line">    header.writeInt16BE(index);</span><br><span class="line">    header.writeInt32BE(body.length, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Buffer.concat([header, body]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 拆解一个二进制包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;buffer&#125;</span> </span>二进制数据包</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> decode = <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (buffer <span class="keyword">instanceof</span> Buffer) &#123;</span><br><span class="line">        <span class="keyword">const</span> header = buffer.slice(<span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">const</span> index = header.readUInt16BE();</span><br><span class="line">        <span class="keyword">const</span> body = buffer.slice(<span class="number">6</span>).toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            success: <span class="literal">true</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                index,</span><br><span class="line">                text: body,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        success: <span class="literal">false</span>,</span><br><span class="line">        message: <span class="string">&#x27;数据包格式不正确&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查获取一个包的长度，默认公示为：头部长度（6）+ 存储在头部的包长度</span></span><br><span class="line"><span class="comment"> * 如果长度小于6，则说明被拆包，需要与下个包数据拼接使用，故返回 0 。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;buffer&#125;</span> <span class="variable">buffer</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> checkBufferLen = <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (buffer <span class="keyword">instanceof</span> Buffer) &#123;</span><br><span class="line">        <span class="comment">// 头部信息不全时，可能是因为内容超长被拆包了</span></span><br><span class="line">        <span class="keyword">if</span> (buffer.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> length = <span class="number">6</span> + buffer.readInt32BE(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> buffer.length &gt;= length ? length : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否模拟网络波动</span></span><br><span class="line"><span class="keyword">const</span> isRandom = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = net.createServer(<span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> residualBuffer = <span class="literal">null</span>;</span><br><span class="line">    socket.on(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 拼接残留的 buffer</span></span><br><span class="line">        <span class="keyword">if</span> (residualBuffer) &#123;</span><br><span class="line">            buffer = Buffer.concat([residualBuffer, buffer]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> completeLen = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 分包解析</span></span><br><span class="line">        <span class="keyword">while</span>(completeLen = checkBufferLen(buffer)) &#123;</span><br><span class="line">            <span class="keyword">const</span> package = buffer.slice(<span class="number">0</span>, completeLen);</span><br><span class="line">            buffer = buffer.slice(completeLen);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> res = decode(package);</span><br><span class="line">            <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">                <span class="keyword">if</span>(isRandom) &#123;</span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        socket.write(</span><br><span class="line">                            encode(res.data.index, searchBookName(res.data.text))</span><br><span class="line">                        );</span><br><span class="line">                    &#125;, <span class="built_in">Math</span>.round(<span class="built_in">Math</span>.random() * <span class="number">1000</span>));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    socket.write(</span><br><span class="line">                        encode(res.data.index, searchBookName(res.data.text))</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        residualBuffer = buffer;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h3 id="RPC框架内存使用"><a href="#RPC框架内存使用" class="headerlink" title="RPC框架内存使用"></a>RPC框架内存使用</h3><blockquote><p>RPC 主要工作</p></blockquote><p>网络收发 – 压缩解压 – 序列化反序列化</p><p>本质上一条 RPC 消息内存是离散的，都需要有自己的 buffer 类型</p><blockquote><p>buffer 设计</p></blockquote><p>链表每块大小怎么定义？</p><blockquote><p>malloc/free</p></blockquote><p>作为系统调度，比较耗费性能<br>一般来说内存分配交给 ptmalloc、jemalloc、tcmalloc</p><blockquote><p>碎片管理</p></blockquote><p>碎片管理会分很多层，大小、使用时间等都会影响这块内存回收到哪层。那么我们组织这些内存碎片的数据结构，必须满足能够互斥、快速找到适合的碎片、碎片及时回收等需求</p><h3 id="RPC-核心"><a href="#RPC-核心" class="headerlink" title="RPC 核心"></a>RPC 核心</h3><p>目的：调用远程方法像调用本地一样无差别<br>本质：屏蔽远程调用网络相关细节</p><blockquote><p>调用基本流程通过动态代理实现</p></blockquote><p>RPC 会给接口生成一个代理类，所以我们调用这个接口实际调用的是动态生成的代理类，由代理类来触发远程调用</p><p>动态代理: Spring（AOP）、JDK 动态代理、cglib、Dubbo（Javassist）</p><img src="/images/RPC 调用.jpg"/><blockquote><p>调用细节</p></blockquote><p><img src="https://pic1.zhimg.com/80/v2-619633f1a8ff09c38a0611b1a0d62afc_1440w.jpg" alt="调用细节"></p><ol><li><p>序列化处理参数，需要综合考虑通用性、性能、可读性和兼容性</p></li><li><p>RPC协议：协议头 + 协议体</p><p> 协议头放一些元数据，包括：魔法位、协议的版本、消息的类型、序列化方式、整体长度、头长度、扩展位等。<br> 协议体就是放请求的数据</p></li><li><p>网络传输</p><p> IO 模型：</p><ul><li>IO 多路复用 （<code>推荐</code>大多数RPC调用场景都是高并发）</li><li>同步阻塞 BIO</li><li>同步非阻塞 NIO</li><li>异步非阻塞 AIO</li></ul><p>JAVA 使用的轮子 Netty</p></li><li><p>工厂级别 RPC，集群部署，需要注册中心</p></li><li><p>路由分组策略：实现分组调用、灰度发布、流量隔离等</p></li><li><p>负载均衡</p></li><li><p>异常重试</p></li><li><p>限流熔断</p></li></ol><blockquote><p>泛化调用</p></blockquote><h4 id="常见-RPC-框架"><a href="#常见-RPC-框架" class="headerlink" title="常见 RPC 框架"></a>常见 RPC 框架</h4><p>RMI、Dubbo、gRPC、Hessian（二进制协议）、Thrift</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React 进阶</title>
      <link href="2021/01/04/React/React%20%E8%BF%9B%E9%98%B6/"/>
      <url>2021/01/04/React/React%20%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Toolbar</span> <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toolbar</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Toolbar 组件接受一个额外的“theme”属性，然后传递给 ThemedButton 组件。</span></span><br><span class="line">  <span class="comment">// 如果应用中每一个单独的按钮都需要知道 theme 的值，这会是件很麻烦的事，</span></span><br><span class="line">  <span class="comment">// 因为必须将这个值层层传递所有组件。</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;ThemedButton theme=&#123;props.theme&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">theme</span>=<span class="string">&#123;this.props.theme&#125;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 Context</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Context 可以让我们无须明确地传遍每一个组件，就能将值深入传递进组件树。</span></span><br><span class="line"><span class="comment">// 为当前的 theme 创建一个 context（“light”为默认值）。</span></span><br><span class="line"><span class="keyword">const</span> ThemeContext = React.createContext(<span class="string">&#x27;light&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 使用一个 Provider 来将当前的 theme 传递给以下的组件树。</span></span><br><span class="line">    <span class="comment">// 无论多深，任何组件都能读取这个值。</span></span><br><span class="line">    <span class="comment">// 在这个例子中，我们将 “dark” 作为当前的值传递下去。</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;ThemeContext.Provider value=<span class="string">&quot;dark&quot;</span>&gt;</span><br><span class="line">        &lt;Toolbar /&gt;</span><br><span class="line">      &lt;/ThemeContext.Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间的组件再也不必指明往下传递 theme 了。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toolbar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;ThemedButton /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 指定 contextType 读取当前的 theme context。</span></span><br><span class="line">  <span class="comment">// React 会往上找到最近的 theme Provider，然后使用它的值。</span></span><br><span class="line">  <span class="comment">// 在这个例子中，当前的 theme 值为 “dark”。</span></span><br><span class="line">  <span class="keyword">static</span> contextType = ThemeContext;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">theme</span>=<span class="string">&#123;this.context&#125;</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：如果只是想避免层层传递属性，组件组合可能是更好的解决方案</p><blockquote><p>API</p></blockquote><p>[React.createContext]</p><p>[Context.Provider]</p><p>一个 Provide 可以和多个消费组件有对应关系，多个 Provide 可以嵌套使用，里层数据覆盖外层<br>当 Provide 的 value 值发生改变时，内部所有的消费组件都会重新渲染</p><p>Provider 及其内部 consumer 组件都不受制于 <code>shouldComponentUpdate</code> 函数，因此当 consumer 组件在其祖先组件退出更新的情况下也能更新</p><p>[Class.contextType]</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> contextType = MyContext <span class="comment">// public class fields 语法</span></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="built_in">this</span>.context</span><br><span class="line">    <span class="comment">/* 基于这个值进行渲染工作 */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>挂载在 class 上的 <code>contextType</code> 属性会被重赋值为 Context 对象，类组件可以通过 <code>this.context</code> 消费最近的 context 值，可以在任何生命周期中访问，包括 render</p><p>[Context.Consumer]</p><p>React 组件也可以订阅到 context 变更，在函数式组件中完成订阅 context</p><p>[Context.displayName]</p><p>context 对象接受一个名为 displayName 的 property，类型为字符串</p><p>注意事项：</p><p>context 会使用参考标识（reference identity）来决定何时进行渲染，Provide 的　value　值最好是基本数据类型或内存地址</p><h4 id="错误边界"><a href="#错误边界" class="headerlink" title="错误边界"></a>错误边界</h4><p>UI 的 javascript 错误不应该导致整个应用崩溃。<code>错误边界</code>是一种 React 组件，可以捕获并打印发生在子组件树任何位置的 javascript 错误，并且提供备用UI渲染</p><p>无法捕获的错误：</p><ul><li>事件处理</li><li>异步代码</li><li>服务端渲染</li><li>自身错误</li></ul><p>使用方法：</p><p>class 组件中定义了 static <code>getDerivedStateFromError()</code> 或 <code>componentDidCatch()</code> 这两个生命周期方法中的任意一个（或两个）时，那么它就变成一个错误边界。前者 渲染备用 UI，后者打印错误信息</p><pre><code>只有 class 组件才可以成为错误边界组件</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props)</span><br><span class="line">    <span class="built_in">this</span>.state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="title">getDerivedStateFromError</span>(<span class="params">error</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 更新 state 使下一次渲染能够显示降级后的 UI</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentDidCatch</span>(<span class="params">error, errorInfo</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 你同样可以将错误日志上报给服务器</span></span><br><span class="line">    logErrorToMyService(error, errorInfo)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.state.hasError) &#123;</span><br><span class="line">      <span class="comment">// 你可以自定义降级后的 UI 并渲染</span></span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Something went wrong.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.props.children</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Refs-转发"><a href="#Refs-转发" class="headerlink" title="Refs 转发"></a>Refs 转发</h4><p>React.forwardRef 来获取传递给它的 ref</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">  &lt;button ref=&#123;ref&#125; className=<span class="string">&quot;FancyButton&quot;</span>&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以直接获取 DOM button 的 ref：</span></span><br><span class="line"><span class="keyword">const</span> ref = React.createRef()</span><br><span class="line">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/FancyButton&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack-bundle-analyzer插件</title>
      <link href="2020/12/26/Vue/webpack-bundle-analyzer%E6%8F%92%E4%BB%B6/"/>
      <url>2020/12/26/Vue/webpack-bundle-analyzer%E6%8F%92%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>安装webpack-bundle-analyzer</p></blockquote><pre><code>npm install --save-dev webpack-bundle-analyzer</code></pre><blockquote><p>解决 ‘NODE_ENV’ 不是内部或外部命令，也不是可运行的程序或批处理文件 的报错</p></blockquote><pre><code>npm install cross-env –save -dev</code></pre><blockquote><p>配置</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">configureWebpack: &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> BundleAnalyzerPlugin(&#123;</span><br><span class="line">      analyzerMode: <span class="string">&quot;server&quot;</span>,</span><br><span class="line">      analyzerHost: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">      analyzerPort: <span class="number">8888</span>,</span><br><span class="line">      reportFilename: <span class="string">&quot;report.html&quot;</span>,</span><br><span class="line">      defaultSizes: <span class="string">&quot;parsed&quot;</span>,</span><br><span class="line">      openAnalyzer: <span class="literal">true</span>,</span><br><span class="line">      generateStatsFile: <span class="literal">false</span>,</span><br><span class="line">      statsFilename: <span class="string">&quot;stats.json&quot;</span>,</span><br><span class="line">      statsOptions: <span class="literal">null</span>,</span><br><span class="line">      logLevel: <span class="string">&quot;info&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>package.json</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;webpack-dev-server --inline --progress --config build/webpack.dev.conf.js --open --hot&quot;</span>,</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="string">&quot;npm run dev&quot;</span>,</span><br><span class="line">    <span class="string">&quot;unit&quot;</span>: <span class="string">&quot;jest --config test/unit/jest.conf.js --coverage&quot;</span>,</span><br><span class="line">    <span class="string">&quot;e2e&quot;</span>: <span class="string">&quot;node test/e2e/runner.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;npm run unit &amp;&amp; npm run e2e&quot;</span>,</span><br><span class="line">    <span class="string">&quot;lint&quot;</span>: <span class="string">&quot;eslint --ext .js,.vue src test/unit test/e2e/specs&quot;</span>,</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;node build/build.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;analyz&quot;</span>: <span class="string">&quot;cross-env NODE_ENV=production npm_config_report=true npm run build&quot;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>npm run analyz</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebPack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Make 构建 Node.js 项目</title>
      <link href="2020/12/26/%E5%89%8D%E7%AB%AF/Make%20%E6%9E%84%E5%BB%BA%20Node.js%20%E9%A1%B9%E7%9B%AE/"/>
      <url>2020/12/26/%E5%89%8D%E7%AB%AF/Make%20%E6%9E%84%E5%BB%BA%20Node.js%20%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="网站项目构建方案"><a href="#网站项目构建方案" class="headerlink" title="网站项目构建方案"></a>网站项目构建方案</h4><ul><li>方案一：基于Node.js的专用构建工具（Grunt、Gulp、Brunch、Broccoli、Mimosa）</li><li>方案二：npm run命令</li><li>方案三：make命令</li></ul><blockquote><p>Make 优点</p></blockquote><p>（1） 插件问题<br>（2） 兼容性问题<br>（3） 语法问题<br>（4） 功能问题</p><h4 id="常见构建任务"><a href="#常见构建任务" class="headerlink" title="常见构建任务"></a>常见构建任务</h4><ul><li>检查语法</li><li>编译模板</li><li>转码</li><li>合并</li><li>压缩</li><li>测试</li><li>删除</li></ul><p>涉及工具（JSHint、handlebars、CoffeeScript、uglifyjs、mocha）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;coffee-script&quot;</span>: <span class="string">&quot;~1.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;handlebars&quot;</span>: <span class="string">&quot;~3.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;jshint&quot;</span>: <span class="string">&quot;^2.6.3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mocha&quot;</span>: <span class="string">&quot;~2.2.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;uglify-js&quot;</span>: <span class="string">&quot;~2.4.17&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Makefile-配置"><a href="#Makefile-配置" class="headerlink" title="Makefile 配置"></a>Makefile 配置</h4><blockquote><p>通用配置</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Make </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React 语法</title>
      <link href="2020/12/25/React/React%20%E8%AF%AD%E6%B3%95/"/>
      <url>2020/12/25/React/React%20%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h4 id="JSX-嵌入表达式"><a href="#JSX-嵌入表达式" class="headerlink" title="JSX 嵌入表达式"></a>JSX 嵌入表达式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatName</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> user.firstName + <span class="string">&#x27; &#x27;</span> + user.lastName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  firstName: <span class="string">&#x27;Harper&#x27;</span>,</span><br><span class="line">  lastName: <span class="string">&#x27;Perez&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = (</span><br><span class="line">  &lt;h1&gt;</span><br><span class="line">    Hello, &#123;formatName(user)&#125;!</span><br><span class="line">  &lt;/h1&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  element,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><blockquote><p>特定属性</p></blockquote><p>const element = <div tabIndex="0"></div></p><p>const element = <img src={user.avatarUrl}></img></p><blockquote><p>防止注入攻击</p></blockquote><p>React DOM 渲染时，默认会进行转义</p><p>Babel 会将 JSX 转译成 React.createElement() 函数调用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = (</span><br><span class="line">  &lt;h1 className=<span class="string">&quot;greeting&quot;</span>&gt;</span><br><span class="line">    Hello, world!</span><br><span class="line">  &lt;/h1&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">等价于</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = React.createElement(</span><br><span class="line">  <span class="string">&#x27;h1&#x27;</span>,</span><br><span class="line">  &#123;<span class="attr">className</span>: <span class="string">&#x27;greeting&#x27;</span>&#125;,</span><br><span class="line">  <span class="string">&#x27;Hello, world!&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>React 元素</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">  type: <span class="string">&#x27;h1&#x27;</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    className: <span class="string">&#x27;greeting&#x27;</span>,</span><br><span class="line">    children: <span class="string">&#x27;Hello, world!&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>React 元素：<code>不可变对象</code></p><h4 id="组件、Props"><a href="#组件、Props" class="headerlink" title="组件、Props"></a>组件、Props</h4><blockquote><p>函数组件</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>class 组件</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>组件名必须大写字母开头，React 默认小写字母开头的组件为原生 DOM 标签</p><blockquote><p>组件组合</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello, &#123; props.name &#125; <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt; <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span>=<span class="string">&quot;Sara&quot;</span>/&gt;</span></span> <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span>=<span class="string">&quot;Cahal&quot;</span>/&gt;</span></span> <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span>=<span class="string">&quot;Edite&quot;</span>/&gt;</span></span> &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;App/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="组件拆分"><a href="#组件拆分" class="headerlink" title="组件拆分"></a>组件拆分</h4><blockquote><p>Comment 组件</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Comment</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;Comment&quot;</span>&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;UserInfo&quot;</span>&gt;</span><br><span class="line">        &lt;img className=<span class="string">&quot;Avatar&quot;</span></span><br><span class="line">          src=&#123;props.author.avatarUrl&#125;</span><br><span class="line">          alt=&#123;props.author.name&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;div className=<span class="string">&quot;UserInfo-name&quot;</span>&gt;</span><br><span class="line">          &#123;props.author.name&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;Comment-text&quot;</span>&gt;</span><br><span class="line">        &#123;props.text&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;Comment-date&quot;</span>&gt;</span><br><span class="line">        &#123;formatDate(props.date)&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>组件化模块</p></blockquote><ul><li>Avatar 组件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Avatar</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">  retrun (</span><br><span class="line">    &lt;img className=<span class="string">&quot;Avatar&quot;</span></span><br><span class="line">      src=&#123;props.user.avatarUrl&#125;</span><br><span class="line">      alt=&#123;props.user.name&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>UserInfo 组件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UserInfo</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;UserInfo&quot;</span>&gt;</span><br><span class="line">      &lt;Avatar user=&#123;props.user&#125; /&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;UserInfo-name&quot;</span>&gt;</span><br><span class="line">        &#123;props.user.name&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>优化后 Comment 组件</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Comment</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;Comment&quot;</span>&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;UserInfo user=&#123; props.author &#125;/&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div className=<span class="string">&quot;Comment-text&quot;</span>&gt;</span><br><span class="line">        &#123;props.text&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;Comment-date&quot;</span>&gt;</span><br><span class="line">        &#123;formatDate(props.date)&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：所有的 React 组件，必须保护 props 不被更改</p><h4 id="State"><a href="#State" class="headerlink" title="State"></a>State</h4><p>State 类似于 Props，但是 State 是私有的，完全受控于当前组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props);</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;<span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 生命周期方法  ↓↓↓↓↓↓</span></span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.timerID = <span class="built_in">setInterval</span>(</span><br><span class="line">      () =&gt; <span class="built_in">this</span>.tick(),</span><br><span class="line">      <span class="number">1000</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment">// 组件已经被渲染到 DOM 中后运行</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentWillUnmount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="built_in">this</span>.timerID)</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ↑↑↑↑↑↑</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">tick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &lt;h2&gt;It is &#123;this.props.date.toLocaleTimeString()&#125;.&lt;/h2&gt;</span></span><br><span class="line">        &lt;h2&gt;It is &#123;<span class="built_in">this</span>.state.date.toLocaleTimeString()&#125;.&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Clock /&gt;, <span class="comment">// date=&#123;new Date()&#125;</span></span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><pre><code>Class 组件应该始终使用 props 参数来调用父类的构造函数。</code></pre><p>注意：</p><p>构造函数是唯一可以给 this.state 赋值的地方<br>state 更新可能是异步的，解决方法 this.setState((state, props) =&gt; { … })</p><h4 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 构造函数中必须绑定 this，否则回调中 this ==&gt; undefined</span></span><br><span class="line"><span class="built_in">this</span>.activateLasers = <span class="built_in">this</span>.activateLasers.bind(<span class="built_in">this</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类中方法 activateLasers</span></span><br><span class="line"></span><br><span class="line">&lt;button onClick=&#123; activateLasers &#125;&gt;</span><br><span class="line">  事件触发</span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure><p>事件命名：小驼峰<br>JSX 中，表达式的方式插入<code>函数</code>作为事件处理函数</p><p><code>e.preventDefault()</code> 实现阻止默认行为</p><blockquote><p>事件处理函数传参</p></blockquote><p>&lt;button onClick={(e) =&gt; this.deleteRow(id, e)}&gt;Delete Row</button><br>&lt;button onClick={this.deleteRow.bind(this, id)}&gt;Delete Row</button></p><p>箭头函数显示传入 e，bind方式隐式传入 e</p><h4 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h4><p>&amp;&amp; 、 三目运算符</p><p>组件的 render 方法中返回 null 并不会影响组件的生命周期</p><h4 id="列表、key"><a href="#列表、key" class="headerlink" title="列表、key"></a>列表、key</h4><p>元素的 key 只有放在就近的数组上下文中<br>map() 方法中的元素需要设置 key 属性<br>key 只在兄弟节点间必须唯一</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberList</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> numbers = props.numbers;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &#123;numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">        &lt;ListItem key=&#123;number.toString()&#125;</span><br><span class="line">                  value=&#123;number&#125; /&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h4><blockquote><p>受控组件</p></blockquote><p>React 的 state 成为“唯一数据源”，渲染表单的 React 组件还控制着用户输入过程中表单发生的操作，被控制取值的表单输入元素即为’受控组件’</p><h4 id="状态提升"><a href="#状态提升" class="headerlink" title="状态提升"></a>状态提升</h4><p>React 中，将多个组件中需要共享的 state 向上移动到它们的最近共同父组件中，便可实现共享 state</p><p>props 只读，要修改属性值，通过”受控组件”进行修改</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TemperatureInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props);</span><br><span class="line">    <span class="built_in">this</span>.handleChange = <span class="built_in">this</span>.handleChange.bind(<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleChange</span>(<span class="params">e</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.props.onTemperatureChange(e.target.value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> temperature = <span class="built_in">this</span>.props.temperature;</span><br><span class="line">    <span class="keyword">const</span> scale = <span class="built_in">this</span>.props.scale;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;fieldset&gt;</span><br><span class="line">        &lt;legend&gt;Enter temperature <span class="keyword">in</span> &#123;scaleNames[scale]&#125;:&lt;/legend&gt;</span><br><span class="line">        &lt;input value=&#123;temperature&#125;</span><br><span class="line">               onChange=&#123;<span class="built_in">this</span>.handleChange&#125; /&gt;</span><br><span class="line">      &lt;/fieldset&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Calculator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props);</span><br><span class="line">    <span class="built_in">this</span>.handleCelsiusChange = <span class="built_in">this</span>.handleCelsiusChange.bind(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.handleFahrenheitChange = <span class="built_in">this</span>.handleFahrenheitChange.bind(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;<span class="attr">temperature</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">scale</span>: <span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleCelsiusChange</span>(<span class="params">temperature</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123;<span class="attr">scale</span>: <span class="string">&#x27;c&#x27;</span>, temperature&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleFahrenheitChange</span>(<span class="params">temperature</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123;<span class="attr">scale</span>: <span class="string">&#x27;f&#x27;</span>, temperature&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> scale = <span class="built_in">this</span>.state.scale;</span><br><span class="line">    <span class="keyword">const</span> temperature = <span class="built_in">this</span>.state.temperature;</span><br><span class="line">    <span class="keyword">const</span> celsius = scale === <span class="string">&#x27;f&#x27;</span> ? tryConvert(temperature, toCelsius) : temperature;</span><br><span class="line">    <span class="keyword">const</span> fahrenheit = scale === <span class="string">&#x27;c&#x27;</span> ? tryConvert(temperature, toFahrenheit) : temperature;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;TemperatureInput</span><br><span class="line">          scale=<span class="string">&quot;c&quot;</span></span><br><span class="line">          temperature=&#123;celsius&#125;</span><br><span class="line">          onTemperatureChange=&#123;<span class="built_in">this</span>.handleCelsiusChange&#125; /&gt;</span><br><span class="line">        &lt;TemperatureInput</span><br><span class="line">          scale=<span class="string">&quot;f&quot;</span></span><br><span class="line">          temperature=&#123;fahrenheit&#125;</span><br><span class="line">          onTemperatureChange=&#123;<span class="built_in">this</span>.handleFahrenheitChange&#125; /&gt;</span><br><span class="line">        &lt;BoilingVerdict</span><br><span class="line">          celsius=&#123;<span class="built_in">parseFloat</span>(celsius)&#125; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="组合、继承"><a href="#组合、继承" class="headerlink" title="组合、继承"></a>组合、继承</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FancyBorder</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#123;<span class="string">&#x27;FancyBorder FancyBorder-&#x27;</span> + props.color&#125;&gt;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WelcomeDialog</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;FancyBorder color=<span class="string">&quot;blue&quot;</span>&gt;</span><br><span class="line">      &lt;h1 className=<span class="string">&quot;Dialog-title&quot;</span>&gt;</span><br><span class="line">        Welcome</span><br><span class="line">      &lt;/h1&gt;</span><br><span class="line">      &lt;p className=<span class="string">&quot;Dialog-message&quot;</span>&gt;</span><br><span class="line">        Thank you <span class="keyword">for</span> visiting our spacecraft!</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    &lt;/FancyBorder&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>FancyBorder JSX 标签中 <code>所有内容</code> 作为 <code>children</code> prop 传递给 FancyBorder 组件</p><blockquote><p>插槽</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SplitPane</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">&quot;SplitPane&quot;</span>&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;SplitPane-left&quot;</span>&gt;</span><br><span class="line">        &#123;props.left&#125; <span class="comment">// 插槽</span></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div className=<span class="string">&quot;SplitPane-right&quot;</span>&gt;</span><br><span class="line">        &#123;props.right&#125; <span class="comment">// 插槽</span></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;SplitPane</span><br><span class="line">      left=&#123;</span><br><span class="line">        &lt;Contacts /&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      right=&#123;</span><br><span class="line">        &lt;Chat /&gt;</span><br><span class="line">      &#125; /&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>React 中，可以将任何东西作为 props 进行传递，默认内容 children</p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2020/12/12/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2020/12/12/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="2020/12/11/%E5%89%8D%E7%AB%AF/parse/"/>
      <url>2020/12/11/%E5%89%8D%E7%AB%AF/parse/</url>
      
        <content type="html"><![CDATA[const recast = require('recast');const code = `function add(a,b){return a + b}`;const ast = recast.parse(code);const add = ast.program.body[0];console.log(add);]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pointer-events:none</title>
      <link href="2020/12/03/Css/pointer-events/"/>
      <url>2020/12/03/Css/pointer-events/</url>
      
        <content type="html"><![CDATA[<p>pointer-events:none 让元素实体<code>虚化</code>，即海市蜃楼</p><p>注意：键盘事件无法过滤</p><p>a 标签应用 disabled 可以禁用键盘事件（避开tab键的索引）【<code>绝大多数浏览器</code>】</p><p>禁用a标签链接或按钮的完美组合是：pointer-events:none &amp; without href</p><blockquote><p>兼容性</p></blockquote><p>FireFox浏览器，Chrome都支持</p><blockquote><p>pointer-events扩展之浏览器支持的JS判断</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> supportsPointerEvents = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dummy = <span class="built_in">document</span>.createElement(<span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span>(!(<span class="string">&#x27;pointerEvents&#x27;</span> <span class="keyword">in</span> dummy.style)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  dummy.style.pointerEvents = <span class="string">&#x27;auto&#x27;</span>;</span><br><span class="line">  dummy.style.pointerEvents = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dummy);</span><br><span class="line">  <span class="keyword">var</span> r = getComputedStyle(dummy).pointerEvents === <span class="string">&#x27;auto&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.removeChild(dummy);</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><blockquote><p>pointer-events扩展之幻影特性的JS替代实现</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noPointerEvents</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">    $(element).bind(<span class="string">&#x27;click mouseover&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        <span class="keyword">var</span> x = evt.pageX, y = evt.pageY,</span><br><span class="line">    under = <span class="built_in">document</span>.elementFromPoint(x, y);</span><br><span class="line">        <span class="built_in">this</span>.style.display = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        evt.stopPropagation();</span><br><span class="line">        evt.preventDefault();</span><br><span class="line">        $(under).trigger(evt.type);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> css3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>canvas 图片加密</title>
      <link href="2020/12/03/Javascript/canvas%20%E5%9B%BE%E7%89%87%E5%8A%A0%E5%AF%86/"/>
      <url>2020/12/03/Javascript/canvas%20%E5%9B%BE%E7%89%87%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<p><canvas id="canvas" width="256" height="256"></canvas></p><script>var ctx = document.getElementById('canvas').getContext('2d')</script><h4 id="加密信息"><a href="#加密信息" class="headerlink" title="加密信息"></a>加密信息</h4><script>var textDatactx.font='30px Microsoft Yahei'ctx.fillText('日升于东', 60, 130)textData = ctx.getImageData(0,0, ctx.canvas.width, ctx.canvas.height).dataconsole.log('textData')console.log(textData)</script><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> textData</span><br><span class="line">ctx.font=<span class="string">&#x27;30px Microsoft Yahei&#x27;</span></span><br><span class="line">ctx.fillText(<span class="string">&#x27;日升于东&#x27;</span>, <span class="number">60</span>, <span class="number">130</span>)</span><br><span class="line">textData = ctx.getImageData(<span class="number">0</span>,<span class="number">0</span>, ctx.canvas.width, ctx.canvas.height).data</span><br></pre></td></tr></table></figure><h4 id="图片信息"><a href="#图片信息" class="headerlink" title="图片信息"></a>图片信息</h4><script>var mergeData = function(newData, color){  var oData = originalData.data // 原始图片信息  var bit_offset = {    R: { bit:0, offset: 3},    G: { bit:1, offset: 2},    B: { bit:2, offset: 1}  }  let {bit,offset} = bit_offset[color]  console.log(`bit: ${bit} offset: ${offset}`)  for(let i = 0; i < oData.length; i++){    if(i % 4 == bit){        if(newData[i + offset] === 0 && (oData[i] % 2 === 1)){            // 没有信息的像素，该通道最低位置0，但不要越界            if(oData[i] === 255){                oData[i]--;            } else {                oData[i]++;            }        } else if (newData[i + offset] !== 0 && (oData[i] % 2 === 0)){            // 信息的像素，该通道最低位置1            oData[i]++;        }    }  }  ctx.putImageData(originalData, 0, 0)}var img = new Image()var originalDataimg.onload = function(){  ctx.drawImage(img, 0, 0)  originalData = ctx.getImageData(0,0, ctx.canvas.width, ctx.canvas.height)  console.log(originalData)  mergeData(textData, 'R')}img.src='/images/me.jpg'</script><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line"><span class="keyword">var</span> originalData</span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  originalData = ctx.getImageData(<span class="number">0</span>,<span class="number">0</span>, ctx.canvas.width, ctx.canvas.height)</span><br><span class="line">  mergeData(textData, <span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">img.src=<span class="string">&#x27;/images/me.jpg&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="合并信息"><a href="#合并信息" class="headerlink" title="合并信息"></a>合并信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> mergeData = <span class="function"><span class="keyword">function</span>(<span class="params">newData, color</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> oData = originalData.data <span class="comment">// 原始图片信息</span></span><br><span class="line">  <span class="keyword">var</span> bit, offset</span><br><span class="line">  <span class="keyword">var</span> bit_offset = &#123;</span><br><span class="line">    R: &#123; <span class="attr">bit</span>:<span class="number">0</span>, <span class="attr">offset</span>: <span class="number">3</span>&#125;,</span><br><span class="line">    G: &#123; <span class="attr">bit</span>:<span class="number">1</span>, <span class="attr">offset</span>: <span class="number">2</span>&#125;,</span><br><span class="line">    B: &#123; <span class="attr">bit</span>:<span class="number">2</span>, <span class="attr">offset</span>: <span class="number">1</span>&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> &#123;bit,offset&#125; = bit_offset[color]</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; oData.length; i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i % <span class="number">4</span> == bit)&#123;</span><br><span class="line"><span class="keyword">if</span>(newData[i + offset] === <span class="number">0</span> &amp;&amp; (oData[i] % <span class="number">2</span> === <span class="number">1</span>))&#123;</span><br><span class="line">            <span class="comment">// 没有信息的像素，该通道最低位置0，但不要越界</span></span><br><span class="line">            <span class="keyword">if</span>(oData[i] === <span class="number">255</span>)&#123;</span><br><span class="line">                oData[i]--;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                oData[i]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newData[i + offset] !== <span class="number">0</span> &amp;&amp; (oData[i] % <span class="number">2</span> === <span class="number">0</span>))&#123;</span><br><span class="line">            <span class="comment">// 信息的像素，该通道最低位置1</span></span><br><span class="line">            oData[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ctx.putImageData(originalData, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><canvas id="canvasTransform" width="256" height="256"></canvas></p><script>var ctxTransform = document.getElementById('canvasTransform').getContext('2d')</script><h4 id="解码"><a href="#解码" class="headerlink" title="解码"></a>解码</h4><script>var processData = function(originalData){    var data = originalData.data    for(var i = 0; i < data.length; i++){        if(i % 4 == 0){            // 红色分量            if(data[i] % 2 == 0){                data[i] = 0            } else {                data[i] = 255            }        } else if(i % 4 == 3){            // alpha通道不做处理            // continue            data[i] = 136        } else {            // 关闭其他分量，不关闭也不影响答案，甚至更美观            // data[i] = 0        }    }    // 将结果绘制到画布    ctxTransform.putImageData(originalData, 0, 0)}var img = new Image()var originalDataimg.onload = function(){  ctxTransform.drawImage(img, 0, 0)  originalData = ctxTransform.getImageData(0,0, ctx.canvas.width, ctx.canvas.height)  console.log(originalData)  processData(originalData)}img.src='/images/mesercet.png'</script><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> processData = <span class="function"><span class="keyword">function</span>(<span class="params">originalData</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> data = originalData.data</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">4</span> == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">// 红色分量</span></span><br><span class="line">            <span class="keyword">if</span>(data[i] % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                data[i] = <span class="number">0</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                data[i] = <span class="number">255</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(i % <span class="number">4</span> == <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="comment">// alpha通道不做处理</span></span><br><span class="line">            <span class="comment">// continue</span></span><br><span class="line">            data[i] = <span class="number">136</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 关闭其他分量，不关闭也不影响答案，甚至更美观</span></span><br><span class="line">            <span class="comment">// data[i] = 0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将结果绘制到画布</span></span><br><span class="line">    ctxTransform.putImageData(originalData, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line"><span class="keyword">var</span> originalData</span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  ctxTransform.drawImage(img, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  originalData = ctxTransform.getImageData(<span class="number">0</span>,<span class="number">0</span>, ctx.canvas.width, ctx.canvas.height)</span><br><span class="line"></span><br><span class="line">  processData(originalData)</span><br><span class="line">&#125;</span><br><span class="line">img.src=<span class="string">&#x27;/images/mesercet.png&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="MutationObserver"><a href="#MutationObserver" class="headerlink" title="MutationObserver"></a>MutationObserver</h4><p>元素异动监控</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> MutationObserver = <span class="built_in">window</span>.MutationObserver || <span class="built_in">window</span>.WebKitMutationObserver || <span class="built_in">window</span>.MozMutationObserver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> observer = <span class="function">(<span class="params">callback</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!MutationObserver) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">let</span> bodyObserver = <span class="keyword">new</span> MutationObserver(</span><br><span class="line">        mutationsList =&gt; mutationsList.forEach(<span class="function"><span class="params">mutation</span> =&gt;</span></span><br><span class="line">            mutation.removedNodes.forEach(</span><br><span class="line">                _target =&gt; _target.id === _id &amp;&amp; callback()</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    bodyObserver.observe(<span class="built_in">document</span>.body, &#123;<span class="attr">childList</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">    <span class="keyword">const</span> target = <span class="built_in">document</span>.getElementById(_id);</span><br><span class="line">    <span class="keyword">let</span> observer = <span class="keyword">new</span> MutationObserver(callback);</span><br><span class="line">    observer.observe(target, &#123;<span class="attr">characterData</span>: <span class="literal">true</span>, <span class="attr">attributes</span>: <span class="literal">true</span>, <span class="attr">childList</span>: <span class="literal">true</span>, <span class="attr">subtree</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span> &#123;bodyObserver, observer&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="http://www.alloyteam.com/2016/03/image-steganography/#prettyPhoto">参考资料</a><br><a href="https://juejin.cn/post/6900713052270755847">水印破解</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> canvas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP 协议</title>
      <link href="2020/11/26/%E5%89%8D%E7%AB%AF/HTTP%20%E5%8D%8F%E8%AE%AE/"/>
      <url>2020/11/26/%E5%89%8D%E7%AB%AF/HTTP%20%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<p>应用层协议，由请求和响应构成。标准的客户端服务器模型，为无状态协议</p><blockquote><p>在 TCP/IP 协议栈中的位置</p></blockquote><p>HTTP(TLS/SSL)<br>TCP<br>IP<br>数据链路层</p><p>HTTP 端口号 80，HTTPS 端口号 443</p><blockquote><p>请求响应模型</p></blockquote><p>永远是客户端发起请求，服务器回送响应</p><h4 id="缓存机制"><a href="#缓存机制" class="headerlink" title="缓存机制"></a>缓存机制</h4><p>根据是否需要重新向服务器发起请求分类：强制缓存、对比缓存</p><p>区别：强制缓存如果生效，不需要再和服务器发生交互，而对比缓存不管是否生效，都需要与服务端发生交互</p><img src="https://user-gold-cdn.xitu.io/2019/3/22/169a1131a01649ce?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><img src="https://user-gold-cdn.xitu.io/2019/3/22/169a113789f814d2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><p><a href="https://juejin.cn/post/6844903801778864136">参考地址</a></p><h4 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>私密性<br>完整性（中间人攻击）<br>身份识别（SSL证书）</p><p>HTTPS协议是由SSL/TLS+HTTP协议构建的加密传输</p><p>http直接与四层交互，https先给安全层交互，然后在与四层交互</p><h4 id="CA-证书"><a href="#CA-证书" class="headerlink" title="CA 证书"></a>CA 证书</h4><p>证书授权中心</p><blockquote><p>内容</p></blockquote><p>颁发者、使用者、版本、签名算法、公钥、指纹、指纹算法</p><blockquote><p>编码格式</p></blockquote><p>X.509 规范约定 PEM 来存储证书相关文件<br>证书文件.crt<br>私钥文件.key<br>证书请求文件.csr</p>]]></content>
      
      
      <categories>
          
          <category> 协议 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字母、汉字不同字符集编码的字节数</title>
      <link href="2020/11/26/%E5%89%8D%E7%AB%AF/%E5%AD%97%E6%AF%8D%E3%80%81%E6%B1%89%E5%AD%97%E4%B8%8D%E5%90%8C%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81%E7%9A%84%E5%AD%97%E8%8A%82%E6%95%B0/"/>
      <url>2020/11/26/%E5%89%8D%E7%AB%AF/%E5%AD%97%E6%AF%8D%E3%80%81%E6%B1%89%E5%AD%97%E4%B8%8D%E5%90%8C%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81%E7%9A%84%E5%AD%97%E8%8A%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h4 id="字节数"><a href="#字节数" class="headerlink" title="字节数"></a>字节数</h4><style>.tableWrap table{    width: 30%;    margin-bottom: 1rem;    border-collapse: collapse;}.tableWrap table th,.tableWrap table td{    padding: .5rem;    border: 1px solid #cdcdcd;}</style><div class="tableWrap"><table><thead><tr><th align="center">编码</th><th align="center">英文</th><th align="center">中文</th></tr></thead><tbody><tr><td align="center">GB2312</td><td align="center">1</td><td align="center">2</td></tr><tr><td align="center">GBK</td><td align="center">1</td><td align="center">2</td></tr><tr><td align="center">GB18030</td><td align="center">1</td><td align="center">2</td></tr><tr><td align="center">ISO-8859-1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="center">UTF-8</td><td align="center">1</td><td align="center">3</td></tr><tr><td align="center">UTF-16</td><td align="center">4</td><td align="center">4</td></tr><tr><td align="center">UTF-16BE</td><td align="center">2</td><td align="center">2</td></tr><tr><td align="center">UTF-16LE</td><td align="center">2</td><td align="center">2</td></tr></tbody></table></div><h4 id="发展史"><a href="#发展史" class="headerlink" title="发展史"></a>发展史</h4><ol><li>ASCII [0 - 7位]  128个字符</li><li>欧洲 256位</li><li>GB2312 65536个汉字字符</li><li>unicode 100W</li><li>UTF</li></ol><p>中文汉字在utf-8中到底占几个字节，一般是3个字节，最常见的编码方式是1110xxxx 10xxxxxx 10xxxxxx</p><p>unicode 定义了所有符号的二进制形式，每个符号使用两个字节表示，16位二进制表示一个符号</p><ul><li>解决 Unicode 下的 ANSI 符号的空间浪费和网络传输下如何截取字符？</li></ul><p>UTF-8 规定：如果一个符号只占一个字节，那么这个8位字节的第一位就为0。如果为两个字节，那么规定第一个字节的前两位都为1，然后第一个字节的第三位为0，第二个字节的前两位为10，然后如果是三个字节的话，那么第一个字节的前三位为111，第四位为0，剩余的两个字节的前两位都为10。</p><p>1字节：0xxx xxxx<br>2字节：110x xxxx 10xx xxxx<br>3字节：1110 xxxx 10xx xxxx 10xx xxxx</p>]]></content>
      
      
      <categories>
          
          <category> 字符集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>傅里叶变换</title>
      <link href="2020/11/26/Other/%E6%95%B0%E5%AD%A6/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/"/>
      <url>2020/11/26/Other/%E6%95%B0%E5%AD%A6/%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<p>时域 –&gt;&gt; 频域</p><p>正交积</p><p>频域：频率，振幅，相位</p><p>滤波</p><h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><p>声音</p><ul><li>低频：男</li><li>高频：女</li></ul><p>图像</p><ul><li>低频：轮廓</li><li>高频：图像细节</li></ul>]]></content>
      
      
      <categories>
          
          <category> 数学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP 压测工具 wrk</title>
      <link href="2020/11/26/%E5%89%8D%E7%AB%AF/HTTP%20%E5%8E%8B%E6%B5%8B%E5%B7%A5%E5%85%B7%20wrk/"/>
      <url>2020/11/26/%E5%89%8D%E7%AB%AF/HTTP%20%E5%8E%8B%E6%B5%8B%E5%B7%A5%E5%85%B7%20wrk/</url>
      
        <content type="html"><![CDATA[<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum groupinstall <span class="string">&#x27;Development Tools&#x27;</span></span><br><span class="line">sudo yum install -y openssl-devel git </span><br><span class="line">git clone https://github.com/wg/wrk.git wrk </span><br><span class="line">cd wrk</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>环境要求：Linux、Mac</p><p>特性：很少的线程压出大并发量<br>原理：使用操作系统特定高性能 IO 机制，select、epoll、kquue等，复用 redis 的 ae 异步事件驱动框架</p><p>缺点：仅支持单机压测</p><p>同类型测试工具：JMeter, LoadRunner</p><blockquote><p>测试结果</p></blockquote><pre><code>./wrk -c 1 -t 1 -d 1 http://www.baidu.com</code></pre><blockquote><p>将可执行文件移动到 /usr/local/bin 位置</p></blockquote><pre><code>sudo cp wrk /usr/local/bin</code></pre><h4 id="wrk-参数说明"><a href="#wrk-参数说明" class="headerlink" title="wrk 参数说明"></a>wrk 参数说明</h4><ul><li>-t 需要模拟的线程数</li><li>-c 需要模拟的连接数</li><li>-timeout 超时时间</li><li>-d 测试持续时间</li></ul><h4 id="结果说明"><a href="#结果说明" class="headerlink" title="结果说明"></a>结果说明</h4><ul><li>Latency <code>响应时间</code></li><li>Req/Sec <code>每个线程每秒完成的请求数</code></li><li>Avg <code>平均</code></li><li>Max <code>最大</code></li><li>Stdev <code>标准差</code></li><li>+/- Stdev <code>正负一个标准差占比</code></li></ul><h4 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h4><p>搭配 lua 使用：启动阶段、运行阶段和结束阶段，对压测进行个性化</p><pre><code>setup（）</code></pre><p>这个函数在目标 IP 地址已经解析完, 并且所有 thread 已经生成, 但是还没有开始时被调用. 每个线程执行一次这个函数.<br>可以通过thread:get(name), thread:set(name, value)设置线程级别的变量.</p><pre><code>init（）</code></pre><p>每次请求发送之前被调用.<br>可以接受 wrk 命令行的额外参数. 通过 – 指定.</p><pre><code>delay（）</code></pre><p>这个函数返回一个数值, 在这次请求执行完以后延迟多长时间执行下一个请求. 可以对应 thinking time 的场景.</p><pre><code>request（）</code></pre><p>通过这个函数可以每次请求之前修改本次请求的属性. 返回一个字符串. 这个函数要慎用, 会影响测试端性能.</p><pre><code>response（）</code></pre><p>每次请求返回以后被调用. 可以根据响应内容做特殊处理, 比如遇到特殊响应停止执行测试, 或输出到控制台等等.</p><pre><code>done（）</code></pre><p>在所有请求执行完以后调用, 一般用于自定义统计结果.</p><blockquote><p>自定义 Lua 脚本中可访问的变量以及方法</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wrk = &#123;</span><br><span class="line">    scheme  = <span class="string">&quot;http&quot;</span>,</span><br><span class="line">    host    = <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    port    = <span class="number">8080</span>,</span><br><span class="line">    method  = <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="built_in">path</span>    = <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    headers = &#123;&#125;,</span><br><span class="line">    body    = <span class="literal">nil</span>,</span><br><span class="line">    thread  = &lt;userdata&gt;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h4><blockquote><p>安装</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.lua.org/ftp/lua<span class="number">-5.3</span><span class="number">.4</span>.tar.gz</span><br><span class="line">tar -zxvf lua<span class="number">-5.3</span><span class="number">.4</span>.tar.gz -C ../</span><br><span class="line">cd lua<span class="number">-5.3</span><span class="number">.0</span></span><br><span class="line">make linux test</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><blockquote><p>winodw 安装 Lua</p></blockquote><p><a href="https://static.runoob.com/download/LuaForWindows_v5.1.4-46.exe">本站下载地址 LuaForWindows_v5.1.4-46</a></p><blockquote><p>执行 lua</p></blockquote><pre><code>方式①</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lua xxx.lua </span><br><span class="line"></span><br><span class="line">或者 </span><br><span class="line"></span><br><span class="line">lua -i</span><br></pre></td></tr></table></figure><pre><code>方式②</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--xxx.lua 起始位置</span><br><span class="line">#!&#x2F;usr&#x2F;local&#x2F;bin&#x2F;lua</span><br><span class="line"></span><br><span class="line">... 代码</span><br></pre></td></tr></table></figure><p>为脚本添加可执行权限，执行脚本：</p><p>cd 脚本目录 -&gt; ./xxx.lua</p><pre><code>退出交互式编程</code></pre><p>Ctrl+D、Ctrl+C、os.exit()</p><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><p>Lua 是一个区分大小写的编程语言</p><blockquote><p>注释</p></blockquote><pre><code>- - 单行注释- -[[多行注释- -]]*推荐使用- -[=[多行注释]=]</code></pre><blockquote><p>标识符</p></blockquote><p>定义变量，[a-Z_] + [a-Z_0-9]，不建议使用 <code>_ + [A-Z]</code>，Lua 保留字</p><blockquote><p>全局变量</p></blockquote><p>默认情况下，变量总认为是全局的，删除全局变量，将变量设为 <code>nil</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b &#x3D; nil</span><br></pre></td></tr></table></figure><blockquote><p>数据类型</p></blockquote><p>nil、boolean、number、string、userdata、function、thread、table</p><p>nil：空，任何值设为 nil，等价于删除<br>boolean：(false、nil) =&gt; false，其余都是 true<br>number：双精度实浮点数<br>string：<code>‘...’</code> <code>“...”</code> <code>[[...]]</code><br>function：C、Lua编写函数<br>userdata：C数据结构<br>thread：最主要的线程是协同程序（coroutine）<br>table：关联数组，数组的索引（数字、字符串、表类型），创建通过’构造表达式’完成，索引从’1’开始，长度会自动增长，没初始的 table 都是 nil</p><p>类型检查：<code>type(</code>print<code>)</code></p><p>[<code>注意</code>]<br><code>数字字符串</code> 和 <code>数字</code> 做运算，优先转数值类型<br>字符串相连：<code>&#39;..&#39;</code><br><code>#</code>：计算字符串的长度，其实是字符串所占的字节数长</p><blockquote><p>table</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tbl = &#123;<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tbl) <span class="keyword">do</span></span><br><span class="line"><span class="built_in">print</span>(k .. <span class="string">&quot;:&quot;</span> .. v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">输出结果：</span><br><span class="line"><span class="number">1</span>：apple</span><br><span class="line"><span class="number">2</span>：pear</span><br><span class="line"><span class="number">3</span>：orange</span><br><span class="line"><span class="number">4</span>：banana</span><br></pre></td></tr></table></figure><p><code>注意</code>：#table 返回第一个 nil 前值的下标</p><p>线程跟协程的区别：线程可以同时多个运行，而协程任意时刻只能运行一个，并且处于运行状态的协程只有被挂起（suspend）时才会暂停</p><blockquote><p>变量</p></blockquote><p>全局变量、局部变量、表达式中的域</p><p>local：声明局部变量，生命周期（从声明位置 -&gt; 语句块结束）</p><p>多变量赋值：<code>a, b = 10, 2*x</code>，同时赋值，不会进行变量传递</p><p>局部变量的好处：</p><ol><li>避免命名冲突</li><li>访问局部变量的速度比全局变量更快</li></ol><blockquote><p>函数</p></blockquote><p>可变参数： <code>&#39;...&#39;</code></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(...)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> s = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i,v <span class="keyword">in</span> <span class="built_in">ipairs</span>&#123;...&#125; <span class="keyword">do</span></span><br><span class="line">s = s + v</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">return</span> s</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>))</span><br></pre></td></tr></table></figure><p>获取可变参数数量的方式：</p><ol><li>#{…}</li><li>select(“#”, …)</li></ol><p>多返回值的函数赋值时，只有最后一个函数才会展开：local b,c,d,e = add(),<code>add()</code></p><blockquote><p>运算符优先级</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">^</span><br><span class="line"><span class="keyword">not</span>    - (unary)</span><br><span class="line">*      /       %</span><br><span class="line">+      -</span><br><span class="line">..</span><br><span class="line">&lt;      &gt;      &lt;=     &gt;=     ~=     ==</span><br><span class="line"><span class="keyword">and</span></span><br><span class="line"><span class="keyword">or</span></span><br></pre></td></tr></table></figure><blockquote><p>字符串操作方法</p></blockquote><p>upper、lower</p><p>string.gsub(操作的字符串，被替换的字符，要替换的字符，替换次数)</p><pre><code>string.gsub(&quot;aaaa&quot;,&quot;a&quot;,&quot;z&quot;, 3)</code></pre><p>string.find(操作的字符串，要查找的字符，从何位置开始）：返回第一次符合要求的索引</p><p>string.char(arg)：整型数字转字符连接<br>string.byte(arg，int[返回第几个，默认第一个])：字符转整数值</p><p>string.rep(操作字符串，重复次数)</p><p>string.match</p><p>string.sub</p><blockquote><p>字符串格式化</p></blockquote><p>string.format()</p><p>%c：数字，转ascii码<br>%d，%i：数字，转有符号整数<br>%o：数字，转8进制<br>%u：数字，转无符号整数<br>%x：数字，转十六进制，使用小写字母<br>%X：数字，转十六进制，使用大写字母</p><p>%e：数字，转科学计数，小写字母e<br>%E：数字，转科学计数，大写字母E</p><p>%f：数字，转浮点数<br>%q：字符串，转可被Lua编译器读入的格式<br>%s：字符串，按照给定参数格式转</p><blockquote><p>迭代器</p></blockquote><p>Lua中迭代器支持指针类型，分为无状态、有状态两种迭代器</p><ul><li>pairs 和 ipairs 区别</li></ul><p>pairs：迭代 table，可以遍历表中所有key，可以返回 nil<br>ipairs：迭代数组，不能返回 nil，遇到则退出</p><p>三个值：<code>迭代器，状态常量，控制变量</code></p><blockquote><p>Table 常用操作</p></blockquote><p>table.concat(数据，连接符，起始位置，结束位置)</p><p>table.insert(数据，插入位置，插入值)</p><p>table.maxn</p><p>table.remove</p><p>table.sort</p><h4 id="模块及包"><a href="#模块及包" class="headerlink" title="模块及包"></a>模块及包</h4><p>Lua 模块是由变量、函数等已知元素组成的 table</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.constant = <span class="string">&#x27;常量&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">module.add</span><span class="params">()</span></span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">write</span>(<span class="string">&#x27;公共函数&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">locfun</span><span class="params">()</span></span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;私有函数&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">module.plus</span><span class="params">()</span></span></span><br><span class="line">locfun()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure><blockquote><p>加载模块</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;module&quot;</span>)</span><br><span class="line"><span class="built_in">module</span>.plus()</span><br><span class="line"></span><br><span class="line">=&gt; <span class="keyword">local</span> m = <span class="built_in">require</span>(<span class="string">&quot;module&quot;</span>)</span><br><span class="line">m.plus()</span><br></pre></td></tr></table></figure><blockquote><p>加载机制</p></blockquote><ol><li>自定义的模块，不是放在哪个文件目录都行</li><li>require 有自己的文件路径加载策略</li><li>require 用于搜索 Lua 文件的路径存放在全局变量 package.path，Lua 启动时，环境变量 LUA_PATH 初始化，如果找不到环境变量，编译时定义的默认路径初始化</li></ol><p>LUA_PATH：根目录 .profile.bashrc </p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#LUA_PATH</span><br><span class="line">export LUA_PATH = <span class="string">&quot;~/lua/?.lua;;&quot;</span> ;; 新加的路径后加上原来的默认路径</span><br><span class="line"></span><br><span class="line">source ~/.profile</span><br></pre></td></tr></table></figure><blockquote><p>C包</p></blockquote><p>使用前必须先加载并连接，实现方式通过动态连接库机制（<code>loadlib()</code>）</p><p>local f = loadlib(path【绝对地址】, “luaopen_socket”【初始化函数】)</p><ul><li>使用 require 函数加载 C 库</li></ul><p>修改 stub 文件对应二进制库的实际路径，将 stub 文件所在的目录加入到 LUA_PATH</p><h4 id="元表-Metatable"><a href="#元表-Metatable" class="headerlink" title="元表 Metatable"></a>元表 Metatable</h4><p>支持多 table 操作</p><p>setmetatable(tbale, metatable)：设置元表，存在<code>‘__metatable ’</code>，则报错<br>getmetatable(table)：获取元表</p><blockquote><p>__index </p></blockquote><p>__index = [tbale, function(table, key)]</p><p>Lua 查找元素的规则步骤：</p><ol><li>表中查找，&amp; 返回 | 继续</li><li>判断表中是否有元表，&amp; 继续| 返回 nil</li><li>判断元表有没有 __index 方法，&amp; (表，重复1，2，3；函数，返回值) | 返回 nil</li></ol><blockquote><p>__newindex</p></blockquote><blockquote><p>为表添加操作符</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">table_maxn</span><span class="params">(t)</span></span></span><br><span class="line"><span class="keyword">local</span> mn = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> mn &lt; k <span class="keyword">then</span></span><br><span class="line">mn = k</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">return</span> mn</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">mytab = <span class="built_in">setmetatable</span>(&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;, &#123;</span><br><span class="line"><span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(mytab, newtab)</span></span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, table_maxn(newtab) <span class="keyword">do</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(mytab, table_maxn(mytab) + <span class="number">1</span>, newtab[i])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">return</span> mytab</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">sectab = &#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</span><br><span class="line">mytab = mytab + sectab</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(mytab) <span class="keyword">do</span></span><br><span class="line"><span class="built_in">print</span>(k .. <span class="string">&#x27; : &#x27;</span> .. v)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>__add  =&gt;  +<br>__sub  =&gt;  -<br>__mul  =&gt;  *<br>__div  =&gt;  /<br>__mod  =&gt;  %<br>__unm  =&gt;  -<br>__concat  =&gt;  ..<br>__eq  =&gt;  ==<br>__lt  =&gt;  &lt;<br>__le  =&gt;  &lt;=</p><blockquote><p>__Call 调用值时调用该方法</p></blockquote><blockquote><p>__tostring 修改表的输出行为</p></blockquote><h4 id="协同程序"><a href="#协同程序" class="headerlink" title="协同程序"></a>协同程序</h4><p>Lua 协同程序与线程比较类似：拥有独立的堆栈、独立的局部变量、独立的指令指针，与其它协同程序，共享全局变量等</p><pre><code>线程、协同程序的区别：</code></pre><ol><li>拥有多线程的程序可以同时运行几个线程，协同程序需要彼此协作运行</li><li>任一指定时候，只有一个协同程序运行，运行中的协同程序只有被挂起的时候才会挂起</li><li>协同程序类似同步的多线程，在等待同一个线程锁的多线程类似协同</li></ol><blockquote><p>语法</p></blockquote><p>coroutine.create() <code>suspended</code><br>coroutine.resume()  <code>running</code> 返回值 boolean<br>coroutine.yield()：挂起 <code>suspended</code><br>coroutine.status()：状态【dead、suspended、running】<br>coroutine.wrap()<br>coroutine.running()<br>return  <code>dead</code></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> npro</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">productor</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    send(i)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consumer</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">local</span> i = receive()</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receive</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> <span class="built_in">status</span>, value = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(npro)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">(x)</span></span></span><br><span class="line">    <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(x)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">npro = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(productor)</span><br><span class="line">consumer()</span><br></pre></td></tr></table></figure><blockquote><p>coroutine.creat、coroutine.wrap 区别</p></blockquote><p>create 返回协同程序，类型 thread，使用 resume 调用<br>wrap 返回普通函数，类型 function，不可以使用 resume 调用</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">yieldReturn</span><span class="params">(arg)</span></span> <span class="keyword">return</span> <span class="built_in">arg</span> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">co_yieldtest = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;启动协程状态&quot;</span>..<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co_yieldtest))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;--&quot;</span>)</span><br><span class="line">        <span class="built_in">coroutine</span>.<span class="built_in">yield</span>()</span><br><span class="line">        <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(<span class="built_in">print</span>(<span class="string">&quot;第3次调用&quot;</span>))</span><br><span class="line">        <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(yieldReturn(<span class="string">&quot;第4次调用&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;启动前协程状态&quot;</span>..<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co_yieldtest))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;--&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>,<span class="number">6</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第&quot;</span>..i..<span class="string">&quot;次调用协程:&quot;</span>, <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co_yieldtest))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;当前协程状态&quot;</span>..<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co_yieldtest))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;--&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">输出结果如下：</span><br><span class="line"></span><br><span class="line">启动前协程状态suspended</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">启动协程状态<span class="built_in">running</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">1</span>次调用协程:    <span class="literal">true</span></span><br><span class="line">当前协程状态suspended</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">2</span>次调用协程:    <span class="literal">true</span>    <span class="number">1</span></span><br><span class="line">当前协程状态suspended</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">3</span>次调用</span><br><span class="line">第<span class="number">3</span>次调用协程:    <span class="literal">true</span></span><br><span class="line">当前协程状态suspended</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">4</span>次调用协程:    <span class="literal">true</span>    第<span class="number">4</span>次调用</span><br><span class="line">当前协程状态suspended</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">5</span>次调用协程:    <span class="literal">true</span>    <span class="number">2</span></span><br><span class="line">当前协程状态dead</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">第<span class="number">6</span>次调用协程:    <span class="literal">false</span>    cannot <span class="built_in">resume</span> dead <span class="built_in">coroutine</span></span><br><span class="line">当前协程状态dead</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="I-O-操作"><a href="#I-O-操作" class="headerlink" title="I/O 操作"></a>I/O 操作</h4><p>读取、处理文件</p><p>简单模式：</p><pre><code>单输入文件 -&gt; 单输出文件</code></pre><p>安全模式：</p><pre><code>文件句柄，面向对象的形式</code></pre><blockquote><p>打开文件</p></blockquote><p>file = io.open(filename, [mode])</p><p>mode 值：</p><p>r、r+：只读，文件必须存在<br>w、w+：只写，文件存在则内容清空，文件不存在则创建<br>a、a+：追加，文件存在则追加内容，文件不存在则创建</p><p>b：二进制模式<br>+：可读模式</p><blockquote><p>常用方法</p></blockquote><p>io.open<br>io.input<br>io.close<br>io.output<br>io.write<br>io.tmpfile<br>io.type<br>io.flush<br>io.lines</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file = <span class="built_in">io</span>.<span class="built_in">input</span>(<span class="string">&#x27;path&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">input</span>(file)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">io</span>.<span class="built_in">read</span>())</span><br></pre></td></tr></table></figure><blockquote><p>完全模式</p></blockquote><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&#x27;path&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(file:<span class="built_in">read</span>())</span><br><span class="line"></span><br><span class="line">file:<span class="built_in">close</span>()</span><br><span class="line">file:<span class="built_in">write</span>(<span class="string">&#x27;str&#x27;</span>)</span><br></pre></td></tr></table></figure><p>file:seek() 设置、获取文件位置<br>file:flush() 向文件写入缓冲中的所有数据</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">io</span>.<span class="built_in">lines</span>(<span class="string">&#x27;path&#x27;</span>) <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">print</span>(line)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file:seek(<span class="string">&#x27;end&#x27;</span>, <span class="number">-100</span>)</span><br><span class="line"><span class="built_in">print</span>(file:<span class="built_in">read</span>(<span class="string">&#x27;*a&#x27;</span>))</span><br></pre></td></tr></table></figure><ul><li>*n 读取一个数字返回</li><li>*a 从当前位置读取整个文件</li><li>*| 读取下一行</li><li>number 返回指定个数的字符串</li></ul><h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h4><ul><li>语法错误</li><li>运行错误</li></ul><blockquote><p>处理错误</p></blockquote><p>assert()、error()</p><p>pcall()、xpcall()、debug()</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfunction</span> <span class="params">()</span></span></span><br><span class="line">   n = n/<span class="literal">nil</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myerrorhandler</span><span class="params">( err )</span></span></span><br><span class="line">   <span class="built_in">print</span>( <span class="string">&quot;ERROR:&quot;</span>, err )</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">status</span> = <span class="built_in">xpcall</span>( myfunction, myerrorhandler )</span><br><span class="line"><span class="built_in">print</span>( <span class="built_in">status</span>)</span><br></pre></td></tr></table></figure><h4 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h4><p>debug()<br>getfenv()<br>gethook()<br>getinfo()<br>debug.getlocal()<br>getmetatable()<br>getregistry()<br>getupvalue()<br>sethook()<br>setlocal()<br>setmetatable()<br>setupvalue()<br>trackback()</p><blockquote><p>调试类型</p></blockquote><p>命令行调试器有：RemDebug、clidebugger、ctrace、xdbLua、LuaInterface - Debugger、Rldb、ModDebug</p><p>图形界调试器有：SciTE、Decoda、ZeroBrane Studio、akdebugger、luaedit</p><h4 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h4><p>collectgarbage(‘collect|count|restart|setpause|setstepmul|setp|stop’)</p><p>一次完整的垃圾收集循环、以K字节数返回使用总内参数、重启垃圾收集器、将arg设为收集器的间歇率、单步运行垃圾收集器、停止</p><h4 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Shape = &#123;area = <span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape</span>:<span class="title">new</span> (<span class="params">o,side</span>)</span></span><br><span class="line"><span class="function">  <span class="title">o</span> = <span class="title">o</span> <span class="title">or</span> </span>&#123;&#125;</span><br><span class="line">  setmetatable(o, self)</span><br><span class="line">  self.__index = self</span><br><span class="line">  side = side or <span class="number">0</span></span><br><span class="line">  self.area = side*side;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape</span>:<span class="title">printArea</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">  <span class="title">print</span>(<span class="params"><span class="string">&quot;面积为 &quot;</span>,self.area</span>)</span></span><br><span class="line"><span class="function"><span class="title">end</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">-- 创建对象</span></span><br><span class="line"><span class="function"><span class="title">myshape</span> = <span class="title">Shape</span>:<span class="title">new</span>(<span class="params">nil,<span class="number">10</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">myshape</span>:<span class="title">printArea</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">-- 派生类</span></span><br><span class="line"><span class="function"><span class="title">Square</span> = <span class="title">Shape</span>:<span class="title">new</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="function"><span class="keyword">function</span> <span class="title">Square</span>:<span class="title">new</span> (<span class="params">o,side</span>)</span></span></span><br><span class="line"><span class="function"><span class="function">  <span class="title">o</span> = <span class="title">o</span> <span class="title">or</span> <span class="title">Shape</span>:<span class="title">new</span>(<span class="params">o,side</span>)</span></span></span><br><span class="line"><span class="function"><span class="function">  <span class="title">setmetatable</span>(<span class="params">o, self</span>)</span></span></span><br><span class="line"><span class="function"><span class="function">  <span class="title">self</span>.<span class="title">__index</span> = <span class="title">self</span></span></span></span><br><span class="line"><span class="function"><span class="function">  <span class="title">return</span> <span class="title">o</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="title">end</span></span></span></span><br><span class="line"><span class="function"><span class="function"></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="keyword">function</span> <span class="title">Square</span>:<span class="title">printArea</span> (<span class="params"></span>)</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function">  <span class="title">print</span>(<span class="params"><span class="string">&quot;正方形面积为 &quot;</span>,self.area</span>)</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="title">end</span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function">-- 创建对象</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="title">mysquare</span> = <span class="title">Square</span>:<span class="title">new</span>(<span class="params">nil,<span class="number">10</span></span>)</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="title">mysquare</span>:<span class="title">printArea</span>(<span class="params"></span>)</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="title">Rectangle</span> = <span class="title">Shape</span>:<span class="title">new</span>(<span class="params"></span>)</span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>:<span class="title">new</span> (<span class="params">o,length,breadth</span>)</span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">o</span> = <span class="title">o</span> <span class="title">or</span> <span class="title">Shape</span>:<span class="title">new</span>(<span class="params">o</span>)</span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">setmetatable</span>(<span class="params">o, self</span>)</span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">self</span>.<span class="title">__index</span> = <span class="title">self</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">self</span>.<span class="title">area</span> = <span class="title">length</span> * <span class="title">breadth</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">return</span> <span class="title">o</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="title">end</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>:<span class="title">printArea</span> (<span class="params"></span>)</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function">  <span class="title">print</span>(<span class="params"><span class="string">&quot;矩形面积为 &quot;</span>,self.area</span>)</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function"><span class="title">end</span></span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function"></span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function">-- 创建对象</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function"><span class="title">myrectangle</span> = <span class="title">Rectangle</span>:<span class="title">new</span>(<span class="params">nil,<span class="number">10</span>,<span class="number">20</span></span>)</span></span></span></span></span></span><br><span class="line"><span class="function"><span class="function"><span class="function"><span class="function"><span class="function"><span class="title">myrectangle</span>:<span class="title">printArea</span>(<span class="params"></span>)</span></span></span></span></span></span><br></pre></td></tr></table></figure><h4 id="数据库访问"><a href="#数据库访问" class="headerlink" title="数据库访问"></a>数据库访问</h4><p><a href="http://luaforge.net/projects/luasql/">LuaSQL</a></p><p>支持的数据库有：ODBC, ADO, Oracle, MySQL, SQLite 和 PostgreSQL</p><blockquote><p>LuaRocks 安装方法</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://luarocks.org/releases/luarocks-2.2.1.tar.gz</span><br><span class="line">tar zxpf luarocks-2.2.1.tar.gz -C ../</span><br><span class="line">cd luarocks-2.2.1</span><br><span class="line">./configure; sudo make bootstrap</span><br><span class="line">sudo luarocks install luasocket</span><br></pre></td></tr></table></figure><blockquote><p>安装数据库</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">luarocks install luasql-sqlite3</span><br><span class="line">luarocks install luasql-postgres</span><br><span class="line">luarocks install luasql-mysql</span><br><span class="line">luarocks install luasql-sqlite</span><br><span class="line">luarocks install luasql-odbc</span><br></pre></td></tr></table></figure><pre><code>*安装 mysql 报错*luarocks install luasql-mysql MYSQL_INCDIR=/usr/include/mysql MYSQL_LIBDIR=/usr/local/mysql/lib</code></pre><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 连接 mysql</span></span><br><span class="line"></span><br><span class="line">luasql = <span class="built_in">require</span> <span class="string">&#x27;luasql.mysql&#x27;</span></span><br><span class="line">env = luasql.mysql</span><br><span class="line"></span><br><span class="line">conn = env:connect(<span class="string">&#x27;db_name&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;ip&#x27;</span>, <span class="string">&#x27;3306&#x27;</span>)</span><br><span class="line">conn:<span class="built_in">execute</span><span class="string">&#x27;set names utf8&#x27;</span></span><br><span class="line"></span><br><span class="line">cur = conn:<span class="built_in">execute</span>(<span class="string">&#x27;select * from md_tag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">row = cur:fetch(&#123;&#125;, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&#x27;md_tag.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> row <span class="keyword">do</span></span><br><span class="line">  var = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&#x27;%d %s\n&#x27;</span>, row.md_id, row.m_name)</span><br><span class="line">  <span class="built_in">print</span>(var)</span><br><span class="line">  file:<span class="built_in">write</span>(var)</span><br><span class="line">  row = cur:fetch(row, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">file:<span class="built_in">close</span>()</span><br><span class="line">conn:<span class="built_in">close</span>()</span><br><span class="line">env:<span class="built_in">close</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>luarocks几个常用命令</p></blockquote><p>build<br>download<br>help<br>list<br>install<br>make<br>pack<br>path<br>remove<br>search<br>show<br>unpack</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端压测 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP 协议</title>
      <link href="2020/11/26/%E5%8D%8F%E8%AE%AE/HTTP%20%E5%8D%8F%E8%AE%AE/"/>
      <url>2020/11/26/%E5%8D%8F%E8%AE%AE/HTTP%20%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<p>应用层协议，由请求和响应构成。标准的客户端服务器模型，为无状态协议</p><blockquote><p>在 TCP/IP 协议栈中的位置</p></blockquote><p>HTTP(TLS/SSL)<br>TCP<br>IP<br>数据链路层</p><p>HTTP 端口号 80，HTTPS 端口号 443</p><blockquote><p>请求响应模型</p></blockquote><p>永远是客户端发起请求，服务器回送响应</p><h4 id="缓存机制"><a href="#缓存机制" class="headerlink" title="缓存机制"></a>缓存机制</h4><p>根据是否需要重新向服务器发起请求分类：强制缓存、对比缓存</p><p>区别：强制缓存如果生效，不需要再和服务器发生交互，而对比缓存不管是否生效，都需要与服务端发生交互</p><img src="https://user-gold-cdn.xitu.io/2019/3/22/169a1131a01649ce?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><img src="https://user-gold-cdn.xitu.io/2019/3/22/169a113789f814d2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><p><a href="https://juejin.cn/post/6844903801778864136">参考地址</a></p><h4 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h4><p>私密性<br>完整性（中间人攻击）<br>身份识别（SSL证书）</p><p>HTTPS协议是由SSL/TLS+HTTP协议构建的加密传输</p><p>http直接与四层交互，https先给安全层交互，然后在与四层交互</p><h4 id="CA-证书"><a href="#CA-证书" class="headerlink" title="CA 证书"></a>CA 证书</h4><p>证书授权中心</p><blockquote><p>内容</p></blockquote><p>颁发者、使用者、版本、签名算法、公钥、指纹、指纹算法</p><blockquote><p>编码格式</p></blockquote><p>X.509 规范约定 PEM 来存储证书相关文件<br>证书文件.crt<br>私钥文件.key<br>证书请求文件.csr</p>]]></content>
      
      
      <categories>
          
          <category> 协议 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3 生态</title>
      <link href="2020/11/25/Javascript/Vue3%20%E7%94%9F%E6%80%81/"/>
      <url>2020/11/25/Javascript/Vue3%20%E7%94%9F%E6%80%81/</url>
      
        <content type="html"><![CDATA[<h4 id="体验Vue3"><a href="#体验Vue3" class="headerlink" title="体验Vue3"></a>体验Vue3</h4><blockquote><p>vue-cli</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue&#x2F;cli</span><br><span class="line">vue create cue3-cli</span><br><span class="line">cd cue3-cli</span><br><span class="line">vue add vue-next</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure><blockquote><p>webpack</p></blockquote><p>git clone <a href="https://github.com/vuejs/vue-next-webpack-preview.git">https://github.com/vuejs/vue-next-webpack-preview.git</a> vue3-webpack</p><blockquote><p>vite</p></blockquote><p>拦截 import 发送 http 请求加载文件，进行预编译</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-vite-app</span><br><span class="line">create-vite-app vue3-vite</span><br><span class="line">cd vue3-vite</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h4 id="Composition-api"><a href="#Composition-api" class="headerlink" title="Composition api"></a>Composition api</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;&#123;&#123;state.count&#125;&#125; * <span class="number">2</span>=&#123;&#123;double&#125;&#125;&lt;/h1&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;num&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;button @click=<span class="string">&quot;add&quot;</span>&gt;累加&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;reactive,computed,ref,onMounted&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">      count:<span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">const</span> num = ref(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      state.count++</span><br><span class="line">      num.value+=<span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> double = computed(<span class="function">()=&gt;</span>state.count*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;mouted&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;state,add,double,num&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>setup</p></blockquote><p>composition 入口，函数在 beforecreate 前调用，函数返回值作为模板渲染上下文</p><blockquote><p>reactive</p></blockquote><p>等同于 Vue.observerable 产生响应式数据</p><blockquote><p>computed</p></blockquote><p>计算属性</p><blockquote><p>全局 import</p></blockquote><p>vue2 data、methods、computed 挂载在 this 上的缺点：<br>1、不利于类型推导<br>2、没办法做到按需加载，没有使用的功能代码也会被打包</p><blockquote><p>ref</p></blockquote><p>将基本数据包装成响应式，模板中直接使用，JS 中使用 .value</p><h4 id="新组件"><a href="#新组件" class="headerlink" title="新组件"></a>新组件</h4><blockquote><p>Fragment</p></blockquote><p>vue 组件不需要一个根节点</p><p>好处：<br>1、少了很多无意义节点<br>2、组件递归可以实现平级递归</p><blockquote><p>Teleport</p></blockquote><p>等同于 React[Protal]，可以渲染 vue 组件内容到指定 dom 节点</p><blockquote><p>Suspense</p></blockquote><p>异步组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Suspense&gt;</span><br><span class="line">  &lt;template #<span class="keyword">default</span>&gt;</span><br><span class="line">    异步的组件</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  &lt;template #fallback&gt;</span><br><span class="line">    加载状态的组件</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/Suspense&gt;</span><br></pre></td></tr></table></figure><h4 id="稳定-RFC"><a href="#稳定-RFC" class="headerlink" title="稳定 RFC"></a>稳定 RFC</h4><ul><li>v-slot：合并slot、slot-scope，# 缩写</li><li>directive：动态调用</li><li>全局 import</li><li>v-model:title 取代 v-bind.sync，支持多个 v-model</li><li>函数式组件必须写成函数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; h &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FunctionalComp = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, <span class="string">`Hello <span class="subst">$&#123;props.name&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>全局 api 不在挂在到 Vue，现在挂在 app 实例</li><li>自定义 directive api 重新设计</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mDirective = &#123;</span><br><span class="line">  <span class="function"><span class="title">bing</span>(<span class="params">el, binding, vnode, prevVnode</span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">inserted</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">update</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">componentUpdated</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">unbind</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">更新为：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="title">beforeMount</span>(<span class="params">el, binding, vnode, prevVnode</span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeUpdate</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">updated</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeUnmount</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">unmounted</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>删除 filter，method、计算属性取代</li><li>删除内联模板</li><li>Events 支持变化</li></ul><p>删除 $on、$once、$off，$emit 促发 emit配置</p><ul><li>defineAsyncComponent 创建异步组件</li></ul><h4 id="vue2-3对比"><a href="#vue2-3对比" class="headerlink" title="vue2\3对比"></a>vue2\3对比</h4><p>vue3 内置 @vue/server-renderer （服务器渲染解析） @vue-compiler-ssr (解析 template 为 render 函数)</p><p>在 setup 中不可以调用 getCurrentInstance().ctx 来获取组件内部数据，因为在 prod 环境会被干掉</p><h4 id="Vue-3-0-新特性"><a href="#Vue-3-0-新特性" class="headerlink" title="Vue 3.0 新特性"></a>Vue 3.0 新特性</h4><ul><li>易维护，基于 TS 更好的数据类型推到</li><li>更快，基于 Proxy 数据代理，更好的虚拟 DOM 和 SSR 渲染</li><li>更小，Tree-Shaking、时间切片</li><li>更好的规划，CompositionApi</li><li>Better DX，组件改进</li></ul><p><a href="https://www.yuque.com/hugsun/vue3/intro">参考地址</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6 Class 应用</title>
      <link href="2020/11/20/Javascript/ES6%20Class/"/>
      <url>2020/11/20/Javascript/ES6%20Class/</url>
      
        <content type="html"><![CDATA[<h4 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">x, y</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.x = x;</span><br><span class="line">    <span class="built_in">this</span>.y = y;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="built_in">this</span>.x + <span class="string">&#x27;, &#x27;</span> + <span class="built_in">this</span>.y + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">等价于</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pointer</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line"><span class="built_in">this</span>.x = x</span><br><span class="line"><span class="built_in">this</span>.y = y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pointer.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="built_in">this</span>.x + <span class="string">&#x27;, &#x27;</span> + <span class="built_in">this</span>.y + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.assign(Point.prototype, &#123;</span><br><span class="line">  <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">toValue</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>一次向类添加多个方法</p><blockquote><p>特性</p></blockquote><p>类的所有方法都定义在类的prototype属性<br>类的内部所有定义的方法，都是不可枚举的<br>实例的属性除非显式定义在其本身（即定义在this对象上），否则都是定义在原型上（即定义在class上）<br>类的所有实例共享一个原型对象</p><p>使用 Object.getPrototypeOf 方法来获取实例对象的原型，然后再来为原型添加方法/属性</p><blockquote><p>取值函数（getter）和存值函数（setter）</p></blockquote><p>存值函数和取值函数是设置在属性的 Descriptor 对象上</p><blockquote><p>Class 表达式</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyClass = <span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">getClassName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Me.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个类的名字是Me，但是Me只在 Class 的内部可用，指代当前类。在 Class 外部，这个类只能用MyClass引用</p><h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><ul><li>类和模块的内部，默认就是严格模式</li><li>类不存在变量提升（hoist）</li><li>class 内部是严格模式，所以 this 实际指向的是 undefined</li><li>static 关键字，表示该方法不会被实例继承，而是直接通过类来调用</li></ul><p><a href="https://es6.ruanyifeng.com/#README">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 深入学习</title>
      <link href="2020/11/09/Vue/Vue%20%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/"/>
      <url>2020/11/09/Vue/Vue%20%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h4 id="运行时-编译器"><a href="#运行时-编译器" class="headerlink" title="运行时 + 编译器"></a>运行时 + 编译器</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要编译器</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  template: <span class="string">&#x27;&lt;div&gt;&#123;&#123; hi &#125;&#125;&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不需要编译器</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  render (h) &#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&#x27;div&#x27;</span>, <span class="built_in">this</span>.hi)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>运行时版本相比完整版体积要小大约 30%，如果任然希望使用完整版，需要在打包工具中配置别名</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6 语法</title>
      <link href="2020/11/09/Javascript/ES6%20%E8%AF%AD%E6%B3%95/"/>
      <url>2020/11/09/Javascript/ES6%20%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h4 id="let-const"><a href="#let-const" class="headerlink" title="let|const"></a>let|const</h4><p>块级作用域：let，应用场景：for 循环，获取索引值</p><p>声明常量：const，应用场景：不可更改的值、引用第三方库时声明的变量，避免重名导致bug</p><ul><li>变量不提升</li><li>暂时性死区（TDZ）</li></ul><blockquote><p>顶层对象的属性</p></blockquote><p>window对象即<code>顶层对象</code></p><p>var命令和function命令声明的全局变量，依旧是顶层对象的属性；<br>let命令、const命令、class命令声明的全局变量，不属于顶层对象的属性。</p><blockquote><p>获取顶层对象的方式</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一</span></span><br><span class="line">(<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">&#x27;undefined&#x27;</span></span><br><span class="line">   ? <span class="built_in">window</span></span><br><span class="line">   : (<span class="keyword">typeof</span> process === <span class="string">&#x27;object&#x27;</span> &amp;&amp;</span><br><span class="line">      <span class="keyword">typeof</span> <span class="built_in">require</span> === <span class="string">&#x27;function&#x27;</span> &amp;&amp;</span><br><span class="line">      <span class="keyword">typeof</span> <span class="built_in">global</span> === <span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">     ? <span class="built_in">global</span></span><br><span class="line">     : <span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法二</span></span><br><span class="line"><span class="keyword">var</span> getGlobal = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">&#x27;undefined&#x27;</span>) &#123; <span class="keyword">return</span> self; &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">&#x27;undefined&#x27;</span>) &#123; <span class="keyword">return</span> <span class="built_in">window</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">global</span> !== <span class="string">&#x27;undefined&#x27;</span>) &#123; <span class="keyword">return</span> <span class="built_in">global</span>; &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;unable to locate global object&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>统一顶层对象：<code>globalThis</code></p><h4 id="class-extends-super"><a href="#class-extends-super" class="headerlink" title="class|extends|super"></a>class|extends|super</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.type = <span class="string">&#x27;animal&#x27;</span></span><br><span class="line">    <span class="comment">/* 构造方法，内部定义的方法、属性属于实力自己 */</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="title">says</span>(<span class="params">say</span>)</span>&#123;</span><br><span class="line">   <span class="comment">/* 所有实例共享 */</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="built_in">this</span>.type + <span class="string">&#x27; says &#x27;</span> + say)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123; <span class="comment">/* extends 实现继承 */</span></span><br><span class="line"> <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">super</span>() <span class="comment">/* 指代父类实例（父类的this对象，子类`必须`在 `constructor` 方法中`调用 super 方法`） */</span></span><br><span class="line">    <span class="built_in">this</span>.type = <span class="string">&#x27;cat&#x27;</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h4><p>mustache：模板工具库</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string"> There are &lt;b&gt;<span class="subst">$&#123;basket.count&#125;</span>&lt;/b&gt; items</span></span><br><span class="line"><span class="string"> in your basket, &lt;em&gt;<span class="subst">$&#123;basket.onSale&#125;</span>&lt;/em&gt;</span></span><br><span class="line"><span class="string"> are on sale!</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><blockquote><p>标签模板</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> total = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">let</span> msg = passthru<span class="string">`The total is <span class="subst">$&#123;total&#125;</span> (<span class="subst">$&#123;total*<span class="number">1.05</span>&#125;</span> with tax)`</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">passthru</span>(<span class="params">literals</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (i &lt; literals.length) &#123;</span><br><span class="line">    result += literals[i++];</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="built_in">arguments</span>.length) &#123;</span><br><span class="line">      result += <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">literals: [<span class="string">&#x27;The total is&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;with tax)&#x27;</span>]</span><br><span class="line"><span class="built_in">arguments</span>: [literals, total, total*<span class="number">1.05</span>]</span><br></pre></td></tr></table></figure><p><code>主要作用</code>：过滤 HTML 字符串，防止用户输入恶意内容</p><blockquote><p>字符串扩展</p></blockquote><p>padStart()、padEnd()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;x&#x27;</span>.padStart(<span class="number">5</span>, <span class="string">&#x27;0&#x27;</span>) <span class="comment">// &#x27;0000x&#x27;，省略第二个参数，默认使用空格补全长度</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;na&#x27;</span>.repeat(<span class="string">&#x27;3&#x27;</span>) <span class="comment">// &#x27;nanana&#x27;</span></span><br></pre></td></tr></table></figure><p>trimLeft() =&gt; trimStart()<br>trimRight() =&gt; trimEnd()</p><h4 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h4><blockquote><p>变量解构</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a,b,c] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]]</span><br><span class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = a</span><br><span class="line"></span><br><span class="line">foo -&gt; <span class="number">1</span></span><br><span class="line">bar -&gt; <span class="number">2</span></span><br><span class="line">baz -&gt; <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x, y, z] = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]);</span><br></pre></td></tr></table></figure><blockquote><p>对象解构</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; foo, bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; log, sin, cos &#125; = <span class="built_in">Math</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置别名</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">first</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">last</span>: <span class="string">&#x27;world&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">first</span>: f, <span class="attr">last</span>: l &#125; = obj;</span><br><span class="line"></span><br><span class="line">first: 模式</span><br><span class="line">f: 变量，可赋值</span><br></pre></td></tr></table></figure><blockquote><p>字符串解构赋值</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">&#x27;hello&#x27;</span>;</span><br></pre></td></tr></table></figure><p>等号右边值不是对象或数组，就先将其转为对象，必须是<code>数据结构具有 Iterator 接口</code>，都可以采用数组形式的解构赋值，</p><p>解构不成功，变量的值就等于undefined</p><p>解构赋值允许指定默认值，只有位置上的值 === undefined，默认值才会生效</p><p><code>*</code>对象的属性没有次序，变量必须与属性同名，对象的解构赋值可以取到继承的属性</p><p>使用场景：</p><p>（1） 交换变量值<br>（2） 函数返回多个值<br>（3） 函数参数的定义<br>（4） 提取 JSON 数据<br>（5） 遍历 Map 结构<br>（6） 输入模块的指定方法</p><h4 id="ES6-扩展"><a href="#ES6-扩展" class="headerlink" title="ES6 扩展"></a>ES6 扩展</h4><p><strong><code>数值扩展</code></strong></p><blockquote><p>指数运算符</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>**<span class="number">3</span>**<span class="number">2</span></span><br><span class="line">=&gt; <span class="number">2</span>**<span class="number">9</span></span><br><span class="line">=&gt; <span class="number">512</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> **= <span class="number">3</span></span><br><span class="line">=&gt; <span class="number">2</span> * <span class="number">2</span> * <span class="number">2</span></span><br></pre></td></tr></table></figure><blockquote><p>bigInt</p></blockquote><p><strong><code>函数扩展</code></strong></p><p>length属性的返回值，等于函数的参数个数减去指定了默认值的参数个数</p><p>默认值参数形成一个单独的作用域</p><blockquote><p>rest 参数</p></blockquote><p>只能是最后一个参数</p><p>函数的length属性，不包括 rest 参数</p><blockquote><p>严格模式，参数使用</p></blockquote><p>第一种是设定全局性的严格模式</p><p>第二种是把函数包在一个无参数的立即执行函数里面</p><blockquote><p>箭头函数直接返回一个对象，必须在对象外面加上括号</p></blockquote><p>箭头函数没有自己的this，它的this是继承外面的，因此内部的this就是外层代码块的this。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> getTempItem = <span class="function"><span class="params">id</span> =&gt;</span> (&#123; <span class="attr">id</span>: id, <span class="attr">name</span>: <span class="string">&quot;Temp&quot;</span> &#125;)</span><br></pre></td></tr></table></figure><blockquote><p>尾调用，尾递归</p></blockquote><p>函数的最后一步操作是<code>函数调用</code></p><p>目前只有 Safari 浏览器支持尾调用优化，Chrome 和 Firefox 都不支持</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n, total</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</span><br><span class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">factorial(<span class="number">5</span>, <span class="number">1</span>) <span class="comment">// 120</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span> (<span class="params">n , ac1 = <span class="number">1</span> , ac2 = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>( n &lt;= <span class="number">1</span> ) &#123;<span class="keyword">return</span> ac2&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Fibonacci (n - <span class="number">1</span>, ac2, ac1 + ac2);</span><br><span class="line">&#125;</span><br><span class="line">Fibonacci(<span class="number">100</span>) <span class="comment">// 573147844013817200000</span></span><br><span class="line">Fibonacci(<span class="number">1000</span>)</span><br></pre></td></tr></table></figure><p>** 尾调用优化只在严格模式下开启 **</p><p>正常模式下，函数内部有两个变量，可以跟踪函数的调用栈</p><p>func.arguments：返回调用时函数的参数。<br>func.caller：返回调用当前函数的那个函数。</p><blockquote><p>蹦床函数</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (f &amp;&amp; f <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">    f = f();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>尾递归优化</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tco</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> value;</span><br><span class="line">  <span class="keyword">var</span> active = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">var</span> accumulated = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">accumulator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    accumulated.push(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">if</span> (!active) &#123;</span><br><span class="line">      active = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">while</span> (accumulated.length) &#123;</span><br><span class="line">        value = f.apply(<span class="built_in">this</span>, accumulated.shift());</span><br><span class="line">      &#125;</span><br><span class="line">      active = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = tco(<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sum(x + <span class="number">1</span>, y - <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">sum(<span class="number">1</span>, <span class="number">100000</span>)</span><br></pre></td></tr></table></figure><blockquote><p>catch 参数省略</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>数组扩展</code></strong></p><blockquote><p>扩展运算符 …</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment">// 1，2，3</span></span><br><span class="line"></span><br><span class="line">...(x &gt; <span class="number">0</span> ? [<span class="string">&#x27;a&#x27;</span>] : [])</span><br><span class="line"></span><br><span class="line"><span class="built_in">Math</span>.max(...[<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a1 = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="keyword">const</span> a2 = [...a1]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> arr3 = [<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]</span><br><span class="line"><span class="keyword">const</span> newArr = [...arr1, ...arr2, ...arr3]</span><br></pre></td></tr></table></figure><p>只有函数调用时，扩展运算符才可以放在<code>（）</code>中</p><blockquote><p>Array.from()</p></blockquote><p>将类数组、可遍历对象转为数组</p><p>等价于：</p><pre><code>const toArray = (() =&gt;  Array.from ? Array.from : obj =&gt; [].slice.call(obj))();</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(arrayLike).map(<span class="function"><span class="params">x</span> =&gt;</span> x * x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">2</span> &#125;, <span class="function">() =&gt;</span> <span class="string">&#x27;jack&#x27;</span>)</span><br><span class="line"><span class="comment">// 第一个参数指定了第二个参数运行的次数</span></span><br></pre></td></tr></table></figure><blockquote><p>Array.of()</p></blockquote><p>将一组值，转换为数组</p><p>等价于：</p><pre><code>function ArrayOf()&#123;  return [].slice.call(arguments);&#125;</code></pre><blockquote><p>find、findIndex</p></blockquote><blockquote><p>fill</p></blockquote><p>填充数组（填充值，起始位置，结束位置）</p><blockquote><p>includes</p></blockquote><blockquote><p>flat、flatMap</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]].flat(整数：维数)</span><br><span class="line"><span class="comment">// [1,2,3,4]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].flatMap(<span class="function">(<span class="params">x</span>) =&gt;</span> [x, x * <span class="number">2</span>])</span><br><span class="line"><span class="comment">// [2, 4, 3, 6, 4, 8]</span></span><br></pre></td></tr></table></figure><p>Infinity： 不管多少维，全部拉平</p><p><strong><code>对象扩展</code></strong></p><p>直接写入变量和函数，作为对象的属性和方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line"><span class="keyword">const</span> baz = &#123;foo&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;x, y&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> o = &#123;</span><br><span class="line">  <span class="function"><span class="title">method</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello!&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [<span class="string">&#x27;h&#x27;</span> + <span class="string">&#x27;ello&#x27;</span>]() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hi&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简写的对象方法不能作为构造函数使用</p><p>对象的方法使用了取值函数（getter）和存值函数（setter），则name属性不是在该方法上面，而是该方法的属性的描述对象的get和set属性上面，返回值是方法名前加上get和set</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="keyword">get</span> <span class="title">foo</span>() &#123;&#125;,</span><br><span class="line">  <span class="keyword">set</span> <span class="title">foo</span>(<span class="params">x</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.foo.name</span><br><span class="line"><span class="comment">// TypeError: Cannot read property &#x27;name&#x27; of undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line"></span><br><span class="line">descriptor.get.name <span class="comment">// &quot;get foo&quot;</span></span><br><span class="line">descriptor.set.name </span><br></pre></td></tr></table></figure><blockquote><p>对象属性描述</p></blockquote><p>Object.getOwnPropertyDescriptor(obj, [key1]:属性参数必传)</p><pre><code>value: 123,writable: true,enumerable: true,configurable: true</code></pre><blockquote><p>enumerable：false 的属性以下操作会被过滤：</p></blockquote><ol><li>for…in循环：只遍历对象自身的和继承的可枚举的属性；</li><li>Object.keys()：返回对象自身的所有可枚举的属性的键名；</li><li>JSON.stringify()：只串行化对象自身的可枚举的属性；</li><li>Object.assign()： 忽略enumerable为false的属性，只拷贝对象自身的可枚举</li></ol><p>ES6规定：所有 Class 原型的方法都不可枚举</p><blockquote><p>对象属性遍历规则：</p></blockquote><pre><code>首先遍历所有数值键，按照数值升序排列遍历所有字符串键，按照加入时间升序排列遍历所有Symbol键，按照加入时间升序排列</code></pre><blockquote><p>super</p></blockquote><blockquote><p>链判断运算符 ?.</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstName = message?.body?.user?.firstName || <span class="string">&#x27;default&#x27;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>Null 判断运算符 ??</p></blockquote><p>与逻辑运算符一起使用，必须用<code>（）</code>表明优先级</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(lhs &amp;&amp; middle) ?? rhs</span><br><span class="line">lhs &amp;&amp; (middle ?? rhs)</span><br><span class="line"></span><br><span class="line">(lhs ?? middle) &amp;&amp; rhs</span><br><span class="line">lhs ?? (middle &amp;&amp; rhs)</span><br><span class="line"></span><br><span class="line">(lhs || middle) ?? rhs</span><br><span class="line">lhs || (middle ?? rhs)</span><br><span class="line"></span><br><span class="line">(lhs ?? middle) || rhs</span><br><span class="line">lhs ?? (middle || rhs)</span><br></pre></td></tr></table></figure><p><strong><code>对象新增方法</code></strong></p><blockquote><p>Object.is()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>, <span class="string">&#x27;is&#x27;</span>, &#123;</span><br><span class="line">  value: <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x === y) &#123;</span><br><span class="line">      <span class="comment">// 针对+0 不等于 -0的情况</span></span><br><span class="line">      <span class="keyword">return</span> x !== <span class="number">0</span> || <span class="number">1</span> / x === <span class="number">1</span> / y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 针对NaN的情况</span></span><br><span class="line">    <span class="keyword">return</span> x !== x &amp;&amp; y !== y;</span><br><span class="line">  &#125;,</span><br><span class="line">  configurable: <span class="literal">true</span>,</span><br><span class="line">  enumerable: <span class="literal">false</span>,</span><br><span class="line">  writable: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>Object.assign()</p></blockquote><p>源对象（source）的所有可枚举属性，复制到目标对象（target）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">const</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="keyword">const</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.assign(target, source1, source2)</span><br><span class="line"><span class="comment">// &#123;a:1, b:2, c:3&#125;</span></span><br></pre></td></tr></table></figure><p><code>同名属性值覆盖</code>，应用场景：对象按顺序赋值排序<br>不可以转换成拥有枚举实义属性的类型，首参数报错，其余位置跳过。</p><blockquote><p>Object.setPrototypeOf()（写操作）</p></blockquote><blockquote><p>Object.getPrototypeOf()（读操作）</p></blockquote><blockquote><p>Object.create()（生成操作）</p></blockquote><blockquote><p>Object.fromEntries()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.fromEntries([</span><br><span class="line">  [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;baz&#x27;</span>, <span class="number">42</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="string">&#x27;foo&#x27;</span>, <span class="literal">true</span>).set(<span class="string">&#x27;bar&#x27;</span>, <span class="literal">false</span>)</span><br><span class="line">=&gt; <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;baz&#x27;</span>, <span class="number">42</span>]</span><br><span class="line">])</span><br></pre></td></tr></table></figure><h4 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h4><p>Symbol函数前不能使用new命令，是一个原始类型的值，不是对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Symbol.prototype.description</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sym = <span class="built_in">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">sym.description</span><br></pre></td></tr></table></figure><p>Symbol 值不能与其他类型的值进行运算，可以显式转为字符串，也可以转为布尔值，但是不能转为数值<br>Symbol 值作为对象属性名时，不能用点运算符<br>Symbol 值作为属性名时，该属性还是公开属性，不是私有属性</p><blockquote><p>Symbol.for()，Symbol.keyFor()</p></blockquote><p>Symbol.for() 全局等级<br>Symbol.keyFor() 获取全局等级的key</p><blockquote><p>内置值</p></blockquote><p>Symbol.hasInstance：判断是否为该对象的实例<br>Symbol.isConcatSpreadable：对象用于Array.prototype.concat()时，是否可以展开<br>Symbol.species：创建衍生对象时，会使用该属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> MyArray(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">const</span> b = a.map(<span class="function"><span class="params">x</span> =&gt;</span> x);</span><br><span class="line"><span class="keyword">const</span> c = a.filter(<span class="function"><span class="params">x</span> =&gt;</span> x &gt; <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">b <span class="keyword">instanceof</span> MyArray <span class="comment">// true</span></span><br><span class="line">c <span class="keyword">instanceof</span> MyArray <span class="comment">// true</span></span><br><span class="line">衍生对象</span><br></pre></td></tr></table></figure><p>Symbol.match<br>Symbol.replace<br>Symbol.search<br>Symbol.split<br>Symbol.iterator<br>Symbol.toPrimitive<br>Symbol.toStringTag<br>Symbol.unscopables</p><h4 id="Set、Map"><a href="#Set、Map" class="headerlink" title="Set、Map"></a>Set、Map</h4><blockquote><p>Set：类似数组，成员值唯一，本身是一构造函数</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>]);</span><br><span class="line">[...set]</span><br></pre></td></tr></table></figure><p>向Set插值时，不会发生类型转换，相当于 “===”，NaN 等于自身</p><blockquote><p>常用方法</p></blockquote><p>add、delete、has、clear</p><p>keys、values、entries、forEach</p><blockquote><p>WeakSet</p></blockquote><p>只能放置对象的成员，不适合放置应用，不计入垃圾回收机制，引用随时消失，因此不可遍历</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="keyword">new</span> <span class="built_in">WeakSet</span>([[<span class="number">2342</span>,<span class="number">234234</span>,<span class="number">453</span>,<span class="number">45656</span>,<span class="number">35</span>]])</span><br><span class="line"></span><br><span class="line">a.add(&#123;&#125;) <span class="comment">// true</span></span><br><span class="line">a = <span class="keyword">new</span> <span class="built_in">WeakSet</span>(&#123;&#125;) <span class="comment">// object is not iterable</span></span><br></pre></td></tr></table></figure><blockquote><p>Map</p></blockquote><p>Object 结构： 字符串—值<br>Map 结构：值-值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">const</span> o = &#123;<span class="attr">p</span>: <span class="string">&#x27;Hello World&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">m.set(o, <span class="string">&#x27;content&#x27;</span>)</span><br><span class="line">m.get(o) </span><br></pre></td></tr></table></figure><blockquote><p>常用方法</p></blockquote><p>has、delete、size</p><p><code>**</code>只有对同一个对象的引用，Map结构才视为同一个键(内存地址的绑定)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">map.set([<span class="string">&#x27;a&#x27;</span>], <span class="number">555</span>);</span><br><span class="line">map.get([<span class="string">&#x27;a&#x27;</span>]) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>主要用途：<br>    DOM 节点作为键名<br>    部署私有属性</p><h4 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h4><p>修改某些操作的默认行为，即元编程，对编程语言进行编程</p><pre><code>let proxy = new Proxy(target[所要拦截的目标对象], handler[定制拦截行为])</code></pre><blockquote><p>支持的拦截操作</p></blockquote><p>get、set、has、deleteProperty、ownKeys、getOwnPropertyDescriptor、defineProperty、preventExtensions、getPrototypeOf、isExtensible、setPrototypeOf、apply、construct</p><h4 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h4><ol><li>获取语言内部的方法</li><li>修改某些Object方法的返回结果</li><li>Object操作都变成函数行为</li><li>Reflect对象的方法与Proxy对象的方法一一对应</li></ol><h4 id="import-export"><a href="#import-export" class="headerlink" title="import|export"></a>import|export</h4><blockquote><p>AMD</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//content.js</span></span><br><span class="line">define(<span class="string">&#x27;content.js&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="string">&#x27;A cat&#x27;</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">&#x27;./content.js&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">animal</span>)</span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(animal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>CommomJs</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">var</span> animal = <span class="built_in">require</span>(<span class="string">&#x27;./content.js&#x27;</span>)</span><br><span class="line"><span class="comment">//content.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="string">&#x27;A cat&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>ES6</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> animal <span class="keyword">from</span> <span class="string">&#x27;./content&#x27;</span></span><br><span class="line"><span class="comment">//content.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">&#x27;A cat&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">&#x27;A cat&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">say</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="string">&#x27;Hello!&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> type = <span class="string">&#x27;dog&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> animal <span class="comment">/* 引用默认 */</span>, &#123; say, type <span class="keyword">as</span> animalType <span class="comment">/* 修改变量名 */</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./content&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> animal, * <span class="keyword">as</span> content <span class="comment">/* 引用全部 */</span> <span class="keyword">from</span> <span class="string">&#x27;./content&#x27;</span></span><br></pre></td></tr></table></figure><p>Tree-shaking（rollup.js）将未被依赖或使用的过滤掉</p><h4 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h4><ul><li><p>promise对象的状态不受处界影响；</p></li><li><p>promise对象共有3种可能的状态：Pending、Fulfiled、Rejected；</p></li><li><p>但promise对象的状态变化只能是以下2种情况之一：</p><pre><code>由Pending变为Fulfiled由Pending变为Rejected</code></pre></li><li><p>promise对象的状态一旦改变，就不会再变，任何时候都可以得到这个结果；</p></li><li><p>promise对象一旦创建就会立即执行创建该promise对象时传入的异步函数；</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">    resolve(value);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>异步加载图片</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImageAsync</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> image = <span class="keyword">new</span> Image();</span><br><span class="line"></span><br><span class="line">    image.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(image);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    image.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;Could not load image at &#x27;</span> + url));</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    image.src = url;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">promise</span><br><span class="line">.then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;···&#125;)</span><br><span class="line">.catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;···&#125;)</span><br><span class="line">.finally(<span class="function">() =&gt;</span> &#123;···&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>Promise.all([p1, p2, p3]) 且关系<br>Promise.race([p1, p2, p3]) 或关系<br>Promise.any() 所有参数实例都变成rejected状态，返回rejected状态<br>Promise.allSettled() 所有参数实例都返回结果，才返回fulfilled状态<br>Promise.try()</p></blockquote><h4 id="Iterator、Generator"><a href="#Iterator、Generator" class="headerlink" title="Iterator、Generator"></a>Iterator、Generator</h4><p>执行 Generator 函数会返回一个遍历器对象，Generator 函数除了状态机，还是一个遍历器对象生成函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>yield表达式只能用在 Generator 函数里面</code></pre><p><code>yield*</code>：Generator 函数里面执行另一个 Generator 函数</p><h4 id="async、await"><a href="#async、await" class="headerlink" title="async、await"></a>async、await</h4><p>Generator函数的语法糖</p><p>async =&gt; * ：表示函数里有异步操作<br>await =&gt; yield：表示需要等待结果</p><blockquote><p>async函数内部 return 语句返回的值，会成为 then 方法回调函数的参数，抛出的错误，会导致返回的 Promise 对象变为 reject 状态</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f().then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</span><br></pre></td></tr></table></figure><p>await命令后面是一个thenable对象（即定义了then方法的对象），那么await会将其等同于 Promise 对象</p><p>await后面的异步操作出错，那么等同于async函数返回的 Promise 对象被reject</p><p>多个await命令后面的异步操作，如果不存在继发关系，最好让它们同时触发</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo, bar] = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([getFoo(), getBar()]);</span><br></pre></td></tr></table></figure><blockquote><p>async 原理</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> spawn(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spawn</span>(<span class="params">genF</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> gen = genF();</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">nextF</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> next;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        next = nextF();</span><br><span class="line">      &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="keyword">return</span> reject(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(next.done) &#123;</span><br><span class="line">        <span class="keyword">return</span> resolve(next.value);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">Promise</span>.resolve(next.value).then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">        step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.next(v); &#125;);</span><br><span class="line">      &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.throw(e); &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.next(<span class="literal">undefined</span>); &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>顶层await只能用在 ES6 模块，不能用在 CommonJS 模块。这是因为 CommonJS 模块的require()是同步加载</p><p><a href="https://es6.ruanyifeng.com/#README">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vuex-router-sync</title>
      <link href="2020/11/03/%E5%89%8D%E7%AB%AF/vuex-router-sync/"/>
      <url>2020/11/03/%E5%89%8D%E7%AB%AF/vuex-router-sync/</url>
      
        <content type="html"><![CDATA[<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre><code>npm install vuex-router-sync --save</code></pre><blockquote><p>配置使用</p></blockquote><pre><code>import &#123;sync&#125; from &#39;vuex-router-sync&#39;sync(store, router)</code></pre><p>通过sync方法把store跟router连接起来，在vue组件中<code>this.$store.state.route</code>，返回结果即router中的<code>currentRoute</code>对象</p><h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.sync = <span class="function"><span class="keyword">function</span> (<span class="params">store, router, options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> moduleName = (options || &#123;&#125;).moduleName || <span class="string">&#x27;route&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// store 中注册一个 module，名称默认‘route’</span></span><br><span class="line">  store.registerModule(moduleName, &#123;</span><br><span class="line">    namespaced: <span class="literal">true</span>,</span><br><span class="line">    state: cloneRoute(router.currentRoute),</span><br><span class="line">    mutations: &#123;</span><br><span class="line">      <span class="string">&#x27;ROUTE_CHANGED&#x27;</span>: <span class="function"><span class="keyword">function</span> <span class="title">ROUTE_CHANGED</span> (<span class="params">state, transition</span>) </span>&#123;</span><br><span class="line">        store.state[moduleName] = cloneRoute(transition.to, transition.from)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> isTimeTraveling = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">var</span> currentPath</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听 store 中 route 对象的变化</span></span><br><span class="line">  <span class="keyword">var</span> storeUnwatch = store.watch(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">state</span>) </span>&#123; <span class="keyword">return</span> state[moduleName]; &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">route</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> fullPath = route.fullPath;</span><br><span class="line">      <span class="keyword">if</span> (fullPath === currentPath) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (currentPath != <span class="literal">null</span>) &#123;</span><br><span class="line">        isTimeTraveling = <span class="literal">true</span></span><br><span class="line">        router.push(route)</span><br><span class="line">      &#125;</span><br><span class="line">      currentPath = fullPath</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; <span class="attr">sync</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过router的全局后置钩子函数监听当前路由对象,修改store中的当前state</span></span><br><span class="line">  <span class="keyword">var</span> afterEachUnHook = router.afterEach(<span class="function"><span class="keyword">function</span> (<span class="params">to, <span class="keyword">from</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isTimeTraveling) &#123;</span><br><span class="line">      isTimeTraveling = <span class="literal">false</span></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    currentPath = to.fullPath</span><br><span class="line">    store.commit(moduleName + <span class="string">&#x27;/ROUTE_CHANGED&#x27;</span>, &#123; <span class="attr">to</span>: to, <span class="attr">from</span>: <span class="keyword">from</span> &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">unsync</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (afterEachUnHook != <span class="literal">null</span>) &#123;</span><br><span class="line">      afterEachUnHook()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (storeUnwatch != <span class="literal">null</span>) &#123;</span><br><span class="line">      storeUnwatch()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    store.unregisterModule(moduleName)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneRoute</span> (<span class="params">to, <span class="keyword">from</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> clone = &#123;</span><br><span class="line">    name: to.name,</span><br><span class="line">    path: to.path,</span><br><span class="line">    hash: to.hash,</span><br><span class="line">    query: to.query,</span><br><span class="line">    params: to.params,</span><br><span class="line">    fullPath: to.fullPath,</span><br><span class="line">    meta: to.meta</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">from</span>) &#123;</span><br><span class="line">    clone.from = cloneRoute(<span class="keyword">from</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.freeze(clone)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vuex pathify 使用指南</title>
      <link href="2020/11/02/%E5%89%8D%E7%AB%AF/vuex%20pathify%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2020/11/02/%E5%89%8D%E7%AB%AF/vuex%20pathify%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p><a href="https://davestewart.github.io/vuex-pathify/#/">vuex pathify</a></p><p>状态的存储访问统一使用 <code>get()</code>、<code>set()</code>、<code>sync()</code>、<code>call()</code> 方法</p><p><a href="https://codesandbox.io/s/github/davestewart/vuex-pathify-demos/tree/master/main?file=/src/main.js">demo</a></p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>npm i vuex-pathify</p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><style>.tableWrap table{    width: 100%;    border-collapse: collapse;}.tableWrap table *{    padding: .25rem;    border:1px solid #cdcdcd;}</style><div class="tableWrap"><table><thead><tr><th align="left">scheme</th><th align="left">path</th><th align="left">state</th><th align="left">getter</th><th align="left">mutation</th><th align="left">action</th><th align="left">notes</th></tr></thead><tbody><tr><td align="left">standard</td><td align="left">/foo</td><td align="left">foo</td><td align="left">foo</td><td align="left">SET_FOO</td><td align="left">setFoo</td><td align="left">默认</td></tr><tr><td align="left">simple</td><td align="left">/foo</td><td align="left">foo</td><td align="left">foo</td><td align="left">foo</td><td align="left">setFoo</td><td align="left">简洁</td></tr></tbody></table></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认配置</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mapping: <span class="string">&#x27;standard&#x27;</span>,  <span class="comment">// map states to store members using the &quot;standard&quot; scheme</span></span><br><span class="line">  strict: <span class="literal">true</span>,         <span class="comment">// throw an error if the store member cannot be found</span></span><br><span class="line">  cache: <span class="literal">true</span>,          <span class="comment">// cache generated functions for faster re-use</span></span><br><span class="line">  deep: <span class="literal">true</span>,           <span class="comment">// allow sub-property access to Vuex stores</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>由于ES6导入的工作方式，配置必须保存在独立文件中，并且必须在导入任何存储文件之前导入</code></pre><ol><li>新建 store/pathify.js</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pathify <span class="keyword">from</span> <span class="string">&#x27;vuex-pathify&#x27;</span></span><br><span class="line"></span><br><span class="line">pathify.options.mapping = <span class="string">&#x27;standard&#x27;</span></span><br><span class="line">pathify.options.deep = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pathify</span><br></pre></td></tr></table></figure><ol start="2"><li>项目集成</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pathify <span class="keyword">from</span> <span class="string">&#x27;vuex-pathify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查设置，输出当前options值和映射函数输出的明细</span></span><br><span class="line">pathify.debug()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = &#123;</span><br><span class="line">  <span class="comment">// state, members, modules, etc</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  plugins: [ pathify.plugin ],</span><br><span class="line">  ...store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>参数说明</p></blockquote><p>deep:</p><p>0：禁止访问子属性<br>1：启用对现有子属性的访问<br>2：允许创建新的子属性</p><h4 id="自定义配置"><a href="#自定义配置" class="headerlink" title="自定义配置"></a>自定义配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pathify.options.mapping = <span class="function"><span class="keyword">function</span> (<span class="params">type, name, formatters</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span>(type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;mutations&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> formatters.const(<span class="string">&#x27;set&#x27;</span>, name)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;actions&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> formatters.camel(<span class="string">&#x27;set&#x27;</span>, name)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;getters&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> formatters.snake(<span class="string">&#x27;get&#x27;</span>, name)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> name <span class="comment">// foo</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>formatters:</p><p>camel - camelCase<br>snake - snake_case<br>const - CONST_CASE</p><h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; make &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex-pathify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">  items: [],</span><br><span class="line">  status: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  filters: &#123;</span><br><span class="line">    search: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    sort : &#123; ... &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>const mutations = make.mutations(state)</p></blockquote><p>代码生成如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mutations = &#123;</span><br><span class="line">    SET_ITEMS: <span class="function">(<span class="params">state, value</span>) =&gt;</span> state.items = value <span class="keyword">instanceof</span> Payload</span><br><span class="line">        ? value.update(state[key])</span><br><span class="line">        : value,</span><br><span class="line">    SET_STATUS: <span class="function">(<span class="params">state, value</span>) =&gt;</span> state.status = value <span class="keyword">instanceof</span> Payload</span><br><span class="line">        ? value.update(state[key])</span><br><span class="line">        : value,</span><br><span class="line">    SET_FILTERS: <span class="function">(<span class="params">state, value</span>) =&gt;</span> state.filters = value <span class="keyword">instanceof</span> Payload</span><br><span class="line">        ? value.update(state[key])</span><br><span class="line">        : value,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>const actions = make.actions(state)</p></blockquote><p>代码生成如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    setItems: <span class="function">(<span class="params">&#123;commit&#125;, value</span>) =&gt;</span> commit(<span class="string">&#x27;SET_ITEMS&#x27;</span>, value),</span><br><span class="line">    setStatus: <span class="function">(<span class="params">&#123;commit&#125;, value</span>) =&gt;</span> commit(<span class="string">&#x27;SET_STATUS&#x27;</span>, value),</span><br><span class="line">    setFilters: <span class="function">(<span class="params">&#123;commit&#125;, value</span>) =&gt;</span> commit(<span class="string">&#x27;SET_FILTERS&#x27;</span>, value),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>const getters = make.getters(state)</p></blockquote><p>代码生成如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">  items: <span class="function"><span class="params">state</span> =&gt;</span> state.items,</span><br><span class="line">  status: <span class="function"><span class="params">state</span> =&gt;</span> state.status,</span><br><span class="line">  filters: <span class="function"><span class="params">state</span> =&gt;</span> state.filters,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>get 访问</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">store.get(<span class="string">&#x27;filters@sort.order&#x27;</span>)</span><br><span class="line"><span class="built_in">this</span>.$store.getters[<span class="string">&#x27;filters@sort.order&#x27;</span>]</span><br></pre></td></tr></table></figure><blockquote><p>set 设置</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.set(<span class="string">&#x27;items&#x27;</span>, data).then(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure><blockquote><p>sync 设置双向绑定数据</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sync(<span class="string">&#x27;products/status&#x27;</span>)</span><br><span class="line"><span class="comment">// 生成代码如下：</span></span><br><span class="line">status: &#123;</span><br><span class="line">    get () &#123; </span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.$store.state.products.status</span><br><span class="line">    &#125;,</span><br><span class="line">    set (value) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;products/SET_STATUS&#x27;</span>, value)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>call 创建函数 dispatch actions</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  load: call(<span class="string">&#x27;products/load&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">methods: &#123;</span><br><span class="line">  load (payload) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.$store.dispatch(<span class="string">&#x27;products/load&#x27;</span>, payload)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Get, Sync, Call &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex-pathify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// component</span></span><br><span class="line">@Components</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> <span class="keyword">extends</span> <span class="title">Vue</span> </span>&#123;</span><br><span class="line">  @Get(<span class="string">&#x27;products/items&#x27;</span>) items</span><br><span class="line">  @Sync(<span class="string">&#x27;products/tax&#x27;</span>) tax</span><br><span class="line">  @Call(<span class="string">&#x27;products/setDiscount&#x27;</span>) setDiscount</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>等价于</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; get, sync, call &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex-pathify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  computed: &#123;</span><br><span class="line">    items: get(<span class="string">&#x27;products/items&#x27;</span>),</span><br><span class="line">    tax: sync(<span class="string">&#x27;products/tax&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    setDiscount: call(<span class="string">&#x27;products/setDiscount&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>apexcharts 使用指南</title>
      <link href="2020/10/27/%E5%89%8D%E7%AB%AF/apexcharts%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2020/10/27/%E5%89%8D%E7%AB%AF/apexcharts%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p><a href="https://apexcharts.com/">apexcharts</a></p><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><div id="chart"></div><style>@import url('https://fonts.googleapis.com/css?family=Poppins');* {  font-family: 'Poppins', sans-serif;}#chart {  max-width: 760px;  margin: 35px auto;  opacity: 0.9;}</style><script src="https://cdn.jsdelivr.net/npm/apexcharts"></script><script> var series = { monthDataSeries1: { dates: ["13 Nov 2017", "14 Nov 2017", "15 Nov 2017", "16 Nov 2017", "17 Nov 2017", "20 Nov 2017"], prices: [8107.85, 8128, 8122.9, 8165.5, 8340.7, 8423.7] }, monthDataSeries2: { dates: ["13 Nov 2017", "14 Nov 2017", "15 Nov 2017", "16 Nov 2017", "17 Nov 2017", "20 Nov 2017"], prices: [8423.7, 8423.5, 8514.3, 8481.85, 8487.7, 8506.9] }, monthDataSeries3: { dates: ["02 Jun 2017", "05 Jun 2017", "06 Jun 2017", "07 Jun 2017", "08 Jun 2017", "09 Jun 2017"], prices: [7114.25, 7126.6, 7116.95, 7203.7, 7233.75, 7451] }}var options = {  annotations: {    yaxis: [      {        y: 8200,        borderColor: "#00E396",        label: {          borderColor: "#00E396",          style: {            color: "#fff",            background: "#00E396"          },          text: "Y Axis Annotation"        }      }    ],    xaxis: [      {        // in a datetime series, the x value should be a timestamp, just like it is generated below        x: new Date("11/17/2017").getTime(),        strokeDashArray: 0,        borderColor: "#775DD0",        label: {          borderColor: "#775DD0",          style: {            color: "#fff",            background: "#775DD0"          },          text: "X Axis Anno Vertical"        },      },      {        x: new Date("14 Nov 2017").getTime(),        borderColor: "#FEB019",        label: {          borderColor: "#FEB019",          style: {            color: "#fff",            background: "#FEB019"          },          orientation: "horizontal",          text: "X Axis Anno Horizonal"        }      }    ],    points: [      {        x: new Date("15 Nov 2017").getTime(),        y: 8122.9,        marker: {          size: 6,          fillColor: "#fff",          strokeColor: "#2698FF",          radius: 2        },        label: {          borderColor: "#FF4560",          offsetY: 0,          style: {            color: "#fff",            background: "#FF4560"          },          text: "Point Annotation (XY)"        }      }    ]  },  chart: {    height: 380,    type: "line",    id: "areachart-2"  },  line: {    dataLabels: {      position: 'top'    }  },  dataLabels: {    enabled: true,    style: {        colors: ['#333']    },    offsetX: -5,    offsetY: 10  },  stroke: {    curve: "straight"  },  series: [    {      data: series.monthDataSeries1.prices    }  ],  title: {    text: "Line with Annotations",    align: "left"  },  labels: series.monthDataSeries1.dates,  xaxis: {    type: "datetime"  }};var chart = new ApexCharts(document.querySelector("#chart"), options);chart.render();</script><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><blockquote><p>npm</p></blockquote><ol><li><p>npm install apexcharts –save</p></li><li><p>import ApexCharts from ‘apexcharts’</p></li></ol><blockquote><p>CDN</p></blockquote><pre><code>&lt;script src=&quot;https://cdn.jsdelivr.net/npm/apexcharts&quot;&gt;&lt;/script&gt;</code></pre><h4 id="图表要点"><a href="#图表要点" class="headerlink" title="图表要点"></a>图表要点</h4><ul><li>范围注释</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">annotations: &#123;</span><br><span class="line">  yaxis: [</span><br><span class="line">    &#123;</span><br><span class="line">      y: <span class="number">8600</span>,</span><br><span class="line">      y2: <span class="number">9000</span>,</span><br><span class="line">      borderColor: <span class="string">&#x27;#000&#x27;</span>,</span><br><span class="line">      fillColor: <span class="string">&#x27;#FEB019&#x27;</span>,</span><br><span class="line">      label: &#123;</span><br><span class="line">        text: <span class="string">&#x27;Y-axis range&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">label: &#123;</span><br><span class="line">  borderColor: <span class="string">&#x27;#00E396&#x27;</span>,</span><br><span class="line">  orientation: <span class="string">&#x27;horizontal&#x27;</span>,</span><br><span class="line">  style: &#123;</span><br><span class="line">    color: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">    background: <span class="string">&#x27;#00E396&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  text: <span class="string">&#x27;Y-axis annotation on 8800&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">marker: &#123;</span><br><span class="line">  size: <span class="number">8</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>数据标签</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">plotOptions: &#123;</span><br><span class="line">  bar: &#123;</span><br><span class="line">    dataLabels: &#123;</span><br><span class="line">      position: <span class="string">&#x27;top&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  dataLabels: &#123;</span><br><span class="line">    enabled: <span class="literal">true</span>,</span><br><span class="line">    style: &#123;</span><br><span class="line">        colors: [<span class="string">&#x27;#333&#x27;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    offsetX: <span class="number">30</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="设置主题"><a href="#设置主题" class="headerlink" title="设置主题"></a>设置主题</h4><pre><code>Apex.theme.palette</code></pre><h4 id="整合使用"><a href="#整合使用" class="headerlink" title="整合使用"></a>整合使用</h4><p>ng-ApexCharts：ApexCharts的Angular包装器组件<br>React-ApexCharts：ApexCharts的React包装器组件<br>Vue-ApexCharts：ApexCharts的Vue包装器组件</p><h4 id="文本自动换行"><a href="#文本自动换行" class="headerlink" title="文本自动换行"></a>文本自动换行</h4><pre><code>将字符串转换成“字符串数组”</code></pre><h4 id="导出图表"><a href="#导出图表" class="headerlink" title="导出图表"></a>导出图表</h4><p>传统上，在服务器上导出图表，使用无头浏览器（Puppeteer或PhantomJS<code>停产</code>），需要Node.js基础结构</p><p>ApexCharts 使用 <a href="https://www.fusioncharts.com/fusionexport">FusionExport</a></p><blockquote><p>无头浏览器</p></blockquote><p>无须显示器、键盘和鼠标操作，通过网络连接控制</p><blockquote><p>如何检查是无头浏览器</p></blockquote><ol><li>User agent</li></ol><p>“Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/59.0.3071.115 Safari/537.36”</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="regexp">/HeadlessChrome/</span>.test(<span class="built_in">window</span>.navigator.userAgent)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Chrome headless detected&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>插件 Plugins</li></ol><p>无头浏览器，插件检查，返回空数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(navigator.plugins.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;It may be Chrome headless&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>语言</li></ol><p>navigator.language 和 navigator.languages。一个是指浏览器界面的语言；一个返回的是个数组，里面存储的是浏览器用户的所有次选语言</p><p>无头浏览器，navigator.languages 返回空字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(navigator.languages == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Chrome headless detected&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>WebGL</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> gl = canvas.getContext(<span class="string">&#x27;webgl&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> debugInfo = gl.getExtension(<span class="string">&#x27;WEBGL_debug_renderer_info&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);</span><br><span class="line"><span class="keyword">var</span> renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(vendor == <span class="string">&quot;Brian Paul&quot;</span> &amp;&amp; renderer == <span class="string">&quot;Mesa OffScreen&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Chrome headless detected&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>加载失败的图片，宽、高均为0</li></ol><blockquote><p>应用场景</p></blockquote><ul><li>网站及应用测试</li><li>JavaScript库测试</li><li>JavaScript模拟与交互</li><li>在后台运行一个或多个自动化UI测试</li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vuetify 使用指南</title>
      <link href="2020/10/27/%E5%89%8D%E7%AB%AF/vuetify%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2020/10/27/%E5%89%8D%E7%AB%AF/vuetify%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vuetifyjs.com/">Vuetify</a>采用移动优先设计方案，基于Material Design 2规范</p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ol><li><p>Vue UI 安装</p></li><li><p>Nuxt 安装</p></li></ol><p>npm install @nuxtjs/vuetify -D</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nuxt.config.js</span></span><br><span class="line">&#123;</span><br><span class="line">  buildModules: [</span><br><span class="line">    <span class="comment">// Simple usage</span></span><br><span class="line">    <span class="string">&#x27;@nuxtjs/vuetify&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// With options</span></span><br><span class="line">    [<span class="string">&#x27;@nuxtjs/vuetify&#x27;</span>, &#123; <span class="comment">/* module options */</span> &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><p>Webpack 安装</p></li><li><p>CDN 安装</p></li><li><p>结合 <a href="http://www.electronjs.org/">Electron</a>、PWA、<a href="http://cordova.axuer.com/">Cordova</a>、<a href="https://capacitorjs.com/">Capacitor</a></p></li></ol><h4 id="字体图标"><a href="#字体图标" class="headerlink" title="字体图标"></a>字体图标</h4><p><a href="https://materialdesignicons.com/">Material Icons</a></p><h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><ol><li>背景、文字样式设置</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置背景 --&gt;</span></span><br><span class="line">color=&quot;grey lighten-5&quot; </span><br><span class="line"><span class="comment">&lt;!-- 设置文字 --&gt;</span></span><br><span class="line">class=&quot;grey--text text--lighten-5&quot;</span><br></pre></td></tr></table></figure><ol start="2"><li>‘v-slot’ directive doesn’t support any modifier</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:</span>[`<span class="attr">item.actions</span>`]=<span class="string">&quot;&#123; item &#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p>设置负边距</p><p> mt-n3</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>企业常见融资方法</title>
      <link href="2020/10/25/Other/%E5%BE%AE%E8%A7%82%E9%87%91%E8%9E%8D/%E4%BC%81%E4%B8%9A%E5%B8%B8%E8%A7%81%E8%9E%8D%E8%B5%84%E6%96%B9%E6%B3%95/"/>
      <url>2020/10/25/Other/%E5%BE%AE%E8%A7%82%E9%87%91%E8%9E%8D/%E4%BC%81%E4%B8%9A%E5%B8%B8%E8%A7%81%E8%9E%8D%E8%B5%84%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>第01类：银行担保/抵押/质押等贷款     </p><p>第02类：银行法人借贷   </p><p>第03类：应收帐款保理     </p><p>第04类：信用担保抵押      </p><p>第05类：个人信用卡集合透支 </p><p>第06类：法人帐户临时透支</p><p>第07类：银行贷款贴息</p><p>第08类：中小企业无担保/抵押/质押贷款</p><p>第09类：无形资产贷款    </p><p>第08类：发行企业债             </p><p>第09类：发行中期票据           </p><p>第10类：发行短期融资券</p><p>第11类：发行中小企业集合票据 </p><p>第12类：发行公司债</p><p>第13类：银行票据贴现</p><p>第14类：银行委托贷款</p><p>第15类：担保公司拆借</p><p>第16类：小额贷款公司拆借               </p><p>第17类：金融租赁拆借</p><p>第18类：融资租赁拆借</p><p>第19类：出售回租融资</p><p>第20类：典当拆借融资     </p><p>第21类：民间直接借贷</p><p>第22类：百联安模式</p><p>第23类：民间模拟法人内部借贷                </p><p>第24类：民间机构间自助</p><p>第25类：民间机构团购授信</p><p>第26类：真实内部借贷                  </p><p>第27类：上游客户资金预收</p><p>第28类：下游客户资金预收</p><p>第29类：商业储值卡预收</p><p>第30类：信用卡银联分账融资</p><p>第31类：村、镇股份有限公司担保融资</p><p>第32类：五户联保融资</p><p>第33类：债权类信托融资</p><p>第34类：股权类信托融资</p><p>第35类：混合类信托融资</p><p>第36类：互助抵押/担保融资</p><p>第37类：天使投资融资</p><p>第38类：创业投资融资</p><p>第39类：风险投资融资</p><p>第40类：股权私募基金融资</p><p>第41类：战略投资人</p><p>第42类：财务投资人融资       </p><p>第43类：上市前私募融资</p><p>第44类：国内各地柜台代办转让系统挂牌融资</p><p>第45类：国内各地OTC市场公开挂牌融资</p><p>第46类：国内各地产权交易市场公开挂牌融资</p><p>第47类：国内A股公开交易市场首次公开挂牌融资</p><p>第48类：国内B股公开交易市场首次公开挂牌融资</p><p>第49类：国内中小板股票公开交易首次公开挂牌融资</p><p>第50类：国内三板股票交易市场公开挂牌融资</p><p>第51类：公开股票发行市场CBA模式融资</p><p>第52类：非上市公司并购重组融资</p><p>第53类：已上市公司并购重组融资</p><p>第54类：非定向/定向增发融资</p><p>第55类：非定向/定向配股融资</p><p>第56类：非上市公司股权质押融资</p><p>第57类：已上市公司股权质押融资</p><p>第58类：公开发行股票交易市场二级市场构架融资</p><p>第59类：发行可转债融资</p><p>第60类：非商业法人主体模式融资</p><p>第61类：慈善/公益模式融资</p><p>第62类：连锁/加盟模式融资</p><p>第63类：预收买卖订金模式融资</p><p>第64类：预收服务保证金模式融资</p><p>第65类：顾问费/咨询费预压模式融资</p><p>第66类：商业模式构架融资</p><p>第67类：电子商务交易市场模式融资</p><p>第68类：期货对冲模式融资</p><p>第69类：远期利益资源配比模式融资</p><p>第70类：国家科技部无偿划拨资金融资</p><p>第71类：国家科技部配套资金融资</p><p>第72类：国家发改委无偿划拨资金融资</p><p>第73类：国家发改委配套资金融资</p><p>第74类：国家工信部补贴或配套资金融资</p><p>第75类：国家商务部补贴或配套资金融资</p><p>第76类：国家级工程/研究中心融资</p><p>第77类：特殊信誉杠杆融资  </p><p>第78类：BT/BOT模式融资</p><p>第79类：变相资产证券化/货币化融资</p><p>第80类：变相红筹构架香港设立/发行基金国内融资</p><p>第81类：家人/朋友/同学等内部融资</p><p>第82类：商业银行私人银行部大客户变相融资</p><p>第83类：发行各类理财产品融资</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>金融普华</title>
      <link href="2020/10/25/Other/%E5%BE%AE%E8%A7%82%E9%87%91%E8%9E%8D/%E9%87%91%E8%9E%8D%E6%99%AE%E5%8D%8E/"/>
      <url>2020/10/25/Other/%E5%BE%AE%E8%A7%82%E9%87%91%E8%9E%8D/%E9%87%91%E8%9E%8D%E6%99%AE%E5%8D%8E/</url>
      
        <content type="html"><![CDATA[<blockquote><p>中西方金融体系、思维方式的差异</p></blockquote><p>历史第一本金融学巨著：【管子】2600年前，西方 1500年前</p><p>历史第一所大学：稷下学宫·齐国 2500年前，西方 1000年前</p><blockquote><p>主板、中小板、创业板</p></blockquote><p>企业：</p><p>三高六新（高科技、高成长、高增值、新经济、新技术、新材料、新能源、新农村、新服务）</p><p>创业板特点：门槛低、融资更多、退出更简单、竞争优势更大</p><p>券商：</p><p>达到创业板标准的企业上创业板，还是中小板标准的企业上创业板</p><p>发审委：</p><p>规模好、效益好、模式清晰的中小板企业上创业板，还是达到创业板标准的企业上创业板</p><p>政府：</p><p>股票市场，一堆符合中小板的企业和刚过线的创业企业更容易让市场火爆</p><p>A类企业：符合创业板条件的创业企业（创业板原来针对企业）</p><p>B类企业：符合中国股市中小板上市条件的中等规模企业</p><blockquote><p>涉及到创业板上市的保荐工作</p></blockquote><p>券商（证券公司投资银行部）、会计审计机构、评估机构和律师机构等</p><blockquote><p>资本运营手段</p></blockquote><p>股市、信托计划、股权私募基金、公募股票基金</p><h4 id="买壳上市"><a href="#买壳上市" class="headerlink" title="买壳上市"></a>买壳上市</h4><p>对上市公司进行并购和重组</p><p>获利者：建议者、券商（财务顾问）、三师（审计、评估、律师）</p><p>成功率：1/64 可操作者 &lt; 5家 （数据来源：09年证监会白皮书）</p><p>成本支出：&gt; n千万，不管是否成功</p><p>业务基本流程：</p><ol><li><p>挑选和确认壳企业</p><p> 小（股本少）、净（零负债、潜亏及复杂连带担保责任）、空（没有主营业务）</p><p> 净壳主要手段：债务重组</p></li><li><p>买壳前期准备</p><p> <code>政府、上市公司控股方、债权方、证监会</code>、国资委、银监会、商务部、外管局、民政局等</p></li><li><p>市值管理</p><p> 买壳前必须通过专业的市值管理体系与壳的前10大流通股股东达成一致行动人意向，至少拥有这些流通股股东一半股票的随时“拆借”的权利。</p><p> 保密原则，防止泄密，涨停增加成本</p><p> 及时停牌，防患于未来</p></li></ol><p><strong>任何买壳的企业都要向证监会承诺未来三年连续增长的业绩。</strong></p><h4 id="民营企业常见犯罪"><a href="#民营企业常见犯罪" class="headerlink" title="民营企业常见犯罪"></a>民营企业常见犯罪</h4><ol><li>抽逃资本金罪</li></ol><p>不按照公司法或者公司章程的规定，抽逃出资，给公司、股东、债权人造成的直接经济损失累计数额在十万元至五十万元以上的或虽未达到上述数额标准，但具有下列情形之一的：1）致使公司资不抵债或者无法正常经营的；2）公司发起人、股东合谋虚假出资、抽逃出资的；3）因虚假出资、抽逃出资，受过行政处罚二次以上，又虚假出资、抽逃出资的；　4）利用虚假出资、抽逃出资所得资金进行违法活动的。</p><p>目前大部分民营企业家随意将自己公司（法人）帐面上的资金挪用在其他地方（无正常手续或发票），或入股、或投资、或消费均属于此种行为。</p><p>处5年以下有期徒刑或者拘役，并处罚金。</p><ol start="2"><li><p>欺诈发行股票、债券罪</p></li><li><p>隐匿、销毁会计资料罪</p></li></ol><p>隐匿或者故意销毁依法应当保存的会计凭证、会计帐簿、财务会计报告，涉嫌下列情形之一的：1）隐匿、销毁的会计资料的；2）为逃避依法查处而隐匿、销毁或者拒不交出会计资料的。</p><p>民营企业某些合伙股东，部分股东通过控制财务人员直接隐匿公司财务。</p><p>处3年以下有期徒刑或者拘役，并处罚金。</p><ol start="4"><li><p>高利转贷罪</p></li><li><p>非法吸收公众存款罪</p></li><li><p>诈骗、合同诈骗、行贿、受贿等均属重罪，可判处无期乃至死刑</p></li></ol><p><strong>需要专业知识（法律、财务、税务）</strong></p><blockquote><p>视频分享</p></blockquote><p><a href="http://video.sina.com.cn/v/b/36235322-1368810002.html">金融基础之货币市场与资本市场 上</a><br><a href="http://video.sina.com.cn/v/b/36226261-1368810002.html">金融基础之货币市场与资本市场 下</a><br><a href="http://video.sina.com.cn/v/b/36227162-1368810002.html">资本市场财务整合</a><br><a href="http://video.sina.com.cn/v/b/38469654-1368810002.html">文化断层时代</a></p><blockquote><p>金融的本质</p></blockquote><p>远期利益、杠杆、对冲</p><h4 id="完整的风险规避意识"><a href="#完整的风险规避意识" class="headerlink" title="完整的风险规避意识"></a>完整的风险规避意识</h4><ol><li>商业风险意识（钱进浅出）</li><li>政策风险（实施细则）</li><li>法律风险（文字游戏）</li></ol><h4 id="商业思维逻辑"><a href="#商业思维逻辑" class="headerlink" title="商业思维逻辑"></a>商业思维逻辑</h4><ol><li>卖的是什么</li><li>客户究竟是谁</li><li>客户为什么选择你</li><li>收入来源途径</li><li>可控资源如何匹配你的商业计划</li></ol><blockquote><p>人生的金字塔</p></blockquote><ol><li>人生是无数个三角形组成的金字塔</li><li>每个人的一生都是从塔底向塔顶攀登的过程</li><li>每个三角形的上层无偿占有下层资源</li><li>在三角形的位置越高，同面违约成本越低</li><li>要用自己强势的三角形解决弱势三角形的问题</li></ol><blockquote><p>金融家和政客</p></blockquote><p>别人几乎无法从他们的外在表现中看到他们真实的目的，资本运营高级玩家都是搞定第10步，才开始走第1步的！当我们看到他们试图买A企业股权时，他们早就已经和卖家签订了出售A公司股权的协议！当我们看到他们办傻事的时候，在看不到的背后，成百倍的利益早就收入囊中。</p><blockquote><p>商业领域永远没有所谓“产能过剩”</p></blockquote><p>目标客户的需求已经发生转变了，而你并没有察觉，还按照以前对客户需求的认知进行生产，不是那个女孩不需要男朋友，只是你的特点不符合她的需求。</p><blockquote><p>任何商业、资本领域的最高端成功行为都不可能和我们几千年的生活习惯背离，因此，也没有任何金融、商业的模式、行为是不能用日常生活的习惯进行思维和解释的！</p></blockquote><ol><li>资本市场和小商品批发市场一样，都只有：买方、卖方、中间方、监管方、担保方五类；其中永远赚钱的只有一类：中间方</li><li>企业选择券商（证券公司投行部）和患者选择医院的思维本质上没有任何差别</li><li>世界上商业、资本以及生活、军事等各领域过去、现在和未来的发展思路都是一样的：跨界融合</li><li>垄断肯定产生暴力</li><li>不用付款的商业模式和无条件回购的商业条款对各领域客户在任何时代都具有强大的吸引力</li><li>先赚有钱人的钱</li></ol><blockquote><p>商业战略思维</p></blockquote><p>土地属性；法律权属；商业模式；销售策略；后期资本对接模式；风险控制；</p><blockquote><p>对待任何资本市场的机会，追求的方向永远是：风险最小化！永远不会把利益是否能够最大化放在衡量项目运作与否的评估中。</p></blockquote><p>“他们都说这个能赚钱（他们是谁？他们说了你就会相信？你赔了他们负担你的损失吗？…）”<br>“放心吧！我保证这个项目赚钱（你以为你是谁？你凭啥保证？你的保证和我有啥关系？）”<br>“他们说国家支持这样做（他们是国家吗？你见到相关法律法规了吗？）”<br>“以前别人这样做就赚钱了（那是以前呀，现在环境一样吗？新的政策和法律还能保证赚钱吗？）”<br>“某某专家这样说的（专家的话就是对的？专家从来不骗人？）”<br>“某领导说了上市对我有好处（领导懂金融吗？领导不会为了利益骗人吗？你能保证领导不会被骗吗？）”<br>“我都做了一年了，以我的经验肯定没问题（你没问题不代表项目就没问题？你运作一年怎么样我们并不知道？）”</p><p>尽职调查，做出相对客观的判断 -&gt; 理性研究商业风险、政策风险、法律风险，得到最终的风险评估报告 -&gt; 设计详尽的风险规避模式 -&gt; 评估项目可行性</p><h4 id="资本运营的演化"><a href="#资本运营的演化" class="headerlink" title="资本运营的演化"></a>资本运营的演化</h4><p>“货币市场”：借钱 —- 还钱</p><p>如：银行、融资租赁、典当、债券、债权信托等</p><p>“商业企业股权化”</p><p>借款变成对这家商业主体的股权，从而使自己拥有这个商业主体这部分股份收益的永久分享权，增加权益限制（对赌协议）</p><p>“资本市场”</p><p>股权模式方向：财团法人、社团法人</p><p>股权责任架构：有限责任、无限责任</p><p>交易模式：现在、未来、私下、公开、国家、地方等</p><p>资本市场横向划分：</p><p>天使投资、创业投资、风险投资、PE股权私募投资、产权交易、柜台代办转让、股票公开挂牌交易、商品期货交易、金融期货交易、大宗商品交易、电子商务交易、份额交易、市值管理、专项并购重组、专项产业基金、柜台理财、政府金融、BOT、BT等</p><p>资本市场横向划分：</p><p>一级市场、一级半市场、二级市场、融资融券、认沽权证、认购权证、套期保值、杠杆收购、杠杆转移、保险、再保险、担保、再担保、QDII、QFII等</p><h4 id="股份治理结构"><a href="#股份治理结构" class="headerlink" title="股份治理结构"></a>股份治理结构</h4><p>法人是什么？自然人是什么？商业法人特点有哪些？非商业法人特点有哪些？有限责任的商业法人包括哪些类型？特点是什么？无限责任的商业法人包括哪些类型？特点是什么？法人代表or法定代表人的特点？不同类型法人主体的发起和设立？股东是什么？有限责任公司的股东责、权、利？股份有限公司的股东责、权、利？公司章程和承诺？股东会的构架和运行？董事会的构架和运行？董事会的责、权、利？董事长、董事和独立董事的责任和关系？监事会的构架和运行？监事会的责、权、利？同业竞争和关联关系？高管团队的构架和运行？高管团队的责权利？期权和期股作用和应用？员工持股会的作用和应用？代持？股权和债权的转换关系？招股说明书的内容和解释？有限责任公司大股东和小股东关系？股份有限公司大股东和投资者关系？什么是转让老股？什么是增资扩股？什么是定向增发？货币定向增发和资产定向增发的异、同？正向收购本质？反向收购本质？一致行动人的责、权、利？…</p><h4 id="投资方向选择"><a href="#投资方向选择" class="headerlink" title="投资方向选择"></a>投资方向选择</h4><ol><li>实物投资：金；银；邮票；纪念币；成套具有纪念价值的储值卡；玉石；大克拉钻石；红木；年份酒；艺术品；奢侈品；房产；土地；古董等。</li><li>商业投资：股权直接投资（分红获利）；股权间接投资（买卖获利）；债权直接投资（直接借贷）；债权间接投资（委托贷款）；商业外包投资；商业收益权投资；商业承包权投资；商业资源投资；融资租赁（直接/变相）投资；并购重组直接/间接投资；百联安模式；电子商务交易系统；大宗商品现货（远期）交易市场；一般商业交易市场；联名信用卡投资；储值卡投资等。</li><li>项目投资：工程项目投资；文化项目投资（电视剧、电影、话剧、演出等）；产业项目投资；政府项目投资等。</li><li>金融（货币市场）投资：银行存款；购买债券；购买稳定收益理财产品；入股基金；购买信托计划等。</li><li>金融（资本市场）投资：公开挂牌上市公司的股票一级、一级半、二级市场投资；上市公司增发、配股投资；商品期货投资；金融期货投资；股权私募基金；份额交易市场投资；创业、天使投资等。</li><li>无形投资：知识产权（含专利技术、商业秘密、商标、品牌等）；人才（艺术家、创业者等）等。</li></ol><h4 id="高效率商业辅助"><a href="#高效率商业辅助" class="headerlink" title="高效率商业辅助"></a>高效率商业辅助</h4><p>OA（办公效率）、CRM（客户效率）、ERP（资源效率）、KPI（员工效率）、SEM+SEO（市场效率）、自媒体机器人（客户吸引力）、网站机器人（客户舒适度）以及财务AI、融资AI、投资AI（人工智能）等</p><blockquote><p>公司在模式、组织、市场、销售、管理、风控、财税等环节中使用的模仿人、替代人、超越人的先进技术（设备）越多，公司就越具备高效益、高融合度、高信任度、强竞争力、低成本等特点。技术覆盖公司运营的环节（18个）越多，吸引客户的核心技术越突出，在市场中的竞争优势就越强大！</p></blockquote><blockquote><p>未来所有产业的入门基础设备和技术条件（大数据采集、分析，客户服务、跟踪等）</p></blockquote><blockquote><p>人的思维、记忆、效率、服从、成本等真的是完全没法和机器人比</p></blockquote><blockquote><p>未来社会最大的机会和危机都将从同样的组合中产生：互联网（渠道）+人工智能（思维）+大数据（信息）</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>杂谈</title>
      <link href="2020/10/19/Other/%E6%9D%82%E8%B0%88/"/>
      <url>2020/10/19/Other/%E6%9D%82%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<ol><li><p>口中有德，目中有人，心中有爱，行中有善。</p></li><li><p>度远近，调余缺，辨贵贱。</p></li><li><p>水则资车，旱则资舟。【货殖列传】</p></li><li><p>务完物，无息币。【货殖列传】</p></li><li><p>天下熙熙，皆为利来；天下攘攘，皆为利往。【货殖列传】</p></li><li><p>人弃我取，人取我与。 【货殖列传】</p></li><li><p>贵上极则反贱，贱下极则反贵。贵处如粪土，贱出如珠玉。【货殖列传】</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 杂谈 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JS模块化</title>
      <link href="2020/09/29/Javascript/JS%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
      <url>2020/09/29/Javascript/JS%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="弊端"><a href="#弊端" class="headerlink" title="弊端"></a>弊端</h4><p>模块化最大的弊端：HTTP请求数增加，上线时必须合并文件</p><h4 id="什么是模块化"><a href="#什么是模块化" class="headerlink" title="什么是模块化"></a>什么是模块化</h4><p>模块化是指在解决某一个复杂问题或者一系列的杂糅问题时，依照一种分类的思维把问题进行系统性的分解以之处理。模块化是一种处理复杂系统分解为代码结构更合理，可维护性更高的可管理的模块的方式。</p><p>可以想象一个巨大的系统代码，被整合优化分割成逻辑性很强的模块时，对于软件是一种何等意义的存在。对于软件行业来说：解耦软件系统的复杂性，使得不管多么大的系统，也可以将管理，开发，维护变得“有理可循”。</p><p>模块化一些专业的定义为：模块化是软件系统的属性，这个系统被分解为一组高内聚，低耦合的模块。那么在理想状态下我们只需要完成自己部分的核心业务逻辑代码，其他方面的依赖可以通过直接加载被人已经写好模块进行使用即可。</p><p>模块化系统：</p><ol><li>定义封装的模块</li><li>定义新模块对其他模块的依赖</li><li>支持对其他模块的引入</li></ol><p>规范：</p><ol><li>CommonJS</li><li>AMD（Asynchronous Module Definition）</li><li>CMD（Common Module Definition）</li></ol><h4 id="模块化打包"><a href="#模块化打包" class="headerlink" title="模块化打包"></a>模块化打包</h4><p><a href="https://github.com/Mcbai/Blog/issues/2">前端构建工具吐槽与parcel极简入门</a></p><blockquote><p><a href="http://browserify.org/">Browserify</a></p></blockquote><p>使用类似于 node 的 require() 的方式来组织浏览器端的 Javascript 代码，通过预编译让前端 Javascript 可以直接使用 Node NPM 安装的一些库。</p><blockquote><p><a href="https://jspm.org/">jspm</a></p></blockquote><p>工作在SystemJs(模块加载器)通用模块之上，与NPM和GitHub协同合作的浏览器包管理工具</p><blockquote><p>systemjs</p></blockquote><p>模块加载器，可以导入任何流行格式的模块(CommonJs、UMD、AMD、ES6)，它是工作在 ES6模块加载polyfill 之上，它能够很好的处理和检测所使用的格式。也能使用插件转换es6（用 Babel 或者 Traceur）或者转换TypeScript 和 CoffeeScript代码。</p><h4 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h4><p><a href="https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88)">规范</a></p><p>CMD 推崇依赖就近，AMD 推崇依赖前置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CMD  </span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="built_in">module</span></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">&#x27;./a&#x27;</span>)  </span><br><span class="line">    a.doSomething()  </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">&#x27;./b&#x27;</span>) <span class="comment">// 依赖就近书写  </span></span><br><span class="line">    b.doSomething()  </span><br><span class="line">    <span class="comment">// ...   </span></span><br><span class="line">&#125;)  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// AMD</span></span><br><span class="line">define([<span class="string">&#x27;./a&#x27;</span>, <span class="string">&#x27;./b&#x27;</span>], <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    a.doSomething()  </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    b.doSomething()  </span><br><span class="line">   <span class="comment">// ...  </span></span><br><span class="line">&#125;)   </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DESIGNER&#39;S GUIDE TO DPI</title>
      <link href="2020/09/29/%E5%89%8D%E7%AB%AF/DESIGNER&#39;S%20GUIDE%20TO%20DPI/"/>
      <url>2020/09/29/%E5%89%8D%E7%AB%AF/DESIGNER&#39;S%20GUIDE%20TO%20DPI/</url>
      
        <content type="html"><![CDATA[<h4 id="DPI、PPI"><a href="#DPI、PPI" class="headerlink" title="DPI、PPI"></a>DPI、PPI</h4><p>DPI(Dots Per Inch)是测量空间点密度的单位，最初应用于打印技术中，它表示每英寸能打印上的墨滴数量。</p><p>计算机屏幕一般采用PPI（Pixels Per Inch）来表示一英寸屏幕上显示的像素点的数量</p><p>安装Windows操作系统的电脑屏幕PPI的初始值是96，Mac的初始值是72。一般来说，非retina桌面（包括Mac）的PPI的取值区间在72-120之间，因为这个取值区间能够确保你的作品在任何地方都能保持大致相同的比例。</p><h4 id="4K"><a href="#4K" class="headerlink" title="4K"></a>4K</h4><p><img src="http://p1.qhimg.com/t01e33ca7765ae9206c.png" alt="4k"></p><h4 id="显示器赫兹"><a href="#显示器赫兹" class="headerlink" title="显示器赫兹"></a>显示器赫兹</h4><p>显示器赫兹(刷新频率)是显示器每秒展示固定图像或者帧的速度单位，(Hz)决定了动画的流畅和精细程度，大多数的屏幕都是60Hz。</p><p><img src="http://p5.qhimg.com/t0193d410318c839943.png" alt="Hz"></p><h4 id="视网膜显示屏"><a href="#视网膜显示屏" class="headerlink" title="视网膜显示屏"></a>视网膜显示屏</h4><p>在完全相同的物理大小上展示比原来高和宽多一倍的像素点。</p><p>iPhone 3G/S是3.5英寸的斜角，分辨率为480 * 320px，PPI为163。<br>iPhone 4/S是3.5英寸的斜角，分辨率为960 * 640px，PPI为326。</p><p><img src="http://p3.qhimg.com/t010e06da3608c18896.png" alt="视网膜显示屏"></p><p>1个标准的像素＝4个Retina像素，像素的四倍。</p><p><img src="http://p1.qhimg.com/t0194e590e2849b5b98.png" alt="清晰度"></p><h4 id="像素比"><a href="#像素比" class="headerlink" title="像素比"></a>像素比</h4><p><img src="http://p6.qhimg.com/t015c3321519d59ab50.png" alt="像素比"></p><h4 id="DP、PT、SP"><a href="#DP、PT、SP" class="headerlink" title="DP、PT、SP"></a>DP、PT、SP</h4><p>DP(Dip)表示独立于设备的像素点，用在Android上。<br>PT表示点，用在Apple上。<br>SP表示与比例无关的像素，通常用来定义字体大小，SP受用户Android设备字体设置的影响。</p><pre><code>始终使用分辨率或者非比例的值作为规范</code></pre><p><a href="https://www.kancloud.cn/chandler/web_technology/168321">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>图数据库应用</title>
      <link href="2020/09/29/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8/"/>
      <url>2020/09/29/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="Native图数据库"><a href="#Native图数据库" class="headerlink" title="Native图数据库"></a>Native图数据库</h4><p>指一开始就是为了解决图类数据结构而设计的数据库</p><ol><li>图数据库的存储</li><li>图数据库的查询和处理</li></ol><p>Neo4j 数据库文件分类：</p><ul><li>标签</li><li>节点</li><li>属性</li><li>关系</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MATCH (node1:沪深股市 &#123;name: &quot;sha_600610&quot;&#125;)-[relation]-(node2:人物_公司股东)</span><br><span class="line">RETURN node1, node2, relation</span><br><span class="line"></span><br><span class="line">1. 查找一个具有标签“沪深股市”，且有一键值对 &#123;name: &quot;sha_600610&quot;&#125; 的节点</span><br><span class="line">2. 查找节点的所有双向关系</span><br><span class="line">3. 在这些关系中，要求另外一个节点具有“人物_公司股东”标签</span><br><span class="line">4. 返回节点，及满足要求的关系和相关节点</span><br></pre></td></tr></table></figure><h4 id="Property-Graph-Model"><a href="#Property-Graph-Model" class="headerlink" title="Property Graph Model"></a>Property Graph Model</h4><p>核心要素：</p><ul><li><p>节点</p><p>  ··· 每个节点都是图中的一个实体<br>  ··· 每个节点可以容纳足够多的属性，以键值对形式<br>  ··· 每个节点可以标注一个标签，相当于特定知识领域的分类标准</p></li><li><p>关系</p><p>  ··· 每条关系可以是有向的、无向的、命名的<br>  ··· 每条关系必须有两个对应的节点</p></li></ul><h4 id="Cypher"><a href="#Cypher" class="headerlink" title="Cypher"></a>Cypher</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### 1. 全表扫描</span></span><br><span class="line">Neo4j：</span><br><span class="line">Match(p:Product)</span><br><span class="line">RETURN p</span><br><span class="line"></span><br><span class="line">mysql: <span class="keyword">SELECT</span> p.* <span class="keyword">FROM</span> products <span class="keyword">as</span> p</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 2. 查询价格最贵的10个商品，只返回商品名字和单价</span></span><br><span class="line">Neo4j：</span><br><span class="line"><span class="keyword">Match</span>(p:Product)</span><br><span class="line"><span class="keyword">RETURN</span> p.name, p.price</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> p.price <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">mysql: <span class="keyword">SELECT</span> p.ProductName, p.UnitPrice</span><br><span class="line"><span class="keyword">FROM</span> products <span class="keyword">as</span> p</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> p.UnitPrice <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 3. 按照商品名字筛选</span></span><br><span class="line"><span class="keyword">MATCH</span> (p:Product)</span><br><span class="line"><span class="keyword">WHERE</span> p.productName = <span class="string">&quot;Chocolade&quot;</span></span><br><span class="line"><span class="keyword">RETURN</span> p.productName, p.unitPrice</span><br><span class="line"></span><br><span class="line"><span class="keyword">MATCH</span> (p:Product &#123;productName:<span class="string">&quot;Chocolade&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">RETURN</span> p.productName, p.unitPrice</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> p.ProductName, p.UnitPrice</span><br><span class="line"><span class="keyword">FROM</span> products <span class="keyword">AS</span> p</span><br><span class="line"><span class="keyword">WHERE</span> p.ProductName = <span class="string">&#x27;Chocolade&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="Ecosystem"><a href="#Ecosystem" class="headerlink" title="Ecosystem"></a>Ecosystem</h4><p>neo4j browser<br>neo4j bloom</p><h4 id="图数据库优势"><a href="#图数据库优势" class="headerlink" title="图数据库优势"></a>图数据库优势</h4><p>更好、更快速的查询和分析<br>更简化、更自然的数据建模<br>由点及面地挖掘知识体系<br>面向对象的思维<br>更强大的问题解决能力<br>迅速的实时扩展<br>并发查询和实时数据更新<br>深度关联分析<br>动态模式更改<br>简单的多维度数据表示<br>高级聚合及分析<br>增强的机器学习和人工智能<br>横向扩展和纵向扩展以管理大型图</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>元数据建设的那些坑</title>
      <link href="2020/09/29/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E5%85%83%E6%95%B0%E6%8D%AE%E5%BB%BA%E8%AE%BE%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/"/>
      <url>2020/09/29/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E5%85%83%E6%95%B0%E6%8D%AE%E5%BB%BA%E8%AE%BE%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h4 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h4><p>竞品：亚信、普元信息、网达、星环</p><p>元数据标准化程度</p><ol><li>基本功能</li></ol><ul><li><p>数据地图</p><p>  数据资产统计：通过数据地图了解数据的使用情况、分布等<br>  元数据中心：整个元数据的输出就是数据地图，用户可以通过元数据中心查看表的元数据信息（技术元数据、业务元数据）、任务信息、血缘关系、使用信息等</p></li><li><p>元模型</p></li><li><p>管理中心</p></li><li><p>数据管理</p><p>  元模型、数据源管理，用于元数据手动、自动采集</p></li><li><p>元数据质量</p><p>  数据治理：库表数据治理，分多维统计元数据完成情况，并实时通知</p></li></ul><ol start="2"><li>产品架构</li></ol><ul><li><p>存储、计算</p><p>  元数据 MySQL 存储、图数据库，查询使用 clickhouse， 缓存分布式 redis</p></li><li><p>服务层</p><p>  基础平台服务能力：元数据管理、元数据地图、管理中心、用户权限等</p></li><li><p>通知服务</p><p>  站内信、短信、邮箱</p></li><li><p>元数据采集</p><p>  kafka、hook插件、flume、sftp</p></li><li><p>安全服务</p><p>  LDAP认证、kerberos</p></li></ul><h4 id="数据地图"><a href="#数据地图" class="headerlink" title="数据地图"></a>数据地图</h4><p>核心功能：元数据信息展示、血缘关系</p><blockquote><p>元数据信息展示</p></blockquote><ul><li><p>采集内容确认</p><p>  ··· 应用信息：应用名称、类型、状态、应用负责人、地址等<br>  ··· 库信息：ip 地址、实例名称、JDBC地址、库名称、归属部门、服务名称、用途、字符集、版本等<br>  ··· 表信息：owner或库名、字段名、字段类型、字段注释、大小、行数、创建时间、分区、索引等</p></li><li><p>元模型确认</p></li></ul><p>元模型决定元数据信息包括哪些内容，可以按照数据库的类型（hive、Hbase、mysql、oracle、ck、ES等）区分基础元模型</p><p>分类：技术信息、业务信息、权限信息</p><blockquote><p>血缘关系</p></blockquote><p>存在问题：覆盖率，字段级关系</p><p>建议：<br>    ··· 实现不了的，罗列规范，避免触碰<br>    ··· 能实现的尽量实现<br>    ··· 长期、大量测试，覆盖主要场景<br>    ··· 按照行业 TPC-DS 评测标准<br>    ··· 超出的按照新需求迭代开发</p><p>[TPC-DS] 提供 99 个 SQL查询，分析数据量大，测试数据与实际商业数据高度相似，同时具有各种业务模型（分析报告、数据挖掘等）</p><blockquote><p>血缘关系从哪开始解析，存哪里？</p></blockquote><p>血缘本质是解析SQL输出表和表之间的关系，SQL基本来自于ETL任务。通常做法为ETL实时传输数据给元数据，元数据进行解析，图数据库进行存储。</p><p><a href="https://www.zhihu.com/question/19916683">图数据库</a>：Neo4j、TigerGraph、Amazon Neptune、janusGraph、ArangoDB</p><blockquote><p>ETL 对接、如何确保100%覆盖？</p></blockquote><p>ETL逻辑：保存 -&gt; 提交 -&gt; 次日运行<br>方案一：任务提交触发通过kafka将SQL以及任务信息传给元数据</p><blockquote><p>表任务信息如何展示？</p></blockquote><p>元数据以表作为维度查看其他信息，ETL以任务作为纬度查看表信息，一个表可能对应多个任务，实际我们只关心数据源自哪个任务</p><p>解决方案：ETL任务、目标表、源表对应关系，即表和任务对应关系接口</p><blockquote><p>表使用信息怎么获取？</p></blockquote><p>解决方案：日志，sftp 定时从 hive 获取 metastore 日志解析，只保证准确性，不保障时效性（T+1）</p><blockquote><p>表更新如何捕获?</p></blockquote><p>解决方案：全量同步做merge，将变更内容做记录</p><p>Hive 元数据变更的捕获：hive hook + kafka</p>]]></content>
      
      
      <categories>
          
          <category> 数据中台 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 元数据 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何打造一个品牌</title>
      <link href="2020/09/28/Other/%E5%A6%82%E4%BD%95%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E5%93%81%E7%89%8C/"/>
      <url>2020/09/28/Other/%E5%A6%82%E4%BD%95%E6%89%93%E9%80%A0%E4%B8%80%E4%B8%AA%E5%93%81%E7%89%8C/</url>
      
        <content type="html"><![CDATA[<p>品牌的打造需要经历三个阶段：知名度、认知度和忠诚度</p><h4 id="知名度"><a href="#知名度" class="headerlink" title="知名度"></a>知名度</h4><p>知名度：用户听说过</p><p>客户性格<br>购买决策路径</p><h4 id="认知度"><a href="#认知度" class="headerlink" title="认知度"></a>认知度</h4><p>认知度：用户对产品的了解</p><p>品牌的诞生，绝不是一次性曝光，而是持续不断的刷屏，进入用户心智，才有机会作出品牌</p><p>ROI：投资回报率</p><h4 id="忠诚度"><a href="#忠诚度" class="headerlink" title="忠诚度"></a>忠诚度</h4><p>用户的忠诚度，取决于怎么提供更好的产品和服务满足用户需求</p><p>忠诚度是相互的</p><p><strong>在用户群中持续曝光，增强自身产品质量，才能形成品牌</strong></p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 产品经理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>datax</title>
      <link href="2020/09/24/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/datax/"/>
      <url>2020/09/24/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/datax/</url>
      
        <content type="html"><![CDATA[<h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><ol><li>异构数据源<code>离线</code>同步工具</li><li>支持数据库（Mysql、Oracle、HDFS、Hive、ODPS、HBase、FTP等）</li></ol><ul><li>框架设计思路</li></ul><p>Framework + Plugin，将数据源读取和写入抽象为 Reader\Writer 插件，纳入到整个同步框架</p><img src="/images/16177192-9fcc7e3c470a25a4.webp"><blockquote><p>Reader: 数据采集模块，将采集的数据源的数据发送到 Framework<br>Writer: 数据写入模块，不断从 Framework 取数据，并将数据写入到目的端<br>Framework: 连接 Reader\Writer 作为两者的数据传输通道，并处理缓冲、流控、并发及数据转换等</p></blockquote><ul><li>支持数据</li></ul><img src="/images/16177192-70b69db4dec28306.webp"/><p><a href="https://links.jianshu.com/go?to=https://github.com/alibaba/DataX">DataX数据源参考指南</a></p><h4 id="安装、测试"><a href="#安装、测试" class="headerlink" title="安装、测试"></a>安装、测试</h4><ol><li><p><a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz">下载包</a></p></li><li><p>解压缩，运行 cmd &gt; python bin/datax.py ../job/job.json</p></li></ol><ul><li><p><a href="https://github.com/WeiYe-Jing/datax-web/tree/master/doc/datax-web/datax-python3">支持 pyhton3 运行</a></p><p>  bin 目录替换 datax.py、dxprof.py、perftrace.py</p></li><li><p>中文乱码问题</p><p>  cmd &gt; CHCP 65001</p></li></ul><h4 id="核心优势"><a href="#核心优势" class="headerlink" title="核心优势"></a>核心优势</h4><p><img src="/images/16177192-e6b945e06ab33d37.webp" alt="核心模块"></p><p>一. 可靠的数据质量监控<br>二. 丰富的数据转换功能<br>三. 精准的速度控制<br>四. 强劲的同步性能<br>五. 健壮的容错机制<br>六. 线程级别重试</p><h4 id="DataX-Web"><a href="#DataX-Web" class="headerlink" title="DataX Web"></a>DataX Web</h4><p><img src="https://camo.githubusercontent.com/e0d13e2b650d9ba790d4054650057a2b092ba5ec/68747470733a2f2f64617461782d7765622e6f73732d636e2d68616e677a686f752e616c6979756e63732e636f6d2f646f632f44617461582d5765622e706e67" alt="datax web 架构图"></p><blockquote><p>Linux 部署</p></blockquote><ul><li><p>解压安装包</p><p>  tar -zxvf datax-web-2.1.2.tar.gz</p></li><li><p>执行一键安装脚本</p><p>  ./bin/install.sh ./bin/install.sh –force（跳过确认过程）</p></li><li><p>数据库初始化</p><p>  系统安装 mysql 服务命令，数据库会自动完成初始化<br>  手动执行：<code>/bin/db/datax-web.sql</code></p><pre><code>       mysql -uroot -p123456 -D dataxweb &lt; datax_web.sql  执行       sed -i &quot;s/datetime(0)/timestamp/g&quot; datax_web.sql   替换</code></pre><p>  完成初始化后修改相关配置：vi ./modules/datax-admin/conf/bootstrap.properties</p><pre><code>  #Database  #DB_HOST=  #DB_PORT=  #DB_USERNAME=  #DB_PASSWORD=  #DB_DATABASE=</code></pre><p>  **mysql 5.5+ ** 不然会报错：timestamp 唯一、datetime default 不支持</p></li><li><p>配置</p><p>  /modules/datax-admin/bin/env.properties 配置邮件服务(可跳过)</p><pre><code>  MAIL_USERNAME=&quot;&quot;  MAIL_PASSWORD=&quot;&quot;</code></pre><p>  /modules/datax-execute/bin/env.properties 指定python-path路径</p><pre><code>  ### 执行datax的python脚本地址  PYTHON_PATH=  ### 保持和datax-admin服务的端口一致；默认是9527，如果没改datax-admin的端口，可以忽略  DATAX_ADMIN_PORT=</code></pre></li><li><p>启动服务</p><p>  ./bin/start-all.sh<br>  ./bin/stop-all.sh<br>  JPS 命令，查看DataXAdminApplication和DataXExecutorApplication进程，存在表示项目运行成功</p></li><li><p>运行</p><p>  ip:9527/index.html admin/123456</p></li></ul><h4 id="windows-部署"><a href="#windows-部署" class="headerlink" title="windows 部署"></a>windows 部署</h4><p>datax-executor 拷贝到 windows 目录</p><pre><code>cmd &gt; /usr/lib/jvm/java-1.8.0-openjdk/bin/java -Xms2g -Xmx2g -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8 -XX:HeapDumpPath=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../logs -Dlog.path=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../logs -Duser.dir=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../ -Dserver.port=9504 -Ddata.path=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../data -Dexecutor.port=9999 -Djson.path=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../json -Dpython.path=/home/morr/datax/bin/datax.py -Ddatax.admin.port=9527 -Dlogging.config=/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../conf/logback.xml -classpath /home/morr/datax-web-2.1.2/modules/datax-executor/bin/../lib/*:/home/morr/datax-web-2.1.2/modules/datax-executor/bin/../conf:. com.wugui.datax.executor.DataXExecutorApplication</code></pre><p><a href="https://github.com/WeiYe-Jing/datax-web/blob/master/doc/datax-web/datax-web-deploy.md">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> 数据中台 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> datax </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpack 配置优化</title>
      <link href="2020/09/20/Vue/webpack%20%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96/"/>
      <url>2020/09/20/Vue/webpack%20%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="关键配置项"><a href="#关键配置项" class="headerlink" title="关键配置项"></a>关键配置项</h4><ul><li>entry</li></ul><p>查找依赖的入口文件配置，入口文件可以多个</p><p><strong>单页面应用入口配置</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: <span class="string">&#x27;./src/vendor.js&#x27;</span>,          <span class="comment">// 第三方依赖库</span></span><br><span class="line">    polyfill: <span class="string">&#x27;./src/polyfill.js&#x27;</span>,      <span class="comment">// 特性填充库</span></span><br><span class="line">    index: <span class="string">&#x27;./src/index.js&#x27;</span>             <span class="comment">// 单页面应用入口文件</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>多页面应用入口配置</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理公共 entry</span></span><br><span class="line"><span class="keyword">const</span> commonEntry = [<span class="string">&#x27;./src/vendor.js&#x27;</span>, <span class="string">&#x27;./src/polyfill.js&#x27;</span>]</span><br><span class="line"><span class="comment">// 页面目录</span></span><br><span class="line"><span class="keyword">const</span> PAGE_DIR = <span class="string">&#x27;./src/pages/&#x27;</span></span><br><span class="line"><span class="keyword">const</span> entry = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历页面目录</span></span><br><span class="line"><span class="keyword">const</span> getPages = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> fs.readdirSync(PAGES_DIR).filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> filepath = path.join(PAGES_DIR, item, <span class="string">&#x27;index.js&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>(!fs.existsSync(filepath))&#123;</span><br><span class="line">      filepath = <span class="string">`<span class="subst">$&#123;filepath&#125;</span>x`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!fs.existsSync(filepath)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getPages(options).forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">  cosnt name = path.basename(file)</span><br><span class="line">  entry[name] = [...commonEntry, <span class="string">`<span class="subst">$&#123;PAGES_DIR&#125;</span>/<span class="subst">$&#123;file&#125;</span>/index`</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>入口 boundle 如何插入对应的 html?</li></ul><p>使用 HtmlWebpackPlugin 自动处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">cosnt plugins = []</span><br><span class="line"><span class="keyword">if</span>(mode = <span class="string">&#x27;single&#x27;</span>)&#123;</span><br><span class="line">  plugins.push(</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      minify: <span class="literal">false</span>,</span><br><span class="line">      filename: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">      template: <span class="string">&#x27;./src/index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(mode = <span class="string">&#x27;multi&#x27;</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> files = getPages(options)</span><br><span class="line">  files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">    cosnt name = path.basename(file)</span><br><span class="line">    file = <span class="string">`<span class="subst">$&#123;PAGES_DIR&#125;</span>/<span class="subst">$&#123;file&#125;</span>/index.html`</span></span><br><span class="line">    <span class="keyword">const</span> chunks = [<span class="string">`runtime~<span class="subst">$&#123;name&#125;</span>`</span>, name]</span><br><span class="line">    plugins.push(</span><br><span class="line">      <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        minify: <span class="literal">false</span>,</span><br><span class="line">        filename: <span class="string">`<span class="subst">$&#123;name&#125;</span>.html`</span>,</span><br><span class="line">        template: file,</span><br><span class="line">        chunks</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>output</li></ul><p>输出 bundle 相关信息</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// name是你配置的entry中key名称，或者优化后chunk的名称</span></span><br><span class="line">    <span class="comment">// hash是表示bundle文件名添加文件内容hash值，以便于实现浏览器持久化缓存支持</span></span><br><span class="line">    filename: <span class="string">&#x27;[name].[hash].js&#x27;</span>,</span><br><span class="line">    <span class="comment">// 在script标签上添加crossOrigin,以便于支持跨域脚本的错误堆栈捕获</span></span><br><span class="line">    crossOriginLoading: <span class="string">&#x27;anonymous&#x27;</span>,</span><br><span class="line">    <span class="comment">//静态资源路径，指的是输出到html中的资源路径前缀</span></span><br><span class="line">    publicPath: <span class="string">&#x27;./fudao/pc/&#x27;</span>,</span><br><span class="line">    <span class="comment">//文件输出路径</span></span><br><span class="line">    path: <span class="string">&#x27;./dist&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>resolve</li></ul><p>该配置主要用于解析模块依赖的自定义项：<br>modules: 用于加速绝对路径查找效率<br>alias: 用户自定义模块查找路径</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">resolve: &#123;</span><br><span class="line">  modules: [</span><br><span class="line">    path.resolve(__dirname, <span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">    path.resolve(__dirname, <span class="string">&#x27;node_modules&#x27;</span>)</span><br><span class="line">  ],</span><br><span class="line">  alias: &#123;</span><br><span class="line">    components: path.resolve(__dirname, <span class="string">&#x27;/src/components&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>扩展：使用了绝对路径，vscode 智能代码导航失效。根目录配置 jsconfig.json</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;baseUrl&quot;</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;paths&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;src/*&quot;</span>: [<span class="string">&quot;./src/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;components/*&quot;</span>: [<span class="string">&quot;./src/components/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;assets/*&quot;</span>: [<span class="string">&quot;./src/assets/*&quot;</span>],</span><br><span class="line">      <span class="string">&quot;pages/*&quot;</span>: [<span class="string">&quot;./src/pages/*&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;include&quot;</span>: [<span class="string">&quot;./src/**/*&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>module</li></ul><p>配置 rules, 对于不同资源的处理器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  <span class="comment">// 当前库不依赖其他库，不需要解析可以加快编译速度</span></span><br><span class="line">  <span class="comment">// 通常可以将一些大型的库且已经编译好的库排除，减少webpack解析耗时</span></span><br><span class="line">  noParse: <span class="regexp">/node_modules\/(moment|chart\.js)/</span>,</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">      test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">      use: resolve(<span class="string">&#x27;babel-loader&#x27;</span>),</span><br><span class="line">      <span class="comment">// 需要被 load 处理的资源</span></span><br><span class="line">      include: [</span><br><span class="line">        path.resolve(projectDir, <span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">        path.resolve(projectDir, <span class="string">&#x27;node_modules/@tencent&#x27;</span>),  </span><br><span class="line">      ].filter(<span class="built_in">Boolean</span>),</span><br><span class="line">      <span class="comment">// 忽略压缩文件</span></span><br><span class="line">      exclude: [<span class="regexp">/(.|_)min\.js$/</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>optimization</li></ul><p>minimizer: 配置输出的文件压缩插件</p><pre><code>js: webpack 集成的 uglifyjs，Terser支持es6、支持多进程压缩css: optimize-css-assets-webpack-plugin（使用 cssnano 作为处理引擎，去除重复代码）</code></pre><p>splitChunks: webpack4.x 新功能，优化公共 chunk 提取策略</p><ul><li>plugin</li></ul><p>包含整个构建过程任何阶段：报告构建耗时、修改输出代码支持主域重试、添加构建进度报告、代码压缩<br>、资源替换等</p><pre><code>实现插件对输出结果处理时，应当在文件输出到磁盘前处理</code></pre><h4 id="开发体验优化"><a href="#开发体验优化" class="headerlink" title="开发体验优化"></a>开发体验优化</h4><ul><li>组件热刷新、CSS热刷新</li></ul><ol><li>dev 模式使用 <code>webpack.HotModuleReplacementPlugin</code> 插件</li><li>所有 entry 中插入 <code>require.resolve(&#39;../utils/webpackHotDevClient&#39;)</code> react官方 create-react-app</li><li>webpack-dev-server 模块启动参数添加 hot:true</li><li>需要热加载的js文件添加如下代码：</li></ol><pre><code>if(process.env.NODE_ENV === &#39;development&#39; &amp;&amp; module.hot)&#123;  module.hot.accept()&#125;</code></pre><ul><li>SSR热调试</li></ul><p>解决方案: webpack watch+nodemon，node 服务需要的 html/js 通过 webpack 插件动态输出，当 nodemon 检查到变化后将自动重启, html 文件中的静态资源全部替换成 dev 模式下的资源，保持 socket 连接自动更新页面</p><ul><li>style 调试</li></ul><p>style-loader 开始 sourceMap 后，sourceMap 是内联在 style 文件中，需要通过 link 导入，本质通过 javascript 生成 blob 后 link 标签解析。<code>（问题：FOUC 页面加载后闪烁）</code></p><p>解决方法：singleton: true</p><h4 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h4><ul><li>node_modules 缓存</li></ul><p>JB系统缓存（@tencent/im-build模块自动缓存）<br>OCI编译系统</p><ul><li>构建中间结果缓存</li></ul><p>webpack 缓存的内容：loader处理结果、plugin处理结果、输出文件结果</p><ol><li>babel-loader 缓存，通过 cacheDirectory 开启缓存</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">use: [&#123;</span><br><span class="line">  loader: resolve(<span class="string">&#x27;babel-loader&#x27;</span>),</span><br><span class="line">  options: &#123;</span><br><span class="line">    babelrc: <span class="literal">false</span>,</span><br><span class="line">    cacheDirectory: path.resolve(options.cache, <span class="string">&#x27;babel-loader&#x27;</span>),</span><br><span class="line">    presets:[[<span class="built_in">require</span>(<span class="string">&#x27;babel-preset-imt&#x27;</span>), &#123; isSSR &#125;]]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><ol start="2"><li>eslint-loader 缓存，通过 cache 指定缓存路径</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">test: <span class="regexp">/\.(js|mjs|jsx)/</span>,</span><br><span class="line">enforce: <span class="string">&#x27;pre&#x27;</span>,</span><br><span class="line">use: [&#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    cache: path.resolve(options.cache, <span class="string">&#x27;eslint-loader&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  loader: <span class="built_in">require</span>.resolve(<span class="string">&#x27;eslint-loader&#x27;</span>)</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><ol start="3"><li>css/scss 缓存</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  loader: resolve(<span class="string">&#x27;cache-loader&#x27;</span>),</span><br><span class="line">  options: &#123; <span class="attr">cacheDirectory</span>: path.join(cache, <span class="string">&#x27;cache-loader-css&#x27;</span>)&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  loader: resolve(<span class="string">&#x27;css-loader&#x27;</span>),</span><br><span class="line">  options: &#123;</span><br><span class="line">    importLoaders: <span class="number">2</span>,</span><br><span class="line">    sourceMap</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>输出代码压缩缓存，JS压缩引擎多进程处理</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 设置缓存目录</span></span><br><span class="line">  cache: path.resolve(cache, <span class="string">&#x27;terser-webpack-pugin&#x27;</span>),</span><br><span class="line">  <span class="comment">// 开启多进程</span></span><br><span class="line">  parallel: <span class="literal">true</span>,</span><br><span class="line">  sourceMap,</span><br><span class="line">  terserOptions: &#123;</span><br><span class="line">    compress: &#123;</span><br><span class="line">      drop_console: <span class="literal">true</span>     <span class="comment">// 删除所有 console 语句</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://user-gold-cdn.xitu.io/2018/11/12/16705be6123ef072?imageslim">编译流程</a></p><p><a href="https://juejin.im/post/6844903799736254477">参考文档</a></p><p><a href="https://user-gold-cdn.xitu.io/2018/11/12/16705be6123ef072?imageslim">webpack讲解</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Axios 详细参数说明</title>
      <link href="2020/09/18/Vue/Axios%20%E8%AF%A6%E7%BB%86%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E/"/>
      <url>2020/09/18/Vue/Axios%20%E8%AF%A6%E7%BB%86%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 post</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">  url: <span class="string">&#x27;url&#x27;</span>,</span><br><span class="line">  data: &#123; <span class="attr">key</span>:value &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送 get 默认方法</span></span><br><span class="line">axios(<span class="string">&#x27;url&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>支持请求别名</p></blockquote><p>axios.request(config)<br>axios.get(url[, config])<br>axios.delete(url[, config])<br>axios.head(url[, config])<br>axios.post(url[, data[, config]])<br>axios.put(url[, data[, config]])<br>axios.patch(url[, data[, config]])</p><blockquote><p>并发使用</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.all(iterable)</span><br><span class="line">axios.spread(callback)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> me = <span class="built_in">this</span></span><br><span class="line"><span class="built_in">this</span>.$axios.all([me.getAllTask(), me.getAllCity()])</span><br><span class="line"> .then(me.$axios.spread(<span class="function"><span class="keyword">function</span>(<span class="params">allTask, allCity</span>)</span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">&#x27;所有请求完成&#x27;</span>)</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">&#x27;请求1&#x27;</span>, allTask)</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">&#x27;请求2&#x27;</span>, allCity)</span><br><span class="line"> &#125;))</span><br></pre></td></tr></table></figure><h4 id="创建实例"><a href="#创建实例" class="headerlink" title="创建实例"></a>创建实例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">&#x27;https://some-domain.com/api/&#x27;</span>,</span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line">  headers: &#123;<span class="string">&#x27;X-Custom-Header&#x27;</span>: <span class="string">&#x27;foobar&#x27;</span>&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>请求配置参数</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 请求服务器地址</span></span><br><span class="line">  url: <span class="string">&#x27;/user/info&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 请求方法, 默认 get</span></span><br><span class="line">  method： <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// baseUrl 自动添加在 url 前面，除非 url 是一个绝对地址</span></span><br><span class="line">  baseURL: <span class="string">&#x27;https://www.xxx.com/api/&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// transformRequest 允许发送数据到服务器前，处理数据</span></span><br><span class="line">  <span class="comment">// 只能用在 put、post、patch 这几个方法</span></span><br><span class="line">  <span class="comment">// 后面数组中函数返回必须字符串、ArrayBuffer、Stream</span></span><br><span class="line">  transformRequest: [</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> data</span><br><span class="line">  &#125;],</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// transformRespone 传递给 then/catch 前，允许修改响应数据</span></span><br><span class="line">  transformRespone: [</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> data</span><br><span class="line">  &#125;],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// headers 自定义请求头</span></span><br><span class="line">  headers: &#123;<span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// params 参数</span></span><br><span class="line">  params: &#123;</span><br><span class="line">    id: <span class="number">12</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// paramsSerializer params 序列化函数</span></span><br><span class="line">  paramsSerializer: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Qs.stringify(params, &#123;<span class="attr">arrayFormat</span>: <span class="string">&#x27;brackets&#x27;</span>&#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 请求主体被发送的数据</span></span><br><span class="line">  <span class="comment">// 只适用于 put、post、patch</span></span><br><span class="line">  <span class="comment">// 没有设置 transformRequest 数据类型必须以下之一：</span></span><br><span class="line">  <span class="comment">// string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams</span></span><br><span class="line">  <span class="comment">// 浏览器专属: formdata, file, blob</span></span><br><span class="line">  <span class="comment">// node专属: stream</span></span><br><span class="line">  data: &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// timeout 请求超时</span></span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 表示跨域请求是否需要凭证</span></span><br><span class="line">  withCredentials: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义处理请求</span></span><br><span class="line">  adapter: <span class="function"><span class="keyword">function</span>(<span class="params">config</span>)</span>&#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 适用 HTTP 基础验证，提供凭据</span></span><br><span class="line">  <span class="comment">// 设置一个 Authorization 重写 headers 设置的自定义 Authorization 头</span></span><br><span class="line">  auth: &#123;</span><br><span class="line">    username: <span class="string">&#x27;janedoe&#x27;</span>,</span><br><span class="line">    password: <span class="string">&#x27;s00pers3cret&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 服务器响应数据类型，arraybuffer、blob、document、json、text、stream</span></span><br><span class="line">  responseType: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `xsrfCookieName` 是用作 xsrf token 的值的 cookie 的名称</span></span><br><span class="line">  xsrfCookieName: <span class="string">&#x27;XSRF-TOKEN&#x27;</span>, <span class="comment">// 默认</span></span><br><span class="line"> </span><br><span class="line">  <span class="comment">// `xsrfHeaderName` 是承载 xsrf token 的值的 HTTP 头的名称</span></span><br><span class="line">  xsrfHeaderName: <span class="string">&#x27;X-XSRF-TOKEN&#x27;</span>, <span class="comment">// 默认</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 允许上传处理进度事件</span></span><br><span class="line">  onUploadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 允许下载处理进度事件</span></span><br><span class="line">  onDownloadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 定义允许的响应内容的最大尺寸</span></span><br><span class="line">  maxContentLength: <span class="number">2000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// HTTP 响应状态码验证</span></span><br><span class="line">  <span class="comment">// 返回 `true` (`null`、`undefined`)，promise 将被 resolve; 否则 promise 将被 rejecte</span></span><br><span class="line">  validateStatus: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt; <span class="number">300</span>; <span class="comment">// 默认</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 定义在 node.js 中 follow 的最大重定向数目</span></span><br><span class="line">  maxRedirects: <span class="number">5</span> <span class="comment">// 默认</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// node.js 中用于定义在执行 http 和 https 时使用的自定义代理</span></span><br><span class="line">  <span class="comment">// keepAlive 默认没有启用</span></span><br><span class="line">  httpAgent: <span class="keyword">new</span> http.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">  httpsAgent: <span class="keyword">new</span> https.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// proxy 定义代理服务器的主机名称和端口</span></span><br><span class="line">  <span class="comment">// auth 表示 HTTP 基础验证应当用于连接代理，并提供凭据</span></span><br><span class="line">  <span class="comment">// 这将会设置一个 Proxy-Authorization 头，覆写 header 设置的自定义 Proxy-Authorization 头。</span></span><br><span class="line">  proxy: &#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    port: <span class="number">9000</span>,</span><br><span class="line">    auth: : &#123;</span><br><span class="line">      username: <span class="string">&#x27;mikeymike&#x27;</span>,</span><br><span class="line">      password: <span class="string">&#x27;rapunz3l&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// 取消请求的 cancel token</span></span><br><span class="line">  cancelToken: <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> (<span class="params">cancel</span>) </span>&#123;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>响应结构</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  data: &#123;&#125;,               <span class="comment">// 由服务器提供的响应</span></span><br><span class="line">  status: <span class="number">200</span>,            <span class="comment">// 来自服务器响应的 HTTP 状态码</span></span><br><span class="line">  statusText: <span class="string">&#x27;OK&#x27;</span>,       <span class="comment">// 来自服务器响应的 HTTP 状态信息</span></span><br><span class="line">  headers: &#123;&#125;,            <span class="comment">// 服务器响应的头</span></span><br><span class="line">  config: &#123;&#125;              <span class="comment">// 是为请求提供的配置信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="配置的默认值"><a href="#配置的默认值" class="headerlink" title="配置的默认值"></a>配置的默认值</h4><blockquote><p>全局默认值</p></blockquote><pre><code>axios.defaults.baseURL = &#39;https://api.example.com&#39;;axios.defaults.headers.common[&#39;Authorization&#39;] = AUTH_TOKEN;axios.defaults.headers.post[&#39;Content-Type&#39;] = &#39;application/x-www-form-urlencoded&#39;;</code></pre><blockquote><p>自定义实例默认值</p></blockquote><pre><code>// 创建实例时设置配置的默认值var instance = axios.create(&#123;  baseURL: &#39;https://api.example.com&#39;&#125;)// 在实例已创建后修改默认值instance.defaults.headers.common[&#39;Authorization&#39;] = AUTH_TOKEN</code></pre><blockquote><p>配置优先级</p></blockquote><ol><li>lib/defaults.js 库的默认值</li><li>实例 defaults 属性</li><li>请求的 config 参数</li></ol><h4 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h4><p>请求或响应被 then、catch 处理前拦截处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span>(<span class="params">config</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>var instance = axios.create();<br>instance.interceptors.request.use(function () { .. });</p><blockquote><p>移除拦截器</p></blockquote><pre><code>axios.interceptors.request.eject(instance)</code></pre><h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">&#x27;/user/12345&#x27;</span>, &#123;</span><br><span class="line">  validateStatus: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> status &lt; <span class="number">500</span>; <span class="comment">// 状态码在大于或等于`500`时才会 reject</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>validateStatus 配置选项定义一个自定义 HTTP 状态码的错误范围</p><p><a href="http://www.axios-js.com/zh-cn/docs/">官方文档</a></p><h4 id="params和data区别"><a href="#params和data区别" class="headerlink" title="params和data区别"></a>params和data区别</h4><blockquote><p>params 添加到url的请求字符串，一般用于 get 请求</p></blockquote><pre><code>传递的都是字符串，无法传递参数中包含json格式的数据</code></pre><blockquote><p>data 添加到请求体（body）中的，一般用于 post 请求</p></blockquote><pre><code>data 不可以用于 get 请求。</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Axios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>配置请求头content-type</title>
      <link href="2020/09/18/Vue/%E9%85%8D%E7%BD%AE%E8%AF%B7%E6%B1%82%E5%A4%B4content-type/"/>
      <url>2020/09/18/Vue/%E9%85%8D%E7%BD%AE%E8%AF%B7%E6%B1%82%E5%A4%B4content-type/</url>
      
        <content type="html"><![CDATA[<h4 id="常见数据格式"><a href="#常见数据格式" class="headerlink" title="常见数据格式"></a>常见数据格式</h4><ol><li><p>Content-Type:application/json<br>请求体中的数据以json字符串形式发送后端</p></li><li><p>Content-Type:application/x-www-form-urlencoded<br>数据以普通表单形式（键值对）发送后端</p></li><li><p>CONTENT-Type:multipart/form-data<br>将请求体的数据处理为一条消息，以标签为单元，分隔符分开。既可以上传键值对，也可以上传文件</p></li></ol><blockquote><p>application/x-www-form-urlencoded</p></blockquote><ul><li>URLSearchParams</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> param = <span class="keyword">new</span> URLSearchParams()</span><br><span class="line">param.append(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;zhangsan&#x27;</span>)</span><br><span class="line">param.append(<span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line"></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">  url: <span class="string">&#x27;api/lockServer/search&#x27;</span>,</span><br><span class="line">  data: param</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>URLSearchParams 不支持所有浏览器</p><ul><li>配置 axios 请求头指定</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">&#123; <span class="attr">headers</span>: &#123;</span><br><span class="line">  <span class="string">&#x27;Content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>将参数转换成 query 参数，利用 qs</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line"><span class="keyword">let</span> data = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;cc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;psd&quot;</span>: <span class="string">&quot;123456&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios(&#123;</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    method: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    url: <span class="string">&#x27;/api/lockServer/search&#x27;</span>,</span><br><span class="line">    data: Qs.stringify(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>Content-Type:multipart/form-data</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> params = <span class="keyword">new</span> FormData()</span><br><span class="line">params.append(<span class="string">&#x27;file&#x27;</span>, <span class="built_in">this</span>.file)</span><br><span class="line">params.append(<span class="string">&#x27;id&#x27;</span>, <span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;userID&#x27;</span>))</span><br><span class="line">params.append(<span class="string">&#x27;userName&#x27;</span>, <span class="built_in">this</span>.name)</span><br><span class="line">params.append(<span class="string">&#x27;sex&#x27;</span>, <span class="built_in">this</span>.sex)</span><br><span class="line">params.append(<span class="string">&#x27;mobile&#x27;</span>, <span class="built_in">this</span>.phone)</span><br><span class="line">params.append(<span class="string">&#x27;email&#x27;</span>, <span class="built_in">this</span>.email)</span><br><span class="line">params.append(<span class="string">&#x27;qq&#x27;</span>, <span class="built_in">this</span>.qq)</span><br><span class="line">params.append(<span class="string">&#x27;weChat&#x27;</span>, <span class="built_in">this</span>.WeChat)</span><br><span class="line"></span><br><span class="line">axios.post(URL, params, &#123; <span class="attr">headers</span>: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;multipart/form-data&#x27;</span>&#125;&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (res.data.code === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.$router.go(-<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>Content-Type:application/json</p></blockquote><p>axios 默认请求数据类型，只需将参数序列化 json 字符串</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> content-type </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软件架构C4模型</title>
      <link href="2020/09/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84C4%E6%A8%A1%E5%9E%8B/"/>
      <url>2020/09/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84C4%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="C4模型"><a href="#C4模型" class="headerlink" title="C4模型"></a>C4模型</h4><p>描述上下文（context）<br>容器（container）  ┐<br>组件（component）  │=&gt; 描述软件系统的静态结构<br>代码（code）       ┘</p><ol><li>系统上下文</li></ol><p>显示了你正在构建的软件系统，以及系统和用户及其他软件系统间的关系</p><ol start="2"><li>容器</li></ol><p>应用程序、数据存储、微服务等，技术决策</p><ol start="3"><li>组件</li></ol><p>组件映射到代码库中的真实抽象</p><ol start="4"><li>代码</li></ol><p>组件的实现方式，UML、接口、类</p><h4 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h4><p>C4模型没有预定义任何特定的符号<br>为符号提供图例，图例中包括颜色、形状、首字母缩略词、线条样式、边框、尺寸等</p><p><a href="https://c4model.com/">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件架构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES 使用</title>
      <link href="2020/09/14/%E6%95%B0%E6%8D%AE%E5%BA%93/ES%20%E4%BD%BF%E7%94%A8/"/>
      <url>2020/09/14/%E6%95%B0%E6%8D%AE%E5%BA%93/ES%20%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="创建索引库"><a href="#创建索引库" class="headerlink" title="创建索引库"></a>创建索引库</h4><p>索引库：逻辑概念，包括分词列表及文档列表，同一个索引库存储了相同类型的文档，相当于MySQL中的表，Mongodb中的集合</p><blockquote><p>postman、curl工具创建</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;srtting&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;index&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;number_of_shards&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;number_of_replicas&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>number_of_shards: 设置分片数量，集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同节点，提高ES处理能力和高可用性</p><p>number_of_replicas: 设置副本数量，提高ES高可靠性</p><p>Mappings:结构化关键字，内容为空，说明索引是一个非结构化索引</p><h4 id="创建映射"><a href="#创建映射" class="headerlink" title="创建映射"></a>创建映射</h4><p>索引中每个文档都包含一个或多个 field，创建映射就是向索引库中创建 field 的过程</p><table><thead><tr><th align="center">document 和 field</th><th align="center">关系数据库概念类比</th></tr></thead><tbody><tr><td align="center">文档 document</td><td align="center">row 记录</td></tr><tr><td align="center">字段 field</td><td align="center">columns 列</td></tr></tbody></table><p>6.0 之前 type 相当于关系数据库的表，9.0以后删除 type</p><style>table{ border-collapse: collapse;}table th,table td{ border: 1px solid #cdcdcd; padding: .3rem .8rem}</style><h4 id="ES-head-使用"><a href="#ES-head-使用" class="headerlink" title="ES-head 使用"></a>ES-head 使用</h4><blockquote><p><code>http://localhost:9200/索引/类型/id [post]</code></p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>，</span><br><span class="line">  <span class="string">&quot;age&quot;</span>: <span class="string">&quot;19&quot;</span>，</span><br><span class="line">  <span class="string">&quot;country&quot;</span>: <span class="string">&quot;China&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>http://localhost:9200/_search [get]</code><br><code>http://localhost:9200/xc_course/user/_search?q=name:computer [get]</code></p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span>: <span class="number">2</span>,                     <span class="comment">// 本次操作花费时间，单位毫秒</span></span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span>: <span class="literal">false</span>,            <span class="comment">// 请求是否超时</span></span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span>: &#123;                   <span class="comment">// 说明本次操作共搜索了那些分片</span></span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span>: &#123;                      <span class="comment">// 搜索命中的记录</span></span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: &#123;                   <span class="comment">// 符合条件的文档总数</span></span><br><span class="line">      <span class="attr">&quot;value&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span>: <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span>: <span class="number">0.4700036</span>,      <span class="comment">// 文档匹配最高分</span></span><br><span class="line">    <span class="attr">&quot;hits&quot;</span>: [                    <span class="comment">// 匹配度较高的前 N 个文档</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;_index&quot;</span>: <span class="string">&quot;xc_course&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;_type&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;_id&quot;</span>: <span class="string">&quot;FIxOfHQBxoWFrDoiNWdH&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;_score&quot;</span>: <span class="number">0.4700036</span>,   <span class="comment">// 当前匹配文档的得分</span></span><br><span class="line">          <span class="attr">&quot;_source&quot;</span>: &#123;           <span class="comment">// 匹配文档的原始内容</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;computer&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;country&quot;</span>: <span class="string">&quot;China&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;price&quot;</span>: <span class="string">&quot;1825&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;date&quot;</span>: <span class="string">&quot;2020-12-18&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        ｝</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>http://localhost:9200/_analyze [post]</code></p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;测试分词内容：elasticsearch&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>默认分词对中文是单字分词，因为是单词分词</p><ul><li><a href="https://github.com/medcl/elasticsearch-analysis-ik">IK 分词器</a></li></ul><p>ES集成方法：解压，文件拷贝到 ES 安装目录下的 plugins &gt; ik 目录下</p><p>IK两种分词模式：ik_max_word 和 ik_smart<br>ik_max_word：最细粒度<br>ik_smart：最粗粒度</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES 基础</title>
      <link href="2020/09/14/%E6%95%B0%E6%8D%AE%E5%BA%93/ES%20%E5%9F%BA%E7%A1%80/"/>
      <url>2020/09/14/%E6%95%B0%E6%8D%AE%E5%BA%93/ES%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><ol><li>基于Lucene 的高扩展的分布式搜索服务器，支持开箱即用</li><li>隐藏了 Lucene 的复杂性，对外提供 RestFul 接口操作索引、搜索</li></ol><ul><li>优点:</li><li>扩展性好，可部署上百台服务器集群，处理PB级数据</li><li>近实时的去索引数据，搜索数据</li><li>支持全文检索</li></ul><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>逻辑结构 ==&gt; 倒排索引表：</p><p>将要搜索的文档内容分词，所有不重复的词组成分词列表<br>将搜索的文档最终以Document方式存储<br>每个词和document都有关联</p><p>示例：<br><img src="https://upload-images.jianshu.io/upload_images/14591403-14a082af8b405526.png?imageMogr2/auto-orient/strip|imageView2/2/w/541/format/webp"/></p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ol><li><p>jdk 1.8 以上</p></li><li><p>支持 tar、zip、rpm等多种安装方式<br> windows下开发建议使用 ZIP 安装</p></li><li><p>支持 docker 安装</p><p> <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/install-elasticsearch.html">详细参见</a></p></li></ol><ul><li><a href="https://www.elastic.co/downloads/past-releases">下载ES</a></li><li><a href="https://blog.csdn.net/ltgsoldier1/article/details/97393154">安装配置</a></li></ul><pre><code>wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.9.1-linux-x86_64.tar.gztar -avxf elasticsearch-7.6.2-linux-x86_64.tar.gz -C /home/morr/cd elasticsearch-7.6.2 &gt; mkdir datavim config/elasticsearch.yml// 关闭防火墙systemctl stop firewalld.service// 禁止防火墙开机启动systemctl disable firewalld.service// 创建es用户useradd espasswd es// 把目录权限赋予给es用户chown -R es /home/morr/elasticsearch-7.6.2// 切换至es用户su esvi /usr/local/elasticsearch-6.2.4/config/elasticsearch.ymlsh /usr/local/elasticsearch-6.2.4/bin/elasticsearchvim /etc/security/limits.confvim /etc/security/limits.d/20-nproc.confvim /etc/sysctl.conf</code></pre><blockquote><p>跨域问题</p></blockquote><pre><code>es.yml配置文件http.cors.enabled: truehttp.cors.allow-origin: &quot;*&quot;</code></pre><blockquote><p>目录结构</p></blockquote><p>bin: 脚本目录，启动、停止等可执行脚本<br>config: 配置文件<br>data: 索引目录，存放索引文件<br>logs: 日志目录<br>modules: 模块目录，包含es的功能模块<br>plugins: 插件目录，es 支持插件机制</p><blockquote><p>配置文件</p></blockquote><p>zip、tar: config<br>RPM: /etc/elasticsearch</p><ul><li><p>elasticsearch.yml</p><p>  配置运行参数<br>  配置方式：层次方式、属性方式：<br>  path: data: /var/lib/elasticsearch logs:/var/log/elasticsearch<br>  path.data: /var/lib/elasticsearch path.logs:/var/log/elasticsearch</p></li><li><p>jvm.options</p><p>  配置Elasticsearch JVM<br>  设置最小、最大的JVM堆内存：<br>  -Xms 和 -Xmx<br>  两个值设置为相等，Xmx 设置为不超过物理内存的一半</p></li><li><p>log4j2.properties</p><p>  配置日志</p></li></ul><blockquote><p>启动ES</p></blockquote><p>cd bin &gt; elasticsearch.bat</p><blockquote><p>插件安装</p></blockquote><p>head 插件是一个可视化管理插件，监视ES状态，并通过head客户端和ES服务进行交互</p><ul><li><p>下载head并运行</p><p>  git clone git://github.com/mobz/elasticsearch-head.git<br>  cd elasticsearch-head<br>  npm install<br>  npm run start</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLALCHEMY</title>
      <link href="2020/08/20/flask/SQLALCHEMY/"/>
      <url>2020/08/20/flask/SQLALCHEMY/</url>
      
        <content type="html"><![CDATA[<h4 id="SQLALCHEMY"><a href="#SQLALCHEMY" class="headerlink" title="SQLALCHEMY"></a>SQLALCHEMY</h4><p>pip install flask_SQLAlchemy<br>pip install sqlalchemy_migrate</p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Flask-SQLAlchemy 扩展</span></span><br><span class="line">SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;sqlite:///&#x27;</span> + os.path.join(basedir, <span class="string">&#x27;app.db&#x27;</span>)</span><br><span class="line"><span class="comment"># SQLAlchemy-migrate 数据文件存储目录</span></span><br><span class="line">SQLALCHEMY_MIGRATE_REPO = os.path.join(basedir, <span class="string">&#x27;db_repository&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="create-py"><a href="#create-py" class="headerlink" title="create.py"></a>create.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> migrate.versioning <span class="keyword">import</span> api</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> SQLALCHEMY_DATABASE_URI</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> SQLALCHEMY_MIGRATE_REPO</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"></span><br><span class="line">db.create_all()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(SQLALCHEMY_MIGRATE_REPO):</span><br><span class="line">    api.create(SQLALCHEMY_MIGRATE_REPO, <span class="string">&#x27;database repository&#x27;</span>)</span><br><span class="line">    api.version_control(SQLALCHEMY_DATABASE_URI, SQLALCHEMY_MIGRATE_REPO)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    api.version_control(SQLALCHEMY_DATABASE_URI,</span><br><span class="line">                        SQLALCHEMY_MIGRATE_REPO,</span><br><span class="line">                        api.version(SQLALCHEMY_MIGRATE_REPO))</span><br></pre></td></tr></table></figure><h4 id="migrate-py"><a href="#migrate-py" class="headerlink" title="migrate.py"></a>migrate.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> imp</span><br><span class="line"><span class="keyword">from</span> migrate.versioning <span class="keyword">import</span> api</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> SQLALCHEMY_DATABASE_URI</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> SQLALCHEMY_MIGRATE_REPO</span><br><span class="line"></span><br><span class="line">v = api.db_version(SQLALCHEMY_DATABASE_URI, SQLALCHEMY_MIGRATE_REPO)</span><br><span class="line"></span><br><span class="line">migration = SQLALCHEMY_MIGRATE_REPO + (<span class="string">&#x27;/versions/%03d_migration.py&#x27;</span> % (v+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">tmp_module = imp.new_module(<span class="string">&#x27;old_model&#x27;</span>)</span><br><span class="line">old_model = api.create_model(SQLALCHEMY_DATABASE_URI, SQLALCHEMY_MIGRATE_REPO)</span><br><span class="line"></span><br><span class="line">exec(old_model, tmp_module.__dict__)</span><br><span class="line"></span><br><span class="line">script = api.make_update_script_for_model(SQLALCHEMY_DATABASE_URI,</span><br><span class="line">                                          SQLALCHEMY_MIGRATE_REPO,</span><br><span class="line">                                          tmp_module.meta,</span><br><span class="line">                                          db.metadata)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(migration, mode=<span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(script)</span><br><span class="line"></span><br><span class="line">api.upgrade(SQLALCHEMY_DATABASE_URI, SQLALCHEMY_MIGRATE_REPO)</span><br><span class="line"></span><br><span class="line">v = api.db_version(SQLALCHEMY_DATABASE_URI, SQLALCHEMY_MIGRATE_REPO)</span><br></pre></td></tr></table></figure><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db, models</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加</span></span><br><span class="line">u = models.User(nickname=<span class="string">&#x27;susan&#x27;</span>, email=<span class="string">&#x27;susan@email.com&#x27;</span>)</span><br><span class="line">db.session.add(u)</span><br><span class="line">db.session.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询</span></span><br><span class="line">users = models.User.query.<span class="built_in">all</span>()</span><br><span class="line">user = models.User.query.get(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">users = models.User.query.order_by(text(<span class="string">&#x27;nickname desc&#x27;</span>)).<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line">db.session.delete(user)</span><br></pre></td></tr></table></figure><p><a href="https://flask-sqlalchemy.palletsprojects.com/en/2.x/">官方文档</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask 项目实战</title>
      <link href="2020/08/18/flask/flask%20%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"/>
      <url>2020/08/18/flask/flask%20%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h4 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">项目名</span><br><span class="line">├─ 包名  【源码】</span><br><span class="line">│  ├─ static  【静态资源、文件】</span><br><span class="line">│  ├─ templates  【模板】</span><br><span class="line">│  ├─ __init__.py  【初始化】</span><br><span class="line">├─ instance</span><br><span class="line">├─ tests  【测试】</span><br><span class="line">├─ MANIFEST.in</span><br><span class="line">├─ setup.py</span><br></pre></td></tr></table></figure><h4 id="应用设置"><a href="#应用设置" class="headerlink" title="应用设置"></a>应用设置</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_app</span>(<span class="params">app_config = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="comment"># 创建 Flask 实例</span></span><br><span class="line">    app = Flask(__name__, instance_relative_config = <span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 设置默认配置</span></span><br><span class="line">    app.config.from_mapping(</span><br><span class="line">        SECRET_KEY = <span class="string">&#x27;DEV&#x27;</span>,</span><br><span class="line">        DATABASE = os.path.join(app.instance_path, <span class="string">&#x27;sqlite&#x27;</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> app_config <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        app.config.from_pyfile(<span class="string">&#x27;config.py&#x27;</span>, silent = <span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        app.config.from_mapping(app_config)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 instance 是否存在</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        os.makedirs(app.instance_path)</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;应用配置成功...&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># close_db、init_db_command 需要注册，否则无法使用</span></span><br><span class="line">    <span class="keyword">from</span> . <span class="keyword">import</span> db</span><br><span class="line">    db.init_app(app)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app</span><br></pre></td></tr></table></figure><h4 id="定义操作数据库"><a href="#定义操作数据库" class="headerlink" title="定义操作数据库"></a>定义操作数据库</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> click</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> current_app, g</span><br><span class="line"><span class="keyword">from</span> flask.cli <span class="keyword">import</span> with_appcontext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_db</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;db&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> g:</span><br><span class="line">        g.db = sqlite3.connect(</span><br><span class="line">            current_app.config[<span class="string">&#x27;DATABASE&#x27;</span>],</span><br><span class="line">            detect_types = sqlite3.PARSE_DECLTYPES</span><br><span class="line">        )</span><br><span class="line">        g.db.row_factory = sqlite3.Row</span><br><span class="line">    <span class="keyword">return</span> g.db</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">close_db</span>(<span class="params">e = <span class="literal">None</span></span>):</span></span><br><span class="line">    db = g.pop(<span class="string">&#x27;db&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> db <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_db</span>():</span></span><br><span class="line">    db = get_db()</span><br><span class="line">    <span class="keyword">with</span> current_app.open_resource(<span class="string">&#x27;schema.sql&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        db.executescript(f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@click.command(<span class="params"><span class="string">&#x27;init_db&#x27;</span></span>)  </span><span class="comment"># 定义一个命令行</span></span><br><span class="line"><span class="meta">@with_appcontext</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_db_command</span>():</span></span><br><span class="line">    init_db()</span><br><span class="line">    click.echo(<span class="string">&#x27;Initialized the database...&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>函数应用注册</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_app</span>(<span class="params">app</span>):</span></span><br><span class="line">    <span class="comment"># 告诉 Flask 返回响应后进行清理时调用此函数</span></span><br><span class="line">    app.teardown_appcontext(close_db)</span><br><span class="line">    <span class="comment"># 添加一个新的可以和 flask 一起工作的命令</span></span><br><span class="line">    app.cli.add_command(init_db_command)</span><br></pre></td></tr></table></figure><blockquote><p>schema.sql</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="keyword">users</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> post;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span>(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span> AUTOINCREMENT,</span><br><span class="line">username <span class="built_in">TEXT</span> <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="keyword">password</span> <span class="built_in">TEXT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> post(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span> AUTOINCREMENT,</span><br><span class="line">author_id <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">created <span class="built_in">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span>,</span><br><span class="line">title <span class="built_in">TEXT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="keyword">context</span> <span class="built_in">TEXT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line"><span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (author_id) <span class="keyword">REFERENCES</span> <span class="keyword">users</span> (<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="蓝图和视图"><a href="#蓝图和视图" class="headerlink" title="蓝图和视图"></a>蓝图和视图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> funtools</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span>(</span><br><span class="line">    Blueprint, flash, g, redirect, render_template, request, sesstion, url_for</span><br><span class="line">)</span><br><span class="line"><span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> check_password_hash, generate_passwork_hash</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> db <span class="keyword">import</span> get_db</span><br><span class="line"></span><br><span class="line">bp = Blueprint(<span class="string">&#x27;auth&#x27;</span>, __name__, url_prefix = <span class="string">&#x27;/auth&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">注册</span></span><br><span class="line"><span class="string">2020-08-18</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods = (<span class="params"><span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;post&#x27;</span></span>)</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        db = get_db()</span><br><span class="line">        error = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username:</span><br><span class="line">            error = <span class="string">&#x27;用户名不能为空...&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> password:</span><br><span class="line">            error = <span class="string">&#x27;密码不能为空...&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> db.execute(</span><br><span class="line">                <span class="string">&#x27;select id from users where username = ?&#x27;</span>, (username,)</span><br><span class="line">            ).fetchone() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            error = <span class="string">&#x27;用户 &#123;&#125; 已经存在...&#x27;</span>.<span class="built_in">format</span>(username) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> error <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            db.execute(</span><br><span class="line">                <span class="string">&#x27;insert into users (username, password) values (?, ?)&#x27;</span>,</span><br><span class="line">                (username, generate_password_hash(password))</span><br><span class="line">            )</span><br><span class="line">            db.commit()</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;auth.login&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">        flash(error)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">登录</span></span><br><span class="line"><span class="string">2020-08-18</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods = (<span class="params"><span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span></span>)</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        db = get_db()</span><br><span class="line">        error = <span class="literal">None</span></span><br><span class="line">        user = db.execute(</span><br><span class="line">                <span class="string">&#x27;select * from users where username = ?&#x27;</span>, (username,)</span><br><span class="line">            ).fetchone()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> user <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            error = <span class="string">&#x27;用户名错误...&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> check_password_hash(user[<span class="string">&#x27;password&#x27;</span>], password):</span><br><span class="line">            error = <span class="string">&#x27;密码错误...&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> error <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session.clear()</span><br><span class="line">            session[<span class="string">&#x27;user_id&#x27;</span>] = user[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        flash(error)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">注销</span></span><br><span class="line"><span class="string">2020-08-18</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bp.route(<span class="params"><span class="string">&#x27;logout&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>():</span></span><br><span class="line">    session.clear()</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">登录验证</span></span><br><span class="line"><span class="string">2020-08-18</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_required</span>(<span class="params">view</span>):</span></span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">view</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapped_view</span>(<span class="params">**kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> g.user <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;auth.login&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> view(**kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapped_view</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">拦截函数</span></span><br><span class="line"><span class="string">2020-08-18</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bp.before_app_request</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_logged_in_user</span>():</span></span><br><span class="line">    user_id = session.get(<span class="string">&#x27;user_id&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_id <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        g.user = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g.user = get_db().execute(</span><br><span class="line">                <span class="string">&#x27;select * from user where id = ?&#x27;</span>, (user_id,)</span><br><span class="line">            ).fetchone()</span><br></pre></td></tr></table></figure><h4 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h4><figure class="highlight jinja"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">extends</span></span> &#x27;base.html&#x27; %&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> header %&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> title %&#125;</span><span class="xml"> 列表 </span><span class="template-tag">&#123;% <span class="name"><span class="name">endblock</span></span> %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> g.user %&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;add&quot;</span> <span class="attr">href</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123; url_for(&#x27;blog.create&#x27;) &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">&quot;</span>&gt;</span>新建<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endblock</span></span> %&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">block</span></span> content %&#125;</span></span><br><span class="line"><span class="xml">  </span><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> post <span class="keyword">in</span> posts %&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><span class="template-variable">&#123;&#123; post[&#x27;title&#x27;] &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="template-variable">&#123;&#123; post[&#x27;username&#x27;] &#125;&#125;</span><span class="xml"> </span><span class="template-variable">&#123;&#123; post[&#x27;created&#x27;].strftime(&#x27;%Y-%m-%d&#x27;) &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> g.user[&#x27;id&#x27;] == post[&#x27;author_id&#x27;] %&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;edit&quot;</span> <span class="attr">href</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123; url_for(&#x27;blog.update&#x27;, id = post[&#x27;id&#x27;]) &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">&quot;</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">      </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;context&quot;</span>&gt;</span></span><span class="template-variable">&#123;&#123; post[&#x27;context&#x27;] &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span></span><br><span class="line"><span class="xml">    </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> not loop.last %&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    </span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">  </span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endblock</span></span> %&#125;</span></span><br></pre></td></tr></table></figure><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><blockquote><p>pip install pytest coverage</p></blockquote><blockquote><p>conftest.py</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> flaskr <span class="keyword">import</span> create_app</span><br><span class="line"><span class="keyword">from</span> flaskr.db <span class="keyword">import</span> get_db, init_db</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(os.path.dirname(__file__), <span class="string">&#x27;data.sql&#x27;</span>), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    _data_sql = f.read().decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">app</span>():</span></span><br><span class="line">    db_fd, db_path = tempfile.mkstemp()</span><br><span class="line"></span><br><span class="line">    app = create_app(&#123;</span><br><span class="line">        <span class="string">&#x27;TESTING&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;DATABASE&#x27;</span>: db_path,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> app.app_context():</span><br><span class="line">        init_db()</span><br><span class="line">        get_db().executescript(_data_sql)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">yield</span> app</span><br><span class="line"></span><br><span class="line">    os.close(db_fd)</span><br><span class="line">    os.unlink(db_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">client</span>(<span class="params">app</span>):</span></span><br><span class="line">    <span class="keyword">return</span> app.test_client()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runner</span>(<span class="params">app</span>):</span></span><br><span class="line">    <span class="keyword">return</span> app.test_cli_runner()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthActions</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, client</span>):</span></span><br><span class="line">        self._client = client</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">login</span>(<span class="params">self, username=<span class="string">&#x27;test&#x27;</span>, password=<span class="string">&#x27;test&#x27;</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._client.post(</span><br><span class="line">            <span class="string">&#x27;/auth/login&#x27;</span>,</span><br><span class="line">            data=&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">logout</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._client.get(<span class="string">&#x27;/auth/logout&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">auth</span>(<span class="params">client</span>):</span></span><br><span class="line">    <span class="keyword">return</span> AuthActions(client)</span><br></pre></td></tr></table></figure><blockquote><p>test_factory.py</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flaskr <span class="keyword">import</span> create_app</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_config</span>():</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="keyword">not</span> create_app().testing</span><br><span class="line">    <span class="keyword">assert</span> create_app(&#123;<span class="string">&#x27;TESTING&#x27;</span>: <span class="literal">True</span>&#125;).testing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_hello</span>(<span class="params">client</span>):</span></span><br><span class="line">    response = client.get(<span class="string">&#x27;/hello&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span> response.data == <span class="string">b&#x27;Hello, World!&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>test_db.py</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> flaskr.db <span class="keyword">import</span> get_db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_get_close_db</span>(<span class="params">app</span>):</span></span><br><span class="line">    <span class="keyword">with</span> app.app_context():</span><br><span class="line">        db = get_db()</span><br><span class="line">        <span class="keyword">assert</span> db <span class="keyword">is</span> get_db()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> pytest.raises(sqlite3.ProgrammingError) <span class="keyword">as</span> e:</span><br><span class="line">        db.execute(<span class="string">&#x27;SELECT 1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&#x27;closed&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(e.value)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_init_db_command</span>(<span class="params">runner, monkeypatch</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Recorder</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        called = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fake_init_db</span>():</span></span><br><span class="line">        Recorder.called = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    monkeypatch.<span class="built_in">setattr</span>(<span class="string">&#x27;flaskr.db.init_db&#x27;</span>, fake_init_db)</span><br><span class="line">    result = runner.invoke(args=[<span class="string">&#x27;init-db&#x27;</span>])</span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&#x27;Initialized&#x27;</span> <span class="keyword">in</span> result.output</span><br><span class="line">    <span class="keyword">assert</span> Recorder.called</span><br></pre></td></tr></table></figure><blockquote><p>test_auth.py</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> g, session</span><br><span class="line"><span class="keyword">from</span> flaskr.db <span class="keyword">import</span> get_db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_register</span>(<span class="params">client, app</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> client.get(<span class="string">&#x27;/auth/register&#x27;</span>).status_code == <span class="number">200</span></span><br><span class="line">    response = client.post(</span><br><span class="line">        <span class="string">&#x27;/auth/register&#x27;</span>, data=&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;a&#x27;</span>&#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&#x27;http://localhost/auth/login&#x27;</span> == response.headers[<span class="string">&#x27;Location&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> app.app_context():</span><br><span class="line">        <span class="keyword">assert</span> get_db().execute(</span><br><span class="line">            <span class="string">&quot;select * from user where username = &#x27;a&#x27;&quot;</span>,</span><br><span class="line">        ).fetchone() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params">(<span class="params"><span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;message&#x27;</span></span>), (<span class="params"></span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params">    (<span class="params"><span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">b&#x27;Username is required.&#x27;</span></span>),</span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params">    (<span class="params"><span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">b&#x27;Password is required.&#x27;</span></span>),</span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params">    (<span class="params"><span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">b&#x27;already registered&#x27;</span></span>),</span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params"></span>)</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_register_validate_input</span>(<span class="params">client, username, password, message</span>):</span></span><br><span class="line">    response = client.post(</span><br><span class="line">        <span class="string">&#x27;/auth/register&#x27;</span>,</span><br><span class="line">        data=&#123;<span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;password&#x27;</span>: password&#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">assert</span> message <span class="keyword">in</span> response.data</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_login</span>(<span class="params">client, auth</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> client.get(<span class="string">&#x27;/auth/login&#x27;</span>).status_code == <span class="number">200</span></span><br><span class="line">    response = auth.login()</span><br><span class="line">    <span class="keyword">assert</span> response.headers[<span class="string">&#x27;Location&#x27;</span>] == <span class="string">&#x27;http://localhost/&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> client:</span><br><span class="line">        client.get(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="keyword">assert</span> session[<span class="string">&#x27;user_id&#x27;</span>] == <span class="number">1</span></span><br><span class="line">        <span class="keyword">assert</span> g.user[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;test&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params">(<span class="params"><span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;message&#x27;</span></span>), (<span class="params"></span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params">    (<span class="params"><span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">b&#x27;Incorrect username.&#x27;</span></span>),</span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params">    (<span class="params"><span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">b&#x27;Incorrect password.&#x27;</span></span>),</span></span></span></span><br><span class="line"><span class="meta"><span class="params"><span class="params"></span>)</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_login_validate_input</span>(<span class="params">auth, username, password, message</span>):</span></span><br><span class="line">    response = auth.login(username, password)</span><br><span class="line">    <span class="keyword">assert</span> message <span class="keyword">in</span> response.data</span><br></pre></td></tr></table></figure><h4 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[tool:pytest]</span><br><span class="line">testpaths &#x3D; tests</span><br><span class="line"></span><br><span class="line">[coverage:run]</span><br><span class="line">branch &#x3D; True</span><br><span class="line">source &#x3D;</span><br><span class="line">blog_source</span><br></pre></td></tr></table></figure><blockquote><p>pytest<br>coverage report<br>coverage html</p></blockquote><h4 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h4><blockquote><p>python setup.py bdist_wheel</p></blockquote><p>文件名由项目名称、版 本号和一些关于项目安装要求的标记组成。</p><blockquote><p>配置秘钥</p></blockquote><p>python -c ‘import os; print(os.urandom(16))’</p><blockquote><p>产品服务器</p></blockquote><p>pip install waitress</p><p>waitress-serve –call ‘app:create_app’</p><h4 id="常用扩展"><a href="#常用扩展" class="headerlink" title="常用扩展"></a>常用扩展</h4><p>pip install flask<br>pip install flask-login<br>pip install flask-openid<br>pip install flask-mail<br>pip install flask-sqlalchemy<br>pip install sqlalchemy-migrate<br>pip install flask-whooshalchemy<br>pip install flask-wtf<br>pip install flask-babel<br>pip install guess_language<br>pip install flipflop<br>pip install coverage</p><ul><li>pip install –no-deps lamson chardet flask-mail</li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask 安装</title>
      <link href="2020/08/16/flask/flask%20%E5%AE%89%E8%A3%85/"/>
      <url>2020/08/16/flask/flask%20%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h4 id="虚拟环境"><a href="#虚拟环境" class="headerlink" title="虚拟环境"></a>虚拟环境</h4><blockquote><p>安装 virtualenv</p></blockquote><p>pip install virtualenv</p><blockquote><p>安装使用 virtualenvwrapper</p></blockquote><p>pip install virtualenvwrapper-win</p><blockquote><p>新建虚拟环境</p></blockquote><p>mkvirtualenv env2</p><p>或者</p><p>python -m venv 虚拟环境名称</p><blockquote><p>激活</p></blockquote><p>workon 虚拟环境名称</p><p>或者</p><p>虚拟环境名称\Scripts&gt;activate.bat</p><blockquote><p>退出</p></blockquote><p>deactivate</p><blockquote><p>修改默认虚拟环境目录</p></blockquote><p>设置 workon_home 环境变量</p><h4 id="flask-依赖"><a href="#flask-依赖" class="headerlink" title="flask 依赖"></a>flask 依赖</h4><blockquote><p>自动安装依赖</p></blockquote><ol><li>Werkzeug 用于实现 WSGI，应用和服务之间的标准 python 接口</li><li>Jinja2 渲染页面的模板语言</li><li>MarkupSafe 与 Jinja 公用，在渲染页面时避免不可信的输入，防止注入攻击</li><li>ItsDangerous 保证数据完整性的安全标志数据，保护session cookie</li><li>Click 命令行应用的框架</li></ol><blockquote><p>可选依赖</p></blockquote><p>Blinker 为信号提供支持<br>SimpleJSON 快速 JSON 实现<br>python-dotenv 运行 flask 命令时，为通过dotenv设置环境变量<br>Watchdog 为开发服务器提供快速高效的重载</p><h4 id="flask-运行"><a href="#flask-运行" class="headerlink" title="flask 运行"></a>flask 运行</h4><ol><li>set FLASK_APP=blog_source</li><li>set FLASK_ENV=development</li><li>flask run</li></ol>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flask 快速上手</title>
      <link href="2020/08/16/flask/flask%20%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"/>
      <url>2020/08/16/flask/flask%20%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><p>使用 route() 装饰器来把函数绑定到 URL</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;Index Page&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>带参数的路由</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_user_profile</span>(<span class="params">username</span>):</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;user %s&#x27;</span> % escape(username)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/post/&lt;int:post_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_post</span>(<span class="params">post_id</span>):</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;post %d&#x27;</span> % post_id</span><br></pre></td></tr></table></figure><blockquote><p>转换器类型</p></blockquote><style>table{ border-collapse: collapse}table th,table td{ border: 1px solid #cdcdcd; padding: .5rem;}</style><table><thead><tr><th align="center">类型</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">string</td><td align="center">默认值，接受任何不含斜杠的文本</td></tr><tr><td align="center">int</td><td align="center">接受正整数</td></tr><tr><td align="center">float</td><td align="center">接受正浮点数</td></tr><tr><td align="center">path</td><td align="center">类似 string，可以包含斜杠</td></tr><tr><td align="center">uuid</td><td align="center">接受 UUID 字符串</td></tr></tbody></table><h4 id="重定向行为"><a href="#重定向行为" class="headerlink" title="重定向行为"></a>重定向行为</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/projects/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">projects</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;The project page&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/about&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">about</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;The about page&#x27;</span></span><br></pre></td></tr></table></figure><p>区别在于尾部的斜杠</p><h4 id="URL-构建"><a href="#URL-构建" class="headerlink" title="URL 构建"></a>URL 构建</h4><p>url_for(函数名， 参数)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> falsk <span class="keyword">import</span> Flask, escape, url_for</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile</span>(<span class="params">username</span>):</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&#123;&#125;\&#x27;s profile&#x27;</span>.<span class="built_in">format</span>(escape(username))</span><br><span class="line"></span><br><span class="line">print(url_for(<span class="string">&#x27;profile&#x27;</span>, username = <span class="string">&#x27;John Doe&#x27;</span>))</span><br></pre></td></tr></table></figure><h4 id="HTTP-方法"><a href="#HTTP-方法" class="headerlink" title="HTTP 方法"></a>HTTP 方法</h4><p>默认情况下，一个路由只回应 GET 请求，route() 装饰器的 methods 参数可以处理不同的 HTTP 方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;登录...&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;登录信息...&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="获取静态文件"><a href="#获取静态文件" class="headerlink" title="获取静态文件"></a>获取静态文件</h4><p>url_for(‘static’, filename = ‘style.css’)</p><h4 id="渲染模板"><a href="#渲染模板" class="headerlink" title="渲染模板"></a>渲染模板</h4><p>render_template()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name</span>):</span></span><br><span class="line"><span class="keyword">return</span> render_template(hello.html, name = name)</span><br></pre></td></tr></table></figure><p>情形 1 : 一个模块:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/application.py</span><br><span class="line">/templates</span><br><span class="line">    /hello.html</span><br></pre></td></tr></table></figure><p>情形 2 : 一个包:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/application</span><br><span class="line">    /__init__.py</span><br><span class="line">    /templates</span><br><span class="line">        /hello.html</span><br></pre></td></tr></table></figure><h4 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h4><p>app.logger.debug()<br>app.logger.warning()<br>app.logger.error()</p><h4 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h4><blockquote><p>读取 cookies:</p></blockquote><p>from flask import request</p><p>request.cookies.get(‘username’)</p><blockquote><p>储存 cookies:</p></blockquote><p>resp = make_response(render_template(…))</p><p>resp.set_cookie(‘username’, ‘the username’)</p><h4 id="重定向和错误"><a href="#重定向和错误" class="headerlink" title="重定向和错误"></a>重定向和错误</h4><p>from flask import abort, redirect, url_for</p><p>redirect(url_for(‘login’))<br>abort(401)</p><h4 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h4><p>jsonify()</p><h4 id="会话"><a href="#会话" class="headerlink" title="会话"></a>会话</h4><p>if ‘username’ in session:<br>    return ‘Logged in as %s’ % escape(session[‘username’])</p><p>session[‘username’] = request.form[‘username’]</p><p>session.pop(‘username’, None)</p><p>Flask.secret_key 生成秘钥</p><h4 id="UWSGI"><a href="#UWSGI" class="headerlink" title="UWSGI"></a>UWSGI</h4><p>from werkzeug.contrib.fixers import LighttpdCGIRootFix<br>app.wsgi_app = LighttpdCGIRootFix(app.wsgi_app)</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>this 讲解</title>
      <link href="2020/08/06/Javascript/this%20%E8%AE%B2%E8%A7%A3/"/>
      <url>2020/08/06/Javascript/this%20%E8%AE%B2%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<div class="console"></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WhoAmI</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  count ++</span><br><span class="line">  <span class="keyword">var</span> res = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&#x27;console&#x27;</span>)[<span class="number">0</span>].innerHTML</span><br><span class="line">  <span class="built_in">document</span>.getElementsByClassName(<span class="string">&#x27;console&#x27;</span>)[<span class="number">0</span>].innerHTML = </span><br><span class="line"><span class="string">`<span class="subst">$&#123;res&#125;</span> &lt;br/&gt; <span class="subst">$&#123;count&#125;</span> I&#x27;m <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span> of <span class="subst">$&#123;<span class="keyword">typeof</span>(<span class="built_in">this</span>)&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">WhoAmI()                      <span class="comment">// ①</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> BillGates = &#123;</span><br><span class="line">  name: <span class="string">&#x27;Bill Gates&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">BillGates.WhoAmI = WhoAmI</span><br><span class="line">BillGates.WhoAmI()            <span class="comment">// ②</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> SteveJobs = &#123;</span><br><span class="line">  name: <span class="string">&#x27;Steve Jobs&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">SteveJobs.WhoAmI = WhoAmI</span><br><span class="line">SteveJobs.WhoAmI()            <span class="comment">// ③</span></span><br><span class="line"></span><br><span class="line">WhoAmI.call(BillGates)        <span class="comment">// ④</span></span><br><span class="line">WhoAmI.call(SteveJobs)        <span class="comment">// ⑤</span></span><br><span class="line"></span><br><span class="line">BillGates.WhoAmI.call(SteveJobs)   <span class="comment">// ⑥</span></span><br><span class="line">SteveJobs.WhoAmI.call(BillGates)   <span class="comment">// ⑦</span></span><br><span class="line"></span><br><span class="line">WhoAmI.WhoAmI = WhoAmI</span><br><span class="line">WhoAmI.name = <span class="string">&#x27;WhoAmI&#x27;</span></span><br><span class="line">WhoAmI.WhoAmI()                    <span class="comment">// ⑧</span></span><br><span class="line"></span><br><span class="line">BillGates.WhoAmI.apply(SteveJobs)  <span class="comment">// ⑨</span></span><br><span class="line">SteveJobs.WhoAmI.apply(BillGates)  <span class="comment">// ⑩</span></span><br></pre></td></tr></table></figure><script>var count = 0function WhoAmI(){  count ++  var res = document.getElementsByClassName('console')[0].innerHTML  document.getElementsByClassName('console')[0].innerHTML = `${res} <br/> ${count}.  I'm ${this.name} of ${typeof(this)}`  console.log(this)}WhoAmI()let BillGates = {  name: 'Bill Gates'}BillGates.WhoAmI = WhoAmIBillGates.WhoAmI()let SteveJobs = {  name: 'Steve Jobs'}SteveJobs.WhoAmI = WhoAmISteveJobs.WhoAmI()WhoAmI.call(BillGates)WhoAmI.call(SteveJobs)BillGates.WhoAmI.call(SteveJobs)SteveJobs.WhoAmI.call(BillGates)WhoAmI.WhoAmI = WhoAmIWhoAmI.name = 'WhoAmI'WhoAmI.WhoAmI()BillGates.WhoAmI.apply(SteveJobs)SteveJobs.WhoAmI.apply(BillGates)</script>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript 面试基础</title>
      <link href="2020/08/06/Javascript/javascript%20%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80/"/>
      <url>2020/08/06/Javascript/javascript%20%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="变量和类型"><a href="#变量和类型" class="headerlink" title="变量和类型"></a>变量和类型</h4><blockquote><p>javascript 规定了几种语言类型?</p></blockquote><p>Undefined、Null、Boolean、String、Number、Symbol、Object、Function</p><pre><code>简单类型都不是对象</code></pre><ol><li><p>undefined</p><p> 表示未定义，任何变量赋值前都是 undefined 类型，值为 undefined （而不是 null）<br> undefined 是一个变量，void(0) 返回 undefined</p></li><li><p>null</p><p> 只有一个值，表示空值，是关键字，typeOf(null) 返回 object</p></li><li><p>String </p><p> 字符串 UTF16编码，最大长度 253-1</p></li><li><p>Number</p><p> typeof(NaN) 和 typeof(Infinity) 都返回 number<br> NaN != NaN<br> Infinity / Infinity = NaN </p></li><li><p>Symbol</p><p> 表示独一无二的值，是一切非字符串的对象key的集合。<br> Symbol(参数)：可以接受一个字符串参数，表示对 Symbol 实例的描述。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>(<span class="number">1</span>) === <span class="built_in">Symbol</span>(<span class="number">1</span>)      <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ol start="6"><li><p>Object</p><p> 为什么给对象添加的方法能用在基本类型上？</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>.prototype.hello = <span class="function">() =&gt;</span> &#123; <span class="built_in">console</span>.log(<span class="string">&#x27;hello&#x27;</span>)&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">Symbol</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> a)      <span class="comment">// symbol</span></span><br><span class="line">a.hello()                  <span class="comment">// hello</span></span><br></pre></td></tr></table></figure><pre><code>运算符提供了装箱操作，会根据基础类型构造一个临时对象，使得基础类型可以调用对象的方法</code></pre><ol start="7"><li>Function</li></ol><ul><li><p>装箱和拆箱</p><p>  在 JavaScript 中，没有任何方法可以更改私有的 Class 属性，因此 Object.prototype.toString 是可以准确识别对象对应的基本类型的方法，它比 instanceof 更加准确。</p><p>  装箱过程使用 object 函数<br>  拆箱转换使用 valueOf、toString，如果valueOf 和 toString都不存在，或者没有返回基本类型，则会产生TypeError。</p></li></ul><blockquote><p>JavaScript对象的底层数据结构是什么?</p></blockquote><p>所有 js 对象都是基于 HeapObject 的类生成的，对象的存储结构：</p><ol><li>头部信息</li><li>属性块，k-v</li><li>元素块</li></ol><p>函数 function 类型本身也具有对象化的能力<br>函数 function 与对象 object 超然的结合能力</p><p>数组应该算是线性数据结构，线性数据结构一般有一定的规律，适合进行统一的批量迭代操作等，有点像波。<br>而对象是离散数据结构，适合描述分散的和个性化的东西，有点像粒子。</p><p>JavaScript里的对象到底是波还是粒子？</p><pre><code>波粒二象性</code></pre><p>javascript 对象是 <code>字典</code> 结构</p><blockquote><p>Symbol类型在实际开发中的应用、可手动实现一个简单的Symbol?</p></blockquote><ol><li>使用Symbol来作为对象属性名(key)</li></ol><p>必须用 <code>对象[key]</code>，不能使用 <code>对象.key</code><br>Symbol类型的 key 是不能通过 Object.keys() 或者 for…in 来枚举<br>JSON.stringify(obj) Symbol 类型也会被排除</p><p>获取 Symbol定义的对象属性：</p><p>Object.getOwnPropertySymbol(obj)<br>Reflect.ownKeys(obj)</p><ol start="2"><li><p>使用Symbol替代常量</p></li><li><p>使用Symbol定义类的私有属性、方法</p></li><li><p>可以定义枚举</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> levels = &#123;</span><br><span class="line">  DEBUG: <span class="built_in">Symbol</span>(<span class="string">&#x27;debug&#x27;</span>),</span><br><span class="line">  INFO: <span class="built_in">Symbol</span>(<span class="string">&#x27;info&#x27;</span>),</span><br><span class="line">  WARN: <span class="built_in">Symbol</span>(<span class="string">&#x27;warn&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Symbol.for(‘foo’)：定义使用同一个Symbol</p><h4 id="原型和原型链"><a href="#原型和原型链" class="headerlink" title="原型和原型链"></a>原型和原型链</h4><blockquote><p>实现继承的几种方式以及他们的优缺点?</p></blockquote><ol><li>原型链继承</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将子类的原型链指向父类的对象实例</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">P</span>(<span class="params">name, id</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.id = id</span><br><span class="line">  <span class="built_in">this</span>.name = name || <span class="string">&#x27;parent&#x27;</span></span><br><span class="line">  <span class="built_in">this</span>.list = [<span class="string">&#x27;p&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line">P.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Hi&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">C.prototype = <span class="keyword">new</span> P()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> C()</span><br><span class="line"><span class="built_in">console</span>.log(c.name)      <span class="comment">// parent</span></span><br><span class="line">c.sayHi()                <span class="comment">// Hi</span></span><br></pre></td></tr></table></figure><p>优点：继承构造函数的属性，父类构造函数的属性，父类原型的属性<br>缺点：无法向父类构造函数传参，且原型对象的引用属性是所有实例共享的，即属性没有私有化，原型上属性的改变会作用到所有的实例上。</p><blockquote><p>构造函数继承</p></blockquote><p>实现：子类构造函数使用 call、apply 劫持父类构造函数方法，并传参<br>原理：call、apply 更改子类函数的作用域，执行父类构造函数，因此子类可以继承父类公有属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">D</span>(<span class="params">name, id</span>)</span>&#123;</span><br><span class="line">  P.call(<span class="built_in">this</span>, name, id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>优点：解决原型链继承缺点，可以实现多继承<br>缺点：</p><ol><li>实例并不是父类的实例，只是子类的实例</li><li>只能继承父类的实例属性和方法，不能继承原型属性/方法</li><li>无法实现函数复用，每个子类都有父类实例函数的副本，影响性能</li></ol><blockquote><p>组合继承</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">E</span>(<span class="params">name, id</span>)</span>&#123;</span><br><span class="line">  P.call(<span class="built_in">this</span>, name, id)</span><br><span class="line">&#125;</span><br><span class="line">E.prototype = <span class="keyword">new</span> P()</span><br><span class="line">E.prototype.constructor = E;  <span class="comment">// 修复构造函数指向</span></span><br></pre></td></tr></table></figure><p>缺点：执行两次父类的构造函数，消耗内存，子类的构造函数会代替原型上的父类构造函数</p><blockquote><p>原型式继承</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> parent = &#123;</span><br><span class="line">  names: [<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">  F.prototype = obj</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = copy(parent)</span><br></pre></td></tr></table></figure><p>缺点：共享应用类型</p><blockquote><p>寄生式继承</p></blockquote><p>原理：二次封装原型式继承，并扩展</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createObj</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> o = copy(obj)</span><br><span class="line">  o.getNames = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.names</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>寄生组合式继承</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subClass, superClass</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 复制一份父类的原型</span></span><br><span class="line">  <span class="keyword">var</span> p = copy(superClass.prototype);</span><br><span class="line">  <span class="comment">// 修正构造函数</span></span><br><span class="line">  p.constructor = subClass;</span><br><span class="line">  <span class="comment">// 设置子类原型</span></span><br><span class="line">  subClass.prototype = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name, id</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.id = id;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="built_in">this</span>.list = [<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">  <span class="built_in">this</span>.printName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name, id</span>)</span>&#123;</span><br><span class="line">  Parent.call(<span class="built_in">this</span>, name, id);</span><br><span class="line">  <span class="comment">// Parent.apply(this, arguments);</span></span><br><span class="line">&#125;</span><br><span class="line">inheritPrototype(Child, Parent);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>箭头函数和函数的区别</title>
      <link href="2020/08/05/Javascript/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>2020/08/05/Javascript/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<ol><li><p>构造函数可以使用 new 生成实例</p></li><li><p>箭头函数没有自己的 this，它的 this 是继承函数所处上下文的 this，call、apply等无法改变 this 指向</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  name:<span class="string">&#x27;ov&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>); </span><br><span class="line">&#125;</span><br><span class="line">fn1.call(obj);        <span class="comment">// obj</span></span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>)   <span class="comment">// this是所属上下文，window</span></span><br><span class="line">&#125;;</span><br><span class="line">fn2.call(obj);        <span class="comment">//window</span></span><br></pre></td></tr></table></figure><img src="https://img.kancloud.cn/3e/bb/3ebbb5a96a565e10eb0fd4f150c0d6aa_828x85.png"/><ol start="3"><li>箭头函数没有 arguments 类数组，只能基于 …arg 获取传递的参数集合</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line">fn(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br></pre></td></tr></table></figure><pre><code>Uncaught ReferenceError: arguments is not defined</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">...arg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg)</span><br><span class="line">&#125;</span><br><span class="line">fn(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br></pre></td></tr></table></figure><p>     [10, 20, 30]</p><ol start="4"><li>箭头函数不能被 new 执行，没有 prototype 属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">dir(a)</span><br><span class="line">dir(b)</span><br></pre></td></tr></table></figure><img src="/images/箭头函数.png"/>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AST 抽象语法树</title>
      <link href="2020/08/05/%E5%89%8D%E7%AB%AF/AST%20%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91/"/>
      <url>2020/08/05/%E5%89%8D%E7%AB%AF/AST%20%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h4 id="函数的抽象语法树"><a href="#函数的抽象语法树" class="headerlink" title="函数的抽象语法树"></a>函数的抽象语法树</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>代码块是一个 <code>FunctionDeclaration</code> (函数定义)对象</li><li>分为3块：<ul><li>一个 id，即 add</li><li>两个 params，即[a, b]</li><li>一个 body，即 {return a + b}</li></ul></li></ol><blockquote><p>add：<code>identifier</code> (标志)对象</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  name: <span class="string">&#x27;add&#x27;</span>,</span><br><span class="line">  type: <span class="string">&#x27;identifier&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>params： <code>identifier 数组</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    type: <span class="string">&#x27;identifier&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">    type: <span class="string">&#x27;identifier&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><blockquote><p>body</p></blockquote><p><code>BlockStatement</code> (块状域)对象，即 <code>&#123;return a + b&#125;</code></p><p><code>ReturnStatement</code> (Return 域)对象，即 <code>return a + b</code></p><p>argument：<code>BinaryExpression</code> (二项式)对象，即 <code>a + b</code></p><p><code>left</code>：identifier a<br><code>right</code>：identifier b<br><code>operator</code>： +</p><blockquote><p>抽象语法树 JSON</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Program&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;start&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;end&quot;</span>: <span class="number">216</span>,</span><br><span class="line">  <span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;FunctionDeclaration&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;start&quot;</span>: <span class="number">179</span>,</span><br><span class="line">      <span class="attr">&quot;end&quot;</span>: <span class="number">215</span>,</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;start&quot;</span>: <span class="number">188</span>,</span><br><span class="line">        <span class="attr">&quot;end&quot;</span>: <span class="number">191</span>,</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;add&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;expression&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">&quot;generator&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">&quot;async&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">&quot;params&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;start&quot;</span>: <span class="number">192</span>,</span><br><span class="line">          <span class="attr">&quot;end&quot;</span>: <span class="number">193</span>,</span><br><span class="line">          <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;a&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;start&quot;</span>: <span class="number">195</span>,</span><br><span class="line">          <span class="attr">&quot;end&quot;</span>: <span class="number">196</span>,</span><br><span class="line">          <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;b&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;body&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;BlockStatement&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;start&quot;</span>: <span class="number">197</span>,</span><br><span class="line">        <span class="attr">&quot;end&quot;</span>: <span class="number">215</span>,</span><br><span class="line">        <span class="attr">&quot;body&quot;</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;ReturnStatement&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start&quot;</span>: <span class="number">201</span>,</span><br><span class="line">            <span class="attr">&quot;end&quot;</span>: <span class="number">213</span>,</span><br><span class="line">            <span class="attr">&quot;argument&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;BinaryExpression&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;start&quot;</span>: <span class="number">208</span>,</span><br><span class="line">              <span class="attr">&quot;end&quot;</span>: <span class="number">213</span>,</span><br><span class="line">              <span class="attr">&quot;left&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;start&quot;</span>: <span class="number">208</span>,</span><br><span class="line">                <span class="attr">&quot;end&quot;</span>: <span class="number">209</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;a&quot;</span></span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">&quot;operator&quot;</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;right&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;Identifier&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;start&quot;</span>: <span class="number">212</span>,</span><br><span class="line">                <span class="attr">&quot;end&quot;</span>: <span class="number">213</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;b&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;sourceType&quot;</span>: <span class="string">&quot;module&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey/Parser_API#Node_objects">AST 对象文档</a></p><h4 id="recast-螺丝刀"><a href="#recast-螺丝刀" class="headerlink" title="recast 螺丝刀"></a>recast 螺丝刀</h4><pre><code>npm i recast -g</code></pre><h4 id="astexplorer"><a href="#astexplorer" class="headerlink" title="astexplorer"></a>astexplorer</h4><p><a href="https://astexplorer.net/">astexplorer</a></p><h4 id="词法分析"><a href="#词法分析" class="headerlink" title="词法分析"></a>词法分析</h4><p>扫描 scanner</p><p>按照预定的规则合并成一个个 tokens 列表，会移除空白符、注释等</p><h4 id="语法分析"><a href="#语法分析" class="headerlink" title="语法分析"></a>语法分析</h4><p>解释器</p><p>将词法分析出来的数组转换成 <code>树</code>，验证语法</p><p>解析器 100% 覆盖所有代码结构生成树叫做 CST（具体语法树），AST 不是 100% 与源码匹配</p><h4 id="代码转换之babel"><a href="#代码转换之babel" class="headerlink" title="代码转换之babel"></a>代码转换之babel</h4><p>解析(parsing) — 将代码字符串转换成 AST抽象语法树<br>转译(transforming) — 对抽象语法树进行变换操作<br>生成(generation) — 根据变换后的抽象语法树生成新的代码字符串</p><blockquote><p>操作 AST 重要模块，babel 核心</p></blockquote><p>esprima、estraverse、escodegen</p><ul><li>esprima 将 js 转换成 AST</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> esprima = <span class="built_in">require</span>(<span class="string">&#x27;esprima&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> code = <span class="string">&#x27;function fn()&#123;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> tree = esprima.parseScript(code)</span><br></pre></td></tr></table></figure><ul><li>estraverse 遍历和修改 AST</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> esprima = <span class="built_in">require</span>(<span class="string">&#x27;esprima&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> estraverse = <span class="built_in">require</span>(<span class="string">&#x27;estraverse&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> code = <span class="string">&#x27;function fn()&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tree = esprima.parseScript(code)</span><br><span class="line"></span><br><span class="line">estraverse.traverse(tree, &#123;</span><br><span class="line">  <span class="function"><span class="title">enter</span>(<span class="params">node</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;enter&#x27;</span>, node.type)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">leave</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;leave&#x27;</span>, node,type)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>escodegen 将 AST 转换成 js</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> escodegen = <span class="built_in">require</span>(<span class="string">&#x27;escodegen&#x27;</span>)</span><br><span class="line">... estraverse</span><br><span class="line"><span class="keyword">let</span> res = escodegen.generate(tree)</span><br></pre></td></tr></table></figure><blockquote><p>实现语法转换（babel-core、babel-types）</p></blockquote><p>主要依赖esprima、estraverse、escodegen</p><blockquote><p>plugin-transform-arrow-functions</p></blockquote><p>将箭头函数转换 ES5 语法的函数表达式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">&#x27;babel-core&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> types = <span class="built_in">require</span>(<span class="string">&#x27;babel-type&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sumCode = <span class="string">`</span></span><br><span class="line"><span class="string">const sum = (a,b) =&gt; &#123;</span></span><br><span class="line"><span class="string">  return a + b</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转化 ES5 插件</span></span><br><span class="line"><span class="keyword">let</span> ArrowPlugin = &#123;</span><br><span class="line">  <span class="comment">// 访问者（访问者模式）</span></span><br><span class="line">  visitor: &#123;</span><br><span class="line">    <span class="comment">// path 是树的路径</span></span><br><span class="line">    <span class="function"><span class="title">ArrowFunctionExpression</span>(<span class="params">path</span>)</span> &#123;</span><br><span class="line">      <span class="comment">// 获取树节点</span></span><br><span class="line">      <span class="keyword">let</span> node = path.node;</span><br><span class="line">      <span class="comment">// 获取参数和函数体</span></span><br><span class="line">      <span class="keyword">let</span> params = node.params;</span><br><span class="line">      <span class="keyword">let</span> body = node.body;</span><br><span class="line">      <span class="comment">// 判断函数体是否是代码块，不是代码块则添加 return 和 &#123;&#125;</span></span><br><span class="line">      <span class="keyword">if</span> (!types.isBlockStatement(body)) &#123;</span><br><span class="line">        <span class="keyword">let</span> returnStatement = types.returnStatement(body);</span><br><span class="line">        body = types.blockStatement([returnStatement]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 生成一个函数表达式树结构</span></span><br><span class="line">      <span class="keyword">let</span> func = types.functionExpression(<span class="literal">null</span>, params, body, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">      <span class="comment">// 用新的树结构替换掉旧的树结构</span></span><br><span class="line">      types.replaceWith(func);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">babel.transform(sumCode, &#123;</span><br><span class="line">  plugins: [ArrowPlugin]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>babel-code 的 <code>transform（codeString，plugins）</code> 方法将 AST 转换成代码块</p><p>codeString：转换前的代码块字符串</p><p>plugins：配置项，值为数组，存储修改 babel-code 转换的AST的插件</p><p>transform 方法将旧的 AST 处理成新的代码块，返回一个 <code>对象.code</code> 为转换后的代码块字符串</p><p>plugins：插件方法必须含有 <code>visitor</code> 属性（固定），值为对象，用于存储修改语法树的方法，方法名严格按照 API</p><p>types.functionExpression(<code>null, params, body, false, false</code>)：函数名，函数参数（必填）、函数体（必填）、是否generator函数（默认false）、是否为async函数（默认false）</p><blockquote><p>plugin-transform-classes</p></blockquote><p>将 ES6 class 类转换成 ES5 构造函数</p><blockquote><p>[JSCodeshift]</p></blockquote><p>jscodeshift是一个跑codemods的工具。codemod是一段描述AST要转化成什么样的代码。</p><blockquote><p>Prettier</p></blockquote><h4 id="node-类型"><a href="#node-类型" class="headerlink" title="node 类型"></a>node 类型</h4><p>(parameter) node:<br>Identifier | 标识符<br>SimpleLiteral |<br>RegExpLiteral |<br>Program | 程序<br>FunctionDeclaration | 函数声明<br>FunctionExpression | 函数表达式<br>ArrowFunctionExpression | 箭头函数表达式<br>SwitchCase | switch<br>CatchClause | case<br>VariableDeclarator | 可变说明符<br>ExpressionStatement | 表达式<br>BlockStatement | 块<br>EmptyStatement | 空<br>DebuggerStatement | 调试<br>WithStatement | with<br>ReturnStatement | 返回值<br>LabeledStatement |<br>BreakStatement | break<br>ContinueStatement | continus<br>IfStatement | if<br>SwitchStatement |<br>ThrowStatement | throw<br>TryStatement | try<br>WhileStatement | while<br>DoWhileStatement | dowhile<br>ForStatement | for<br>ForInStatement | for in<br>ForOfStatement | for of<br>VariableDeclaration |<br>ClassDeclaration | class<br>ThisExpression | this<br>ArrayExpression | array<br>ObjectExpression | object<br>YieldExpression | yield<br>UnaryExpression | 一元<br>UpdateExpression |<br>BinaryExpression | 二元<br>AssignmentExpression | 赋值<br>LogicalExpression | 逻辑<br>MemberExpression | 成员<br>ConditionalExpression | 条件<br>SimpleCallExpression |<br>NewExpression | new<br>SequenceExpression | 序列<br>TemplateLiteral | 模板<br>TaggedTemplateExpression |<br>ClassExpression |<br>MetaProperty |<br>AwaitExpression | await<br>Property |<br>AssignmentProperty |<br>Super |<br>TemplateElement |<br>SpreadElement |<br>ObjectPattern | 对象模式<br>ArrayPattern | 数组模式<br>RestElement |<br>AssignmentPattern |<br>ClassBody | 类主题<br>MethodDefinition | 方法定义<br>ImportDeclaration |<br>ExportNamedDeclaration |<br>ExportDefaultDeclaration |<br>ExportAllDeclaration |<br>ImportSpecifier |<br>ImportDefaultSpecifier |<br>ImportNamespaceSpecifier |<br>ExportSpecifier</p><h4 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h4><ul><li><p>代码语法检查，风格检查，代码格式化，高亮，错误提示，自动补全等<br>  JSLint、IDE功能</p></li><li><p>代码压缩<br>  UglifyJS2</p></li><li><p>优化代码<br>  CommonJS、AMD、CMD代码规范转换<br>  CoffeeScript、TypeScript、JSX转换为原生JS</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>浏览器加载资源优化</title>
      <link href="2020/08/05/%E5%89%8D%E7%AB%AF/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%E4%BC%98%E5%8C%96/"/>
      <url>2020/08/05/%E5%89%8D%E7%AB%AF/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="浏览器加载资源过程"><a href="#浏览器加载资源过程" class="headerlink" title="浏览器加载资源过程"></a>浏览器加载资源过程</h4><ol><li>将资源分类</li><li>资源安全策略检查，决定资源的加载权限</li><li>资源优先级计算和排序</li><li>根据加载优先级顺序加载资源</li></ol><h5 id="资源分类"><a href="#资源分类" class="headerlink" title="资源分类"></a>资源分类</h5><p>chrome 浏览器资源分为 14 类：</p><style>table{  border-collapse:collapse;}table th,table td{  padding: .5rem 1rem;  border:1px solid #cdcdcd;}</style><table><thead><tr><th align="center">类别</th><th align="center">介绍</th></tr></thead><tbody><tr><td align="center">kMainResource</td><td align="center">主资源，Html页面文件资源属于该类型</td></tr><tr><td align="center">kImage</td><td align="center">图片资源</td></tr><tr><td align="center">kCssStyleSheet</td><td align="center">层叠样式资源</td></tr><tr><td align="center">kScript</td><td align="center">脚本资源，即js</td></tr><tr><td align="center">kFont</td><td align="center">字体资源，即.woff</td></tr><tr><td align="center">kRaw</td><td align="center">混合类型资源，ajax请求属于该类资源</td></tr><tr><td align="center">kSVGDocument</td><td align="center">SVG矢量图资源</td></tr><tr><td align="center">kXSLStyleSheet</td><td align="center">扩展样式表</td></tr><tr><td align="center">kLinkPrefetch</td><td align="center">HTML5 页面的预读取资源，如dns-prefetch</td></tr><tr><td align="center">kTextTrack</td><td align="center">video 字幕资源，即<track>标签</td></tr><tr><td align="center">kImportResource</td><td align="center">HTML Imports，如<link href="xxx.html" rel="import"/></td></tr><tr><td align="center">kMedia</td><td align="center">多媒体资源</td></tr><tr><td align="center">kManifest</td><td align="center">应用程序缓存资源</td></tr><tr><td align="center">kMock</td><td align="center">预留的测试类型</td></tr></tbody></table><h5 id="安全策略检查"><a href="#安全策略检查" class="headerlink" title="安全策略检查"></a>安全策略检查</h5><p>Content Security Policy，即 CSP，浏览器提供的白名单制度。<br>通过配置外部资源的加载和执行限制，提高网页安全性。</p><p>常用应用：通过限制非信任域名脚本的加载来预防XSS攻击</p><blockquote><p>配置CSP的2种方式</p></blockquote><ol><li>页面HTTP请求头的Content-Security-Policy字段来限制</li><li>通过<code>&lt;meta&gt;</code>标签设置</li></ol><ul><li><p>预防XSS</p><p>  <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;script-src &#39;self&#39;; style-src nos.netease.com kaola.com;&quot;&gt;</code><br>  script-src：脚本资源<br>  style-src：样式资源<br>  ‘self’：只信任当前域名下的外部资源<br>  nos.netease.com kaola.com：信任白名单域名下的资源</p></li><li><p>站点请求协议升级（http -&gt; https）</p><p>  <code>&lt;meta http-equiv=&quot;Content-Secur****ity-Policy&quot; content=&quot;upgrade-insecure-requests&quot;&gt;</code><br>  upgrade-insecure-requests：升级所有非安全请求<br>  将http资源强制以https或wss或SSL加密形式发送请求而不报错，如果服务器不支持https等SSL加密，则资源不加载</p></li><li><p>阻止 Mixed Content</p><p>  <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;block-all-mixed-content&quot;&gt;</code></p></li></ul><p>浏览器对于可能对安全性造成较大威胁的资源类型的混合模式请求都会直接拦截报错，例如脚本资源，但对于图片、音频、视频等资源只会警告，但不会阻止其加载。</p><h5 id="资源优先级计算"><a href="#资源优先级计算" class="headerlink" title="资源优先级计算"></a>资源优先级计算</h5><p>资源优先级分级：5级</p><p>网络层面：Highest、Medium、Low、Lowest、Idle<br>浏览器内核：VeryHigh、High、Medium、Low、VeryLow<br>用户端控制台显示：Highest、High、Medium、Low、Lowest</p><blockquote><p>浏览器内核，资源优先级计算</p></blockquote><ul><li><p>资源类型设定默认优先级</p><ol><li>html、css、font 优先级最高</li><li>preload 预加载、script、xhr</li><li>图片、语言、视频</li><li>prefetch 预读取资源</li></ol></li><li><p>根据实际规则，对优先级进行调整</p><ol><li>XHR资源请求：同步XHR请求优先级最高</li><li>图片资源：默认优先级 LOW ，现代浏览器为了提高首屏体验，会将首屏资源优先级提高到 High</li><li>脚本资源：<br> defer/async属性标签的脚本的优先级会全部降为Low<br> 脚本位置是在第一张图片前，标记early<strong>，定为 High 优先级；之后标记late</strong>，设为 Medium 优先级</li></ol></li></ul><img src="https://user-gold-cdn.xitu.io/2018/1/5/160c40056cc4e9cb?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><h5 id="加载资源"><a href="#加载资源" class="headerlink" title="加载资源"></a>加载资源</h5><p>关键请求链：Critical-Request-Chains，可视区域渲染完毕（首屏），并对于用户来说可用时，必须加载的资源请求队列</p><blockquote><p>查找页面的关键请求链</p></blockquote><ol><li>首屏快照获取关键 image 资源</li><li><a href="https://developers.google.com/web/tools/lighthouse/">LightHouse</a> 插件获取关键 js、css资源</li><li>控制台查看各资源优先级</li></ol><blockquote><p>优化关键请求链</p></blockquote><ol><li>preload 和 prefetch</li></ol><p>Preload：某些资源可能将来会被使用</p><pre><code>&lt;link rel=&quot;preload&quot; href=&quot;test.jpg&quot;&gt;</code></pre><p>prefetch：资源预加载、DNS预解析、http预连接和页面预渲染</p><pre><code>资源预加载：&lt;link rel=&quot;prefetch&quot; href=&quot;test.css&quot;&gt;DNS预解析：&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//haitao.nos.netease.com&quot;&gt;http预连接：&lt;link rel=&quot;prefetch&quot; href=&quot;//www.kaola.com&quot;&gt; 将建立对该域名的TCP链接页面预渲染：&lt;link rel=&quot;prerender&quot; href=&quot;//m.kaola.com&quot;&gt; 将会预先加载链接文档的所有资源</code></pre><p>兼容性：<br>除了 dns-prefetch ，其他的兼容性十分堪忧，尤其 Safari</p><ol start="2"><li>LocalStorage</li></ol><p>资源本地缓存</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MVVM 原理</title>
      <link href="2020/08/03/Javascript/MVVM%20%E5%8E%9F%E7%90%86/"/>
      <url>2020/08/03/Javascript/MVVM%20%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h4><p>数据劫持 + 发布订阅模式</p><p>ES5中提供的 Object.defineProperty，浏览器兼容支持到 IE8+</p><blockquote><p>Object.defineProperty </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> song = <span class="string">&#x27;发如雪&#x27;</span>;</span><br><span class="line">obj.singer = <span class="string">&#x27;周杰伦&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;=== Object.defineProperty 前 ===&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;music&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">// value: &#x27;七里香&#x27;，</span></span><br><span class="line">  configurable: <span class="literal">true</span>,      <span class="comment">// 可以配置对象，删除属性</span></span><br><span class="line">  <span class="comment">// writable: true,          // 可写</span></span><br><span class="line">  enumerable: <span class="literal">true</span>,        <span class="comment">// 可枚举</span></span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;                  <span class="comment">// get,set设置时，不能设置 writable 和 value属性，两者互斥</span></span><br><span class="line">    <span class="keyword">return</span> song;           <span class="comment">// 获取 obj.music 调用 get 方法</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">set</span>(<span class="params">val</span>)</span> &#123;</span><br><span class="line">    song = val;            <span class="comment">// 将修改的值重新赋值给 song</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;=== Object.defineProperty 后 ===&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.music</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;=== 删除 music ===&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"></span><br><span class="line">obj.music = <span class="string">&#x27;听妈妈的话&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;=== 重新赋值 music ===&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;    </span><br><span class="line">    <span class="comment">// 默认情况下通过 defineProperty 定义的属性是不能被枚举(遍历)的</span></span><br><span class="line">    <span class="comment">// 需要设置 enumerable 为 true 才可以</span></span><br><span class="line">    <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`获取 obj.music：<span class="subst">$&#123;obj.music&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">obj.music = <span class="string">&#x27;夜曲&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`重新赋值后，获取 obj.music：<span class="subst">$&#123;obj.music&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><blockquote><p>输出结果</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">=== <span class="built_in">Object</span>.defineProperty 前 ===</span><br><span class="line">&#123;</span><br><span class="line">singer: <span class="string">&quot;周杰伦&quot;</span>,</span><br><span class="line"> __proto__: <span class="built_in">Object</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">=== <span class="built_in">Object</span>.defineProperty 后 ===</span><br><span class="line">&#123;</span><br><span class="line">music: <span class="string">&quot;发如雪&quot;</span>,</span><br><span class="line">singer: <span class="string">&quot;周杰伦&quot;</span>,</span><br><span class="line">get music: ƒ get(),</span><br><span class="line">set music: ƒ set(val),</span><br><span class="line">__proto__: <span class="built_in">Object</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">=== 删除 music ===</span><br><span class="line">&#123;</span><br><span class="line">singer: <span class="string">&quot;周杰伦&quot;</span>,</span><br><span class="line">__proto__: <span class="built_in">Object</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">=== 重新赋值 music ===</span><br><span class="line">singer: <span class="string">&quot;周杰伦&quot;</span></span><br><span class="line">music: <span class="string">&quot;听妈妈的话&quot;</span></span><br><span class="line">__proto__: <span class="built_in">Object</span></span><br><span class="line"></span><br><span class="line">singer</span><br><span class="line">music</span><br><span class="line"></span><br><span class="line">获取 obj.music：听妈妈的话</span><br><span class="line"></span><br><span class="line">重新赋值后，获取 obj.music：夜曲</span><br></pre></td></tr></table></figure><script>let obj = {};let song = '发如雪';obj.singer = '周杰伦';console.log('=== Object.defineProperty 前 ===')console.log(obj)Object.defineProperty(obj, 'music', {  // value: '七里香'，  configurable: true,      // 可以配置对象，删除属性  // writable: true,          // 可写  enumerable: true,        // 可枚举  get() {                  // get,set设置时，不能设置 writable 和 value属性，两者互斥    return song;           // 获取 obj.music 调用 get 方法  },  set(val) {    song = val;            // 将修改的值重新赋值给 song  }})console.log('=== Object.defineProperty 后 ===')console.log(obj);delete obj.musicconsole.log('=== 删除 music ===')console.log(obj)obj.music = '听妈妈的话'console.log('=== 重新赋值 music ===')console.log(obj)for (let key in obj) {        // 默认情况下通过 defineProperty 定义的属性是不能被枚举(遍历)的    // 需要设置 enumerable 为 true 才可以    console.log(key);}console.log(`获取 obj.music：${obj.music}`);obj.music = '夜曲';console.log(`重新赋值后，获取 obj.music：${obj.music}`);</script><h4 id="数据劫持"><a href="#数据劫持" class="headerlink" title="数据劫持"></a>数据劫持</h4><p>为什么要做数据劫持？</p><ul><li>观察对象，给对象增加 Object.defineProperty</li><li>vue 特点是不能新增不存在的属性，不存在的属性没有 get、set</li><li>深度响应，每次赋予一个新对象时会给这个新对象增加 defineProperty （数据劫持）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observe</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 数据劫持就是给对象增加 get、set</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">    <span class="keyword">let</span> val = data[key]</span><br><span class="line">    observe(val)    <span class="comment">// 递归，实现深度数据劫持</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">      configurable: <span class="literal">true</span>,</span><br><span class="line">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(val == newVal)&#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        val = newVal</span><br><span class="line">        observe(newVal)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!data || <span class="keyword">typeof</span> data !== <span class="string">&quot;object&quot;</span>) <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Observe(data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="数据编译"><a href="#数据编译" class="headerlink" title="数据编译"></a>数据编译</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mvvm</span>(<span class="params">options = &#123;&#125;</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">new</span> Compile(options.el, <span class="built_in">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Compile</span>(<span class="params">el, vm</span>)</span>&#123;</span><br><span class="line">  vm.$el = <span class="built_in">document</span>.querySelector(el)</span><br><span class="line">  <span class="keyword">let</span> fragment = <span class="built_in">document</span>.createDocumenyFragment()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(child = vm.$el.firstChild)&#123;</span><br><span class="line">    fragment.appendChild(child)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">replace</span>(<span class="params">frag</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Array</span>.from(frag.childNodes).forEach(<span class="function"><span class="params">node</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> txt = node.textContent</span><br><span class="line">      <span class="keyword">let</span> reg = <span class="regexp">/\&#123;\&#123;(.*?)\&#125;\&#125;/g</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(node.nodeType === <span class="number">3</span> &amp;&amp; reg.test(txt))&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceTxt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            node.textContent = txt.replace(reg, <span class="function">(<span class="params">matched, placeholder</span>) =&gt;</span> &#123;   </span><br><span class="line">                <span class="built_in">console</span>.log(placeholder);   </span><br><span class="line">                <span class="comment">// 匹配到的分组 如：song, album.name, singer...</span></span><br><span class="line">                <span class="keyword">new</span> Watcher(vm, placeholder, replaceTxt);   </span><br><span class="line">                <span class="comment">// 监听变化，进行匹配替换内容</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">return</span> placeholder.split(<span class="string">&#x27;.&#x27;</span>).reduce(<span class="function">(<span class="params">val, key</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> val[key]; </span><br><span class="line">                &#125;, vm);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        replaceTxt()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(node.childNodes &amp;&amp; node.childNodes.length)&#123;</span><br><span class="line">        replace(node)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  replace(fragment)</span><br><span class="line">  vm.$el.appendChild(fragment)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="发布订阅"><a href="#发布订阅" class="headerlink" title="发布订阅"></a>发布订阅</h4><p>发布订阅：主要利用数组关系，订阅就是放入函数，发布就是让数组里的函数执行</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.subs = []    <span class="comment">// 存放函数的事件池</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dep.prototype = &#123;</span><br><span class="line">  <span class="function"><span class="title">addSub</span>(<span class="params">sub</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.subs.push(sub)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">notify</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.subs.forEach(<span class="function"><span class="params">sub</span> =&gt;</span> sub.update())  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.fn = fn</span><br><span class="line">&#125;</span><br><span class="line">Watcher.prototype.update = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.fn()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="数据更新视图"><a href="#数据更新视图" class="headerlink" title="数据更新视图"></a>数据更新视图</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replace</span>(<span class="params">frag</span>)</span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  node.textContent = txt.replace(reg, val).trim()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">new</span> Watcher(vm, <span class="built_in">RegExp</span>.$1, <span class="function"><span class="params">newVal</span> =&gt;</span> &#123;</span><br><span class="line">    node.textContent = txt.replace(reg, val).trim()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span>(<span class="params">vm, exp, fn</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.fn = fn;</span><br><span class="line">  <span class="built_in">this</span>.vm = vm;</span><br><span class="line">  <span class="built_in">this</span>.exp = exp;</span><br><span class="line">  <span class="comment">// 添加一个事件</span></span><br><span class="line">  <span class="comment">// 这里我们先定义一个属性</span></span><br><span class="line">  Dep.target = <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">let</span> arr = exp.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">  <span class="keyword">let</span> val = vm;</span><br><span class="line">  arr.forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;    <span class="comment">// 取值</span></span><br><span class="line">     val = val[key]       <span class="comment">// 获取到this.a.b，默认就会调用get方法</span></span><br><span class="line">  &#125;);</span><br><span class="line">  Dep.target = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observe</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            Dep.target &amp;&amp; dep.addSub(Dep.target);   <span class="comment">// 将watcher添加到订阅事件中 [watcher]</span></span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (val === newVal) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            val = newVal;</span><br><span class="line">            observe(newVal);</span><br><span class="line">            dep.notify();   <span class="comment">// 让所有watcher的update方法执行即可</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Watcher.prototype.update = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// notify的时候值已经更改了</span></span><br><span class="line">    <span class="comment">// 再通过vm, exp来获取新的值</span></span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">this</span>.exp.split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> val = <span class="built_in">this</span>.vm;</span><br><span class="line">    arr.forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;    </span><br><span class="line">        val = val[key];   <span class="comment">// 通过get获取到新的值</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.fn(val);   <span class="comment">// 将每次拿到的新值去替换&#123;&#123;&#125;&#125;的内容即可</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://juejin.im/post/6844903586103558158">参考资料</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>懒加载实现</title>
      <link href="2020/08/03/Javascript/%E6%87%92%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0/"/>
      <url>2020/08/03/Javascript/%E6%87%92%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h4><p><code>data-src</code> 属性为真实图片路径</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;default.jpg&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;www.example.com/1.jpg&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lazy = <span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">let</span> scrTop = getTop();</span><br><span class="line"> <span class="keyword">let</span> windowHeight = <span class="built_in">document</span>.documentElement.clientHeight;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getTop</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop; </span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getOffset</span>(<span class="params">node</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> node.getBoundingClientRect().top + scrTop;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">inView</span>(<span class="params">node</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 设立阈值</span></span><br><span class="line"> <span class="keyword">const</span> threshold = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">const</span> viewTop = scrTop;</span><br><span class="line"> <span class="keyword">const</span> viewBot = viewTop + windowHeight;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> nodeTop = getOffset(node);</span><br><span class="line"> <span class="keyword">const</span> nodeBot = nodeTop + node.offsetHeight;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> offset = (threshold / <span class="number">100</span>) * windowHeight;</span><br><span class="line"> <span class="built_in">console</span>.log((nodeBot &gt;= viewTop - offset), (nodeTop &lt;= viewBot + offset))</span><br><span class="line">    <span class="keyword">return</span> (nodeBot &gt;= viewTop - offset) &amp;&amp; (nodeTop &lt;= viewBot + offset)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">node</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">let</span> el = <span class="built_in">document</span>.querySelector(node);</span><br><span class="line">   <span class="keyword">let</span> images = [...el.querySelectorAll(<span class="string">&#x27;img&#x27;</span>)];</span><br><span class="line">   images.forEach(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(inView(img))&#123;</span><br><span class="line">     img.src = img.dataset.src;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;</span><br><span class="line"> check(el);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onscroll = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> lazy(<span class="string">&#x27;.foo&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="IntersectionObserver"><a href="#IntersectionObserver" class="headerlink" title="IntersectionObserver"></a>IntersectionObserver</h4><p>可以异步监听目标元素与其祖先或视窗(viewport)处于交叉状态的方式。祖先元素与视窗(viewport)被称为根(root)</p><ul><li>root: 这是用于观察的根元素。他定义了可观察元素的基本捕获框架,默认情况下,root指向的是浏览器的视口,但实际上可以是任意的DOM元素,要注意的是：root在这种情况下,要观察元素的必选要在root代表的Dom元素内部</li></ul><img src="https://user-gold-cdn.xitu.io/2018/2/4/16160647d4a881c0?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><ul><li>rootMargin: 计算交叉时添加到根(root)边界盒bounding box的矩形偏移量， 可以有效的缩小或扩大根的判定范围从而满足计算需要。值得选项与marginCSS类似,比如rootMargin: ‘50px 20px 10px 40px’(top, right, bottom, left)</li></ul><img src="https://user-gold-cdn.xitu.io/2018/2/4/161606ab5f551732?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><ul><li>threshold: 一个包含阈值的list, 升序排列, list中的每个阈值都是监听对象的交叉区域与边界区域的比率。当监听对象的任何阈值被越过时，都会生成一个通知(Notification)。如果构造器未传入值, 则默认值为0.</li></ul><img src="https://user-gold-cdn.xitu.io/2018/2/4/161606c169087875?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><blockquote><p>使用方法</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config对象和回调函数一起传递到Observer构造函数</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  root: <span class="literal">null</span>,</span><br><span class="line">  rootMargin: <span class="string">&#x27;0px&#x27;</span>,</span><br><span class="line">  threshold: <span class="number">0.5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> observer = <span class="keyword">new</span> IntersectionObserver(<span class="function"><span class="title">fucntion</span>(<span class="params">entries, self</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 回调函数处理逻辑</span></span><br><span class="line">&#125;, config)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给 IntersectionObserver 实际观察的元素</span></span><br><span class="line"><span class="keyword">const</span> images = <span class="built_in">document</span>.querySelecttorAll(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">images.forEach(<span class="function"><span class="params">image</span> =&gt;</span> &#123;</span><br><span class="line">    observer.observe(image)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>注意事项</p></blockquote><p>观察的元素必须位于 root 代表的DOM元素中<br>IntersectionObserver 一次只能接受一个观察元素，不支持批量观察，如果观察多个元素，需要遍历分别观察</p><blockquote><p>entries </p></blockquote><p>回调函数作为Array是特殊类型：IntersectionObserverEntry </p><ul><li>rootBounds: ‘捕捉框架(root + rootMargin)’的矩形</li><li>boundClientRect: 观察元素本身的矩形</li><li>intersectionRect: 捕捉框架和观察元素相交的矩形</li></ul><p>isIntersecting： 返回观察元素是否与捕获框架相交<br>intersctionRatio：利于计算的遍历属性，返回 intersectionRect 与 boundingClientRect 的比例值.</p><h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> imgs = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;[data-src]&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  rootMargin: <span class="string">&#x27;0px&#x27;</span>,</span><br><span class="line">  threshold: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> observer = <span class="keyword">new</span> IntersectionObserver(<span class="function">(<span class="params">entries, self</span>) =&gt;</span> &#123;</span><br><span class="line">  entries.forEach(<span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (entry.isIntersecting) &#123;</span><br><span class="line">      <span class="comment">// 加载图像</span></span><br><span class="line">      preloadImage(entry.target)</span><br><span class="line">      self.unobserve(entry.target)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;, config)</span><br><span class="line"></span><br><span class="line">imgs.forEach(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span><br><span class="line">  observer.observe(img)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">preloadImage = <span class="function">(<span class="params">img</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> src = img.dataset.src</span><br><span class="line">  <span class="keyword">if</span> (!src) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">  img.src = src</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="lazyLoad"></div><style>.lazyLoad img{  width: 120px;  margin: 1rem;}</style><script>const imgsUrl = ['https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=2435648396,3879384970&fm=26&gp=0.jpg', 'https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2249871602,59311995&fm=11&gp=0.jpg'];const defaultUrl = 'https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1596523441205&di=b0cef4e6026fa8715048149b4bc83e29&imgtype=0&src=http%3A%2F%2Fimg3.imgtn.bdimg.com%2Fit%2Fu%3D2774391408%2C3578926483%26fm%3D214%26gp%3D0.jpg';const lazyele = document.getElementsByClassName('lazyLoad')[0];for(i=0; i<15; i++){  var imgEle = document.createElement('img');  imgEle.src = defaultUrl;  imgEle.dataset.src = imgsUrl[i%2];  lazyele.appendChild(imgEle)}const imgs = document.querySelectorAll('[data-src]')const config = {  rootMargin: '0px',  threshold: 0}let observer = new IntersectionObserver((entries, self) => {  entries.forEach(entry => {    if (entry.isIntersecting) {      // 加载图像      preloadImage(entry.target)      self.unobserve(entry.target)    }  })}, config)imgs.forEach(img => {  observer.observe(img)})preloadImage = (img) => {  const src = img.dataset.src  if (!src) { return; }  img.src = src}</script><h4 id="延迟加载的优点"><a href="#延迟加载的优点" class="headerlink" title="延迟加载的优点"></a>延迟加载的优点</h4><p>在优化内容加载和简化最终用户体验之间达成平衡<br>用户可以更快加载到内容，局部加载<br>网站看到更多的用户保留，不断向用户提供内容，减少用户离开网站的可能<br>网站看到较低的资源成本，按需加载内容</p><h4 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h4><p>IE和safari暂时还不支持，chrome，firefox， edge支持性良好</p><p><a href="https://github.com/w3c/IntersectionObserver/tree/master/polyfill">polyfill</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>web性能优化</title>
      <link href="2020/08/03/%E5%89%8D%E7%AB%AF/web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>2020/08/03/%E5%89%8D%E7%AB%AF/web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="度量标准"><a href="#度量标准" class="headerlink" title="度量标准"></a>度量标准</h4><blockquote><p>标准</p></blockquote><p>首次有效绘制：主要内容呈现在页面上<br>英雄渲染时间：用户最关心的内容渲染完成<br>可交互时间：页面布局稳定，关键页面字体可见，主程序可用于处理用户输入，可以交互<br>输入响应：界面响应用户输入所需时间<br>感知速度指数：页面加载视觉变化速度<br>自定义指标</p><blockquote><p>目标</p></blockquote><p>100毫秒界面响应时间与60FPS<br>速度指标小于 1250 ms<br>3G网络环境可交互时间小于5s<br>重要文件大小预算小于170kb</p><h4 id="编码优化"><a href="#编码优化" class="headerlink" title="编码优化"></a>编码优化</h4><blockquote><p>数据读取速度</p></blockquote><p>字面量与局部变量的访问速度最快，数组和对象相对较慢<br>变量从局部作用域到全局作用域的搜索过程越长速度越慢<br>对象嵌套越深，读取速度越慢<br>对象在原型链中存在位置越深，查找速度越慢</p><blockquote><p>DOM</p></blockquote><p>JS中对DOM访问的代价非常高<br>重排和重绘的代价非常高<br>善于使用事件委托</p><blockquote><p>流程控制</p></blockquote><p>避免使用 for … in (能够枚举到原型，所以慢)<br>JS 中倒序循环可以略微提升性能<br>减少迭代次数<br>基于循环的迭代比基于函数的迭代快 8 倍<br>用 Map 表代替大量的 if-else 和 switch</p><h4 id="静态资源优化"><a href="#静态资源优化" class="headerlink" title="静态资源优化"></a>静态资源优化</h4><blockquote><p>压缩</p></blockquote><p>使用Brotli或Zopfli进行纯文本压缩</p><blockquote><p>图片优化</p></blockquote><p>通过srcset，sizes 和 <picture>元素使用响应式图片。还可以通过 <picture> 元素使用 WebP 格式的图像。</p><h4 id="交付优化"><a href="#交付优化" class="headerlink" title="交付优化"></a>交付优化</h4><blockquote><p>异步无阻塞加载JS</p></blockquote><p><code>defer</code>、<code>async</code>、动态创建 script 标签、使用 XHR 异步请求 JS 代码并注入到页面</p><blockquote><p>Intersection Observer实现懒加载</p></blockquote><blockquote><p>优先加载关键的CSS</p></blockquote><p>Critical</p><blockquote><p>资源提示</p></blockquote><p>Resource Hints（资源提示）定义了HTML中的Link元素与dns-prefetch、preconnect、prefetch与prerender之间的关系</p><blockquote><p>Preload</p></blockquote><h4 id="构建优化"><a href="#构建优化" class="headerlink" title="构建优化"></a>构建优化</h4><blockquote><p>使用预编译</p></blockquote><blockquote><p>Tree-shaking、Scope hoisting、Code-spliting</p></blockquote><blockquote><p>SSR 服务端渲染</p></blockquote><blockquote><p>使用import函数动态导入模块</p></blockquote><blockquote><p>使用HTTP缓存头</p></blockquote><p>Cache-control: immutable避免重新验证</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>再聊性能优化</title>
      <link href="2020/08/03/%E5%89%8D%E7%AB%AF/%E5%86%8D%E8%81%8A%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>2020/08/03/%E5%89%8D%E7%AB%AF/%E5%86%8D%E8%81%8A%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<style>ol{  padding-left: 1.2rem;}</style><h4 id="参考指标"><a href="#参考指标" class="headerlink" title="参考指标"></a>参考指标</h4><p>白屏时间、首屏时间、整页时间、DNS时间、CPU占有率等</p><h4 id="网络传输优化"><a href="#网络传输优化" class="headerlink" title="网络传输优化"></a>网络传输优化</h4><blockquote><p>浏览器缓存</p></blockquote><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652ce6490e4d7e5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><ol><li>浏览器响应请求步骤</li></ol><p>重定向 —&gt; 拉取缓存 —&gt; DNS 查询 —&gt; 建立 TCP 连接 —&gt; 发起请求 —&gt; 接收响应 —&gt; 处理 HTML 元素 —&gt; 元素加载完成</p><ol start="2"><li>浏览器处理缓存策略</li></ol><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652ce6490fcfb58?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><p>浏览器缓存默认地址内存中，内存里的缓存会因为进程的结束或者说浏览器的关闭而被清除，而存在硬盘里的缓存才能够被长期保留下去。</p><p>network 请求的size项里：from memory cache、from disk cache</p><p>控制缓存存放位置的方法：设置服务器 ETag 字段，检查服务器响应头，是否包含 ETag 字段，有则将本次缓存写入硬盘</p><blockquote><p>资源打包压缩</p></blockquote><p>网络性能优化：减少请求数、减小请求资源体积、提高网络传输速率</p><pre><code>自动化打包推荐 webpack，Gulp和Grunt来编译node，Parcel太新</code></pre><ol><li>webpack</li></ol><p>① JS 压缩</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">    minimizer: [</span><br><span class="line">        <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">            cache: <span class="literal">true</span>,</span><br><span class="line">            parallel: <span class="literal">true</span>,</span><br><span class="line">            sourceMap: <span class="literal">true</span> <span class="comment">// set to true if you want JS source maps</span></span><br><span class="line">        &#125;),</span><br><span class="line">        ...Plugins</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>② HTML 压缩</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">new HtmlWebpackPlugin(&#123;</span><br><span class="line">    template: __dirname + &#x27;/views/index.html&#x27;,</span><br><span class="line">    filename: &#x27;../index.html&#x27;,</span><br><span class="line">    minify: &#123;</span><br><span class="line">        removeComments: true,</span><br><span class="line">        collapseWhitespace: true,</span><br><span class="line">        removeRedundantAttributes: true,</span><br><span class="line">        useShortDoctype: true,</span><br><span class="line">        removeEmptyAttributes: true,</span><br><span class="line">        removeStyleLinkTypeAttributes: true,</span><br><span class="line">        keepClosingSlash: true,</span><br><span class="line">        minifyJS: true,</span><br><span class="line">        minifyCSS: true,</span><br><span class="line">        minifyURLs: true,</span><br><span class="line">    &#125;,</span><br><span class="line">    chunksSortMode: &#x27;dependency&#x27;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>③ 提取公共资源</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">splitChunks: &#123;</span><br><span class="line">  cacheGroups: &#123;</span><br><span class="line">    vendor: &#123;                     <span class="comment">// 抽离第三方插件</span></span><br><span class="line">      test: <span class="regexp">/node_modules/</span>,       <span class="comment">// 指定是node_modules下的第三方包</span></span><br><span class="line">      chunks: <span class="string">&#x27;initial&#x27;</span>,</span><br><span class="line">      name: <span class="string">&#x27;common/vendor&#x27;</span>,      <span class="comment">// 打包后的文件名，任意命名    </span></span><br><span class="line">      priority: <span class="number">10</span>                <span class="comment">// 设置优先级，防止和自定义的公共代码提取时被覆盖，不进行打包</span></span><br><span class="line">    &#125;,</span><br><span class="line">    utils: &#123;                      <span class="comment">// 抽离自定义公共代码</span></span><br><span class="line">      test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      chunks: <span class="string">&#x27;initial&#x27;</span>,</span><br><span class="line">      name: <span class="string">&#x27;common/utils&#x27;</span>,</span><br><span class="line">      minSize: <span class="number">0</span>                  <span class="comment">// 只要超出0字节就生成一个新包</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>④ 提取CSS压缩</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [..., &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            _mode === <span class="string">&#x27;development&#x27;</span> ? <span class="string">&#x27;style-loader&#x27;</span> : MiniCssExtractPlugin.loader, &#123;</span><br><span class="line">                loader: <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    importLoaders: <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                loader: <span class="string">&#x27;postcss-loader&#x27;</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    ident: <span class="string">&#x27;postcss&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>图片资源优化</li></ol><ul><li><p>不要在HTML里缩放图片</p></li><li><p>使用雪碧图</p><p>  <a href="https://www.toptal.com/developers/css/sprite-generator">自动生成雪碧图</a></p></li></ul><p>雪碧图生成插件: webpack-spritesmith</p><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652ce64cac2c669?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><ul><li><p>使用字体图标</p><p>  icomoon：将 svg 图片自动转化成 CSS 样式</p></li><li><p>使用 WebP</p></li><li><p>网络传输性能检测工具 —— Page Speed</p></li><li><p>使用 CDN</p></li></ul><p>Linux：traceroute targetIp<br>Windows：tracert targetIp</p><p>定义用户与目标计算机之间的路由器</p><h4 id="页面渲染优化"><a href="#页面渲染优化" class="headerlink" title="页面渲染优化"></a>页面渲染优化</h4><p>Webkit技术内幕，减少重排和重绘</p><blockquote><p>浏览器解释器</p></blockquote><img src="https://user-gold-cdn.xitu.io/2018/8/12/1652ce657f301c95?imageView2/0/w/1280/h/960/format/webp/ignore-error/1"/><blockquote><p>DOM 渲染和 GPU 硬件加速</p></blockquote><p>渲染步骤：</p><ul><li><p>浏览器获取 DOM 树并依据样式将其分割成多个独立的渲染层</p></li><li><p>CPU 将每个层绘制进绘图中</p></li><li><p>将位图作为纹理上传到 GPU 显卡绘制</p></li><li><p>GPU 将所有的渲染层缓存</p></li><li><p>复合多个渲染层展示最终页面</p><p>  布局由 CPU 处理，绘制由 GPU 完成</p></li></ul><p>Layers（开启渲染层功能模块）<br>rendering（开启渲染性能监测工具）</p><p>① Paint flashing：勾选之后会对页面中发生重绘的元素高亮显示<br>② Layer borders：和我们的Layer版块功能类似，它会用高亮边界突出我们页面中的各个渲染层<br>③ FPS meter：就是开启小黑窗，用于观察我们的GPU占用率</p><ul><li>触发渲染层</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translateZ</span>(0)</span><br><span class="line"><span class="selector-tag">backface-visibility</span>: <span class="selector-tag">hidden</span></span><br></pre></td></tr></table></figure><blockquote><p>重排和重绘</p></blockquote><p>① 重排（reflow）：渲染层内的元素布局发生修改，都会导致页面重新排列，比如窗口的尺寸发生变化、删除或添加DOM元素，修改了影响元素盒子大小的CSS属性（诸如：width、height、padding）。<br>② 重绘（repaint）：绘制，即渲染上色，所有对元素的视觉表现属性的修改，都会引发重绘。</p><blockquote><p>performance 测页面重排重绘时间比</p></blockquote><p>① 蓝色部分：HTML解析和网络通信占用的时间<br>② 黄色部分：JavaScript语句执行所占用时间<br>③ 紫色部分：重排占用时间<br>④ 绿色部分：重绘占用时间</p><pre><code>重排是由CPU处理的，而重绘是由GPU处理的，CPU的处理效率远不及GPU，并且重排一定会引发重绘，而重绘不一定会引发重排</code></pre><p><a href="https://csstriggers.com/">参考表</a></p><blockquote><p>优化策略</p></blockquote><ul><li>CSS 属性操作读写分离，先读后写</li><li>通过切换 class 后者 style.csstext 批量操作元素样式</li><li>DOM 离线更新，display:none、visibility:hidden 先隐藏元素，绘制完再显示</li><li>压缩 DON 深度，少用 DOM 完成页面样式，多用伪元素</li><li>图片渲染前指定大小</li><li>对页面可能发生大量重排重绘的元素单独触发渲染层，使用 GPU 分担 CPU 压力</li></ul><h4 id="JS-阻塞性能"><a href="#JS-阻塞性能" class="headerlink" title="JS 阻塞性能"></a>JS 阻塞性能</h4><p>JavaScript Profile</p><h4 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h4><blockquote><p>Node.js处理IO密集型请求</p></blockquote><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxOTc0NzExNg==&mid=2665513044&idx=1&sn=9b8526e9d641b970ee5ddac02dae3c57&scene=21#wechat_redirect">事件驱动的运行机制</a></p><p><a href="https://www.zhihu.com/question/19653241/answer/15993549">node的优劣</a></p><blockquote><p>pm2实现Node.js“多线程”</p></blockquote><pre><code>npm i pm2 -gpm2 start pm2.json</code></pre><blockquote><p>nginx搭建反向代理</p></blockquote><p><a href="https://www.zhihu.com/question/24723688">反向代理</a></p><p>反向代理是对服务器实现负载均衡，而pm2是对进程实现负载均衡</p><p>nginx 模块：</p><ul><li>handler</li><li>filter</li><li>upstream 反向代理模块，负责完成数据的接收、处理和转发</li></ul><p>upstream配置信息：</p><ul><li>ip_hash 关键字：控制用户再次访问时是否连接到前一次连接的服务器</li><li>server关键字：真实服务器的地址</li></ul><p>server配置信息：</p><ul><li>listen关键字：服务器监听的端口</li><li>location关键字：把用户的请求分配到对应的upstream上</li></ul><p>[推荐书籍 大型网站性能监测、分析与优化（唐文）]</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端性能优化清单</title>
      <link href="2020/08/03/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%B8%85%E5%8D%95/"/>
      <url>2020/08/03/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>tree-shaking：无用代码移除</p></blockquote><p>Webpack2 引入的功能，DCE 的一个方法</p><p>tree-shaking：找到需要的代码，灌入最终结果<br>DCE：找到执行不到的代码，AST里清除</p><p><a href="https://www.zhihu.com/question/41922432">如何评价 Webpack 2 新引入的 Tree-shaking 代码优化技术？</a></p><blockquote><p>scope hoisting：作用域提升</p></blockquote><p>Webpack3 新功能，将所有模块都用函数包裹，自己实现模块加载、执行和缓存的功能。目的为了更容易实现Code Splitting(按需加载)、模块热替换</p><p><a href="https://zhuanlan.zhihu.com/p/27980441">Webpack 3 的新功能：Scope Hoisting</a></p><blockquote><p>Code Splitting：按需加载</p></blockquote><p>对于大型web应用，所有代码放在一个文件效率低下，特别是在加载一些特定环境下使用的阻塞代码时。<br>Webpack将代码分离成 Chunk，按需加载</p><p><a href="http://www.alloyteam.com/2016/02/code-split-by-routes/">Webpack中使用Code Splitting实现按需加载</a></p><blockquote><p>intersection obsercer</p></blockquote><p>目标元素和视口产生的交叉区，该 API 又叫“交叉观察器”，实现懒加载</p><p><a href="http://www.ruanyifeng.com/blog/2016/11/intersectionobserver_api.html">IntersectionObserver API 使用教程</a></p><blockquote><p>clients hints：自动响应式图片</p></blockquote><p><a href="https://cloudinary.com/blog/automatic_responsive_images_with_client_hints">Automatic responsive images with Client Hints</a></p><blockquote><p>css containment</p></blockquote><p>新的css属性，允许开发者限制浏览器样式、布局和paint工作范围</p><p><a href="https://developers.google.com/web/updates/2016/06/css-containment">CSS Containment in Chrome 52</a></p><blockquote><p>service workers</p></blockquote><p>实现离线页面，<a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">Service worker concepts and usage</a></p><pre><code>性能必须被测量、监测和完善，度量会根据设备、浏览器、协议、网络类型和延迟而显着变化（CDN，ISP，缓存，代理，防火墙，负载均衡器和服务器）</code></pre><blockquote><p>WPO Stats</p></blockquote><p><a href="https://wpostats.com/">WPO Stats</a> 发布的案例研究和实验数据，帮助提高对性能和业务前潜在关系的认识，以及性能对用户体验和业务度量的影响</p><p>目标：至少比你最快的竞争对手还快 20%</p><blockquote><p>创建预算</p></blockquote><p><a href="http://www.performancebudget.io/">性能预算计算器</a><br><a href="https://browserdiet.com/calories/">Browser Calories</a></p><p><a href="https://juejin.im/post/6844903568130965517">参考资料</a></p><h4 id="优化方案"><a href="#优化方案" class="headerlink" title="优化方案"></a>优化方案</h4><ol><li>测量实际环境的体验并设定适当的目标。一个好的目标是：第一次有意义的绘制 &lt; 1 s，速度指数 &lt; 1250，在慢速的 3G 网络上的交互 &lt; 5s，对于重复访问，TTI &lt; 2s。优化渲染开始时间和交互时间。</li><li>为您的主模板准备关键的 CSS，并将其包含在页面的 <head> 中。（你的预算是 14 KB）。对于 CSS/JS，文件大小不超过 170 KB gzipped（解压后 0.8-1 MB）。</li><li>延迟加载尽可能多的脚本，包括您自己的和第三方的脚本——特别是社交媒体按钮、视频播放器和耗时的 JavaScript 脚本。</li><li>添加资源提示，使用 dns-lookup、preconnect、prefetch 和 preload 加速传输。</li><li>分离 web 字体，并以异步方式加载它们（或切换到系统字体）。</li><li>优化图像，并在重要页面（例如登录页面）中考虑使用 WebP。</li><li>检查 HTTP 缓存头和安全头是否设置正确。</li><li>在服务器上启用 Brotli 或 Zopfli 压缩。（如果做不到，不要忘记启用 Gzip 压缩。）</li><li>如果 HTTP/2 可用，启用 HPACK 压缩并开启混合内容警告监控。如果您正在运行 LTS，也可以启用 OCSP stapling。</li><li>在 service worker 缓存中尽可能多的缓存资产，如字体、样式、JavaScript </li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端缓存实践</title>
      <link href="2020/08/03/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5/"/>
      <url>2020/08/03/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<h4 id="强缓存和协商缓存"><a href="#强缓存和协商缓存" class="headerlink" title="强缓存和协商缓存"></a>强缓存和协商缓存</h4><p>区别：使用本地缓存时，是否需要向服务器验证本地缓存的有效性。</p><blockquote><p>强缓存</p></blockquote><p>主要通过 http 请求头中的 Cache-Control 和 Expire 两个字段控制</p><p>Cache-Control = “public, max-age=xxx” 表示 xxx 秒内再次访问该资源，均使用本地缓存</p><p>问题：更新不及时，数据不一致</p><blockquote><p>协商缓存</p></blockquote><p>每次都要请求验证，缓存的意义何在？</p><p>合理使用缓存方案：</p><ul><li>HTML：使用协商缓存。</li><li>CSS&amp;JS&amp;图片：使用强缓存，文件命名带上hash值。</li></ul><h4 id="webpack-hash"><a href="#webpack-hash" class="headerlink" title="webpack hash"></a>webpack hash</h4><p>hash、chunkhash、contenthash</p><ul><li>hash：跟<code>整个项目</code>的构建相关，构建生成的文件hash值都是一样的，只要项目里有文件更改，整个项目构建的hash值都会更改。</li><li>chunkhash：根据不同的<code>入口文件</code>(Entry)进行依赖文件解析、构建对应的chunk，生成对应的hash值。</li><li>contenthash：由<code>文件内容</code>产生的hash值，内容不同产生的contenthash值也不一样。</li></ul><h4 id="ETag-计算"><a href="#ETag-计算" class="headerlink" title="ETag 计算"></a>ETag 计算</h4><p>Nginx：文件最后修改时间16进制-文件长度16进制</p><p>Express：使用 serve-static 中间件配置缓存方案</p><ol><li>文件大小和修改时间</li><li>文件内容的 hash 值和内容长度</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>伪类和伪元素</title>
      <link href="2020/08/03/Css/%E4%BC%AA%E7%B1%BB%E5%92%8C%E4%BC%AA%E5%85%83%E7%B4%A0/"/>
      <url>2020/08/03/Css/%E4%BC%AA%E7%B1%BB%E5%92%8C%E4%BC%AA%E5%85%83%E7%B4%A0/</url>
      
        <content type="html"><![CDATA[<p>伪类：<code>伪类：</code><br>伪元素：<code>伪元素：：</code></p><h4 id="伪类盒子阴影"><a href="#伪类盒子阴影" class="headerlink" title="伪类盒子阴影"></a>伪类盒子阴影</h4><p>box-shadow 属性实现盒子阴影效果，repaint 消耗较多，可以通过修改伪元素的透明度实现盒子阴影</p><p>实现原理：</p><div class="before">    <p>Before</p>    <p>Animate/transition box-shadow 可以使用box-shadow属性来实现盒子阴影效果，但重绘消耗较多</p></div> <hr /><div class="after">    <p>After</p>    <p>通过修改伪元素的透明度来实现同样的效果,没有重绘消耗</p></div><style>.before{  padding: 1em;  background-color: #fff;  transition: 0.2s;}.before:hover{  box-shadow: 0 0 10px rgba(0,0,0,.3)}.after{  position:relative;  padding: 1em;  background: #fff;}.after:before{  content: '';  position: absolute;  top: 0;  right: 0;  bottom: 0;  left: 0;  z-index: -1;  box-shadow:0 0 10px rgba(0,0,0,.3);  opacity: 0;  will-change: opacity;  transition: 0.2s;}.after:hover:before{  opacity: 1;}</style><h4 id="伪元素面包屑"><a href="#伪元素面包屑" class="headerlink" title="伪元素面包屑"></a>伪元素面包屑</h4><ul class="breadcrumb">    <li><span>Home</span></li>    <li><span>Pictures</span></li>    <li><span>Summer 15</span></li>    <li>Italy</li></ul><style>ul.breadcrumb{  padding: 8px 16px;  list-style: none;  background-color: #eee;}ul.breadcrumb li{  display: inline;}ul.breadcrumb li+li:before{  padding: 8px;  color: black;  content: ">"}ul.breadcrumb li span{  color: #0092db;  cursor:pointer;}</style><h4 id="伪元素悬停动画"><a href="#伪元素悬停动画" class="headerlink" title="伪元素悬停动画"></a>伪元素悬停动画</h4><div class="wrap"><div class="box one">    <div class="item">Buy</div></div><div class="box two">    <div class="item">Buy</div></div></div><style>@import url("https://fonts.googleapis.com/css?family=Roboto");.wrap{    display: flex;    justify-content: center;    align-items: center;    font-family: 'Roboto', sans-serif;}.box {    position: relative;    width: 120px;    height: 50px;    display: flex;    justify-content: center;    align-items: center;    margin: 15px;    color: #F27059;}.item {    text-transform: uppercase;    letter-spacing: 2px;    font-size: 14px;    z-index: 99;    display: flex;    justify-content: center;    align-items: center;    transition: 0.4s all ease;}.one:before,.one:after {    position: absolute;    content: '';    width: 100%;    height: 2px;    background: #F27059;    transition: 0.4s all ease;}.one:before {    top: 0;}.one:after {    bottom: 0;}.one .item:before,.one .item:after {    position: absolute;    top: 0;    content: '';    height: 100%;    width: 2px;    background: #F27059;    transition: 0.4s all ease;    z-index: -1;}.one .item:before {    left: 0;}.one .item:after {    right: 0;}.one:hover:before,.one:hover:after {    transition: 0.4s all ease;}.one:hover:before {    transform: translateY(-10px);}.one:hover:after {    transform: translateY(10px);}.one:hover .item {    color: white;}.one:hover .item:before,.one:hover .item:after {    width: 100%;    transition: 0.4s all ease;}.two {    box-sizing: border-box;    border: 2px solid #F27059;    position: relative;}.two:before {    position: absolute;    content: '';    width: 0;    height: 50px;    transition: 0.4s all ease;    background: #F27059;    left: 0;    z-index: -1;}.two:hover {    color: white;}.two:hover:before {    width: 100%;    transition: 0.4s all ease;}</style><h4 id="伪元素角度边界"><a href="#伪元素角度边界" class="headerlink" title="伪元素角度边界"></a>伪元素角度边界</h4><p>原理：transform: skewY(xxdeg);</p><div class="block -berry edge--bottom">    <p>Bottom Angled Edge</p></div><div class="block -blue edge--bottom--reverse">    <p>Bottom Angled Edge</p>    <p>Reversed</p></div><div class="block -berry edge--top">    <p>Top Angled Edge</p></div><div class="block -blue edge--top--reverse">    <p>Top Angled Edge</p>    <p>Reversed</p></div><div class="block -orange edge--both">    <p>Top & Bottom Angled Edges</p></div><div class="block -green edge--both--reverse">    <p>Top & Bottom Angled Edges</p>    <p>Reversed</p></div><style>.edge--bottom {    position: relative;    z-index: 1;}.edge--bottom:after {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--bottom:after {    bottom: 0;    -webkit-transform: skewY(-1.5deg);    -ms-transform: skewY(-1.5deg);    transform: skewY(-1.5deg);    -webkit-transform-origin: 100%;    -ms-transform-origin: 100%;    transform-origin: 100%;}.edge--bottom--reverse {    position: relative;    z-index: 1;}.edge--bottom--reverse:after {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--bottom--reverse:after {    bottom: 0;    -webkit-transform: skewY(1.5deg);    -ms-transform: skewY(1.5deg);    transform: skewY(1.5deg);    -webkit-transform-origin: 0 100%;    -ms-transform-origin: 0 100%;    transform-origin: 0 100%;}.edge--top {    position: relative;    z-index: 1;}.edge--top:before {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--top:before {    top: 0;    -webkit-transform: skewY(1.5deg);    -ms-transform: skewY(1.5deg);    transform: skewY(1.5deg);    -webkit-transform-origin: 100% 0;    -ms-transform-origin: 100% 0;    transform-origin: 100% 0;}.edge--top--reverse {    position: relative;    z-index: 1;}.edge--top--reverse:before {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--top--reverse:before {    top: 0;    -webkit-transform: skewY(-1.5deg);    -ms-transform: skewY(-1.5deg);    transform: skewY(-1.5deg);    -webkit-transform-origin: 0 0;    -ms-transform-origin: 0 0;    transform-origin: 0 0;}.edge--both {    position: relative;    z-index: 1;}.edge--both:before,.edge--both:after {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--both:before {    top: 0;    -webkit-transform: skewY(1.5deg);    -ms-transform: skewY(1.5deg);    transform: skewY(1.5deg);    -webkit-transform-origin: 100% 0;    -ms-transform-origin: 100% 0;    transform-origin: 100% 0;}.edge--both:after {    bottom: 0;    -webkit-transform: skewY(-1.5deg);    -ms-transform: skewY(-1.5deg);    transform: skewY(-1.5deg);    -webkit-transform-origin: 100%;    -ms-transform-origin: 100%;    transform-origin: 100%;}.edge--both--reverse {    position: relative;    z-index: 1;}.edge--both--reverse:before,.edge--both--reverse:after {    background: inherit;    content: '';    display: block;    height: 50%;    left: 0;    position: absolute;    right: 0;    z-index: -1;}.edge--both--reverse:before {    top: 0;    -webkit-transform: skewY(-1.5deg);    -ms-transform: skewY(-1.5deg);    transform: skewY(-1.5deg);    -webkit-transform-origin: 0 0;    -ms-transform-origin: 0 0;    transform-origin: 0 0;}.edge--both--reverse:after {    bottom: 0;    -webkit-transform: skewY(1.5deg);    -ms-transform: skewY(1.5deg);    transform: skewY(1.5deg);    -webkit-transform-origin: 0 0;    -ms-transform-origin: 0 0;    transform-origin: 0 0;}.-berry {    background: #b52b4a;}.-blue {    background: #41ade5;}.-orange {    background: #de6628;}.-green {    background: #5e9b42;}.block {    color: #fff;    font-family: 'Fira Sans', sans-serif;    margin: 0 0 80px;    padding: 5% 20px;    text-align: center;}p {    margin-top: 0.5em;}</style><h4 id="自动打字动画"><a href="#自动打字动画" class="headerlink" title="自动打字动画"></a>自动打字动画</h4><p class="tagline">    <span class="tagline-skill"><span class="tagline-skill_inner">webdesign</span></span></p><style>.tagline,.tagline-skill {    height: 50px;}.tagline {    font-family: "Fira Mono", monospace;    overflow: hidden;    padding: 1rem;    background-color: #666;    color: #fff;}.tagline-skill {    position: relative;    font-size: 1.5em;    padding-top: .75em;    -webkit-animation: animatetotop 6s steps(3) infinite;    animation: animatetotop 6s steps(3) infinite;}.tagline-skill_inner,.tagline-skill-overlay {    display: inline-block;}.tagline-skill_inner {    position: relative;    line-height: 1;}.tagline-skill_inner:after {    content: "";    position: absolute;    top: -1px;    right: 0;    bottom: -2px;    left: 0;    border-left: 1px solid #fff;    background-color: #666;    -webkit-animation: animatetoright 1s steps(10) infinite alternate;    animation: animatetoright 1s steps(10) infinite alternate;}@keyframes animatetoright {    0% {        left: 0;        margin-right: auto;    }    100% {        left: 100%;        margin-left: .6em;        margin-right: -.6em;    }}@keyframes animatetotop {    0% {        top: 0;    }    100% {        top: -240px;    }}</style><h4 id="背景水印"><a href="#背景水印" class="headerlink" title="背景水印"></a>背景水印</h4><div class="doc_content">    <div class="pre-headline">23 October 1983</div>    <strong>Welcome The Internet, The Nice Version</strong>    <p>Was Phileas Fogg rich? Undoubtedly. But those who knew him best could not imagine how he had made his fortune, and Mr. Fogg was the last person to whom to apply for the information. He was not lavish, nor, on the contrary, avaricious; for, whenever        he knew that money was needed for a noble, useful, or benevolent purpose, he supplied it quietly and sometimes anonymously. He was, in short, the least communicative of men. He talked very little, and seemed all the more mysterious for his taciturn        manner. His daily habits were quite open to observation; but whatever he did was so exactly the same thing that he had always done before, that the wits of the curious were fairly puzzled.</p>  <p>Had he travelled? It was likely, for no one seemed to know the world more familiarly; there was no spot so secluded that he did not appear to have an intimate acquaintance with it. He often corrected, with a few clear words, the thousand conjectures advanced by members of the club as to lost and unheard-of travellers, pointing out the true probabilities, and seeming as if gifted with a sort of second sight, so often did events justify his predictions. He must have travelled everywhere, at least in the spirit.</p></div><style>.doc_content {    width: 80%;    padding: 1rem 4rem 2rem 2rem;    background: #fff;    margin: 0.5rem;}.pre-headline {    color: #777;    letter-spacing: 0.1rem;    font-family: monospace;    font-size: 1.25rem;    text-transform: uppercase;}strong {    position: relative;    margin: 0;    font-weight: bold;    letter-spacing: -0.05rem;    line-height: 1;    text-transform: uppercase;    z-index: 10;}strong:before {    content: "2018/08";    font-family: monospace;    font-size: 10rem;    position: absolute;    top: 2rem;    left: 2rem;    z-index: 0;    line-height: 1;    color: rgba(50, 25, 0, 0.1);}</style><h4 id="伪元素页码摘要"><a href="#伪元素页码摘要" class="headerlink" title="伪元素页码摘要"></a>伪元素页码摘要</h4><ul class="pageList">    <li data-page="1">青铜-1、伪类实现盒子阴影</li>    <li data-page="2">青铜-2、伪元素:before实现的面包屑导航栏</li>    <li data-page="3">青铜-3、伪元素实现悬停时按钮填充和边界浮动动画</li>    <li data-page="4">青铜-4、伪类after实现的三角箭头</li>    <li data-page="5">青铜-5、伪类after实现的图片箭头</li>    <li data-page="6">青铜-6、伪元素实现带角度的底部边界（倾斜的边界）</li>    <li data-page="7">王者-1、伪元素和平移（translate）变换实现的提示框</li>    <li data-page="8">王者-2、使用CSS3伪元素实现的自动打字动画</li>    <li data-page="9">王者-3、CSS3 伪元素构建的文章水印背景</li>    <li data-page="10">王者-4、CSS3 用伪元素做页码摘要</li></ul><style>.pageList li {    display: flex;    flex-flow: row nowrap;    align-items: baseline;    margin: .5rem 0;    text-decoration: none;    transition: color .2s ease-in-out;}.pageList li::before {    height: .1em;    flex: 1 1 auto;    order: 1;    background: left bottom/contain repeat-x url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3IDIiPjxjaXJjbGUgZmlsbD0iI2ZmZiIgY3g9IjMuNSIgY3k9IjEiIHI9IjEiLz48L3N2Zz4=);    content: '';}.pageList li::after {    order: 2;    content: "p." attr(data-page);}.pageList li:hover,.pageList li:focus {    color: black;}</style><blockquote><p>兼容性</p></blockquote><p>IE8 不支持 CSS3 很多特性，伪元素nth-child 可以用 <code>+ 相邻元素</code> 实现<br>IE9.js 解决 IE5.5 至 IE8 CSS3的特性兼容问题</p>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSONP 原理</title>
      <link href="2020/08/01/Javascript/JSONP%20%E5%8E%9F%E7%90%86/"/>
      <url>2020/08/01/Javascript/JSONP%20%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h4 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h4><p>跨域通信的手段，原理如下：</p><ol><li>利用 script 标签的 src 属性实现跨域</li><li>通过将前端方法作为参数传递到服务端，服务端注入参数后返回，实现服务端向客户端通信</li><li>由于使用 script 标签的 src 属性，只支持 get 方法</li></ol><h4 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h4><ol><li><p>设定 script 标签</p> <script src="http://jsonp.js?callback=xxx"></script></li><li><p>callback定义了一个函数名，而远程服务端通过调用指定的函数并传入参数来实现传递参数，将fn(response)传递回客户端</p></li></ol><pre><code>$callback = !empty($_GET[&#39;callback&#39;]) ? $_GET[&#39;callback&#39;] : &#39;callback&#39;;echo $callback.&#39;(.json_encode($data).)&#39;;</code></pre><ol start="3"><li>客户端接收到返回的 js 脚本，解析执行fn(response)</li></ol><h4 id="实现示例"><a href="#实现示例" class="headerlink" title="实现示例"></a>实现示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">global</span></span>) </span>&#123; </span><br><span class="line">  <span class="keyword">var</span> id = <span class="number">0</span>,</span><br><span class="line">      container = <span class="built_in">document</span>.getElementByTagName(<span class="string">&quot;head&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">var</span> jsonp = <span class="function">(<span class="params">options</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!options || !options.url) <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> scriptNode = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>),</span><br><span class="line">        data = options.data || &#123;&#125;,</span><br><span class="line">        url = options.url,</span><br><span class="line">        callback = options.callback,</span><br><span class="line">        fnName = “jsonp” + id++</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加回调函数</span></span><br><span class="line">    data[<span class="string">&quot;callback&quot;</span>] = fnName</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 拼接 URL</span></span><br><span class="line">    <span class="keyword">var</span> params = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">      params.push(<span class="built_in">encodeURIComponent</span>(key) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(data[key]))</span><br><span class="line">    &#125;</span><br><span class="line">    url = url.indexOf(<span class="string">&quot;?&quot;</span>) &gt; <span class="number">0</span> ? (url + <span class="string">&quot;&amp;&quot;</span>) : (url + <span class="string">&quot;?&quot;</span>)</span><br><span class="line">    url += params.join(<span class="string">&quot;&amp;&quot;</span>)</span><br><span class="line">    scriptNode.src = url</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传递的是一个匿名回调，要执行的话，暴露为一个全局方法</span></span><br><span class="line">    <span class="built_in">global</span>[fnName] = <span class="function">(<span class="params">ret</span>) =&gt;</span> &#123;</span><br><span class="line">      callback &amp;&amp; callback(ret)</span><br><span class="line">      container.removeChild(scriptNode)</span><br><span class="line">      <span class="built_in">global</span>[fnName] &amp;&amp; <span class="keyword">delete</span> <span class="built_in">global</span>[fnName]</span><br><span class="line">    &#125;</span><br><span class="line">    scriptNode.onerror = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      callback &amp;&amp; callback(&#123;<span class="attr">error</span>: <span class="string">&quot;error&quot;</span>&#125;)</span><br><span class="line">      container.removeChild(scriptNode)</span><br><span class="line">      <span class="built_in">global</span>[fnName] &amp;&amp; <span class="keyword">delete</span> <span class="built_in">global</span>[fnName]</span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    scriptNode.type = <span class="string">&quot;text/javascript&quot;</span></span><br><span class="line">    container.appendChild(scriptNode)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">global</span>.jsonp = jsonp</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(<span class="built_in">this</span>)</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jsonp(&#123;</span><br><span class="line">  url: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  data: &#123;&#125;,</span><br><span class="line">  callback: <span class="function">(<span class="params">ret</span>) =&gt;</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js 趣解</title>
      <link href="2020/08/01/Javascript/Node.js%20%E8%B6%A3%E8%A7%A3/"/>
      <url>2020/08/01/Javascript/Node.js%20%E8%B6%A3%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><p>只用一个线程处理所有请求，事件驱动编程</p><p>店小二：线程<br>顾客：http请求<br>工作（迎客，找座，下单）：服务端代码，能够快速执行<br>后厨做菜，客人吃饭：耗时的I/O操作<br>后厨召唤，上菜：耗时I/O操作完成后的事件<br>客人召唤，结账：耗时I/O操作完成后的事件<br>工作（上菜，结账）：快速执行代码，需要等待耗时I/O完成；确切的说是收到系统发出的事件以后开始执行。Node.js 中实际上是回调函数中执行</p><p>Node.js 使用 javascript 作为服务器端的编程语言，使用 Chrome 的 V8 引擎执行 javascript ，效率非常高</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>URL 输入到页面展现发生了什么？</title>
      <link href="2020/08/01/Javascript/URL%20%E8%BE%93%E5%85%A5%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%8E%B0%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F/"/>
      <url>2020/08/01/Javascript/URL%20%E8%BE%93%E5%85%A5%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%8E%B0%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><p>. DNS 解析：域名解析成 IP 地址<br>. TCP 连接：TCP 三次握手<br>. 发送 HTTP 请求<br>. 服务器处理请求并返回 HTTP 报文<br>. 浏览器解析渲染页面<br>. 断开连接：TCP 四次挥手</p><h4 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h4><p>统一资源定位符，用于定位互联网上资源，网址（<a href="https://www.w3school.com.cn)/">https://www.w3school.com.cn）</a></p><p>语法规则：<br>. scheme 定义因特网服务的类型（http、https、ftp、file）<br>. host 定义域主机，默认主机 www<br>. domain 定义域名，<a href="http://www.w3school.com.cn/">www.w3school.com.cn</a><br>. port 定义端口号，默认端口 80<br>. path 定义服务器上路径（如省略，文档定位到网站根目录）<br>. filename 定义文档资源名称</p><h4 id="域名解析-DNS"><a href="#域名解析-DNS" class="headerlink" title="域名解析 DNS"></a>域名解析 DNS</h4><p>IP 地址：32位二进制数，一个逻辑地址，用以屏蔽物理地址的差异</p><p>域名：IP 地址的伪装者，作用便于记忆和沟通的一组服务器的地址</p><blockquote><p>域名解析</p></blockquote><p>DNS 协议提供通过域名和IP地址互查询服务</p><blockquote><p>浏览器如何通过域名查询 URL 对应的 IP？</p></blockquote><ol><li>浏览器缓存：浏览器按照一定的频率缓存 DNS 记录</li><li>操作系统缓存：如果浏览器缓存中找不到需要的 DNS 记录，查询操作系统缓存</li><li>路由缓存：路由器缓存 DNS 记录</li><li>ISP DNS 服务器：ISP 互联网服务提供商（Internet Service Provider）提供 DNS 查询请求</li><li>根服务器：ISP 查询不到记录，会向根服务器发出请求，进行递归查询</li></ol><h4 id="TCP-三次握手"><a href="#TCP-三次握手" class="headerlink" title="TCP 三次握手"></a>TCP 三次握手</h4><p>目的：同步客户端和服务端的序列号和确认号，交换TCP窗口大小信息，为了防止已失效的连接请求报文段突然又传送到了服务器，因而产生错误</p><p>客户端发送一个带 SYN=1，Seq=X 的数据包到服务器端口，告诉服务器我要发送请求了<br>服务器发回一个带 SYN=1，ACK=X+1，Seq=Y 的响应包以示传达确认信息，告诉浏览器准备完毕<br>客户端回传一个带 ACK=Y+1，Seq=Z的数据包，表示“握手结束”，告诉服务器准备发文</p><h4 id="HTTP-请求"><a href="#HTTP-请求" class="headerlink" title="HTTP 请求"></a>HTTP 请求</h4><p>请求报文组成：请求行（request line）、请求体（header）、请求体</p><img src="https://pic1.zhimg.com/80/v2-0004258bd5cd7513f175c093a69b8777_720w.jpg"/><ol><li>请求行包含请求方法、URL、协议版本</li></ol><p>请求方法8种：GET、POST、PUT、DELETE、PATCH、HEAD、OPTIONS、TRACE<br>URL 即请求地址，由&lt;协议&gt;：//&lt;主体&gt;：&lt;端口&gt;/&lt;路径&gt;？&lt;参数&gt;<br>协议版本即 http 版本号</p><pre><code>POST /chapter17/user.html HTTP/1.1</code></pre><ol start="2"><li>请求头</li></ol><p>附加信息，键值对，包含客户端环境和请求正文的有用信息</p><ol start="3"><li>请求体</li></ol><p>请求参数</p><h4 id="服务器处理请求并返回-HTTP-报文"><a href="#服务器处理请求并返回-HTTP-报文" class="headerlink" title="服务器处理请求并返回 HTTP 报文"></a>服务器处理请求并返回 HTTP 报文</h4><ol><li>服务器</li></ol><p>常见的 web server : apache、nginx、IIS</p><ol start="2"><li>MVC </li></ol><img src="https://pic2.zhimg.com/80/v2-0a48d53801496faece49e953bdf500ce_720w.jpg"/><ol start="3"><li>http 响应报文</li></ol><ul><li><p>响应行：协议版本、状态码、状态码描述</p><p>  1xx：提示信息<br>  2xx：成功<br>  3xx：重定向<br>  4xx：客户端错误<br>  5xx：服务端错误</p></li><li><p>响应头包含附加信息，键值对组成</p></li><li><p>响应体返回数据，不是所有响应报文都需要响应数据</p></li></ul><h4 id="浏览器解析渲染"><a href="#浏览器解析渲染" class="headerlink" title="浏览器解析渲染"></a>浏览器解析渲染</h4><img src="https://pic2.zhimg.com/80/v2-db363acb52bf35ec64bb9cf9251a7121_720w.jpg"/><p>解析步骤:</p><ol><li>根据 HTML 解析 DOM 树，根据 CSS 解析 CSS 规则树</li><li>DOM 树 结合 CSS 规则数，生成 渲染树</li><li>根据渲染树计算每一个节点的信息</li><li>根据计算好的信息绘制页面</li></ol><h4 id="断开连接"><a href="#断开连接" class="headerlink" title="断开连接"></a>断开连接</h4><p>浏览器发送报文，Fin、Ack、Seq，表示数据已经传输完，进入 FIN_WAIT_1 状态<br>服务器发送报文，Ack、Seq，同意关闭请求，主机进入 FIN_WAIT_2 状态<br>服务器发送报文段，Fin、Ack、Seq，请求关闭连接，进入 LAST_ACK 状态<br>浏览器发送报文段，Ack、Seq。进入 TIME_WAIT 状态，服务器收到报文关闭连接，浏览器等待一定时间未收到回复，正常关闭</p><h4 id="TCP-状态"><a href="#TCP-状态" class="headerlink" title="TCP 状态"></a>TCP 状态</h4><p>TCP 有个 FLAGS 字段，状态值：SYN，FIN，ACK，PSH，RST，URG</p><blockquote><p>SYN 同步序列编号，表示建立连接</p></blockquote><p>SYN 攻击属于 DDos 攻击的一种，预防技术：通过防火墙、路由器等过滤网管，通过加固 TCP/IP 协议栈</p><blockquote><p>ACK 确认字符，表示响应</p></blockquote><p>接收站发给发送站的一种传输类控制字符，表示发来的数据已确认接收无误</p><blockquote><p>Seq 数据包本身的序列号</p></blockquote><blockquote><p>PSH 表示 DATA 数据传输</p></blockquote><blockquote><p>FIN 表示关闭连接</p></blockquote><blockquote><p>RST 表示连接重置</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>call和apply</title>
      <link href="2020/08/01/Javascript/call%E5%92%8Capply/"/>
      <url>2020/08/01/Javascript/call%E5%92%8Capply/</url>
      
        <content type="html"><![CDATA[<blockquote><p>共同点</p></blockquote><p>改变函数执行时的上下文<br>调用 call 和 apply 的对象，必须是一个函数</p><h4 id="call"><a href="#call" class="headerlink" title="call"></a>call</h4><p>Function.call(obj, param1, param2, …, paramN)</p><p>注意点：</p><ol><li>调用 call，必须是函数</li><li>call 第一个参数是一个对象，function 的调用者，this 指向这个对象，不传默认为 window</li><li>第二个参数开始，接收任意个参数，每个参数映射到 function 参数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> (<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.sum = x + y * z</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func.call(&#123;&#125;, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment">// this = &#123;sum: 16&#125;</span></span><br></pre></td></tr></table></figure><h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><p>Function.apply(obj, [argArray])</p><p>注意点：<br>1.调用 apply，必须是函数，只接受两个参数<br>2.第一个参数同 call<br>3.第二个参数必须是数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys(<span class="built_in">this</span>).forEach(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>[x])</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`a + b: <span class="subst">$&#123;a + b&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print.apply(&#123;</span><br><span class="line">  <span class="string">&#x27;a&#x27;</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="string">&#x27;b&#x27;</span>: <span class="number">12</span>,</span><br><span class="line">  <span class="string">&#x27;c&#x27;</span>: <span class="number">22</span></span><br><span class="line">&#125;, [<span class="number">11</span>, <span class="number">23</span>, <span class="number">33</span>])</span><br></pre></td></tr></table></figure><blockquote><p>类数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line"> <span class="number">0</span>: <span class="number">1</span>,</span><br><span class="line"> <span class="number">1</span>: <span class="number">2</span>,</span><br><span class="line"> <span class="number">2</span>: <span class="number">3</span>,</span><br><span class="line"> length: <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>特征：<br>具备和数组特征类似的对象<br>可以索引取值，赋值<br>可以遍历<br>具有 length 属性</p><p>无法使用forEach、splice、push等数组原型链上的方法</p><h4 id="call、apply-用途"><a href="#call、apply-用途" class="headerlink" title="call、apply 用途"></a>call、apply 用途</h4><ul><li><p>call</p><p>  对象继承<br>  借用方法</p></li><li><p>apply</p><p>  Math.max<br>  实现两个数组合并</p></li></ul><h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`add: <span class="subst">$&#123;<span class="built_in">this</span>&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sub</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`sub: <span class="subst">$&#123;<span class="built_in">this</span>&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;</span><br><span class="line">add.bind(sub, <span class="number">5</span>, <span class="number">3</span>);     <span class="comment">// 这时，并不会返回 8</span></span><br><span class="line">add.bind(sub, <span class="number">5</span>, <span class="number">3</span>)();   <span class="comment">// 调用后，返回 8</span></span><br></pre></td></tr></table></figure><p>bind 返回的是函数，需要再次调用才能执行</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端监控极致化</title>
      <link href="2020/08/01/Javascript/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7%E6%9E%81%E8%87%B4%E5%8C%96/"/>
      <url>2020/08/01/Javascript/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7%E6%9E%81%E8%87%B4%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="监控方案"><a href="#监控方案" class="headerlink" title="监控方案"></a>监控方案</h4><p>通过监听全局 window.onerror 事件捕获运行时错误，上报采集端，展示结果</p><h4 id="采集"><a href="#采集" class="headerlink" title="采集"></a>采集</h4><blockquote><p>Script Error</p></blockquote><p>Script Error，浏览器对跨域错误处于安全机制考虑的一种处理方式</p><ul><li><p>跨域</p><p>  页面和页面中应用的javascript文件不同源（协议、域名、端口不一致）</p></li><li><p>避免Script Error</p><p>  crossorigin 属性，<code>&lt;script&gt;</code>标签属性<br>  crossorigin 生效需要服务端、浏览器同时支持</p></li></ul><blockquote><p>突破跨域报错限制</p></blockquote><p>服务端：</p><pre><code>CROS响应头 —— Access-Control-Allow-Origin CDN服务器</code></pre><p>浏览器：</p><img src="https://pic2.zhimg.com/v2-9e0142b5586806368cdc281e7f4c2732_r.jpg"/><pre><code>通过 Patch 原生方法捕获错误信息</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> prevSetTimeout = <span class="built_in">window</span>.setTimeout</span><br><span class="line"><span class="built_in">window</span>.setTimeout = <span class="function">(<span class="params">callback, timeout</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">return</span> prevSetTimeout(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      callback.call(<span class="built_in">this</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">throw</span> e</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, timeout)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>框架层解决方案</p></blockquote><p>AngularJS 的 ErrorHandler<br>Vue 的 Vue.config.errorHandler</p><h4 id="埋点方法"><a href="#埋点方法" class="headerlink" title="埋点方法"></a>埋点方法</h4><blockquote><p>手动埋点</p></blockquote><p>优点:<br>    1. 设置自定义属性、事件<br>    2. 精细化自定义分析</p><p>缺点：<br>    1. 工作量大，埋点位置多<br>    2. 容错率低<br>    3. 埋点成本高，数据收集周期长，效率低</p><blockquote><p>可视化埋点</p></blockquote><p>Mixpanel、TalkingData、MTA</p><p>原理：Xpath</p><blockquote><p>无埋点</p></blockquote><p>前端自动采集全部事件，上报服务端处理</p><p>优点：<br>    1. 一次性加载埋点脚本<br>缺点：<br>    1. 流量、采集数据量大<br>    2. 服务器压力大</p><p>GrowingIo，神策</p><h4 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h4><blockquote><p>日志服务进入数据处理流程前进行<code>采样率控制</code></p></blockquote><ol><li>日志写入成本低</li><li>rotate 机制保证存储不会浪费</li><li>了解真实打点请求数据量</li><li>避免采集端绕过采样率限制</li></ol><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>故障发生时能够分析原因<br>报错数高不一定是不稳定<br>异常波动一定有元凶</p><h4 id="报警"><a href="#报警" class="headerlink" title="报警"></a>报警</h4><p>规则报警，阙值配置不合理解决办法：数学模型</p><h4 id="监控分类"><a href="#监控分类" class="headerlink" title="监控分类"></a>监控分类</h4><blockquote><p>数据监控</p></blockquote><ol><li>PV/UV：页面点击量，访问站点或信息的不同IP地址人数</li><li>用户在页面停留时间</li><li>用户通过什么入口访问</li><li>用户在页面触发的行为</li></ol><blockquote><p>性能监控</p></blockquote><ol><li>（用户、机型、系统）首屏加载时间</li><li>白屏时间</li><li>http 请求响应时间</li><li>静态资源整体下载时间</li><li>页面渲染时间</li><li>页面交互时间</li></ol><blockquote><p>异常监控</p></blockquote><ol><li>javascript 异常</li><li>样式丢失异常</li></ol><h4 id="收集用户信息"><a href="#收集用户信息" class="headerlink" title="收集用户信息"></a>收集用户信息</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> params = &#123;&#125;;</span><br><span class="line">    <span class="comment">// document</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>) &#123;</span><br><span class="line">        params.domain = <span class="built_in">document</span>.domain || <span class="string">&#x27;&#x27;</span>;       <span class="comment">// 域名</span></span><br><span class="line">        params.url = <span class="built_in">document</span>.URL || <span class="string">&#x27;&#x27;</span>;             <span class="comment">// 当前 URL 地址</span></span><br><span class="line">        params.title = <span class="built_in">document</span>.title || <span class="string">&#x27;&#x27;</span>;         <span class="comment">// 当前页面标题</span></span><br><span class="line">        params.referrer = <span class="built_in">document</span>.referrer || <span class="string">&#x27;&#x27;</span>;   <span class="comment">// 上一个访问页面 URL 地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// window</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span> &amp;&amp; <span class="built_in">window</span>.screen) &#123;</span><br><span class="line">        params.sh = <span class="built_in">window</span>.screen.height || <span class="number">0</span>;       <span class="comment">// 屏幕高度</span></span><br><span class="line">        params.sw = <span class="built_in">window</span>.screen.width || <span class="number">0</span>;        <span class="comment">// 屏幕宽度</span></span><br><span class="line">        params.cd = <span class="built_in">window</span>.screen.colorDepth || <span class="number">0</span>;   <span class="comment">// 屏幕颜色深度</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// navigator</span></span><br><span class="line">    <span class="keyword">if</span>(navigator) &#123;</span><br><span class="line">        params.lang = navigator.language || <span class="string">&#x27;&#x27;</span>;      <span class="comment">// 语言</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 拼接参数</span></span><br><span class="line">    <span class="keyword">let</span> args = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> params) &#123;</span><br><span class="line">        <span class="keyword">if</span>(args !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">            args += <span class="string">&#x27;&amp;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        args += <span class="string">`<span class="subst">$&#123;i&#125;</span>=<span class="subst">$&#123;params[i]&#125;</span>`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过伪装成 Image 对象，传递给后端</span></span><br><span class="line">    <span class="keyword">let</span> img = <span class="keyword">new</span> Image(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> src = <span class="string">`http://www.funlee.cn/api/test.jpg?args=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(args)&#125;</span>`</span>;</span><br><span class="line">    img.src = src;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><h4 id="script-引入埋点"><a href="#script-引入埋点" class="headerlink" title="script 引入埋点"></a>script 引入埋点</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> hm = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    hm.type = <span class="string">&quot;text/javascript&quot;</span>;</span><br><span class="line">    hm.async = <span class="literal">true</span>;</span><br><span class="line">    hm.src = <span class="string">&quot;http://www.funlee.cn/testAnalyze.js&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;script&quot;</span>)[<span class="number">0</span>]; </span><br><span class="line">    s.parentNode.insertBefore(hm, s);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h4 id="web-阶段响应时间"><a href="#web-阶段响应时间" class="headerlink" title="web 阶段响应时间"></a>web 阶段响应时间</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timing = performance.timing,</span><br><span class="line">    start = timing.navigationStart,</span><br><span class="line">    dnsTime = <span class="number">0</span>,</span><br><span class="line">    tcpTime = <span class="number">0</span>,</span><br><span class="line">    firstPaintTime = <span class="number">0</span>,</span><br><span class="line">    domRenderTime = <span class="number">0</span>,</span><br><span class="line">    loadTime = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">dnsTime = timing.domainLookupEnd - timing.domainLookupStart;</span><br><span class="line">tcpTime = timing.connectEnd - timing.connectStart;</span><br><span class="line">firstPaintTime = timing.responseStart - start;</span><br><span class="line">domRenderTime = timing.domContentLoadedEventEnd - start;</span><br><span class="line">loadTime = timing.loadEventEnd - start;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;DNS解析时间:&#x27;</span>, dnsTime, </span><br><span class="line">            <span class="string">&#x27;\nTCP建立时间:&#x27;</span>, tcpTime, </span><br><span class="line">            <span class="string">&#x27;\n首屏时间:&#x27;</span>, firstPaintTime,</span><br><span class="line">            <span class="string">&#x27;\ndom渲染完成时间:&#x27;</span>, domRenderTime, </span><br><span class="line">            <span class="string">&#x27;\n页面onload时间:&#x27;</span>, loadTime);</span><br></pre></td></tr></table></figure><h4 id="css-埋点"><a href="#css-埋点" class="headerlink" title="css 埋点"></a>css 埋点</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.link</span><span class="selector-pseudo">:active</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">url</span>(<span class="string">&quot;http://192.168.1.110:3000/someapi?params=someInfo&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://files.alicdn.com/tpsservice/39299d06993224a40767f1d29c6345e7.pdf">参考资料</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>异常处理方法</title>
      <link href="2020/08/01/Javascript/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/"/>
      <url>2020/08/01/Javascript/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h4 id="try—catch"><a href="#try—catch" class="headerlink" title="try—catch"></a>try—catch</h4><p>只能捕获同步的运行时错误，对语法、异步错误无能为力，用来可预见情况下的特定错误监控</p><h4 id="window-onerror"><a href="#window-onerror" class="headerlink" title="window.onerror"></a>window.onerror</h4><p>JS 运行错误发生时，window 会触发一个 ErrorEvent 接口的 error 事件，并执行 window.onerror()。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">message, source, lineno, colno, error</span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">&#x27;捕获到异常：&#x27;</span>, &#123;message, source, lineno, colno, error&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>window.onerror 函数只有在返回 true 的时候，异常才不会向上抛出，写在所有 js 脚本前面，捕获意料之外的错误（静态资源错误、接口错误）</p><h4 id="addEventListener"><a href="#addEventListener" class="headerlink" title="addEventListener"></a>addEventListener</h4><p>加载资源失败时，加载资源的元素会触发 Event 接口的 error 事件，并执行该元素上的 onerror 处理函数，error 事件不会向上冒泡到 window</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;捕获到异常：&#x27;</span>, error);</span><br><span class="line">&#125;, <span class="literal">true</span>)</span><br></pre></td></tr></table></figure><p>注意点：<br>    1. 不同浏览器返回 error 对象不同，考虑兼容<br>    2. 避免 addEventListener 重复监听</p><h4 id="Promise-Catch"><a href="#Promise-Catch" class="headerlink" title="Promise Catch"></a>Promise Catch</h4><p>捕获异步 error，没有写 catch 的 Promise 抛出的错误无法被 onerror、try-catch 捕获</p><blockquote><p>漏写 catch 解决方案</p></blockquote><p>全局增加一个对 unhandledrejection 的监听，用来全局监听 Uncaught Promise Error</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;unhandledrejection&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">  e.preventDefault()                   <span class="comment">// 去掉控制台的异常显示</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;捕获到异常：&#x27;</span>, e);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="string">&#x27;promise error&#x27;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>VUE errorHandler 和 React componentDidCatch</p></blockquote><h4 id="页面崩溃"><a href="#页面崩溃" class="headerlink" title="页面崩溃"></a>页面崩溃</h4><ol><li>window 对象的 load、beforeunload</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;load&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    sessionStorage.setItem(<span class="string">&#x27;good_exit&#x27;</span>, <span class="string">&#x27;pending&#x27;</span>);</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        sessionStorage.setItem(<span class="string">&#x27;time_before_crash&#x27;</span>, <span class="keyword">new</span> <span class="built_in">Date</span>().toString());</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;beforeunload&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    sessionStorage.setItem(<span class="string">&#x27;good_exit&#x27;</span>, <span class="string">&#x27;true&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(sessionStorage.getItem(<span class="string">&#x27;good_exit&#x27;</span>) &amp;&amp;</span><br><span class="line">    sessionStorage.getItem(<span class="string">&#x27;good_exit&#x27;</span>) !== <span class="string">&#x27;true&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        insert crash logging code here</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    alert(<span class="string">&#x27;Hey, welcome back from your crash, looks like you crashed on: &#x27;</span> </span><br><span class="line">+ sessionStorage.getItem(<span class="string">&#x27;time_before_crash&#x27;</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>Service Worker</li></ol><p>特点：<br>    + 独立线程<br>    + 生命周期比网页长</p><pre><code>navigator.serviceWorker.controller.postMessage</code></pre><h4 id="错误上报"><a href="#错误上报" class="headerlink" title="错误上报"></a>错误上报</h4><ol><li><p>ajax</p></li><li><p>动态创建 img </p><p> 利用 new Image().src 实现上报，控制采集率，达到缓解服务器压力的作用</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>柯里化和反柯里化</title>
      <link href="2020/08/01/Javascript/%E6%9F%AF%E9%87%8C%E5%8C%96%E5%92%8C%E5%8F%8D%E6%9F%AF%E9%87%8C%E5%8C%96/"/>
      <url>2020/08/01/Javascript/%E6%9F%AF%E9%87%8C%E5%8C%96%E5%92%8C%E5%8F%8D%E6%9F%AF%E9%87%8C%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="Currying"><a href="#Currying" class="headerlink" title="Currying"></a>Currying</h4><p>把接受多个参数的函数变换成接受一个单一参数(最初函数的第一个参数)的函数，并且返回接受余下的参数且返回结果的新函数</p><blockquote><p>示例</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">reg, txt</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> reg.test(txt)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">check(<span class="regexp">/\d+/g</span>, <span class="string">&#x27;test&#x27;</span>)       <span class="comment">//false</span></span><br><span class="line">check(<span class="regexp">/[a-z]+/g</span>, <span class="string">&#x27;test&#x27;</span>)    <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Currying 后</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curryingCheck</span>(<span class="params">reg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">txt</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> reg.test(txt)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hasNumber = curryingCheck(<span class="regexp">/\d+/g</span>)</span><br><span class="line"><span class="keyword">var</span> hasLetter = curryingCheck(<span class="regexp">/[a-z]+/g</span>)</span><br><span class="line"></span><br><span class="line">hasNumber(<span class="string">&#x27;test1&#x27;</span>)       <span class="comment">// true</span></span><br><span class="line">hasNumber(<span class="string">&#x27;testtest&#x27;</span>)    <span class="comment">// false</span></span><br><span class="line">hasLetter(<span class="string">&#x27;21212&#x27;</span>)       <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ul><li>优缺点</li></ul><ol><li>参数复用</li><li>提前确定执行函数</li><li>延迟计算，惰性求值</li></ol><ul><li>性能</li></ul><p>存取 arguments 对象通常比存取命名参数慢<br>老版本浏览器 arguments.length 实现上相当慢<br>fn.apply()、fn.call() 比直接调用 fn()慢<br>大量嵌套作用域和闭包性能损耗</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span> (<span class="params">fn, currArgs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> args = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="comment">// 首次调用时，若未提供最后一个参数currArgs，则不用进行args的拼接</span></span><br><span class="line">    <span class="keyword">if</span> (currArgs !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">      args = args.concat(currArgs);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 递归调用</span></span><br><span class="line">    <span class="keyword">if</span> (args.length &lt; fn.length) &#123;</span><br><span class="line">      <span class="keyword">return</span> curry(fn, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 递归出口</span></span><br><span class="line">    <span class="keyword">return</span> fn.apply(<span class="literal">null</span>, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Array.prototype.slice.call(arguments)</p></blockquote><p>把 arguments 转化成数组</p><h4 id="反柯里化"><a href="#反柯里化" class="headerlink" title="反柯里化"></a>反柯里化</h4><p>一个泛型化的过程。它使得被反柯里化的函数，可以接收更多参数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Toast</span>(<span class="params">option</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.prompt = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Toast.prototype = &#123;</span><br><span class="line">  <span class="title">constructor</span>: <span class="title">Toast</span>,</span><br><span class="line">  // 输出提示</span><br><span class="line">  <span class="title">show</span>: <span class="title">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.prompt);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新对象</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  prompt: <span class="string">&#x27;新对象&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unCurrying</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">var</span> that = args.shift();</span><br><span class="line">    <span class="keyword">return</span> fn.apply(that, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> objShow = unCurrying(Toast.prototype.show);</span><br><span class="line"></span><br><span class="line">objShow(obj);</span><br></pre></td></tr></table></figure><blockquote><p>实现方式</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.unCurrying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Function</span>.prototype.call.apply(self, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> objShow = Toast.prototype.show.unCurrying();</span><br><span class="line">objShow(obj);</span><br></pre></td></tr></table></figure><blockquote><p>事件监听 柯里化</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nodeListen</span>(<span class="params">node, eventName</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    node.addEventListener(eventName, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      fn.apply(<span class="built_in">this</span>, <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>));</span><br><span class="line">    &#125;, <span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bodyClickListen = nodeListen(<span class="built_in">document</span>.body, <span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">bodyClickListen(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;first listen&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">bodyClickListen(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;second listen&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="部分应用"><a href="#部分应用" class="headerlink" title="部分应用"></a>部分应用</h4><p>部分应用函数是将一个函数转化为具有更少的元素（即更少的参数）的函数。</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>节流函数和防抖函数</title>
      <link href="2020/08/01/Javascript/%E8%8A%82%E6%B5%81%E5%87%BD%E6%95%B0%E5%92%8C%E9%98%B2%E6%8A%96%E5%87%BD%E6%95%B0/"/>
      <url>2020/08/01/Javascript/%E8%8A%82%E6%B5%81%E5%87%BD%E6%95%B0%E5%92%8C%E9%98%B2%E6%8A%96%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h4 id="节流函数"><a href="#节流函数" class="headerlink" title="节流函数"></a>节流函数</h4><p>原理：周期性定时器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> run = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">window</span>.onresize = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(!run)&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  run = <span class="literal">false</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;函数节流...&#x27;</span>)</span><br><span class="line">    run = <span class="literal">true</span></span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="防抖函数"><a href="#防抖函数" class="headerlink" title="防抖函数"></a>防抖函数</h4><p>事件触发没有结束是不会执行的，只有在事件触发结束后延迟执行一次</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;onresize...&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> handle</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(handle)</span><br><span class="line">    handle = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn()</span><br><span class="line">    &#125;, delay)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>, debounce(fun, <span class="number">500</span>))</span><br></pre></td></tr></table></figure><blockquote><p>总结：</p></blockquote><pre><code>1.防抖函数和节流函数都是用来提升性能优化及用户体验的一种方案；2.防抖函数只会执行一次，且是最后触发的那一次，而节流函数会规律性的执行多次；</code></pre>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闭包</title>
      <link href="2020/08/01/Javascript/%E9%97%AD%E5%8C%85/"/>
      <url>2020/08/01/Javascript/%E9%97%AD%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p>闭包就是一个函数，一个外部函数通过调用函数并return返回出内部函数，这里的内部函数就是一个闭包；此时在内部函数中是可以访问到外部函数的变量的；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> x = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> y = <span class="number">12</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x + y)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = a()</span><br><span class="line"><span class="comment">// a() 返回闭包函数</span></span><br><span class="line">b()</span><br><span class="line"><span class="comment">// 输出 13</span></span><br></pre></td></tr></table></figure><blockquote><p>优点</p></blockquote><p>可以读取函数内部变量<br>可以避免全局污染</p><blockquote><p>缺点</p></blockquote><p>闭包会导致变量不会被垃圾回收机制清除，消耗内存<br>不恰当的闭包会造成内存泄露</p><blockquote><p>作用域链、栈内存、堆内存</p></blockquote><table><thead><tr><th align="right">数据</th><th align="center">内存地址</th></tr></thead><tbody><tr><td align="right">变量，原始数据类型</td><td align="center"><code>栈内存</code></td></tr><tr><td align="right">引用类型</td><td align="center"><code>堆内存</code></td></tr></tbody></table><style>table{    border-collapse: collapse;    margin-bottom: 1rem;}table th, table td{    padding: .5rem 1rem;    border: 1px solid #cdcdcd;}</style>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>纯 CSS 滚动进度条效果</title>
      <link href="2020/07/31/Css/%E7%BA%AF%20CSS%20%E6%BB%9A%E5%8A%A8%E8%BF%9B%E5%BA%A6%E6%9D%A1%E6%95%88%E6%9E%9C/"/>
      <url>2020/07/31/Css/%E7%BA%AF%20CSS%20%E6%BB%9A%E5%8A%A8%E8%BF%9B%E5%BA%A6%E6%9D%A1%E6%95%88%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<div class="scroll"><div class="wrap"><blockquote><p>分析需求</p></blockquote><p>如何得知用户当前滚动页面的距离并且通知顶部进度条？</p><p>如此思考则陷入了传统思维，进度条就是进度条，接收页面滚动距离，改变宽度。如果页面滚动和进度条是一个整体呢。</p><blockquote><p>实现需求</p></blockquote><pre><code>线性渐变</code></pre><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.scroll</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20rem</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#cdcdcd</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span> <span class="selector-tag">blockquote</span>,<span class="selector-class">.wrap</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span> <span class="selector-tag">blockquote</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span>,<span class="selector-class">.wrap</span> <span class="selector-tag">pre</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent<span class="meta">!important</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">3.15rem</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">20rem</span> - .<span class="number">5rem</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to right top, #ffcc00 <span class="number">50%</span>, #eee <span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="built_in">calc</span>(<span class="number">100%</span> + <span class="number">5px</span>) <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">20.2rem</span> + <span class="number">8px</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><style>.scroll{    margin: 1rem 0;    height: 20rem;    border: 1px dashed #cdcdcd;    overflow: auto;}.wrap{    margin-top: 8px;    padding: 1rem;    position: relative; }.wrap blockquote,.wrap figure.highlight{    margin: 0!important;    padding: 0;}.wrap blockquote p {    padding-left: 1rem;}.wrap figure.highlight,.wrap pre{    background: transparent!important}.wrap::after {    content: "";    position: fixed;    top: 3.15rem;    left: 0;    width: 100%;    height: calc(20rem - .5rem);    background: #fff;    z-index: -1;}.wrap::before {    content: "";    position: absolute;    top: 0;    left: 0;    width: 100%;    height: 100%;    background-image: linear-gradient(to right top, #ffcc00 50%, #eee 50%);    background-size: calc(100% + 5px) calc(100% - 20.2rem + 8px);    background-repeat: no-repeat;    z-index: -2;}</style</div></div>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vuex axios 封装</title>
      <link href="2020/07/29/Vue/Vuex%20axios%20%E5%B0%81%E8%A3%85/"/>
      <url>2020/07/29/Vue/Vuex%20axios%20%E5%B0%81%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h4 id="request-拦截"><a href="#request-拦截" class="headerlink" title="request 拦截"></a>request 拦截</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> service = axios.create(&#123;</span><br><span class="line">  baseUrl: process.env.ENV_CONFIG</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (config.method === <span class="string">&#x27;post&#x27;</span>)&#123;</span><br><span class="line">      config.data.heep_headers = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="response-拦截"><a href="#response-拦截" class="headerlink" title="response 拦截"></a>response 拦截</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">service.interceptors.respone.use(</span><br><span class="line">  response =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (response.data.result &amp;&amp; response.data.result === <span class="string">&#x27;failed&#x27;</span>)&#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> response.data</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>axios 请求不同数据格式的处理及表单提交处理</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">urlRequest</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    transformRequest: [<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> qs.stringify(data)</span><br><span class="line">    &#125;],</span><br><span class="line">    url: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    method: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded; charset=UTF-8&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuex 详解</title>
      <link href="2020/07/29/Vue/Vuex%20%E8%AF%A6%E8%A7%A3/"/>
      <url>2020/07/29/Vue/Vuex%20%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h4 id="包含对象"><a href="#包含对象" class="headerlink" title="包含对象"></a>包含对象</h4><p>state、mutations、getters、actions</p><blockquote><p>state</p></blockquote><p>Vuex 中的数据源，可以通过 this.$store.state.变量名 访问仓库的数据源</p><blockquote><p>mutations</p></blockquote><p>通过 this.$store.commit(‘方法名’) 修改仓库中的数据源信息，<code>同步操作</code></p><blockquote><p>getters</p></blockquote><p>理解为 vue 中的 computed</p><blockquote><p>actions</p></blockquote><p>类似 mutations，<code>异步操作</code></p><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state=&#123;</span><br><span class="line">  number:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations=&#123;</span><br><span class="line">  <span class="function"><span class="title">addFunction</span>(<span class="params">state</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> state.number+=<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.$store.state.number;</span><br><span class="line"><span class="built_in">this</span>.$store.commit(<span class="string">&#x27;addFunction&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getters=&#123;</span><br><span class="line">  <span class="comment">//通过方法触发 state 是上面的 state对象，能读取state的值</span></span><br><span class="line">  <span class="function"><span class="title">addFunction</span>(<span class="params">state</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> state.number++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">this</span>.$store.getters.addFunction</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions=&#123;</span><br><span class="line">  <span class="function"><span class="title">addFunction</span>(<span class="params">context</span>)</span>&#123;</span><br><span class="line">    context.commit(<span class="string">&quot;addFunction&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">this</span>.$store.dispatch(<span class="string">&quot;addFunction&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue-router 详解</title>
      <link href="2020/07/29/Vue/vue-router%20%E8%AF%A6%E8%A7%A3/"/>
      <url>2020/07/29/Vue/vue-router%20%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>route：路由，url 地址<br>routes：route 的数组集合<br>router：路由器，管理 routes 集合中的 route</p><blockquote><p>设置路由默认值</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes=[</span><br><span class="line">  &#123;<span class="attr">path</span>:<span class="string">&#x27;/url&#x27;</span>,<span class="attr">component</span>:com&#125;,</span><br><span class="line">  &#123;<span class="attr">path</span>:<span class="string">&#x27;/url&#x27;</span>,<span class="attr">component</span>:com&#125;,</span><br><span class="line">  <span class="comment">// 可以配置重定向</span></span><br><span class="line">  &#123;<span class="attr">path</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">redirect</span>:<span class="string">&#x27;path&#x27;</span>&#125;</span><br><span class="line">  <span class="comment">// 或者重新写个路径为空的路由</span></span><br><span class="line">  &#123;<span class="attr">path</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">component</span>:path&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>用<code>重定向</code>和<code>单独配置路由</code>的<code>区别</code>：</p><p>重定向实际上是当匹配到路径符合条件的时候去执行对应的路由，当然这个时候的url上面的地址显示的是对应的路由，页面也是对应的路由页面；</p><p>重新配置路由是当匹配到路径符合条件的时候，router-view页面展示部分负责拿符合条件路由的页面来展示，实际上url是没有发生变化的；</p><h4 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">path</span>:<span class="string">&quot;/user/:name&quot;</span>,<span class="attr">component</span>:user&#125;</span><br></pre></td></tr></table></figure><h4 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path:<span class="string">&#x27;/page1&#x27;</span>,</span><br><span class="line">  component:page1,</span><br><span class="line">  children: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">&quot;phone&quot;</span>,</span><br><span class="line">      component: phone</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">&quot;computer&quot;</span>,</span><br><span class="line">      component: computer</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="路由导航方式"><a href="#路由导航方式" class="headerlink" title="路由导航方式"></a>路由导航方式</h4><blockquote><p>标签导航</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to=<span class="string">&quot;&#123; name: &#x27;user&#x27;, params: &#123; userId: 123 &#125;&#125;&quot;</span>&gt;User&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><blockquote><p>编程式导航</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通路由：</span></span><br><span class="line">router.push(&#123; <span class="attr">path</span>: <span class="string">&#x27;/user/:userId&#x27;</span>, <span class="attr">params</span>: &#123; <span class="attr">userId</span>: <span class="number">123</span> &#125;&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 命名路由：</span></span><br><span class="line">router.push(&#123; <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">params</span>: &#123; <span class="attr">userId</span>: <span class="number">123</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MyBatis 原理</title>
      <link href="2020/07/03/Java/MyBatis/"/>
      <url>2020/07/03/Java/MyBatis/</url>
      
        <content type="html"><![CDATA[<h4 id="手写-MyBatis"><a href="#手写-MyBatis" class="headerlink" title="手写 MyBatis"></a>手写 MyBatis</h4><blockquote><p>纯 MyBatis 开发步骤</p></blockquote><ol><li>读取 mybatis-config.xml 配置文件</li><li>构建 SqlSessionFactory</li><li>打开 SqlSession</li><li>获取 Mapper 接口对象</li><li>调用 Mapper 接口对象的方法操作数据库</li></ol><blockquote><p>源码流程</p></blockquote><p>寻找入口 –&gt; 断点跟踪 –&gt; 先粗后细 –&gt; 精略结合</p><h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><style>summary{  margin-left: 3rem; outline: none;  cursor: pointer;}summary:hover{  color: #c60;}center{  margin-top: 1rem;  padding: .5rem 1rem;  font-size: 1.1rem; color: red;  text-align: left;  background: #fdfdfd;  border: 1px dashed #cdcdcd;}</style><center style="margin-bottom: 1rem;">mapper</center><details>    <summary>UUserInfoMapper 接口</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接口定义执行数据库方法</span></span><br><span class="line"><span class="function">List&lt;MetaBasePO&gt; <span class="title">selectOneLayer</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;parentId&quot;)</span> Integer parentId, </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;types&quot;)</span> List&lt;String&gt; types, </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;queryWord&quot;)</span> String queryWord,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;deleted&quot;)</span> Integer deleted, </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;status&quot;)</span> Integer status, </span></span></span><br><span class="line"><span class="function"><span class="params"><span class="meta">@Param(&quot;containExtAttr&quot;)</span> <span class="keyword">boolean</span> containExtAttr</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><details>    <summary>UUserInfoMapper.xml</summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.mandalat.apolar.metadata.dao.mapper.MetaBaseMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.mandalat.apolar.common.biz.model.metadata.po.MetaBasePO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_id&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_parent_id&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">property</span>=<span class="string">&quot;parentId&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_group_id&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">property</span>=<span class="string">&quot;groupId&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_code&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;code&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_name&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_type&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;type&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_ext_attr&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;extAttr&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_owner&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;owner&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_post_to_db&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TINYINT&quot;</span> <span class="attr">property</span>=<span class="string">&quot;postToDb&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_is_deleted&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TINYINT&quot;</span> <span class="attr">property</span>=<span class="string">&quot;isDeleted&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_status&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TINYINT&quot;</span> <span class="attr">property</span>=<span class="string">&quot;status&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_sort_no&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;INTEGER&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sortNo&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_memo&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;memo&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_ctime&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TIMESTAMP&quot;</span> <span class="attr">property</span>=<span class="string">&quot;ctime&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_cuid&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;cuid&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_mtime&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;TIMESTAMP&quot;</span> <span class="attr">property</span>=<span class="string">&quot;mtime&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;m_muid&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span> <span class="attr">property</span>=<span class="string">&quot;muid&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOneLayer&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        select m_id, m_parent_id, m_group_id, m_code, m_name, m_type, m_owner,</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;containExtAttr&quot;</span>&gt;</span></span><br><span class="line">               m_ext_attr,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            m_post_to_db, m_is_deleted, m_status, m_sort_no, m_memo, m_ctime, </span><br><span class="line">m_cuid, m_mtime, m_muid from md_meta_base where m_parent_id=#&#123;parentId&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;types != null and types.size()&gt;0&quot;</span>&gt;</span></span><br><span class="line">                and m_type in</span><br><span class="line">                <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;types&quot;</span> <span class="attr">item</span>=<span class="string">&quot;type&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">                    #&#123;type&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;queryWord != null and queryWord != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                and (m_code like #&#123;queryWord&#125; or m_name like #&#123;queryWord&#125;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;deleted != null&quot;</span>&gt;</span></span><br><span class="line">                and m_deleted = #&#123;deleted&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span></span><br><span class="line">                and m_status = #&#123;status&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        order by m_sort_no</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></details><center>model</center><ul><li>数据库对象类</li></ul><center>mybatis</center><ul><li>mapping</li></ul><details>    <summary>MyConfiguration</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">MyConfiguration</span> <span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> MyEnviroment myEnviroment</span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, MapperStatement&gt; mapperStatementMap</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MyEnviroment</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 映射 mybatis-config.xml</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">MyEnviroment</span> <span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String driver</span><br><span class="line">  <span class="keyword">private</span> String url</span><br><span class="line">  <span class="keyword">private</span> String username</span><br><span class="line">  <span class="keyword">private</span> String password</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MapperStatement</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 映射 Mapper.xml</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">MapperStatement</span> <span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String namesapce</span><br><span class="line">  <span class="keyword">private</span> String id</span><br><span class="line">  <span class="keyword">private</span> String parameterType</span><br><span class="line">  <span class="keyword">private</span> String resultType</span><br><span class="line">  <span class="keyword">private</span> String sql</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li>executor</li></ul><details>    <summary>MyExecutor</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据库初始化操作</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExecutor</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> DataSource datasource</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MyExecutor</span> <span class="params">(MyConfiguration myconfig)</span></span>&#123;</span><br><span class="line">    datasource = MyDataSource.getInstance(myconfig.getMyEnvironment())</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">query</span> <span class="params">(MapperStatement mapperStatement, Object parameter)</span></span>&#123;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement preparedState = <span class="keyword">null</span>;</span><br><span class="line">    ResultSet res = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      connection = datasource.getConnection()</span><br><span class="line">      preparedState = connection.preparedStatement(mapperStatement.getSql())</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (parameter <span class="keyword">instanceof</span> Integer) &#123;</span><br><span class="line">        preparedState.setInt(<span class="number">1</span>, (Integer) parameter)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      res = preparedState.executeQuery()</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">final</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">null</span> != res &amp;&amp; <span class="keyword">null</span> != preparedState) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">          res.close()</span><br><span class="line">          preparedState.close()</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">null</span> != connection) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">          datasource.release(connection)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li>session</li></ul><details>    <summary>MySqlSession</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySqlSession</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> MyConfiguration myconfig</span><br><span class="line">  <span class="keyword">private</span> MyExecutor myexecutor</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MySqlSession</span> <span class="params">(MyConfiguration myconfig, MyExecutor myexecutor)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.myconfig = myconfig</span><br><span class="line">    <span class="keyword">this</span>.myexecutor = myexecutor</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getMapper</span><span class="params">(Class&lt;T&gt; clazz)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 动态代理对象</span></span><br><span class="line">MaperProxy maperProxy = <span class="keyword">new</span> MaperProxy(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h</span></span><br><span class="line">    <span class="keyword">return</span> (T)Proxy.newProxyInstance(clazz.getClass().getClassLoader(),</span><br><span class="line">                                          Class&lt;?&gt;[] &#123;clazz&#125;,</span><br><span class="line">                                          InvocationHandler h)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">doSomthing</span><span class="params">(<span class="keyword">int</span> args, String statementKey)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> myexecutor.query(myconfig.getMapperStatementMap().get(statementKey), args)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MySqlSessionFactory</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySqlSessionFactory</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> MyConfiguration myconfig</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MySqlSessionFactory</span><span class="params">(MyConfiguration myconfig)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.myconfig = myconfig</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> MySqlSession <span class="title">openSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">    MyExecutor myExecutor = <span class="keyword">new</span> MyExecutor(myconfig)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MySqlSession(myconfig, myExecutor)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MySqlSessionFactoryBuild</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> MySqlSessionFactory <span class="title">build</span><span class="params">(InputStream inputStream)</span></span>&#123;</span><br><span class="line">  <span class="comment">// 解析 XML</span></span><br><span class="line">  MyConfiguration myconfig = <span class="keyword">new</span> XMLConfigBuilder(inputStream).parse()</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> MySqlSessionFactory(MyConfiguration myconfig)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li>proxy</li></ul><details>    <summary>MaperProxy</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> class MaperProxy implements <span class="title">InvocationHandler</span> <span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> MySqlSession mySqlSession</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MaperProxy</span><span class="params">(MySqlSession mySqlSession)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mySqlSession = mySqlSession</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line"><span class="comment">// 实现查询方法</span></span><br><span class="line">    Class&lt;?&gt; clazz = method.getReturnType()</span><br><span class="line">    <span class="comment">// 返回类型是集合</span></span><br><span class="line">    <span class="keyword">if</span> (Collection.class.isAssignableForm(clazz)) &#123;</span><br><span class="line">      <span class="keyword">return</span> mySqlSession.doSomthing(args)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回类型是Map</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Map.class.isAssignableForm(clazz)) &#123;</span><br><span class="line">      <span class="keyword">return</span> mySqlSession.doSomthing(args)</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 返回对象</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      String statementKey = method.getDeclaringClass().getName() + <span class="string">&quot;.&quot;</span> + method.getName()</span><br><span class="line">      <span class="keyword">return</span> mySqlSession.doSomthing(statementKey, args)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li>parsing</li></ul><details>    <summary>XMLConfigBuilder</summary><pre><code>解析 XML 获取环境对象，Mapper 对象</code></pre></details><ul><li>pool</li></ul><details>    <summary>MyDataSourceInterface</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyDataSourceInterface</span> <span class="keyword">extends</span> <span class="title">DataSource</span></span>&#123;</span><br><span class="line">  <span class="comment">// 接口可以实现默认方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>MyDataSource</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDataSource</span> <span class="keyword">implements</span> <span class="title">MyDataSourceInterface</span></span>&#123;</span><br><span class="line">  <span class="comment">// 实现部分方法即可</span></span><br><span class="line">  <span class="comment">// 数据库连接池</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><center>pom.xml</center><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><center>main</center><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Resources &lt;==&gt; 类名.class.getClassLoder()</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      InputStream inputStream = Resources.getResourceAsStream(<span class="string">&#x27;mybatis-config.xml&#x27;</span>)</span><br><span class="line">      MySqlSessionFactory sqlsfactory = <span class="keyword">new</span> MySqlSessionFactoryBuild().build(inputStream)</span><br><span class="line">      MySqlSession session = sqlsfactory.openSession()</span><br><span class="line">      UUserInfoMapper uuserInfoMapper = session.getMapper(UUserInfoMapper.class)</span><br><span class="line">      UUserInfo uuserInfo = uuserInfoMapper.selectByPrimaryKey(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center>mybatis-config.xml</center><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">environments -&gt; dataSource</span><br><span class="line">mappers</span><br></pre></td></tr></table></figure><h4 id="pom-xml-说明"><a href="#pom-xml-说明" class="headerlink" title="pom.xml 说明"></a>pom.xml 说明</h4><ol><li>全局配置 project build</li></ol><details>    <summary>配置示例</summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  // 执行build任务时，没有指定目标，将使用默认值。当前配置相当于执行 mvn install</span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultGoal</span>&gt;</span>install<span class="tag">&lt;/<span class="name">defaultGoal</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  // build 目标文件的存放位置</span><br><span class="line">  <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/target<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  // build 目标文件名称</span><br><span class="line">  <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;artifactId&#125;-$&#123;version&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">filters</span>&gt;</span></span><br><span class="line">    // 将属性值应用到支持 filter 的 resources 中</span><br><span class="line">    // maven 的默认 filter 文件夹为 $&#123;basedir&#125;/src/main/filters</span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span>filters/filter1.properties<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filters</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  // 用于包含或者排除某些资源文件，描述与项目关联的文件是什么和在哪里</span><br><span class="line">  <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">      // 指定 build 后的 resource 存放的文件夹，默认 basedir</span><br><span class="line">      <span class="tag">&lt;<span class="name">targetPath</span>&gt;</span>META-INF/plexus<span class="tag">&lt;/<span class="name">targetPath</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // filter 是否激活</span><br><span class="line">      <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // 定义 resource 文件所在文件夹</span><br><span class="line">      <span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;basedir&#125;/src/main/plexus<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // 指定哪些文件将被匹配，以*作为通配符</span><br><span class="line">      <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span>&gt;</span>configuration.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // 指定哪些文件将被忽略</span><br><span class="line">      <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  // 指定使用的插件</span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-jar-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">extensions</span>&gt;</span>false<span class="tag">&lt;/<span class="name">extensions</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">inherited</span>&gt;</span>true<span class="tag">&lt;/<span class="name">inherited</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // 配置 plugin 期望得到的 properties </span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">classifier</span>&gt;</span>test<span class="tag">&lt;/<span class="name">classifier</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      // 作为 plugin 的依赖</span><br><span class="line">      <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>...<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">executions</span>&gt;</span>...<span class="tag">&lt;/<span class="name">executions</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></details><pre><code>pluginManagement &lt;plugins&gt; &#39;子 pom&#39; 直接使用 &#39;父 pom&#39; 定义的 plugin</code></pre><ol start="2"><li>配置 profile build</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">profile</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span>…<span class="tag">&lt;/<span class="name">build</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">profile</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MyBatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React+TypeScript 经验</title>
      <link href="2020/07/01/%E5%89%8D%E7%AB%AF/React+TypeScript%20%E7%BB%8F%E9%AA%8C/"/>
      <url>2020/07/01/%E5%89%8D%E7%AB%AF/React+TypeScript%20%E7%BB%8F%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><ol><li>文件顶部注释</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description <span class="variable">xxx</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@author <span class="variable">oeloowu</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@since </span>20/07/31</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ol start="2"><li>模块注释</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 拷贝数据</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>data                     源数据</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> <span class="type">&#123;&#123;isDeep = false&#125;</span>  </span>是否深拷贝，默认浅拷贝</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return <span class="type">&#123;*&#125;</span>                         </span>返回拷贝后的数据</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ol start="3"><li>业务代码注释</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 业务代码注释 */</span></span><br></pre></td></tr></table></figure><ol start="4"><li>变量注释</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface IState &#123;</span><br><span class="line">  <span class="comment">// 名字</span></span><br><span class="line">  name: string;</span><br><span class="line">  <span class="comment">// 电话</span></span><br><span class="line">  phone: number;</span><br><span class="line">  <span class="comment">// 地址</span></span><br><span class="line">  address: string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="组件引用顺序"><a href="#组件引用顺序" class="headerlink" title="组件引用顺序"></a>组件引用顺序</h4><p>先引用<code>外部组件库</code>，再引用<code>当前组件块级组件</code>，然后<code>common公共函数</code>，最后<code>css样式</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;Dropdown, Menu, Icon&#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">&#x27;./Header&#x27;</span></span><br><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;common/toast&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.less&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="引号使用"><a href="#引号使用" class="headerlink" title="引号使用"></a>引号使用</h4><p>单引号，ES6 反引号 `</p><h4 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h4><ol><li><p>缩进使用两个空格</p></li><li><p>二元和三元运算符两侧必须有一个空格，一元运算符与操作对象之间不允许有空格</p><p> <code>++x</code><br> <code>y--</code><br> <code>z = x ? 1: 2</code></p></li><li><p>代码块起始左花括号<code>｛</code>前必须有一个空格</p></li><li><p>对象创建，属性<code>：</code>后面必须有空格，前面不予许有空格</p></li></ol><h4 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h4><p>以下关键字后必须有大括号，即使代码只有一行：if、else、for、while、do、switch、try、catch、finally、with</p><h4 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h4><ul><li>类名：大驼峰风格</li><li>函数名：小驼峰风格</li><li>变量名：同函数名</li><li>常量：全大写风格，单词之间下划线分隔</li><li>使用 onXxx 形式作为 props 中用于回调的属性名称</li><li>组件内事件函数使用 handle 开头，<code>handleCheckBtn</code></li><li>使用 withXxx 作为高阶组件的名称</li><li>接口命名前面带上I，<code>interfase IProps()</code></li></ul><h4 id="interface-声明顺序"><a href="#interface-声明顺序" class="headerlink" title="interface 声明顺序"></a>interface 声明顺序</h4><p>只读参数 -&gt; 必选参数 -&gt; 可选参数 -&gt; 不确定参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface IPeople &#123;</span><br><span class="line">  readonly x: number;</span><br><span class="line">  readonly y: number;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number;</span><br><span class="line">  height?: number;</span><br><span class="line">  [propName: string]: any;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="TS-相关工具泛型、tips"><a href="#TS-相关工具泛型、tips" class="headerlink" title="TS 相关工具泛型、tips"></a>TS 相关工具泛型、tips</h4><ul><li>Record&lt;string, any&gt; 声明对象结构的类型</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people:Record&lt;string, any&gt; = &#123;</span><br><span class="line">  name: <span class="string">&#x27;oeloowu&#x27;</span>,</span><br><span class="line">  age: <span class="number">10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Partial 将传入的属性变为可选项</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people:Partial&lt;IPeople&gt; = &#123;</span><br><span class="line">  name: <span class="string">&#x27;oeloowu&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义的结构可以是接口的任意 key</span></span><br></pre></td></tr></table></figure><ul><li>Readonly 将传入的属性变为只读</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people:Readonly&lt;IPeople&gt; = &#123;</span><br><span class="line">  name: <span class="string">&#x27;oeloowu&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Required 将传入的属性变为必选项</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people:Require&lt;IPeople&gt; = &#123;</span><br><span class="line">  name: <span class="string">&#x27;oeloowu&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Error: property &#x27;height&#x27; missing</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/Microsoft/TypeScript-Handbook/diffs/0?base_sha=22b37a2d8c9a1dd378795444baf954c2e7ecccf5&commentable=true&head_user=csantos42&pull_number=801&sha1=22b37a2d8c9a1dd378795444baf954c2e7ecccf5&sha2=9d4c56f5d414dbe23780719885baa3df40222412&short_path=0b2da51&unchanged=expanded&utf8=%E2%9C%93#requiredt">查看更多</a></p><ul><li>keyof</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">type T = keyof IPeople</span><br><span class="line"><span class="comment">// 输出 IPeople keys</span></span><br><span class="line"></span><br><span class="line">type Keys = <span class="string">&quot;a&quot;</span> | <span class="string">&quot;b&quot;</span></span><br><span class="line">type Obj =  &#123;</span><br><span class="line">  [p <span class="keyword">in</span> Keys]: any</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// -&gt; &#123; a: any, b: any &#125;</span></span><br></pre></td></tr></table></figure><h4 id="稳健性判断"><a href="#稳健性判断" class="headerlink" title="稳健性判断"></a>稳健性判断</h4><p>增加必要的判断，提高代码的稳健性，如：非空，数组.xx，对象.xx.xx 等</p><h4 id="判断真假"><a href="#判断真假" class="headerlink" title="判断真假"></a>判断真假</h4><p>js 中，false、null、undefined、0、’’、NaN 为 false，其他均为真</p><h4 id="常用属性缓存"><a href="#常用属性缓存" class="headerlink" title="常用属性缓存"></a>常用属性缓存</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, time&#125; = <span class="built_in">this</span>.props</span><br></pre></td></tr></table></figure><h4 id="阻止默认行为"><a href="#阻止默认行为" class="headerlink" title="阻止默认行为"></a>阻止默认行为</h4><p>React 中不能通过返回 false 阻止默认行为，必须明确调用 preventDefault</p><h4 id="hasOwnProperty-判断"><a href="#hasOwnProperty-判断" class="headerlink" title="hasOwnProperty 判断"></a>hasOwnProperty 判断</h4><p>for … in 中一定要有 hasOwnProperty 判断，即禁止直接读取原型对象的属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  name: <span class="string">&#x27;oeloowu&#x27;</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sexy: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = []</span><br><span class="line"><span class="keyword">for</span> (key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">    arr.push(obj[key]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Event-事件对象类型"><a href="#Event-事件对象类型" class="headerlink" title="Event 事件对象类型"></a>Event 事件对象类型</h4><p>ClipboardEvent&lt;T = Element&gt;     剪贴板事件对象<br>DragEvent&lt;T = Element&gt;          拖拽事件对象<br>ChangeEvent&lt;T = Element&gt;        Change 事件对象<br>KeyboardEvent&lt;T = Element&gt;      键盘事件对象<br>MouseEvent&lt;T = Element&gt;         鼠标事件对象<br>TouchEvent&lt;T = Element&gt;         触摸事件对象<br>WheelEvent&lt;T = Element&gt;         滚轮事件对象<br>AnimationEvent&lt;T = Element&gt;     动画事件对象<br>TransitionEvent&lt;T = Element&gt;    过渡事件对象</p><h4 id="代码颗粒度"><a href="#代码颗粒度" class="headerlink" title="代码颗粒度"></a>代码颗粒度</h4><p>工具函数 和 业务逻辑 抽离<br>表单校验 和 业务逻辑 抽离<br>事件函数 和 业务逻辑 抽离<br>ajax 和 业务逻辑 抽离</p><h4 id="其他规范"><a href="#其他规范" class="headerlink" title="其他规范"></a>其他规范</h4><p>不要使用 var 声明变量<br>不会被修改的变量使用 const 声明<br>去除声明但未使用的代码<br>禁止代码中使用 debug<br>不允许空代码块<br>input 输入框 trim()<br>location 跳转前需要先转义，<code>window.location.href = redirectUrl + encodeURIComponent(&#39;?a=10&amp;b=20&#39;);</code><br>调用第三方库，try catch 包裹，防止第三方库出错</p><blockquote><p>a 标签安全问题</p></blockquote><p>window.opener（.location） 访问原始页面的 location 对象</p><pre><code>target=&quot;_blank&quot; 标签加上 rel = &quot;noopener&quot;</code></pre><p>window.open 打开的页面，将 opener 对象置空</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> windowObj = <span class="built_in">window</span>.open();</span><br><span class="line">windowObj.opener = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端架构</title>
      <link href="2020/07/01/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/"/>
      <url>2020/07/01/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h4 id="软件架构"><a href="#软件架构" class="headerlink" title="软件架构"></a>软件架构</h4><p>不以实现为目的的架构，都是无意义的。</p><blockquote><p>系统架构的基本判断 </p></blockquote><pre><code>1. 无法上线的应用架构，算不上好的软件架构2. 没人能完成开发的软件架构，算不上具有可行性的软件架构3. 在现有技术上不可行的架构，算不上合理的软件架构</code></pre><blockquote><p>软件架构参与人员</p></blockquote><p>实施者、维护者：系统可以以预计的方式构建<br>实施规范、原则：系统可以按预期的方式实施项目</p><blockquote><p>包含内容</p></blockquote><ul><li>系统之间的关系</li><li>系统内的关系</li><li>应用内架构</li><li>规范和原则</li></ul><blockquote><p>收集架构需求</p></blockquote><p>了解相关者的利益<br>寻找架构关注点<br>明确跨功能需求<br>罗列技术风险点</p><h4 id="架构风格"><a href="#架构风格" class="headerlink" title="架构风格"></a>架构风格</h4><blockquote><p>分层架构</p></blockquote><p>OSI 七层模型<br>TCO/IP 五层模型</p><blockquote><p>MVC 架构</p></blockquote><blockquote><p>发布-订阅风格</p></blockquote><blockquote><p>管理-过滤器</p></blockquote><h4 id="架构开发方法"><a href="#架构开发方法" class="headerlink" title="架构开发方法"></a>架构开发方法</h4><blockquote><p>4+1 视图法</p></blockquote><p>逻辑视图：设计期的模块、接口划分，职责及协作方式等<br>流程视图：运行期的运行数据同步<br>开发视图：开发期的框架、库、技术选型及对应的编译<br>物理视图：部署视图，在部署期与持续交付相关的技术决策<br>场景：用例视图</p><blockquote><p>TOGAF及ADM</p></blockquote><p>TOGAF：开放组体系结构框架</p><ul><li><p>架构域</p><p>  业务架构<br>  应用架构<br>  数据架构<br>  技术架构</p></li></ul><p>ADM：创建企业级架构,8个阶段 A-H</p><p>架构上下文：【预备阶段、架构远景（A）】<br>架构交付：【业务架构（B）、信息系统架构（C）、技术架构（D）】<br>迁移计划：【机会及解决方案（E）、迁移计划（F）】<br>架构治理：【实施治理（G）、架构变更管理（H）】</p><h4 id="架构产物"><a href="#架构产物" class="headerlink" title="架构产物"></a>架构产物</h4><p>架构图、迭代计划、技术栈及选型、示例代码、测试策略、部署方式、持续集成方式</p><h4 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h4><p>不多不少、演进式、持续性</p><p>对于低级别设计：尽量避免进入细节设计，宝贵的资源投入到业务开发<br>对于高级别设计：不预先设计模块和组件，仅从架构考虑，即为未来预留扩展的空间</p><pre><code>适配器、代理模式对第三方组件进行二次封装</code></pre><p>敏捷开发：适应用户不断变化的需求<br>瀑布模式：完全计划式设计</p><p>20% 计划式设计，80% 演进式设计</p><p><strong>延迟决策</strong></p><h4 id="前端架构"><a href="#前端架构" class="headerlink" title="前端架构"></a>前端架构</h4><p>构建工具：Grunt、Gulp<br>包管理工具：Bower、NPM<br>模块管理：ADM、Common.js</p><blockquote><p>微前端</p></blockquote><p>跨框架、应用拆分、遗留系统迁移</p><blockquote><p>架构设计层级</p></blockquote><p>系统级：前后端分离、微前端<br>应用级：模块库、组件库、设计系统<br>模块级：组件化、模块化<br>代码级：规范、原则、质量</p><blockquote><p>技术架构实施</p></blockquote><pre><code>质量、能力、进度</code></pre><p>技术准备期</p><p>架构设计、概念验证POC、迭代0（搭建完整环境）</p><p>业务回补期<br>成长优化期</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Spark 基础</title>
      <link href="2020/06/28/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/Spark/"/>
      <url>2020/06/28/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/Spark/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>类 Hadoop MapReduce 通用并行框架，大数据处理计算引擎<br>Job 中间输出结果可以保存在内存中</p><p>Spark 将 Scala 作为应用程序框架<br>Spark 通过 Mesos 第三方集群框架，可以在 Hadoop 文件系统中并行运行</p><blockquote><p>特点</p></blockquote><ol><li>Java、Scala、Python 和 R APIs。</li><li>可扩展至超过 8000 个结点。</li><li>能够在存储器内缓存数据集以进行交互式数据分析。</li><li>Scala 或 Python 中的交互式命令行接口可降低横向扩展数据探索的反应时间。</li><li>Spark Streaming 对即时数据流的处理具有可扩展性、高吞吐量、可容错性等特点。</li><li>Spark SQL 支持结构化和关系式查询处理（SQL）。</li><li>MLlib 机器学习算法和 Graphx 图形处理算法的高端库。</li></ol><blockquote><p>性能</p></blockquote><ol><li><p>更快的速度</p><p> 内存计算，Spark比Hadoop快100倍</p></li><li><p>易用性</p><p> 80多个高级运算符</p></li><li><p>通用性</p><p> Spark Core（离线计算），Spark Sql（交互式查询），Spark Streaming（实时流式计算），MLlib（机器学习），Graphx（图计算）</p></li><li><p>支持多种资源管理器</p><p> Hadoop YARN，Mesos</p></li></ol><blockquote><p>存储文件格式</p></blockquote><p>列存储：parquet，ORC<br>行存储：Avro，JSON，CSV，Text，Binary</p><p>Spark 可以和 Alluxio, HDFS、 Cassandra 、OpenStack Swift 和 Amazon S3 等接口搭载</p><blockquote><p>支持 Hive 特性</p></blockquote><p>Hive的查询，包括：SELECT, GROUP BY, ORDER BY, CLUSTER BY, STORT BY<br>所有的Hive操作，包括：关系操作符，如 =, &lt;=&gt;, ==, &lt;&gt;, &lt;, &gt;, &gt;=, &lt;= 等 ( 这里的&lt;=&gt;操作比较罕见，相当于ifnull(a!=b, false)，比如 1&lt;=&gt;2 值为false, 1&lt;=&gt;1 值为true )；数学运算符，如 +, -, *, /, %等；逻辑操作符，如 AND, &amp;&amp;, OR, || 等；复杂构造器；数学函数，如 sign, ln, cos 等；字符串函数，如 instr, length, printf。<br>用户自定义函数， UDF<br>用户自定义聚合函数，UDAF<br>用户自定义序列化格式，SerDes<br>窗口函数<br>关联操作，如 JOIN, {LEFT | RIGHT | FULL} OUTER JOIN, LEFT SEMI JOIN, CROSS JOIN<br>合并操作<br>子查询，如 SELECT col FROM (SELECT a+b AS col from t1) t2<br>抽样 sample<br>解释执行计划 explain<br>分区表 以及 动态分区插入<br>视图 VIEW<br>DDL函数，如 CREATE TABLE, CREATE TABLE AS SELECT, ALTER TABLE<br>支持大部分Hive的数据类型，包含：TINYINT, SMALLINT, INT, BIGINT, BOOLEAN, FLOAT, DOUBLE, STRING, BINARY, TIMESTAMP, DATE, ARRAY&lt;&gt;, MAP&lt;&gt;, STRUCT&lt;&gt;</p>]]></content>
      
      
      <categories>
          
          <category> Spark </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 源码阅读</title>
      <link href="2020/06/18/Vue/Vue%20%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
      <url>2020/06/18/Vue/Vue%20%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vue-js.com/learn-vue/reactive/array.html">源码中文社区</a></p><h4 id="源码内容"><a href="#源码内容" class="headerlink" title="源码内容"></a>源码内容</h4><p>config</p><pre><code>optionMergeStrategiessilent: falseproductionTip: truedevtools: trueperformance: falseerrorHandler: nullwarnHandler: nullignoredElements: []keyCodes: &#123;&#125;isReservedTag: ƒ (a, b, c)isReservedAttr: ƒ (a, b, c)isUnknownElement: ƒ (a, b, c)getTagNamespace: ƒ noop(a, b, c)parsePlatformTagName: ƒ (_)mustUseProp: ƒ (a, b, c)_lifecycleHooks: (10) [&quot;beforeCreate&quot;, &quot;created&quot;, &quot;beforeMount&quot;, &quot;mounted&quot;, &quot;beforeUpdate&quot;, &quot;updated&quot;, &quot;beforeDestroy&quot;, &quot;destroyed&quot;, &quot;activated&quot;, &quot;deactivated&quot;]</code></pre><p>warn、tip、formatComponentName、repeat、generateComponentTrace</p><p>判断浏览器环境</p><pre><code>var inBrowser = typeof window !== &#39;undefined&#39;;var UA = inBrowser &amp;&amp; window.navigator.userAgent.toLowerCase();var isIE = UA &amp;&amp; /msie|trident/.test(UA);var isIE9 = UA &amp;&amp; UA.indexOf(&#39;msie 9.0&#39;) &gt; 0;var isEdge = UA &amp;&amp; UA.indexOf(&#39;edge/&#39;) &gt; 0;var isAndroid = UA &amp;&amp; UA.indexOf(&#39;android&#39;) &gt; 0;var isIOS = UA &amp;&amp; /iphone|ipad|ipod|ios/.test(UA);var isChrome = UA &amp;&amp; /chrome\/\d+/.test(UA) &amp;&amp; !isEdge;</code></pre><p>new _Set()</p><pre><code>has: ƒ has()add: ƒ add()delete: ƒ delete()clear: ƒ clear()entries: ƒ entries()forEach: ƒ forEach()values: ƒ values()keys: ƒ values()</code></pre><p>new Dep()</p><pre><code>id: 2subs: []__proto__:    addSub: ƒ addSub(sub)    removeSub: ƒ removeSub(sub)    depend: ƒ depend()    notify: ƒ notify()</code></pre><p>strats = config.optionMergeStrategies</p><pre><code>propsData: ƒ (parent, child, vm, key)el: ƒ (parent, child, vm, key)data: ƒ ( parentVal, childVal, vm )beforeCreate: ƒ mergeHook( parentVal, childVal )created: ƒ mergeHook( parentVal, childVal )beforeMount: ƒ mergeHook( parentVal, childVal )mounted: ƒ mergeHook( parentVal, childVal )beforeUpdate: ƒ mergeHook( parentVal, childVal )updated: ƒ mergeHook( parentVal, childVal )beforeDestroy: ƒ mergeHook( parentVal, childVal )destroyed: ƒ mergeHook( parentVal, childVal )activated: ƒ mergeHook( parentVal, childVal )deactivated: ƒ mergeHook( parentVal, childVal )components: ƒ mergeAssets(parentVal, childVal)directives: ƒ mergeAssets(parentVal, childVal)filters: ƒ mergeAssets(parentVal, childVal)watch: ƒ (parentVal, childVal)computed: ƒ (parentVal, childVal)inject: ƒ (parentVal, childVal)methods: ƒ (parentVal, childVal)props: ƒ (parentVal, childVal)provide: ƒ mergeDataOrFn( parentVal, childVal, vm )</code></pre><p>perf = inBrowser &amp;&amp; window.performance;</p><p>VNode</p><pre><code>tag: undefineddata: undefinedchildren: undefinedtext: undefinedelm: undefinedns: undefinedcontext: undefinedfunctionalContext: undefinedkey: undefinedcomponentOptions: undefinedcomponentInstance: undefinedparent: undefinedraw: falseisStatic: falseisRootInsert: trueisComment: falseisCloned: falseisOnce: falseasyncFactory: undefinedasyncMeta: undefinedisAsyncPlaceholder: false</code></pre><p>Watcher</p><p>componentVNodeHooks</p><pre><code>initprepatchinsertdestroy</code></pre><p>initMixin</p><pre><code>_init    initLifecycle(vm);    initEvents(vm);    initRender(vm);    callHook(vm, &#39;beforeCreate&#39;);    initInjections(vm);    initState(vm);    initProvide(vm);    callHook(vm, &#39;created&#39;);    ...    vm.$mount(vm.$options.el);</code></pre><p>stateMixin</p><pre><code>$data、$props、$set、$delete 、$watch</code></pre><p>eventsMixin</p><pre><code>$on、$once、$off、$emit</code></pre><p>lifecycleMixin</p><pre><code>_update、$forceUpdate、$destroy</code></pre><p>renderMixin</p><pre><code>$nextTick、_renderVue.prototype._o = markOnce;Vue.prototype._n = toNumber;Vue.prototype._s = toString;Vue.prototype._l = renderList;Vue.prototype._t = renderSlot;Vue.prototype._q = looseEqual;Vue.prototype._i = looseIndexOf;Vue.prototype._m = renderStatic;Vue.prototype._f = resolveFilter;Vue.prototype._k = checkKeyCodes;Vue.prototype._b = bindObjectProps;Vue.prototype._v = createTextVNode;Vue.prototype._e = createEmptyVNode;Vue.prototype._u = resolveScopedSlots;Vue.prototype._g = bindObjectListeners;</code></pre><p>KeepAlive</p><pre><code>name: &quot;keep-alive&quot;abstract: trueprops: &#123;include: Array(3), exclude: Array(3)&#125;created: ƒ created()destroyed: ƒ destroyed()watch: &#123;include: ƒ, exclude: ƒ&#125;render: ƒ render()</code></pre><p>builtInComponents = {<br>    KeepAlive: KeepAlive<br>}</p><p>initGlobalAPI</p><pre><code>initUse(Vue);initMixin$1(Vue);initExtend(Vue);initAssetRegisters(Vue);</code></pre><p>nodeOps</p><pre><code>createElement: ƒ createElement$1(tagName, vnode)createElementNS: ƒ createElementNS(namespace, tagName)createTextNode: ƒ createTextNode(text)createComment: ƒ createComment(text)insertBefore: ƒ insertBefore(parentNode, newNode, referenceNode)removeChild: ƒ removeChild(node, child)appendChild: ƒ appendChild(node, child)parentNode: ƒ parentNode(node)nextSibling: ƒ nextSibling(node)tagName: ƒ tagName(node)setTextContent: ƒ setTextContent(node, text)setAttribute: ƒ setAttribute(node, key, val)</code></pre><p>ref</p><pre><code>create: ƒ create(_, vnode)update: ƒ update(oldVnode, vnode)destroy: ƒ destroy(vnode)</code></pre><p>directives</p><pre><code>create: ƒ updateDirectives(oldVnode, vnode)update: ƒ updateDirectives(oldVnode, vnode)destroy: ƒ unbindDirectives(vnode)</code></pre><p>baseModules = [ref, directives]</p><p>attrs = {</p><pre><code>create: updateAttrs,update: updateAttrs</code></pre><p>}</p><p>klass = {</p><pre><code>create: updateClass,update: updateClass</code></pre><p>}</p><p>events = {</p><pre><code>create: updateDOMListeners,update: updateDOMListeners</code></pre><p>}</p><p>domProps = {</p><pre><code>create: updateDOMProps,update: updateDOMProps</code></pre><p>}</p><p>style = {</p><pre><code>create: updateStyle,update: updateStyle</code></pre><p>}</p><p>platformModules = [attrs, klass, events, domProps, style, transition]</p><p>modules = platformModules.concat(baseModules)</p><p>patch = createPatchFunction({</p><pre><code>nodeOps: nodeOps,modules: modules</code></pre><p>})</p><p>transitionProps = {</p><pre><code>name: String,appear: Boolean,css: Boolean,mode: String,type: String,enterClass: String,leaveClass: String,enterToClass: String,leaveToClass: String,enterActiveClass: String,leaveActiveClass: String,appearClass: String,appearActiveClass: String,appearToClass: String,duration: [Number, String, Object]</code></pre><p>}</p><p><strong>patch</strong></p><p>$mount</p><blockquote><p>compile 编译</p></blockquote><pre><code>compileToFunctions|-- parse 解析|-- optimize 优化|-- generate 生成</code></pre><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>UI = render(state)</p><p>state 和 UI 都是用户定的，不变的是这个 render() ==&gt; vue</p><p>变化侦测：追踪状态</p><pre><code>Angular 中是通过`脏值检查流程`来实现变化侦测在 React 是通过`对比虚拟DOM`来实现变化侦测</code></pre><blockquote><p>Object.defineProperty</p></blockquote><pre><code>实现数据的读写观察</code></pre><blockquote><p>Observer </p></blockquote><pre><code>Observer类会通过递归的方式把一个对象的所有属性都转化成可观测对象</code></pre><blockquote><p>在 getter 中收集依赖，在 setter 中通知依赖更新</p></blockquote><pre><code>依赖管理器 Dep </code></pre><blockquote><p>Watcher</p></blockquote><blockquote><p>Array  拦截器</p></blockquote><blockquote><p>虚拟 DOM</p></blockquote><pre><code>用一个JS对象来描述一个DOM节点VNode 类：注释节点文本节点元素节点组件节点函数式组件节点克隆节点</code></pre><blockquote><p>DOM-Diff ===&gt; patch</p></blockquote><p>创建节点，删除节点和更新节点</p><blockquote><p>render</p></blockquote><ul><li>抽象语法数（AbstractSyntaxTree，AST）</li></ul><ol><li>模板解析阶段：将一堆模板字符串用正则等方式解析成抽象语法树AST；</li><li>优化阶段：遍历AST，找出其中的静态节点，并打上标记；</li><li>代码生成阶段：将AST转换成渲染函数；</li></ol><ul><li>优化</li></ul><p>在AST中找出所有静态节点并打上标记；<br>在AST中找出所有静态根节点并打上标记；</p><h4 id="生命周期流程"><a href="#生命周期流程" class="headerlink" title="生命周期流程"></a>生命周期流程</h4><ol><li>new Vue()</li><li>vm_init<br> -&gt; 初始化 lifecycle<br> -&gt; 初始化 Events<br> -&gt; 初始化 Render<br> -&gt; 调用钩子 beforeCreate<br> -&gt; 初始化 State<pre><code> -&gt; 依赖收集 （props\data\computed\watch\methods）</code></pre> -&gt; 调用钩子 created<br> 挂载组件 vm.$mount</li><li>vm.$mount<br> -&gt; compile()<br> -&gt; 调用钩子 beforeMount<br> -&gt; new Watcher<pre><code> -&gt; vm_render createElement -&gt; VNode Tree -&gt; vm_update 渲染真实DOM</code></pre> -&gt; 调用钩子 mount</li><li>compile()<br> -&gt; parse -&gt; AST<br> -&gt; optimize 优化<br> -&gt; generate 生成</li><li>render function<br> – touch –&gt; getter\setter –&gt; watcher – &gt; update<br> – VDOM Tree</li><li>patch()<br> -&gt; patchVnode<br> -&gt; updateChikldren</li><li>Real Dom</li></ol>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据中台架构</title>
      <link href="2020/06/13/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0%E6%9E%B6%E6%9E%84/"/>
      <url>2020/06/13/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<p>公共业务模块下层：复用<br>共享、连接、服务（双中台：业务中天、数据中台）<br>one data<br>数据加工和深度分析（AI）<br>云原生</p><h4 id="发展"><a href="#发展" class="headerlink" title="发展"></a>发展</h4><p>数据湖阶段  –&gt;  数据工厂阶段  –&gt;  数据中台阶段</p><blockquote><p>数据仓库</p></blockquote><p>恩门模式</p><pre><code>整体架构</code></pre><p>金博尔模式</p><pre><code>维度和事实</code></pre><blockquote><p>数据湖</p></blockquote><p>数据规模和数据类型的限制</p><ol><li>完全分布式</li><li>弱化数据格式 （数据模型和数据存储分离）</li><li>原始数据存储</li></ol><blockquote><p>数据工厂</p></blockquote><p>数据集成 –&gt; 数据开发 –&gt; 数据测试 –&gt; 发布上线 –&gt;  任务运维</p><p>计算、资源调度（yarn、K8s）和存储（HDFS、Kudu、HBase）<br>离线数据清洗加工（Hive、Spark）<br>Flink 解决实时计算<br>Impala 解决交互式查询<br>HDFS 存全量数据、主要存维度表<br>Kudu 实时数仓</p><p>问题：数据无法共享</p><blockquote><p>数据中台</p></blockquote><p>底层架构：数据湖<br>建模方式：维度建模<br>数据服务化</p><p>“数据治理、数据服务、数据安全、接口治理、数据应用、系统治理”</p><p>主数据 + 多径合一 + 数据血缘 + 数据地图 + 数据安全</p><p>+数据应用</p><p>BI报表<br>数据产品<br>自动取数</p><p><code>数据</code>和<code>特征</code>决定机器学习的上限<br><code>算法</code>和<code>模型</code>只是无限逼近上限</p><blockquote><p>未来</p></blockquote><p>实时数据平台<br>云上数据平台<br>智能元数据管理 + 增强分析<br>自动化代码构建<br>数据产品</p><p>流批统一、可视化建模和SQL建模、上云</p><p>DWD、DWS、DM、ADS</p><h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4>]]></content>
      
      
      <categories>
          
          <category> 数据中台 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据中台 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql 基础</title>
      <link href="2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql%20%E5%9F%BA%E7%A1%80/"/>
      <url>2020/06/10/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="5-7-特性"><a href="#5-7-特性" class="headerlink" title="5.7 特性"></a>5.7 特性</h4><ol><li><p>初始化完成后，随机 Root 密码</p></li><li><p>默认安装完成没有 test 数据库，用户自定义创建及权限控制</p></li><li><p>默认 SSL 加密</p></li><li><p>密码过期策略</p></li><li><p>用户锁</p></li><li><p>支持 JSON</p><p> 服务端提供操作 JSON 的函数，存储方式：将 JSON 编码成 BLOB    </p></li><li><p>支持两类生成列</p><p> 虚拟生成列、存储生成列</p></li><li><p>引入系统库</p></li></ol><h4 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h4><p><a href="http://c.biancheng.net/view/7135.html">配置</a></p><p>默认端口：3306<br>默认用户：root</p><blockquote><p>免安装配置 Windows</p></blockquote><ol><li><p>配置环境变量</p></li><li><p>创建配置文件，命名为 my.ini</p><p> basedir = D:\mysql-5.7.20-winx64<br> datadir = D:\mysql-5.7.20-winx64\data<br> port =3306</p></li><li><p>安装 MySQL 服务，执行命令为 mysqld–install</p></li><li><p>执行 MySQL 初始化命令</p><p> mysqld –initialize-insecure –user=mysql</p></li><li><p>启动 MySQL 服务，并使用用户 root 登录，同时设置登录密码</p><p> net start mysql<br> mysqladmin -u -root -p password</p></li><li><p>测试是否部署成功</p><p> mysql -u root -p</p></li></ol><h4 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h4><blockquote><p>DOS</p></blockquote><pre><code>net start\stop mysql(mysql 服务器名称)</code></pre><blockquote><p>登录mysql 数据库</p></blockquote><pre><code>mysql -h localhost -u -root -p[密码]</code></pre><blockquote><p>Linux</p></blockquote><pre><code>RPM包、二进制包、源码包（`需要编译二进制后使用`）</code></pre><blockquote><p>卸载</p></blockquote><pre><code>查看当前系统中是否安装 MySQL，`CentOS 7 下，默认安装的数据库为 MariaDB`rpm  -qa | grep -i mysql停止服务、卸载service mysql stoprpm -e --nodeps mysql-libs-5.1.71-1.el6.x86_64查找老版本 MySQL 的目录find / -name mysql删除目录rm -rf 目录名</code></pre><blockquote><p>安装、启动</p></blockquote><pre><code>rpm -ivh mysql-community-common-5.7.29-1.el6.x86_64.rpmrpm -ivh mysql-community-libs-5.7.29-1.el6.x86_64.rpmrpm -ivh mysql-community-client-5.7.29-1.el6.x86_64.rpmrpm -ivh mysql-community-server-5.7.29-1.el6.x86_64.rpmservice mysql start | stop | restart | statusmysql -uroot -p修改密码set password=&#39;testroot&#39;</code></pre><ul><li>扩展<style>.remarkinfo{margin:1rem 1rem 1rem -2rem; display: flex; flex-wrap: wrap; padding:1rem; border: 1px dashed #cdcdcd;}.remarkinfo p{ width:33.33%;}</style><div class="remarkinfo"><p><span style="color: #0000ff;">蓝色</span>：目录文件</p><p><span style="color: #008000;">绿色</span>：可执行文件</p><p><span style="color: #ff0000;">红色</span>：压缩文件</p><p><span style="color: #00ffff;">浅蓝色</span>：链接文件</p><p><span style="color: #000000;">白色</span>：普通文件</p><p><span style="color: #ffff00;">黄色</span>：设备文件</p></div></li></ul><blockquote><p>my.cnf 配置文件详解</p></blockquote><pre><code>[client]port=3306socket=/var/run/mysql/mysql.sock[mysqldump]quickmax_allowed_packet = 16M</code></pre><p>socket：套接字文件所在目录<br>quick：支持较大的数据库转储，导出非常巨大的表时需要此项 。<br>max_allowed_packet：服务所能处理的请求包的最大大小以及服务所能处理的最大的请求大小（当与大的BLOB字段一起工作时相当必要），每个连接独立的大小，大小动态增加。</p><pre><code>[mysqld]user = mysqlbasedir = /usr/local/mysqldatadir = /mydata/mysql/dataport=3306server-id = 1socket=/var/run/mysql/mysql.sock</code></pre><p>user：mysqld 程序在启动后将在给定 UNIX/Linux 账户下执行。mysqld 必须从 root 账户启动才能在启动后切换到另一个账户下执行。mysqld_safe 脚本将默认使用 user=mysql 选项来启动 mysqld 程序。<br>basedir：指定 MySQL 安装的绝对路径；<br>datadir：指定 MySQL 数据存放的绝对路径；<br>port：服务端口号，默认为 3306<br>server-id：MySQL 服务的唯一编号，每个 MySQL 服务的 id 需唯一。<br>socket：socket 文件所在目录</p><pre><code>character-set-server = utf8mb4collation-server = utf8mb4_general_ciinit_connect=&#39;SET NAMES utf8mb4&#39;lower_case_table_names = 1key_buffer_size=16Mmax_allowed_packet=8Mno-auto-rehashsql_mode=TRADITIONAL</code></pre><p>character-set-server：数据库默认字符集，主流字符集支持一些特殊表情符号（特殊表情符占用 4 个字节）<br>collation-server：数据库字符集对应一些排序等规则，注意要和 character-set-server 对应<br>init_connect：设置 client 连接 mysql 时的字符集，防止乱码<br>lower_case_table_names：是否对 sql 语句大小写敏感，1 表示不敏感<br>key_buffer_size：用于指定索引缓冲区的大小<br>max_allowed_packet：设置一次消息传输的最大值<br>no-auto-rehash：仅仅允许使用键值的 UPDATES 和 DELETES<br>sql_mode：表示 SQL 模式的参数，通过这个参数可以设置检验 SQL 语句的严格程度</p><h4 id="Mysql-SQL"><a href="#Mysql-SQL" class="headerlink" title="Mysql SQL"></a>Mysql SQL</h4><blockquote><p>show</p></blockquote><pre><code>show create table t_user \G;</code></pre><blockquote><p>use</p></blockquote><blockquote><p>注释</p></blockquote><pre><code>#、--、/* ...... */</code></pre><blockquote><p>SQL 语句的大小写规则</p></blockquote><p>windows\Mac 系统文件名不区分大小写<br>Linux 系统文件名<code>区分大小写</code><br><code>MySql 用服务器主机的底层文件系统所包含的目录和文件表示数据库和表。数据库名和表名的默认大小写取决于操作系统的命名规则。视图 用文件夹表示</code><br>存储函数、存储过程、事件名称不区分大小写，列名、索引不区分大小写<br>触发器名称<code>区分大小写</code><br>表的别名<code>区分大小写</code></p><blockquote><p>MySql 系统帮助</p></blockquote><pre><code>\h contents</code></pre><p>· help_category：关于帮助主题类别的信息<br>· help_keyword：与帮助主题相关的关键字信息<br>· help_relation：帮助关键字信息和主题信息之间的映射<br>· help_topic：帮助主题的详细内容</p><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><style>table{ width: 100%;}table, th, td{    padding: .25rem .5rem;    font-size: 1rem;    border-collapse: collapse;    border: 1px solid #cdcdcd;}.small table{    font-size: 1rem;    line-height: 1.25rem;}.small table th{    padding: .6rem .5rem;}</style><ol><li><p>数值类型</p><p> 整型：TINYINT、SMALLINT、MEDIUMINT、INT、BIGINT<br> 浮点型：FLOAT、DOUBLE<br> 定点数类型：DECIMAL</p></li></ol><table><thead><tr><th align="center">类型名称</th><th align="left">说明</th><th align="left">存储需求</th></tr></thead><tbody><tr><td align="center">TINYINT</td><td align="left">-128〜127</td><td align="left">1个字节</td></tr><tr><td align="center">SMALLINT</td><td align="left">-32768〜32767</td><td align="left">2个宇节</td></tr><tr><td align="center">MEDIUMINT</td><td align="left">-8388608〜8388607</td><td align="left">3个字节</td></tr><tr><td align="center">INT (INTEGHR)</td><td align="left">-2147483648〜2147483647</td><td align="left">4个字节</td></tr><tr><td align="center">BIGINT</td><td align="left">-9223372036854775808〜9223372036854775807</td><td align="left">8个字节</td></tr></tbody></table><p>FLOAT [4 个字节] 类型的取值范围如下：<br>有符号的取值范围：-3.402823466E+38～-1.175494351E-38<br>无符号的取值范围：0 和 -1.175494351E-38～-3.402823466E+38</p><p>DOUBLE [8 个字节] 类型的取值范围如下：<br>有符号的取值范围：-1.7976931348623157E+308～-2.2250738585072014E-308<br>无符号的取值范围：0 和 -2.2250738585072014E-308～-1.7976931348623157E+308</p><ol start="2"><li><p>日期和时间类型</p><p> YEAR、TIME、DATE、DATETIME 和 TIMESTAMP</p></li></ol><div class="small"><table><thead><tr><th align="left">类型名称</th><th align="left">日期范围</th><th align="left">存储需求</th></tr></thead><tbody><tr><td align="left">YEAR <br/> YYYY</td><td align="left">1901 ~ 2155</td><td align="left">1 个字节</td></tr><tr><td align="left">TIME <br/> HH:MM:SS</td><td align="left">-838:59:59 ~ 838:59:59</td><td align="left">3 个字节</td></tr><tr><td align="left">DATE <br/> YYYY-MM-DD</td><td align="left">1000-01-01 ~ 9999-12-3</td><td align="left">3 个字节</td></tr><tr><td align="left">DATETIME <br/> YYYY-MM-DD HH:MM:SS</td><td align="left">1000-01-01 00:00:00 <br/> 9999-12-31 23:59:59</td><td align="left">8 个字节</td></tr><tr><td align="left">TIMESTAMP <br/> YYYY-MM-DD HH:MM:SS</td><td align="left">1980-01-01 00:00:01 UTC <br/> 2040-01-19 03:14:07 UTC</td><td align="left">4 个字节</td></tr></tbody></table></div><ol start="3"><li><p>字符串类型</p><p> CHAR、VARCHAR、BINARY、VARBINARY、BLOB、TEXT、ENUM、SET</p></li><li><p>二进制类型</p><p> BIT、BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB、LONGBLOB</p></li></ol><h4 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h4><p>InnoDB、MyISAM、Memory、Merge、Archive、Federated、CSV、Blackhole</p><table><thead><tr><th align="left">存储引擎</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">ARCHIVE</td><td align="left">用于数据存档的引擎，数据被插入后就不能在修改了，且不支持索引。</td></tr><tr><td align="left">CSV</td><td align="left">在存储数据时，会以逗号作为数据项之间的分隔符。</td></tr><tr><td align="left">BLACKHOLE</td><td align="left">会丢弃写操作，该操作会返回空内容。</td></tr><tr><td align="left">FEDERATED</td><td align="left">将数据存储在远程数据库中，用来访问远程表的存储引擎。</td></tr><tr><td align="left">InnoDB</td><td align="left">具备外键支持功能的事务处理引擎</td></tr><tr><td align="left">MEMORY</td><td align="left">置于内存的表</td></tr><tr><td align="left">MERGE</td><td align="left">用来管理由多个 MyISAM 表构成的表集合</td></tr><tr><td align="left">MyISAM</td><td align="left">主要的非事务处理存储引擎</td></tr><tr><td align="left">NDB</td><td align="left">MySQL 集群专用存储引擎</td></tr></tbody></table><blockquote><p>查看默认引擎</p></blockquote><pre><code>show variables like &#39;default_storage_engine%&#39;</code></pre><table><thead><tr><th align="left">特性</th><th align="left">MyISAM</th><th align="left">InnoDB</th><th align="left">MEMORY</th></tr></thead><tbody><tr><td align="left">存储限制</td><td align="left">有</td><td align="left">支持</td><td align="left">有</td></tr><tr><td align="left">事务安全</td><td align="left">不支持</td><td align="left">支持</td><td align="left">不支持</td></tr><tr><td align="left">锁机制</td><td align="left">表锁</td><td align="left">行锁</td><td align="left">表锁</td></tr><tr><td align="left">B树索引</td><td align="left">支持</td><td align="left">支持</td><td align="left">支持</td></tr><tr><td align="left">哈希索引</td><td align="left">不支持</td><td align="left">不支持</td><td align="left">支持</td></tr><tr><td align="left">全文索引</td><td align="left">支持</td><td align="left">不支持</td><td align="left">不支持</td></tr><tr><td align="left">集群索引</td><td align="left">不支持</td><td align="left">支持</td><td align="left">不支持</td></tr><tr><td align="left">数据缓存</td><td align="left">-</td><td align="left">支持</td><td align="left">支持</td></tr><tr><td align="left">索引缓存</td><td align="left">支持</td><td align="left">支持</td><td align="left">支持</td></tr><tr><td align="left">数据可压缩</td><td align="left">支持</td><td align="left">不支持</td><td align="left">不支持</td></tr><tr><td align="left">空间使用</td><td align="left">低</td><td align="left">高</td><td align="left">N/A</td></tr><tr><td align="left">内存使用</td><td align="left">低</td><td align="left">高</td><td align="left">中等</td></tr><tr><td align="left">批量插入速度</td><td align="left">高</td><td align="left">低</td><td align="left">高</td></tr><tr><td align="left">支持外键</td><td align="left">不支持</td><td align="left">支持</td><td align="left">不支持</td></tr></tbody></table><h4 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h4><blockquote><p>修改表</p></blockquote><p>ALTER TABLE &lt;表名&gt;<br>{ ADD COLUMN &lt;列名&gt; &lt;类型&gt;[约束条件] （FIRST | AFTER &lt;已存在字段名&gt;）<br>| CHANGE COLUMN &lt;旧列名&gt; &lt;新列名&gt; &lt;新列类型&gt;<br>| ALTER COLUMN &lt;列名&gt; { SET DEFAULT &lt;默认值&gt; | DROP DEFAULT }<br>| MODIFY COLUMN &lt;列名&gt; &lt;类型&gt;<br>| DROP COLUMN &lt;列名&gt;<br>| RENAME TO &lt;新表名&gt;<br>| CHARACTER SET &lt;字符集名&gt;<br>| COLLATE &lt;校对规则名&gt; }</p><blockquote><p>删除关联表</p></blockquote><p>ALTER TABLE 子表 DROP FOREIGN KEY 外键约束;<br>DROP TABLE 主表;</p><blockquote><p>查看表结构</p></blockquote><p>DESC 表名;<br>SHOW CREATE TABLE &lt;表名&gt;;</p><blockquote><p>约束</p></blockquote><p>1）主键约束</p><pre><code>&lt;字段名&gt; &lt;数据类型&gt; PRIMARY KEY [默认值] (AUTO_INCREMENT)PRIMARY KEY(字段，字段...)ALTER TABLE &lt;数据表名&gt; ADD PRIMARY KEY(&lt;字段名&gt;)ALTER TABLE &lt;数据表名&gt; DROP PRIMARY KEY</code></pre><p>2）外键约束</p><pre><code>CONSTRAINT &lt;外键名&gt;] FOREIGN KEY 字段名REFERENCES &lt;主表名&gt; 主键列</code></pre><p>3）唯一约束</p><pre><code>&lt;字段名&gt; &lt;数据类型&gt; UNIQU可以有多个，并且设置唯一约束的列是允许有空值的</code></pre><p>4）检查约束</p><pre><code>CHECK(表达式)</code></pre><p>5）非空约束<br>6）默认值约束</p><blockquote><p>函数</p></blockquote><p><a href="http://c.biancheng.net/mysql/function/">常用函数汇总</a></p><blockquote><p>去重</p></blockquote><pre><code>DISTINCT </code></pre><blockquote><p>设置别名</p></blockquote><pre><code>AS</code></pre><blockquote><p>分页查询</p></blockquote><pre><code>LIMIT 初始位置，记录数LIMIT 记录数 OFFSET 初始位置</code></pre><blockquote><p>WHERE with HAVING</p></blockquote><p>WHERE 用于过滤数据行，而 HAVING 用于过滤分组。<br>WHERE 查询条件中不可以使用聚合函数，而 HAVING 查询条件中可以使用聚合函数。<br>WHERE 在数据分组前进行过滤，而 HAVING 在数据分组后进行过滤 。<br>WHERE 针对数据库文件进行过滤，而 HAVING 针对查询结果进行过滤。也就是说，WHERE 根据数据表中的字段直接进行过滤，而 HAVING 是根据前面已经查询出的字段进行过滤。<br>WHERE 查询条件中不可以使用字段别名，而 HAVING 查询条件中可以使用字段别名</p><blockquote><p>JOIN</p></blockquote><pre><code>笛卡尔积：两个集合 X 和 Y 的乘积</code></pre><p>交叉连接 – 笛卡尔积</p><p>内连接</p><pre><code>SELECT &lt;字段名&gt; FROM &lt;表1&gt; INNER JOIN &lt;表2&gt; [ON子句]</code></pre><p>外连接</p><pre><code>LEFT OUTER JOIN、RIGHT OUTER JOIN</code></pre><blockquote><p>正则表达式</p></blockquote><pre><code>REGEXP</code></pre><blockquote><p>清空表</p></blockquote><pre><code>TRUNCATE TABLE 表名</code></pre><blockquote><p>TRUNCATE 和 DELETE 的区别</p></blockquote><p>DELETE 是 DML 类型的语句；TRUNCATE 是 DDL 类型的语句。它们都用来清空表中的数据。<br>DELETE 是逐行一条一条删除记录的；TRUNCATE 则是直接删除原来的表，再重新创建一个一模一样的新表，而不是逐行删除表中的数据，执行数据比 DELETE 快。因此需要删除表中全部的数据行时，尽量使用 TRUNCATE 语句， 可以缩短执行时间。<br>DELETE 删除数据后，配合事件回滚可以找回数据；TRUNCATE 不支持事务的回滚，数据删除后无法找回。<br>DELETE 删除数据后，系统不会重新设置自增字段的计数器；TRUNCATE 清空表记录后，系统会重新设置自增字段的计数器。<br>DELETE 的使用范围更广，因为它可以通过 WHERE 子句指定条件来删除部分数据；而 TRUNCATE 不支持 WHERE 子句，只能删除整体。<br>DELETE 会返回删除数据的行数，但是 TRUNCATE 只会返回 0，没有任何意义。</p><blockquote><p>查看模式</p></blockquote><p>select @@sql_mode</p><blockquote><p>视图</p></blockquote><p>使用视图重新格式化检索出的数据。<br>使用视图简化复杂的表连接。<br>使用视图过滤数据。</p><blockquote><p>存储过程</p></blockquote><pre><code>DELIMITER //CREATE PROCEDURE ShowStuScore()-&gt; BEGIN-&gt; SELECT * FROM tb_students_score;-&gt; END //</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes 基础</title>
      <link href="2020/06/01/Kubernetes/Kubernetes%20%E5%9F%BA%E7%A1%80/"/>
      <url>2020/06/01/Kubernetes/Kubernetes%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="前世今生"><a href="#前世今生" class="headerlink" title="前世今生"></a>前世今生</h4><p>[阿里云] Infrastructure as a service<br>[新浪云] platform as a service<br>[office 365] software as a service</p><blockquote><p>分布式资源管理器</p></blockquote><p>MeSoS 伯克利、Twitter、2019-05弃用<br>Docker Swarm 2019-7 阿里弃用<br>Kubernetes 谷歌，2010年 borg系统，go语言翻写 borg 系统 =&gt; Kubernetes</p><ul><li><p>borg 系统</p><p>  config file/borgcfg | command lines tools | web browers<br>  scheduler -&gt; BorgMaster(备份3个以上奇数个)[Paxos] —link shard—&gt; Borglet</p></li><li><p>Kubernetes</p><p>  scheduler | replication controller  -&gt; api server  &lt;—-&gt;  etcd<br>  node [ kubelet | kube proxy —-&gt; firewall | Pod {container [Docker]}] </p></li><li><p>etcd</p><p>  etcd: 可信赖的分布式键值存储服务 V2 内存，V3 Database（V1.11后支持）<br>  HTTP server -&gt; （Raft、Store） –&gt; WAL（预写日志） | Entry | Snapshot</p></li></ul><blockquote><p>Kubernetes 特点</p></blockquote><p>轻量级：消耗资源小<br>开源<br>弹性伸缩<br>负载均衡 IPVS</p><pre><code>IPVS: IP虚拟服务器，运行在LVS（ipvsadm程序完成该功能）下提供负载均衡</code></pre><h4 id="组件和核心"><a href="#组件和核心" class="headerlink" title="组件和核心"></a>组件和核心</h4><table><thead><tr><th>组件</th><th align="center">介绍</th></tr></thead><tbody><tr><td>APIServer</td><td align="center">所有服务访问的统一入口</td></tr><tr><td>ControllerManager</td><td align="center">维持副本期望数目</td></tr><tr><td>Scheduler</td><td align="center">负责介绍任务，选择合适的节点分配任务</td></tr><tr><td>ETCD</td><td align="center">键值对数据库，存储集群的重要信息，进行持久化</td></tr><tr><td>Kuberlet</td><td align="center">直接和容器引擎交互实现容器的生命周期管理</td></tr><tr><td>KuberProxy</td><td align="center">负责写入规则至IPTABLES\IPVS实现服务映射访问</td></tr><tr><td>CoreDNS</td><td align="center">为集群中的SVC创建一个域名解析</td></tr><tr><td>Dashboard</td><td align="center">为K8S集群提供B\S架构支持</td></tr><tr><td>INGRESS Controller</td><td align="center">从4层支持到7层</td></tr><tr><td>Fedetation</td><td align="center">支持多集群统一管理</td></tr><tr><td>Prometheus</td><td align="center">提供集群监控能力</td></tr><tr><td>Elk</td><td align="center">日志统一分析介入平台</td></tr></tbody></table><blockquote><p>Pod</p></blockquote><p>自主式Pod、控制器管理的Pod</p><p>只要运行Pod，Pause容器就会启动存在<br>一个Pod可以存在多个容器（尾根隔离，进程不隔离，容器端口不能冲突），多个容器公用Pause的网络栈，存储卷</p><pre><code>控制器：ReplicationController 确保副本期望数目ReplicaSet 本质同上，支持集合 selectorDeployment 建议使用，自动管理 RS，支持 rolling updateHorizontal Pod Autoscaling HPA CPU利用率扩容StatefulSet 解决有状态服务问题    稳定的持久化存储：基于PVC，Pod重新调度后访问的持久化数据不变    稳定的网络标志：基于Headless Service，Pod重新调度后 PodName、HostName不变    有序部署    有序收缩DaemonSet Job、Cron Job 负责批处理任务，即仅执行一次的任务，确保任务成功结束</code></pre><blockquote><p>服务发现</p></blockquote><pre><code>RR：轮询</code></pre><blockquote><p>网络通讯模式</p></blockquote><p>网络模型：所有Pod在一个可以直接连通的扁平化网络空间中</p><pre><code>不同节点上的 Docker 容器间的互相访问需要打通，然后运行 K8S</code></pre><p>同一 Pod 内的多个容器：Pause 共享网络栈<br>Pod 间的通讯：Overlay Nerwork<br>Pod 和 Service 间的通讯：各节点的 Iptables 规则、LVS</p><ul><li><p>Overlay Nerwork</p><p>  Flannel –&gt; Flanneld<br>  etcd 存储管理 Flannel 可分配的 IP 地址段资源<br>  监控每个 Pod 的实际地址，并在内存中 维护 Pod 节点路由表</p></li></ul><h4 id="资源清单"><a href="#资源清单" class="headerlink" title="资源清单"></a>资源清单</h4><blockquote><p>资源</p></blockquote><p>名称空间级别</p><pre><code>工作负载型资源：Pod、控制器服务发现及负载均衡资源：service、ingress配置和存储型资源：Volume（存储卷）、CSI（容器存储接口、可扩展第三方存储卷）特殊类型存储卷：ConfigMap（配置文件热更新）、Secret（保存敏感数据）、DownwardAPI（把外部环境中的信息输出给容器）</code></pre><p>集群级别</p><pre><code>Namespace、Node、Role、ClusterRole、RoleBinding、ClusterRoleBinding</code></pre><p>元数据级别</p><pre><code>HPA、PodTemplate、LimitRange</code></pre><blockquote><p>YAML 文件及资源清单</p></blockquote><p>YAML：可读性高，表达数据序列的格式，一种标记语言</p><p>基本语法：</p><pre><code>缩进只允许使用空格# 标识注释</code></pre><p>数据结构：</p><pre><code>对象、数组、纯量</code></pre><p>常用字段:</p><table><thead><tr><th>name</th><th align="center">介绍</th></tr></thead><tbody><tr><td>version</td><td align="center">K8S API 版本</td></tr><tr><td>kind</td><td align="center">文件定义的资源类型和角色</td></tr><tr><td>metadata</td><td align="center">元数据对象</td></tr><tr><td>metadata.name</td><td align="center">元数据对象的名称，如命名Pod的名称</td></tr><tr><td>metadata.namespace</td><td align="center">元数据对象的命名空间</td></tr><tr><td>Spec</td><td align="center">详细定义对象</td></tr><tr><td>Spec.containers[]</td><td align="center">容器列表</td></tr><tr><td>Spec.containers[].name</td><td align="center">容器的名称</td></tr><tr><td>Spec.containers[].image</td><td align="center">使用到的镜像名称</td></tr></tbody></table><p>容器生命周期：</p><p>存储<br>调度器<br>集群安全机制<br>HELM</p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>koolshare 软路由</p><blockquote><p>系统初始化</p></blockquote><p>设置系统主机名和 Host 文件相互解析<br>安装依赖包<br>设置防火墙位 Iptables 设置空规则<br>关闭 Selinux<br>调整内核参数（开启网桥，关闭ipv6）<br>调整系统时区<br>关闭不需要的服务<br>设置 rsyslogd 和 systemd journald<br>升级系统内核为4.44</p><p>kube-proxy 开启 ipvs 前置条件<br>安装 Docker、Docker-ce<br>配置 docker\daemon.json<br>安装 Kubeadm、Kubectl、Kubelet<br>初始化主节点、加入节点<br>部署网络</p><blockquote><p>配置私有仓库</p></blockquote><p>Harbor 安装</p>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>数据仓库</title>
      <link href="2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/"/>
      <url>2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h4 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h4><p>维度<br>    单级维、层级维、变化维</p><p>度量<br>    度量是反映企业运行情况或状态的一些数值指标，是业务量化的表示，可以用来监测业务的成效，比如销售额、利润来反应企业业绩</p><p>事实表<br>    事务粒度事实表、周期快照粒度事实表、累积快照粒度事实表</p><p>原则：一致性维度和一致性事实</p><h4 id="分层"><a href="#分层" class="headerlink" title="分层"></a>分层</h4><p>贴源层，就是将所有涉及业务系统的数据抽取到这一层集中存放，同时也会保留历史数据，这一层基本保留了与源系统一样的结构和数据。<br>整合层，会保留最细颗粒的所有历史数据，它面向主题、规范化建模，站在全局的视角上规划主题、整合业务模型，在数据模型维度上完成重大的转变。<br>集市层，面向某个业务主题的多维模型集合。通过预计算、预连接、维度规范化等方式进一步将业务系统的范式模型转变成面向主题的多维模型。<br>汇总层，它应技术或业务需要而建，直面需求，方便展现，同时提高数据的存储性能。</p><p>建模工具：Erwin、PowerDesigner、EsDataFactory</p><blockquote><p>OLTP 数据系统，主要技术难点</p></blockquote><pre><code>分层、分片、分布式事务</code></pre><blockquote><p>OLAP 主要技术：</p></blockquote><pre><code>列存储、降维、切分</code></pre><h4 id="构成"><a href="#构成" class="headerlink" title="构成"></a>构成</h4><p>基础：调度系统，数据管理、数据监控</p><p>数据流：数据采集—数据传输（同步、转换）—数据研发（ETL）</p><p>数据采集–数据传输–实时计算（流计算）</p><p>辅助功能：元数据管理 权限 血缘 成本管理</p><p>规范：数据仓库规则，表名规则，字段规范</p><p>应用：数据产品，分析、算法，ABtest，用户画像，数据分析，数据挖掘，搜索</p>]]></content>
      
      
      <categories>
          
          <category> 数据资产 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据仓库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据仓库工具书-维度建模初步</title>
      <link href="2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%B7%A5%E5%85%B7%E4%B9%A6-%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E5%88%9D%E6%AD%A5/"/>
      <url>2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%B7%A5%E5%85%B7%E4%B9%A6-%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E5%88%9D%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>序</p></blockquote><p>数据展现获得成功，必须建立在简单性的基础上，以业务用户的需求来驱动<br>维度建模是建立集成化的 DW/BI 系统的<code>主导结构</code><br>使用维度建模的<code>一致性维度</code>和<code>一致性事实</code>，可以<code>增量式</code>的建立具有<code>可实践性</code>、<code>可预测</code>、<code>分布式</code>的<code>复杂</code> DW/BI 系统框架</p><blockquote><p>数据获取 VS 数据分析</p></blockquote><p>信息的作用：操作型记录的保存、分析型决策的制定</p><p>操作型系统通常不必维护历史数据，只需修改数据以反映最新状态<br>分析型系统要求保存历史环境，以精确的评估组织在一段时间内的性能</p><blockquote><p>DW/BI 基本需求</p></blockquote><ol><li><p>能够方便的存取信息</p><p> 数据需要直观性<br> 数据结构与标识必须符合业务用户的思维过程和词汇<br> 业务用户能以各种形式分割和合并分析数据<br> 访问数据的工具和应用要简单易用<br> 能够快速查询出结果</p></li><li><p>以一致的形式展示信息</p><p> 数据必须可信<br> 清洗不同来源的数据，确保质量<br> 公告标识和定义能够在不同数据源公用</p></li><li><p>必须能够适应变化</p><p> 用户需求、业务环境、数据及技术</p></li><li><p>必须能够及时展现信息</p><p> DW/BI 系统主要用于操作型决策，原始数据需要短时间内转换成可用信息</p></li><li><p>成为保护信息财富的安全堡垒</p><p> 有效控制组织中机密信息的访问</p></li><li><p>成为提高决策制定能力的权威和可信的基础</p><p> DW/BI 系统重要的输出是基于分析证据所产生的决策</p></li><li><p>系统成功的标志是业务群体的接受</p></li></ol><blockquote><p>维度建模</p></blockquote><p>解决问题：<br>以商业用户可以理解的方式发布数据<br>提高高效的查询性能</p><blockquote><p>用于度量的事实表</p></blockquote><p>维度模型中的事实表存储组织机构业务过程中事件的性能度量结果，同一个业务过程的底层度量结果尽可能存储于一个维度模型</p><p>事实可以通过连续描述，有助于区分到底是事实还是维度属性的问题</p><p>从行的数量 -&gt; 事实表趋向于变长<br>从列的数量 -&gt; 事实表趋向于变短</p><p>事实表粒度划分：<code>事务</code>、周期性快照、累积快照</p><p>事实表具有N个外键与维度表的主键关联，主键是组合键</p><blockquote><p>用于描述环境的维度表</p></blockquote><p>维度表是事实表不可或缺的组成部分</p><p>维度表单一主键<br>维度属性可作为查询约束、分组、报表标识的主要来源<br>尽量减少在维度表中使用代码，将代码替换成详细的文本属性</p><pre><code>数据仓库的好坏直接取决于维度属性的设置DW/BI 环境的分析能力取决于维度属性的质量和深度</code></pre><p>+如何区分数值数据元素是事实属性还是维度属性</p><p>包含多个值并作为计算的参与者的度量 -&gt; 事实<br>对具体值得描述，是一个常量、某一约束和行标识的参与者 -&gt; 维度属性</p><blockquote><p>DW/BI 环境划分</p></blockquote><p>操作型源系统、ETL系统（获取，转换，加载）、数据展现、商业智能应用</p><p>ETL主要任务：在交付过程中划分维度和事实</p><blockquote><p>商业智能决策的展现区</p></blockquote><p>展现区：<br>数据应以维度模型来展现，星型模式、OLAP多维数据库<br>包含详细的原子数据<br>围绕业务过程度量事件来构建<br>使用公共的、一致性的维度建立维度结构</p><blockquote><p>常见 DW/BI 架构</p></blockquote><p>独立数据集市架构<br>辐射状企业信息工厂架构 INmon</p>]]></content>
      
      
      <categories>
          
          <category> 数据资产 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 维度建模 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据仓库工具书-零售业务</title>
      <link href="2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%B7%A5%E5%85%B7%E4%B9%A6-%E9%9B%B6%E5%94%AE%E4%B8%9A%E5%8A%A1/"/>
      <url>2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%B7%A5%E5%85%B7%E4%B9%A6-%E9%9B%B6%E5%94%AE%E4%B8%9A%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>维度建模设计的4步骤</p></blockquote><ol><li><p>选择业务过程</p><p> 解释：由组织完成的微观活动，获得订单、开具发票、接收付款等<br> 公共特征：</p><pre><code> 通常用行为动词表示，表示业务执行的活动 由某个操作型系统支撑 建立或获取关键性能度量（过滤器和约束的不同组合来审查和评估度量） 由输入激活嘛，产生输出度量（一系列过程产生一系列事实表）    </code></pre><p> 业务战略规划 –&gt; 深入挖掘，理解数据和操作型系统，支持对规划进行分析的需求</p><p> 业务过程 ≠ 功能化的部门</p><p> 确保一致性的最好方法：一次发布数据</p></li><li><p>声明粒度</p><p> 解释：精确定义某个事实表的每一行表示什么，由获取业务过程事件的操作型系统的物理实现确定，以业务术语表示</p><p> 粒度传递的是与事实表度量有关的细节级别（如何描述事实表中每行的内容）</p><p> 粒度与主键等价</p><p> 原子粒度数据具有多维性，分析灵活，支持商业用户随意查询</p><p> DW/BI系统要求数据尽可能最细粒度表示，不是因为需要查询单独的某行，而是因为查询需要以最精准的方式对细节进行切分</p></li><li><p>确定维度</p><p> 选择维度时应该列出所有具体的、文本类型的属性以充实每个维度表</p><p> 维度集合装饰事实表</p></li><li><p>确定事实</p><p> 解释：过程的度量？</p><p> 典型事实是可加性数值</p><ul><li><p>计算获得的事实</p></li><li><p>不可加事实</p></li><li><p>事务事实表</p><p>  稀疏、多维</p></li></ul></li></ol><pre><code>需要综合考虑业务用户需求和数据来源的实际情况，通过以上4步骤来进行维度建模</code></pre><blockquote><p>事实表粒度</p></blockquote><blockquote><p>事务类型事实表</p></blockquote><p>事务事实表一行表示的是发生在一件事务中的事实，通常都是最原子的数据</p><blockquote><p>可加、不可加以及抽取的事实</p></blockquote><p>可加事实指可以按照任意维度汇总的事实<br>半可加事实指只能按照部分维度汇总的事实<br>不可加事实指完全不能按照维度汇总的事实</p><blockquote><p>维度属性</p></blockquote><blockquote><p>日期维度和当天时间维度</p></blockquote><p>“日期维度”表示粒度按天处理的维度表</p><blockquote><p>产品维度</p></blockquote><p>扁平化多对一层次</p><p>数字值可同时用于计算以及过滤/分组功能，应当在事实表和维度表中同时存储该值。<br>涉及计算的数据应该放入事实表中，涉及约束、分组和标记的数据应该放入维度表中。</p><p>描述性属性</p><blockquote><p>商店维度</p></blockquote><p>多层次维度表</p><p>跨多层次的属性名称和值应该具有唯一性</p><blockquote><p>促销维度</p></blockquote><p>因果维度的一种</p><blockquote><p>因果维度</p></blockquote><blockquote><p>退化维度</p></blockquote><p>表示双亲的唯一标识符</p><blockquote><p>维度模型的空值</p></blockquote><p>空外键、空属性、空事实</p><blockquote><p>维度模型的可扩展</p></blockquote><blockquote><p>无事实的事实表</p></blockquote><p>不含度量数字的事实表，例如商品状态事实表，只展示商品的上下架状态，没有可计算的事实数据</p><blockquote><p>代理键、自然建与持久键</p></blockquote><p>维度表的唯一主键是代理键而不是来自操作型系统的标识符，也是所谓的自然建或（无意义键、整数键、非自然键、人工键和合成键等）<br>作用：连接维度表和事实表</p><p>优点：<br>    1. 为数据仓库缓冲操作型系统的变化<br>    2. 集成多个源系统<br>    3. 改进性能<br>    4. 处理空值或未知条件<br>    5. 支持维度属性变化跟踪</p><blockquote><p>雪花模式的维度属性<br>蜈蚣事实表（多维度）</p></blockquote><ul><li>度量环境</li><li>性能度量</li><li>候选事实</li><li>典型事实</li><li>事务</li><li>滞后时间</li><li>层次</li><li>支架</li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据资产 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 维度建模 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据资产管理白皮书</title>
      <link href="2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E8%B5%84%E4%BA%A7%E7%AE%A1%E7%90%86%E7%99%BD%E7%9A%AE%E4%B9%A6/"/>
      <url>2020/05/25/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0/%E6%95%B0%E6%8D%AE%E8%B5%84%E4%BA%A7%E7%AE%A1%E7%90%86%E7%99%BD%E7%9A%AE%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>数据是资产<br>国际数据管理协会（DAMA）<br>能力成熟度模型集成（CMMI）</p><blockquote><p>现状</p></blockquote><p>数据基础薄弱，数据标准混乱、质量层次不齐、数据孤岛化现象严重，阻碍了数据的共享<br>受限数据规模和数据源种类，主要应用：精准营销、风险控制；应用深度不够<br>数据价值很难评估，包括数据的成本和对戏业务的贡献</p><blockquote><p>四部分</p></blockquote><p>概念和特征趋势；实践角度资产管理主要内容；实施步骤、模式，技术工具和成功要素；实践经验案例</p><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>数据资产管理需要充分融合业务、技术和管理，以确保数据资产保值增值。</p><p>一、数据资产管理的核心管理职能<br>二、确保这些管理职能落地实施的保障措施，包括战略规划、组织架构、制度体系等</p><p>数据资产管理贯穿数据采集、存储、应用和销毁整个生命周期全过程，促进数据“内增值、外增效”，同时控制成本消耗</p><p>包括统筹规划、管理实施、稽核检查和资产运营四个主要阶段</p><blockquote><p>数据管理领域</p></blockquote><p>DMBOK1.0</p><ol><li><p>数据治理</p><p> <code>最高层次、规划性的，关键活动：制定数据战略、完善数据政策、建立数据架构等，注重数据的使用者、使用方式、使用权限等合规性制定，强调开展数据资产全生命周期管理前的基础工作，关注数据资产管理中的相关保障措施</code></p></li><li><p>数据架构管理</p></li><li><p>数据开发</p></li><li><p>数据操作管理</p></li><li><p>数据安全管理</p></li><li><p>参考数据和主数据管理</p></li><li><p>数据仓库和商务智能管理</p></li><li><p>文档和内容管理</p></li><li><p>元数据管理</p></li><li><p>数据质量管理</p></li></ol><p>DBMOK2.0</p><ol><li>数据架构</li><li>数据模型和设计</li><li>数据存储与操作</li><li>数据安全</li><li>数据集成与互操作性</li><li>文件和内容</li><li>参考数据和主数据</li><li>数据仓库和商务智能</li><li>元数据</li><li>数据质量</li></ol><blockquote><p>数据价值难以有效发挥的原因</p></blockquote><ul><li><p>缺乏数据视图</p></li><li><p>数据孤岛现象</p></li><li><p>数据质量低下</p></li><li><p>缺乏安全的数据环境</p><p>  数据安全的风险：数据泄露和数据滥用</p></li><li><p>缺乏数据价值管理体系</p></li></ul><blockquote><p>数据价值有效发挥的必经之路</p></blockquote><p>体系化的方式实现数据的可得、可用、好用，用较小的数据成本获得较大的数据收益</p><ul><li>全面掌握数据资产的现状</li><li>提升数据质量</li><li>实现数据互联互通</li><li>提高数据获取效率</li><li>保障数据安全合规</li><li>数据价值持续释放</li></ul><p>数据跨境流动：数据主权、隐私保护、法律适用和管辖、国际贸易规则等</p><h4 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h4><p>8个管理职能：</p><ol><li><p>数据标准管理（基础类数据标准和指标类数据标准）</p><p> 基础类数据标准：（参考数据和主数据标准、逻辑数据模型标准、物理数据模型标准、元数据标准、公共代码和编码标准）<br> 指标类数据标准：（基础类指标、计算指标）</p><p> 数据标准三要素：标准分类、标准信息内容和相关公共代码和编码</p></li><li><p>数据模型管理</p><p> 数据模型内容：数据结构、数据操作和数据约束<br> 按应用层次分为：概念数据模型、逻辑数据模型、物理数据模型</p><p> 数据模型管理包括对数据模型的设计、数据模型和数据标准词典的同步、数据模型审核发布、数据模型差异对比、版本控制等</p></li><li><p>元数据管理</p><p> 技术元数据、业务元数据和管理元数据    </p></li><li><p>主数据管理</p></li><li><p>数据质量管理</p></li><li><p>数据安全管理</p><p> 存、管、用：事前可管、事中可控、事后可查</p></li><li><p>数据价值管理</p></li><li><p>数据共享管理</p><p> 数据提供者、数据消费者、数据服务者和数据运营者</p></li></ol><p>5个保障：</p><ol><li><p>战略规划</p></li><li><p>组织架构</p></li><li><p>制度体系</p><p> 数据资产管理规范（元数据管理规范、生命周期管理规范、数据质量管理规范及数据安全管理规范）<br> 规范需细化到接口设计、接口开发、模型设计、模型开发、数据开发及服务封装等<br> 规范的标准（基础分类标准、命名规范要求、数据架构划分、存储与数据权限规则、元数据信息完整性要求等）</p></li><li><p>审计制度</p></li><li><p>培训宣贯</p></li></ol><h4 id="实施要点"><a href="#实施要点" class="headerlink" title="实施要点"></a>实施要点</h4><p>建立组织架构 → 应用需求梳理 → 数据盘点梳理 → 引进平台技术 → 汇聚多源数据治理数据 → 数据应用 → 数据运营</p><blockquote><p>实施步骤</p></blockquote><p>统筹规划 -&gt; 管理实施 -&gt; 稽核检查 -&gt; 资产运营</p><ul><li><p>统筹规划交付物<br>一阶段交付物：《数据资产管理规划》、《数据资产管理认责机制》、《数据资产管理工作指引》、《数据资产管理考核评价办<br>法》<br>二阶段交付物：《数据资产盘点清单》、《数据资产管理现状评估》<br>三阶段交付物：《数据资产标准管理办法》</p></li><li><p>管理实施</p></li></ul><p>数据可视化、搜索式分析、数据产品化等降低数据使用难度<br>数据“平民化”（如数据应用商店）扩大数据覆盖范围</p><p>交付物：《数据资产管理办法》、《数据资产管理实施细则》（包括数据标准管理、数据质量管理、元数据管理、主数<br>据管理、数据安全管理、数据应用管理等）</p><ul><li>稽核检查</li></ul><ol><li>数据标准执行情况检查的常态化</li><li>数据质量稽核的常态化</li><li>灵活配置数据存储策略的常态化</li><li>数据资产安全检查的常态化</li></ol><ul><li>资产运营</li></ul><p>交付物：《数据资产价值评估方法》、《数据资产成本管理方法》、《数据资产共享流通管理办法》</p><blockquote><p>实践模式</p></blockquote><p>思考维度：组织方式、建设策略</p><p>组织方式：自上而下（<code>规范、标准先行</code>）、自下而上（<code>问题导向、系统建设先行、快速见效</code>）<br>建设策略：生产系统优先、数据系统优先</p><blockquote><p>软件工具</p></blockquote><ol><li><p>数据标准管理工具</p><p> 标准生成、标准映射、变更查询、映射查询、维护标准、标准版本查询、标准导出、标准文档管理</p></li><li><p>数据模型管理工具</p><p> 数据模型设计、模型差异稽核、数据模型变更管控、模型可视化</p></li><li><p>元数据管理工具</p><p> 元数据采集、元数据识别、元数据分类、元数据展示、元数据应用、元数据搜索</p></li><li><p>主数据管理工具</p><p> 企业级主数据存储、整合、清洗、监管以及分发等功能<br> 主数据存储\整合、主数据管理、主数据分析、主数据分发与共享</p></li><li><p>数据质量管理工具</p><p> 质量需求管理、规则设置、规则校验、任务管理、监控分析、质量报警、报告生成</p></li><li><p>数据安全管理工具</p><p> 数据获取安全、数据脱敏、统一认证、租户隔离、角色授权、日志审计、异常监控、数据分类分级</p></li><li><p>数据价值管理工具</p><p> 数据需求分析、数据价值评估、数据成本管理、数据收益管理、数据服务、数据资产价值统计</p></li><li><p>数据服务管理工具</p><p> 服务目录、服务目录版本管理、数据资产共享和流通、其他功能</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 数据资产 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据资产 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java Spring IOC和DI</title>
      <link href="2020/05/12/Java/Java%20Spring%20IOC%20%E5%92%8C%20DI/"/>
      <url>2020/05/12/Java/Java%20Spring%20IOC%20%E5%92%8C%20DI/</url>
      
        <content type="html"><![CDATA[<h4 id="创建对象的几种方式"><a href="#创建对象的几种方式" class="headerlink" title="创建对象的几种方式"></a>创建对象的几种方式</h4><p>new、反射、反序列化、clone</p><h4 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h4><p>反射概念：<br>    提供一个 Class对象 ,可以获得这个类对象的所有属性和方法</p><p>反射优劣势：<br>    增加程序灵活，代码简洁，增强可读性，提高代码复用<br>    量大时性能下降（安全权限检查 newInstance、class.forName JNI）、内部暴露和安全隐患</p><p>Class包含：</p><pre><code>包（Package）构造方法（Constructor）字段（Filed）函数（Method）注解（Annotation）接口父类    修饰符 ...</code></pre><p>clazz.getFields();          //获取类中所有的公有字段，包括集成<br>clazz.getDeclaredFields();  //获取类中定义的字段</p><p>clazz.getModifiers();          //获取类中所有的公有方法，包括集成<br>clazz.getDeclaredModifiers();  //获取类中定义的方法<br>getModifiers()                 //获取修饰符<br>invoke()</p><p>clazz.getDeclaredConstructors()    //获取所有构造方法<br>…</p><h4 id="IOC，DI"><a href="#IOC，DI" class="headerlink" title="IOC，DI"></a>IOC，DI</h4><p>IOC：控制反转，对象实例创建的控制权交给程序（IOC 容器：K-V HashMap）<br>DI：依赖注入，对象构建的过程当中，IOC 动态的提供对象需要的其他对象</p><p>Spring IOC 容器中对象的创建方式：</p><pre><code>构造器、静态工厂方法、实例工厂方法</code></pre><p>Spring DI 的几种方式：</p><pre><code>有参的构造器、setter函数</code></pre><h4 id="Bean-规范"><a href="#Bean-规范" class="headerlink" title="Bean 规范"></a>Bean 规范</h4><p>类 -&gt; 是公有修饰 public<br>类 -&gt; 具有 public 默认构造函数<br>类 -&gt; 属性访问修饰是 private，需要有public（setter,getter）</p><blockquote><p>spring 配置元数据</p></blockquote><ul><li>基于XML的配置文件</li><li>基于注解的配置</li><li>基于JAVA的配置<br>  <code>class</code><br>  <code>name</code><br>  <code>scope</code><br>  <code>constructor-arg</code><br>  <code>properties</code><br>  <code>autowiring mode</code><br>  <code>lazy-initialization mode</code><br>  <code>initialization</code><br>  <code>destruction</code></li></ul><blockquote><p>作用域</p></blockquote><pre><code>singleton、prototype、request、session、global-sessionWebApplicationContext可用（request、session、global-session）</code></pre><blockquote><p>生命周期</p></blockquote><p>init-method：InitializingBean <code>不建议使用</code><br>destroy-method：DisposableBean <code>不建议使用</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;Beans.xml&quot;</span>);</span><br><span class="line">      HelloWorld obj = (HelloWorld) context.getBean(<span class="string">&quot;helloWorld&quot;</span>);</span><br><span class="line"></span><br><span class="line">      context.registerShutdownHook();</span><br></pre></td></tr></table></figure><p>XML -&gt; beans 配置默认的初始化和销毁方法<br>    <code>default-init-method=&quot;init&quot;</code><br>    <code>default-destroy-method=&quot;destroy&quot;</code></p><blockquote><p>后置处理器</p></blockquote><p>BeanPostProcessor<br>调用<code>初始化方法前后</code>对 Bean 进行额外的处理<br>通过设置 BeanPostProcessor 实现的 Ordered 接口提供的 order 属性来控制这些 BeanPostProcessor 接口的执行顺序</p><blockquote><p>定义继承</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;beanTeamplate&quot;</span> <span class="keyword">abstract</span>=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;message1&quot;</span> value=<span class="string">&quot;Hello World!&quot;</span>/&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;message2&quot;</span> value=<span class="string">&quot;Hello Second World!&quot;</span>/&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;message3&quot;</span> value=<span class="string">&quot;Namaste India!&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=<span class="string">&quot;helloIndia&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.tutorialspoint.HelloIndia&quot;</span> parent=<span class="string">&quot;beanTeamplate&quot;</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;message1&quot;</span> value=<span class="string">&quot;Hello India!&quot;</span>/&gt;</span><br><span class="line">  &lt;property name=<span class="string">&quot;message3&quot;</span> value=<span class="string">&quot;Namaste India!&quot;</span>/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring</title>
      <link href="2020/05/11/Java/Spring/"/>
      <url>2020/05/11/Java/Spring/</url>
      
        <content type="html"><![CDATA[<h4 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h4><blockquote><p>核心容器</p></blockquote><p>spring-core<code>①</code>、spring-beans<code>②</code>、spring-context<code>③</code>、spring-context-support<code>④</code>、spring-expression<code>⑤</code><br>①：框架基本组成部分，包括Ioc、依赖注入<br>②：BeanFactory,工厂模式的微妙实现<br>③：类似JNDI注册的方式访问对象，继承自beans<br>④：提供第三方库集成<br>⑤：表达式语言，用于运行时查询和操作对象图</p><blockquote><p>数据访问、集成</p></blockquote><p>JDBC<code>①</code> ORM<code>②</code> OXM<code>③</code> JMS<code>④</code> 事务处理<code>⑤</code><br>①：提供JDBC抽象层<br>②：对流行的对象关系隐射API的集成（JPA、JDO、Hibernate）<br>③：对OXM实现的支持（JAXB、Castor、XML Beans、JiBX、Xstream）<br>⑤：实现特殊接口类及所有POJO支持编程式和声明式事务管理</p><blockquote><p>Web</p></blockquote><p>Web<br>Web-Mvc<br>Web-Scoket:为 WebSocket-based 提供了支持，提供了客户端和服务器端之间通信的两种方式<br>Web-Portlet:用于Portlet环境的MVC实现，并反映了spring-webmvc模块的功能</p><blockquote><p>其他重要模块</p></blockquote><p>AOP、Aspects、Instrumentation，Web 和测试模块</p><h4 id="IoC容器"><a href="#IoC容器" class="headerlink" title="IoC容器"></a>IoC容器</h4><blockquote><p>spring BeanFactory<br>spring ApplicationContext</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.xml.XmlBeanFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.ClassPathResource;</span><br><span class="line"></span><br><span class="line">XmlBeanFactory factory = <span class="keyword">new</span> XmlBeanFactory(<span class="keyword">new</span> ClassPathResource(<span class="string">&quot;spring-config.xml&quot;</span>));</span><br><span class="line">        HelloWorld w = (HelloWorld) factory.getBean(<span class="string">&quot;hellowold&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;spring-config.xml&quot;</span>);</span><br><span class="line">        HelloWorld helloWorld = (HelloWorld) context.getBean(<span class="string">&quot;hellowold&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h4><p>基于构造函数注入<br>基于设值函数注入</p><pre><code>基于构造函数注入中，我们使用的是〈bean〉标签中的〈constructor-arg〉元素，而在基于设值函数的注入中，我们使用的是〈bean〉标签中的〈property〉元素    如果你要把一个引用传递给一个对象，那么你需要使用 标签的 ref 属性，而如果你要直接传递一个值，那么你应该使用 value 属性。</code></pre><p>注入内部Beans<br>注入集合</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jumpServer 安装、配置</title>
      <link href="2020/04/28/JumpServer/jumpServer%20%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE/"/>
      <url>2020/04/28/JumpServer/jumpServer%20%E5%AE%89%E8%A3%85%E3%80%81%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h4><ol><li>Python = 3.6.x  （python -V）</li><li>Mysql Server ≥ 5.6  （mysql -V）</li><li>Mariadb Server ≥ 5.5.56</li><li>Redis</li></ol><blockquote><p>安装 python 3.7</p></blockquote><p>安装依赖：yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel libffi-devel gcc make<br>下载包：wget <a href="https://www.python.org/ftp/python/3.7.7/Python-3.7.7.tar.xz">https://www.python.org/ftp/python/3.7.7/Python-3.7.7.tar.xz</a><br>解压缩：tar -xvJf Python-3.7.7.tar.xz<br>编译：./configure<br>make&amp;&amp;make install</p><p><code>. python 备份，python3 软连接到 python</code><br>python 软连接：ln -s /usr/local/bin/python3 /usr/bin/python<br>pip3 软连接：ln -s /usr/local/bin/pip3 /usr/bin/pip3</p><pre><code>报错：yum 不可用，第一行改成 python2vi /usr/libexec/urlgrabber-ext-down vi /usr/bin/yum</code></pre><blockquote><p>安装Redis</p></blockquote><p>下载包：wget <a href="http://download.redis.io/releases/redis-4.0.6.tar.gz">http://download.redis.io/releases/redis-4.0.6.tar.gz</a><br>解压缩：tar -zxvf redis-4.0.6.tar.gz<br>gcc依赖：yum install gcc （gcc -v）<br>cd redis-4.0.6<br>编译解压：make MALLOC=libc　<br>启动：redis-server</p><blockquote><p>设置redis开机自启动</p></blockquote><p>/etc目录下新建redis目录：mkdir redis<br>cp /usr/local/redis-4.0.6/redis.conf /etc/redis/6379.conf<br>cp /usr/local/redis-4.0.6/utils/redis_init_script /etc/init.d/redisd</p><pre><code>报错：chkconfig redisd on -- service redisd does not support chkconfigredisd文件，在第一行加入如下两行注释# chkconfig:   2345 90 10# description:  Redis is a persistent key-value database　</code></pre><p>service redisd start</p><pre><code>nohup src/redis-server &gt; /dev/null 2&gt;&amp;1 &amp;ps aux|grep redis</code></pre><blockquote><p>查看 python 虚拟环境</p></blockquote><p>env python -V</p><blockquote><p>获取 JumpServer </p></blockquote><p>cd /opt<br>git clone –depth=1 <a href="https://github.com/jumpserver/jumpserver.git">https://github.com/jumpserver/jumpserver.git</a><br>cd /opt/jumpserver/requirements<br>yum -y install $(cat rpm_requirements.txt)<br>pip3 install -r requirements.txt -i <a href="https://mirrors.aliyun.com/pypi/simple/">https://mirrors.aliyun.com/pypi/simple/</a></p><blockquote><p>创建数据库 Jumpserver 并授权</p></blockquote><p>create database jumpserver default charset ‘utf8’;<br>flush privileges;<br>grant all on jumpserver.* to ‘jumpserver’@’127.0.0.1’ identified by ‘jumps1@db’;</p><blockquote><p>修改 Jumpserver 配置文件</p></blockquote><p>cd /opt/jumpserver<br>cp config_example.py config.py<br>vi config.py</p><pre><code># 生成随机SECRET_KEYSECRET_KEY=`cat /dev/urandom | tr -dc A-Za-z0-9 | head -c 50` # 生成随机BOOTSTRAP_TOKENBOOTSTRAP_TOKEN=`cat /dev/urandom | tr -dc A-Za-z0-9 | head -c 16`  #配置密钥sed -i &quot;s/SECRET_KEY:/SECRET_KEY: $SECRET_KEY/g&quot; /opt/jumpserver/config.yml#配置token信息sed -i &quot;s/BOOTSTRAP_TOKEN:/BOOTSTRAP_TOKEN: $BOOTSTRAP_TOKEN/g&quot; /opt/jumpserver/config.yml#关闭debugsed -i &quot;s/# DEBUG: true/DEBUG: false/g&quot; /opt/jumpserver/config.yml#修改日志界别为errorsed -i &quot;s/# LOG_LEVEL: DEBUG/LOG_LEVEL: ERROR/g&quot; /opt/jumpserver/config.yml#设定session在关闭浏览器的时候清空sed -i &quot;s/# SESSION_EXPIRE_AT_BROWSER_CLOSE: false/SESSION_EXPIRE_AT_BROWSER_CLOSE: true/g&quot; /opt/jumpserver/config.yml#替换数据库的密码配置sed -i &quot;s/DB_PASSWORD: /DB_PASSWORD: $DB_PASSWORD/g&quot; /opt/jumpserver/config.yml</code></pre><blockquote><p>启动 jumpserver</p></blockquote><p>./jms start all -d </p><pre><code>报错：pip install psutil -i https://mirrors.aliyun.com/pypi/simple/</code></pre>]]></content>
      
      
      <categories>
          
          <category> JumpServer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JumpServer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HBase 安装配置</title>
      <link href="2020/04/23/Hbase/HBase%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"/>
      <url>2020/04/23/Hbase/HBase%20%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> HBase </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HBase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HBase Shell</title>
      <link href="2020/04/16/Hbase/HBase%20Shell/"/>
      <url>2020/04/16/Hbase/HBase%20Shell/</url>
      
        <content type="html"><![CDATA[<blockquote><p>create</p></blockquote><pre><code>hbase &gt; create &#39;表名&#39;，&#39;列族名&#39;</code></pre><blockquote><p>list 查表</p></blockquote><pre><code>list</code></pre><blockquote><p>put 插入</p></blockquote><pre><code>put &#39;表名&#39;，&#39;row key&#39;，&#39;列族名：列名&#39;，&#39;数据&#39;</code></pre><blockquote><p>scan 查询最新版本数据</p></blockquote><pre><code>scan &#39;表名&#39;缺点：全表扫描指定范围：scan &#39;表名&#39;，｛STARTROW =&gt; &#39;row key&#39;，ENDROW =&gt; &#39;row key&#39;｝scan &#39;表名&#39;，｛COLUMNS =&gt; &#39;列族名&#39;｝scan &#39;表名&#39;，｛COLUMNS =&gt; &#39;列族名:列名&#39;｝scan &#39;表名&#39;，｛RAW =&gt; true，VERSIONS = 3｝</code></pre><blockquote><p>describe 查看详细信息</p></blockquote><pre><code>desc &#39;表名&#39;</code></pre><blockquote><p>alert 修改列族信息</p></blockquote><pre><code>alert &#39;表名&#39;，｛NAME =&gt; &#39;列族名&#39;，VERSIONS =&gt; &#39;5&#39;｝</code></pre><blockquote><p>get 获取历史版本</p></blockquote><pre><code>get &#39;表名&#39;，&#39;row key&#39;，｛COLUMNS =&gt; &#39;列族：列名&#39;，VERSIONS =&gt; &#39;5&#39;｝</code></pre><blockquote><p>delete</p></blockquote><pre><code>delete &#39;表名&#39;，&#39;row key&#39;，&#39;列族：列名&#39;，版本号删除版本后所有，逻辑删除，合并时定期删除。主要是性能考虑。</code></pre><blockquote><p>drop 删除表</p></blockquote><pre><code>drop &#39;表名&#39;</code></pre><blockquote><p>disable 停用表</p></blockquote><pre><code>disable &#39;表名&#39;</code></pre>]]></content>
      
      
      <categories>
          
          <category> HBase </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HBase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HBase 应用</title>
      <link href="2020/04/16/Hbase/HBase%20%E5%BA%94%E7%94%A8/"/>
      <url>2020/04/16/Hbase/HBase%20%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>本质：分布式、面向<code>列</code>的开源数据库，Apache的Hadoop子项目。<br>适用于：非结构化数据存储的数据库</p><h4 id="技术特点"><a href="#技术特点" class="headerlink" title="技术特点"></a>技术特点</h4><ol><li>大表</li><li>面向列：面向列族的存储和权限控制，列族独立检索</li><li>稀疏：对于为空（null）的列，并不占用存储空间</li><li>不基于MR、Yarn，而是基于自身的文件索引</li><li>无Join功能，做不了分析类处理，通常增删改查</li><li>RS（Rgion Server），决定集群处理能力，支持水平扩展</li><li>用于实时读写场景，Online场景</li></ol><h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h4><p>表数据量大（至少亿级别以上）、数据append业务、无跨行跨表事务要求、写入量大（每天千万级别以上）、读取场景简单不经常变化，查询场景固化、无正序，逆序的排序要求、不适合全量读取、RowKey不可发生变化</p><pre><code>不适合场景多维度索引，无二级索引需要事务分析类，即逻辑复杂查询不适合Count操作不适合多条件查询case</code></pre><h4 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h4><blockquote><p>Master 服务器：负责维护表结构信息 </p></blockquote><pre><code>负责协调工作，如建表、删表、移动Region、合并等</code></pre><blockquote><p>RegionServer 服务器：负责数据的存储，直接存储在 <code>Hadoop</code> 的 <strong><code>HDFS</code></strong> 上</p></blockquote><pre><code>存放 Region 的容器，相当于服务器上的服务</code></pre><p>【 WAL(Write-Ahead Log：预写日志) | Region | Block Cache】</p><p>通常Hbase集群有 <code>一个 Master</code> 和 <code>多个 RegionServer</code></p><p>client <code>---&gt;</code>  ZooKeeper  <code>----管理--&gt;</code> RegionServer <code>---&gt;</code> HDFS</p><blockquote><p>Region 一段数据集合</p></blockquote><ol><li>不能跨服务器</li><li>不足以存储所有数据时，HBase会自动拆分</li><li>HBase进行负责均衡时，Region可能会在RegionServer之间移动</li><li>基于HDFS</li></ol><p>【 store（对应一个列族）【 MemStore（数据排序） | HFile】】</p><p>【 HFile：【 Data | Data Index 】】</p><p>【 Data：【 BlockType | Cell(Key Value) 】】</p><p>【 Cell：【 Key Len | Value Len | TimeStamp | Key Type | Value 】】</p><blockquote><p>RowKey</p></blockquote><p>作用：索引、为组合性 <code>最基本的存储单元是“列”</code></p><p>访问HBase Table中的行，只有三种方式：</p><ol><li>通过单个 row key 访问</li><li>通过 row key 的 range</li><li>全表扫描</li></ol><p>row key 可以是任意字符串，在hbase内部， row key 保存为<code>字节数组</code>，存储时，数据按照 row key 的<code>字典顺序</code>排序存储。</p><blockquote><p>Columns Family</p></blockquote><p>HBase 表中每个列，都归属于某个列族，相同列族的列 HBase 会尽量放在同一台机器上<br><code>列族</code>是<code>表的 schema</code> 的<code>一部分</code>，**<code>而列不是</code>**，必须在使用表之前定义。<br>列名都以列族作为前缀:courses:history<br>访问控制、磁盘和内存的使用统计都是在列族层面进行的</p><pre><code>create &#39;tableName&#39;, &#39;cf&#39;, &#39;cfc&#39; ...  创建多列族的表，通常一个表只有一个列族flush 和 compaction 触发的基本单元都是 region 级别。</code></pre><blockquote><p>Time Stamp </p></blockquote><p>HBase 中通常 row 和 columns 组成一个存储单元 cell<br>每个 cell 都保存同一份数据的多个版本<code>按照时间</code>**<code>倒序排序</code>**。版本通过<code>时间戳（类型为64位整型）</code>来索引。</p><p>  时间戳赋值<br>  数据写入时自动赋值，此时时间为毫秒级当前系统时间<br>  客户手动赋值，需确保时间戳的唯一性</p><blockquote><p>cell</p></blockquote><p>由{row key, column(=<family> + <label>), version} 唯一确定的单元。</p><p>cell中的数据是没有类型的，全部是<code>字节码形式存贮</code>。</p><h4 id="协处理器"><a href="#协处理器" class="headerlink" title="协处理器"></a>协处理器</h4><blockquote><p>Observer</p></blockquote><blockquote><p>EndPoint</p></blockquote><h4 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h4><p>Apache Hadoop<br>CDH（优化组件兼容和交互接口、简化安装配置、增加Cloudera兼容特性）<br>CDH5.1 目前最稳定版本，内核Hadoop 2.3 <code>主流版本</code></p><p>CDH5下载地址：<br><a href="http://archive.cloudera.com/cm5/redhat/6/x86_64/cm/">CM</a>  <a href="http://archive.cloudera.com/cdh5/redhat/6/x86_64/cdh/">Cdh</a><br><a href="http://archive.cloudera.com/cm5/installer/">cloudera-manager-installer.bin</a></p><p><a href="http://www.ibeifeng.com/goods-427.html">Storm流计算从入门到精通之技术篇</a><br><a href="http://www.ibeifeng.com/goods-310.html">Cdh4 实战课程</a></p><h4 id="配置-NTP-服务器"><a href="#配置-NTP-服务器" class="headerlink" title="配置 NTP 服务器"></a>配置 NTP 服务器</h4><p>NetWork Time Protocol 网络时间协议              </p><blockquote><p><a href="http://www.360doc.com/content/14/1010/17/4171006_415846558.shtml">虚拟机启动状态下添加硬盘</a></p></blockquote><pre><code>1. fdisk -l 列出当前系统中所有硬盘设备及其分区的信息。2. mkfs命令、mkswap命令</code></pre><h4 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h4><p>Consistency 一致性</p><pre><code>更新操作成功并返回客户端完成后，分布式系统所有的节点在同一时间的数据完全一致</code></pre><p>Availability 可用性</p><pre><code>读写操作都能成功</code></pre><p>Partition tolerance 分区容错性</p><pre><code>出现网络故障导致分布式节点间不能通信时，系统能否继续服务</code></pre>]]></content>
      
      
      <categories>
          
          <category> HBase </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HBase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hive</title>
      <link href="2020/04/16/Hbase/Hive/"/>
      <url>2020/04/16/Hbase/Hive/</url>
      
        <content type="html"><![CDATA[<p>OLAP：联机分析处理 （Hive适用）<br>OLTP：联机事务处理</p>]]></content>
      
      
      <categories>
          
          <category> HBase </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环境准备</title>
      <link href="2020/04/16/jenkins%E9%83%A8%E7%BD%B2/%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/"/>
      <url>2020/04/16/jenkins%E9%83%A8%E7%BD%B2/%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<h4 id="安装-JDK"><a href="#安装-JDK" class="headerlink" title="安装 JDK"></a>安装 JDK</h4><blockquote><p>检查是否安装 JDK<br>java -version<br>echo $JAVA_HOME<br>echo $CLASSPATH<br>echo $PATH</p></blockquote><ol><li><p>找到合适的版本</p><p> yum search java | grep jdk</p></li><li><p>安装合适版本</p><p> yum install java-1.8.0-openjdk.x86_64 java-1.8.0-openjdk-devel.x86_64 </p></li><li><p>安装目录</p><p> ls /usr/lib/jvm/</p></li><li><p>配置环境变量</p><p> vi /etc/profile：<br> export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk<br> export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br> export PATH=$PATH:$JAVA_HOME/bin</p></li><li><p>执行生效环境配置</p><p> source /etc/profile</p></li></ol><h4 id="安装-maven"><a href="#安装-maven" class="headerlink" title="安装 maven"></a>安装 maven</h4><ol><li><p>[下载](wget <a href="https://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz">https://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz</a>)</p><p> 官网：<a href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a><br> 拷贝文件名为 *-bin.tar.gz 的链接地址</p><p> 报错：未找到命令<br> yum -y install wget</p></li><li><p>解压</p><p> tar xvf apache-maven-3.6.3-bin.tar.gz</p></li><li><p>配置环境变量</p><p> vi /etc/profile<br> export M2_HOME=/usr/local/apache-maven-3.6.3<br> export PATH=$PATH:$M2_HOME/bin</p></li><li><p>执行生效环境配置</p><p> source /etc/profile</p></li></ol><h4 id="安装-git"><a href="#安装-git" class="headerlink" title="安装 git"></a>安装 git</h4><pre><code>yum install git</code></pre><h4 id="安装-jenkins"><a href="#安装-jenkins" class="headerlink" title="安装 jenkins"></a>安装 jenkins</h4><ol><li><p>[下载](wget <a href="http://pkg.jenkins-ci.org/redhat-stable/jenkins-2.7.3-1.1.noarch.rpm">http://pkg.jenkins-ci.org/redhat-stable/jenkins-2.7.3-1.1.noarch.rpm</a>)</p></li><li><p>rpm -ivh jenkins-2.7.3-1.1.noarch.rpm</p></li><li><p>vi /etc/sysconfig/jenkins</p></li><li><p>service jenkins start/stop/restart</p><p> 系统会创建一个“jenkins”用户来允许这个服务，如果改变服务所有者，同时需要修改/var/log/jenkins, /var/lib/jenkins, 和/var/cache/jenkins的所有者<br> 启动的时候将从/etc/sysconfig/jenkins获取配置参数<br> 默认情况下，Jenkins运行在8080端口，在浏览器中直接访问该端进行服务配置<br> Jenkins的RPM仓库配置被加到/etc/yum.repos.d/jenkins.repo</p></li><li><p>初始密码在：/var/lib/jenkins/secrets/initialAdminPassword </p></li></ol><blockquote><p>报错：插件删除 /var/lib/jenkins/plugins</p></blockquote><h4 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h4><p>Folders<br>Build Timeout<br>Credentials Binding<br>Workspace Cleanup<br>Ant/NAnt<br>Gradle<br>Pipeline<br>Git<br>Subversion<br>SSH Slaves<br>LDAP<br>Email Extension<br>PAM Authentication<br>Pipeline:Stage View<br>GitHub Organization</p><p><a href="http://updates.jenkins-ci.org/download/plugins/">jenkins 插件</a></p><h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><ul><li><p>密码忘记</p><pre><code>  cd /var/lib/jenkins  cat users/admin/config.xml</code></pre><p>  passwordHash字段：</p><p>  <code>#jbcrypt:$2a$10$MiIVR0rr/UhQBqT.bBq0QehTiQVqgNpUGyWW2nJObaVAM/2xSQdSq</code></p><p>  重置密码为：123456</p><p>  <code>#jbcrypt:$2a$10$DdaWzN64JgUtLdvxWIflcuQu2fgrrMSAMabF5TSrGK5nXitqK9ZMS</code></p><p>  重置密码为：111111</p><p>  重启服务：<code>service Jenkins restart</code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> jenkins </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>领域驱动设计（一）</title>
      <link href="2020/04/15/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>2020/04/15/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4><ol><li>微服务如何拆分和设计，微服务如何定义？</li><li>如何将通用的可复用的业务能力沉淀到中台业务模型，实现服务复用？</li></ol><blockquote><p>领域驱动核心思想：搞清楚领域驱动、微服务和中台之间的关系<br>中台：业务模型<br>微服务：业务模型的系统<br>领域驱动：设计思想</p></blockquote><pre><code>现有领域模型而后形成微服务架构**战略设计**和**战术设计**</code></pre><h4 id="基础知识体系"><a href="#基础知识体系" class="headerlink" title="基础知识体系"></a>基础知识体系</h4><p>领域、子域、核心域、通用域、支撑域、限界上下文、实体、值对象、聚合、聚合根</p><p>分解业务领域常用方法：<code>用例分析</code>、<code>场景分析</code>和<code>用户旅程分析</code></p><blockquote><p>领域驱动要点</p></blockquote><ul><li>真实世界中有什么实物,系统设计中就有什么对象（从对象在不同的场景中查找共同的特征和行为，就是聚合的过程，也是形成类的过程）</li><li>真实世界中有什么行为，系统设计中对象中就有什么样的方法。</li><li>真实世界中有什么样的关系，系统设计中对象之间就是什么样的关系（依赖，关联，聚合）</li></ul><blockquote><p><code>领域</code>是用来<code>限定</code><strong>业务</strong><code>边界</code>和<code>范围</code></p></blockquote><ul><li>关系</li></ul><p>关联关系、依赖关系、扩展关系、包含关系、实现关系、精化关系、泛化关系、聚合关系、组合关系</p><ul><li><p>用例</p></li><li><p>涉众</p><p>  用 OO 方法建立商业模型必须先定义<code>涉众</code>。商业系统无论多复杂，无论什么行业，其本质<br>无非是<code>人，事，物，规则</code>。人是一切的中心，人做事，做事产生物，规则限制人事物。人<br>驱动系统，事体现过程，物记录结果，规则则是控制。复杂的表面下其实只是一个简单的<br>规则，系统分析员弄明白有什么人，什么人做什么事，什么事产生什么物，中间有什么规<br>则，再把人，事，物之间的关系定义出来，商业建模也就基本完成了。这时候可以说，系<br>统分析员已经完全了解了用户需求。</p></li></ul><blockquote><p>通用语言 <code>定义上下文含义</code></p></blockquote><ul><li><p>场景要素</p><p>  Who(谁)<br>  <code>What（业务功能）</code><br>  <code>Why（业务价值）</code><br>  Where(限界上下文)<br>  When<br>  <code>How(怎么实现)</code> — <code>“职责的层次”</code></p></li></ul><blockquote><p>限界上下文 <code>定义领域边界</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 领域驱动设计 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Konckout 入门</title>
      <link href="2020/03/26/Knockout/Knockout%20%E5%85%A5%E9%97%A8/"/>
      <url>2020/03/26/Knockout/Knockout%20%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="重要概念"><a href="#重要概念" class="headerlink" title="重要概念"></a>重要概念</h4><ol><li><p>声明式绑定 Declarrative Bindings:数据绑定关联DOM</p></li><li><p>UI界面自动刷新 Automatic UI Refresh:数据变化时，DOM自动刷新渲染</p></li><li><p>依赖跟踪 Dependency Tracking:转变和联合数据</p></li><li><p>模板 Templating:可嵌套复制 UI</p><p> 兼容性：（IE6+, Firefox 2+, Chrome, Sarfari, 其他）纯Javascript类库，兼容任何服务端、客户端技术<br> 简洁性：Gzip 25KB</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Knockout </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MVVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring 全家桶</title>
      <link href="2020/03/10/Java/Spring%20%E5%85%A8%E5%AE%B6%E6%A1%B6/"/>
      <url>2020/03/10/Java/Spring%20%E5%85%A8%E5%AE%B6%E6%A1%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="springBean"><a href="#springBean" class="headerlink" title="springBean"></a>springBean</h4><blockquote><p>循环依赖 –&gt; 属性注入（自动注入）</p></blockquote><p>spring 默认单例支持循环依赖</p><p>初始化 spring 容器（AnnotationConfigApplicationContext）的时候完成<code>依赖注入</code></p><blockquote><p>bean 的生命周期</p></blockquote><p>初始化 bean 的过程</p><ul><li>bean VS Java Object</li></ul><p>scan<br>parse<br>调用扩展<br>遍历map<br>validate<br>new</p><blockquote><p>bean 的实例化过程</p></blockquote><p>class –&gt; BeanDefinition</p><p>BeanFactoryPostProcessor（扩展）</p><h4 id="springCloud"><a href="#springCloud" class="headerlink" title="springCloud"></a>springCloud</h4><blockquote><p>getWay</p></blockquote><p>http请求 –&gt; webflux/reactor（响应式编程） –&gt; DispatcherHandler.handle</p><p>核心：handlerMapping、webHandler –&gt; ProxiedService</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter 手册</title>
      <link href="2020/03/04/Flutter%20%E6%89%8B%E5%86%8C/"/>
      <url>2020/03/04/Flutter%20%E6%89%8B%E5%86%8C/</url>
      
        <content type="html"><![CDATA[<h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>1、环境变量配置</p><pre><code>PUB_HOSTED_URL = https://pub.flutter-io.cnFLUTTER_STORAGE_BASE_URL = https://storage.flutter-io.cn</code></pre><p>2、下载 Flutter</p><pre><code>git clone -b beta https://github.com/flutter/flutter.git</code></pre><p>3、用户变量<br>Path 路径：控制面板 -&gt; 系统和安全 -&gt; 系统 -&gt; 高级系统设置 -&gt; 环境变量，Path 变量中添加 Flutter 路径，到 \bin 级</p><blockquote><p>常见问题</p></blockquote><ul><li><p>flutter doctor sdk 版本问题<br>  升级一下即可</p></li><li><p>缺少 flutter dart 插件<br>  安装下插件即可</p></li><li><p>Exception in thread main java.lang.NoClassDefFoundError<br>  方案一：flutter 使用的 JDK 版本为 1.8 安装 JDK 1.8 即可<br>  方案二：<a href="https://www.cnblogs.com/MJ-CAT/p/12237484.html">缺失库</a></p></li><li><p> Some Android licenses not accepted.</p></li><li><p>Android license status unknown<br>  flutter doctor –android-licenses 一路Y</p></li><li><p>真机测试，一直卡在 loading<br>  在安装flutter的路径底下进入bin/cache，然后把lockfile删除</p></li></ul><h4 id="框架概述"><a href="#框架概述" class="headerlink" title="框架概述"></a>框架概述</h4><blockquote><p>Widget</p></blockquote><p>无状态的StatelessWidget、有状态的StatefulWidget</p><p>Text<br>Row、Column 基于web开发的Flexbox布局模型<br>Stack 基于Web开发中的绝度定位（absolute positioning )布局模型<br>Container margin、padding、border、background等</p>]]></content>
      
      
      <categories>
          
          <category> Flutter </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>领域驱动设计：软件核心复杂性应对之道</title>
      <link href="2020/03/03/Other/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"/>
      <url>2020/03/03/Other/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<p><strong>领域模型、公共语言、结构化设计</strong></p><p>重视业务逻辑<br>提供灵活性和扩展性</p><p>决定软件复杂性的是设计方法</p><h4 id="两个实践"><a href="#两个实践" class="headerlink" title="两个实践"></a>两个实践</h4><p>1、迭代开发 — ‘敏捷开发’的基础<br>2、开发人员与领域专家具有密切的关系</p><pre><code>领域驱动设计的本质：消化吸收大量知识，最后产生一个反应深层次领域知识并聚焦于关键概念的模型</code></pre><p>敏捷过程强调应对变更和不确定性的能力<br>极限编程承认设计决策的重要性，但强烈反对预先设计</p><h4 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h4><p>1、运用领域模型<br>2、模型驱动设计的构造块<br>3、通过重构来加深理解<br>4、战略设计</p><pre><code>上下文、提炼、大型结构</code></pre><h4 id="运用领域模型"><a href="#运用领域模型" class="headerlink" title="运用领域模型"></a>运用领域模型</h4><p>地图即模型，模型被用来描绘人们所关注的显示或想法的某个方面。<br>模型是一种简化，是对现实的解释 —— 把与解决问题密切相关的方面抽象出来，而忽略无关的细节</p><ul><li><p>3个基本用途决定模型的设计</p><p>  1、模型和设计的核心互相影响<br>  2、模型是团队所有成员使用的通用语言的中枢<br>  3、模型是浓缩的知识</p></li></ul><blockquote><p>消化知识</p></blockquote><ul><li><p>有效建模的要素</p><p>  1、模型和实现的绑定<br>  2、建立一个基于模型的语言<br>  3、开发一个蕴含丰富知识的模型<br>  4、提炼模型<br>  5、头脑风暴</p></li></ul><blockquote><p>交流与语言的使用</p></blockquote><ul><li><p>UBIQUITOUS LANGUAGE</p><p>  通用语言的词汇包括类和主要操作的名称</p></li></ul><blockquote><p>绑定模型和实现</p></blockquote><pre><code>两个基本要素（即模型要支持有效的实现并抽象出关键的领域知识）整体设计的有效性有几个非常敏感的影响因素——那就是细粒度的设计和实现决策的质量和一致性</code></pre><ul><li>MODEL-DRIVEN DESIGN</li><li>HANDS-ON MODELER</li></ul><h4 id="模型驱动设计构造块"><a href="#模型驱动设计构造块" class="headerlink" title="模型驱动设计构造块"></a>模型驱动设计构造块</h4><p>软件设计风格： “职责驱动设计”</p><blockquote><p>分离领域</p></blockquote><ul><li>LAYERED ARCHITECTURE （分层架构）</li><li>领域层是模型的精髓</li><li>THE SMART UI “反模式”</li></ul><blockquote><p>软件中表示的模型</p></blockquote><p>表示模型的3种模型元素模式：ENTITY、VALUE OBJECT和SERVICE。</p><ul><li><p>关联</p></li><li><p>ENTITY（REFERENCEOBJECT）</p></li><li><p>VALUE OBJECT</p></li><li><p>SERVICE</p><p>  好的service 应该具有的特点：<br>  （1）与领域概念相关的操作不是ENTITY或VALUEOBJECT的一个自然组成部分。<br>  （2）接口是根据领域模型的其他元素定义的。<br>  （3）操作是无状态的。</p></li><li><p>MODULE（也称为PACKAGE）</p></li></ul><blockquote><p>领域对象的生命周期</p></blockquote><pre><code>主要挑战： 1、在整个生命周期中维护完整性 2、防止模型陷入管理生命周期复杂性造成的困境当中</code></pre><ul><li><p>解决方案： <strong>工厂</strong>来创建和重建复杂对象和<strong>聚合</strong>，<strong>存储库</strong>提供检查和检索持久化对象并封装庞大基础设施</p></li><li><p>FACTORY</p><p>  每个创建方法都是原子的，并且要保证被创建对象或聚合的所有固定规则。FACTORY生成对象要处于一致的状态。<br>  应该被抽象为所需的类型，而不是所要创建的具体类。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 架构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 架构 </tag>
            
            <tag> 设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>梅特勒托利多</title>
      <link href="2020/01/13/%E6%A2%85%E7%89%B9%E5%8B%92%E6%89%98%E5%88%A9%E5%A4%9A/"/>
      <url>2020/01/13/%E6%A2%85%E7%89%B9%E5%8B%92%E6%89%98%E5%88%A9%E5%A4%9A/</url>
      
        <content type="html"><![CDATA[<p>大多数商用台秤都采用以下两种技术中的一种：应变片技术或电磁力补偿技术 (MonoBloc)。</p><h4 id="串口通讯"><a href="#串口通讯" class="headerlink" title="串口通讯"></a>串口通讯</h4><p>RS-232 适配上位机和PC端进行连接，只限于PC串口和设备间点对点通讯，通讯方式异步，传输数据类型为byte，重要参数：波特率、数据位、停止位、奇偶校验。</p><p>波特率：串口通讯中两个串口之间的通讯单元叫做码元，每分钟传递的信号（码元）即为波特率<br>奇校验：就是让原有数据序列中（包括你要加上的一位）1的个数为奇数 —- 1000110（0）你必须添0这样原来有3个1已经是奇数了所以你添上0之后1的个数还是奇数个。<br>偶校验：就是让原有数据序列中（包括你要加上的一位）1的个数为偶数 —- 1000110（1）你就必须加1了这样原来有3个1要想1的个数为偶数就只能添1了。</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 台秤 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博弈论</title>
      <link href="2020/01/13/%E5%85%AC%E5%BC%80%E8%AF%BE/%E8%80%B6%E9%B2%81/%E5%8D%9A%E5%BC%88%E8%AE%BA/"/>
      <url>2020/01/13/%E5%85%AC%E5%BC%80%E8%AF%BE/%E8%80%B6%E9%B2%81/%E5%8D%9A%E5%BC%88%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="lesson-1"><a href="#lesson-1" class="headerlink" title="lesson 1"></a>lesson 1</h4><ul><li>不要选择严格劣势策略</li><li>如欲得之，必先知之</li><li>理性选择形成劣势策略</li><li>换位思考</li></ul><p>沟通解决不了囚徒境遇</p><blockquote><p>博弈的组成要素</p></blockquote><pre><code>参与人（i,j）、收益(U)、策略组合</code></pre><h4 id="lesson-2"><a href="#lesson-2" class="headerlink" title="lesson 2"></a>lesson 2</h4><p>迭代剔除劣势策略</p><blockquote><p>中为选民定理</p></blockquote><p>模型缺陷：</p><ol><li>多位参与人</li><li>弃权票</li><li>党内初选，多维度分析</li><li>政治立场信任</li><li>现实中选民不均匀分布</li></ol><ul><li>加入约束条件，调整模型</li></ul><blockquote><p>最佳策略</p></blockquote><style>.tableWrap table{    width: 300px;    margin-bottom:1rem;    border-collapse: collapse}.tableWrap table th,.tableWrap table td{    border: 1px solid #cdcdcd;    padding: .3rem}</style><div class="tableWrap"><table><thead><tr><th>-</th><th>L</th><th>R</th></tr></thead><tbody><tr><td>T</td><td>5,1</td><td>0,2</td></tr><tr><td>M</td><td>1,3</td><td>4,1</td></tr><tr><td>D</td><td>4,2</td><td>2,3</td></tr></tbody></table><div><p>Q：哪个参与人存在劣势策略？</p><pre><code>否</code></pre><p>参与人 Ⅰ</p><p>选上是左的最佳策略，选中是右的最佳策略 </p><p>收益：</p><p>2.5 | 2.5 | <code>3</code></p><p>X = 1/3<br>Y = 2/3</p><h4 id="lesson-3"><a href="#lesson-3" class="headerlink" title="lesson 3"></a>lesson 3</h4><p>点球收益</p><div class="tableWrap"><table><thead><tr><th>-</th><th>L</th><th>R</th></tr></thead><tbody><tr><td>L</td><td>4,-4</td><td>9,-9</td></tr><tr><td>C</td><td>6,-6</td><td>6,-6</td></tr><tr><td>R</td><td>9,-9</td><td>4,-4</td></tr></tbody></table><div><p>结论： 不要从中路射门，即不要选择在任何情况下都不是最佳策略的策略</p><p>模型缺陷：</p><ol><li>守门员左右手习惯</li><li>罚球人员左右脚习惯</li><li>守门员可以守中路</li></ol>]]></content>
      
      
      <categories>
          
          <category> 公开课 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 公开课 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千万别说你懂买房 — 徐斌</title>
      <link href="2019/12/31/Other/%E5%8D%83%E4%B8%87%E5%88%AB%E8%AF%B4%E4%BD%A0%E6%87%82%E4%B9%B0%E6%88%BF/"/>
      <url>2019/12/31/Other/%E5%8D%83%E4%B8%87%E5%88%AB%E8%AF%B4%E4%BD%A0%E6%87%82%E4%B9%B0%E6%88%BF/</url>
      
        <content type="html"><![CDATA[<h4 id="二手房买卖"><a href="#二手房买卖" class="headerlink" title="二手房买卖"></a>二手房买卖</h4><p>1、认购资格（认房认贷）<br>2、准备资金<br>3、定金（法律规定定金的数额上限是总房款的20%）<br>4、首付款<br>5、尾款，即贷款（等额本息、等额本金）<br>6、中介费（最高成交价格3%）<br>7、税费（个人所得税、<code>契税</code>、增值税、城建税、<code>印花税</code>、土地增值税、教育附加费、综合地价款、<code>土地出让金</code>等）</p><pre><code>红色标记税费由购房人承担，并且必须在过户之前缴纳必须提前了解（契税、个人所得税、营业税）的免税政策</code></pre><p>8、契税（网签交易价格的1%-3%）<br>9、增值税（合同成交价和取得房屋的交易价格的价差的5%）</p><pre><code>不满2年：总价/1.05%*5.6%满2年以上：普通住宅（免征）、非普通住宅（差价/1.05%*5.6%）</code></pre><p>10、个人所得税</p><pre><code>满五唯一：免个人所得税计算方式：合同成交价的1%；交易差价的20%</code></pre><p><em>避税的危害</em></p><pre><code>过户时产生的税费由买房承担，但是以2万元为上限，超出部分由业主承担</code></pre><h4 id="如何选房"><a href="#如何选房" class="headerlink" title="如何选房"></a>如何选房</h4><p>1、明确房子性质</p><p>商品房、小产权房、回迁房、房改房等；<br>法律上的分类：商品房（一手房，采用<code>期房预售制</code>）、存量房（二手房）</p><pre><code>买房时，土地性质由“划拨”变成“出让”，房子才有从0开始70年使用权，且70年产权是不会重新计算的。</code></pre><p>军产房、央产房、校产房</p><pre><code>公房性质的房屋，上市有不少限制条件；军产房不能起诉</code></pre><p>2、选择小区</p><p>一定要看房（有没有业委会、楼道干不干净、电梯好不好用、安保是否严密、物业评价如何、车位状况、小区环境及公共配套设施）</p><p>3、选房</p><p>环境、噪音、户型、面积、采光、通风、楼层、房屋产权（纠纷“填平原则”）</p><pre><code>房屋产权纠纷解决方法：拉产调</code></pre><h4 id="中介"><a href="#中介" class="headerlink" title="中介"></a>中介</h4><p>· 不要太信任中介<br>· 找多个中介<br>· 找大的中介</p><pre><code>中介公司拼的是规模，而不是服务；中介拼的是业绩，而不是口碑</code></pre><p>中介费在居间服务合同中；<br>第一次签字在看房的时候，会签看房确认单，防跳单条款藏在其中。<br>第二次签字是买卖合同、补充协议，此时决定你的中介费是几个点，代书费：中介代劳书写部分。<br>第三次签字是网签、面签、预约登记等。</p><pre><code>针对中介费讨价还价：看房后、签合同前</code></pre><h4 id="砍价"><a href="#砍价" class="headerlink" title="砍价"></a>砍价</h4><p>价格谈判原则：<br>1、凡是涉及价格、交易流程比较敏感问题，见面聊<br>2、谈判时间越长，对买家越有利<br>3、成交越早，对买家越有利</p><p>谈判内容：<br>1、价格<br>2、交易顺序（先付多少钱，后付多少钱，什么时候付款）<br>3、时间（什么时候办完贷款，什么时候过户）<br>4、解抵押<br>5、税费<br>6、共有权（夫妻共同财产）<br>7、网签（什么时候做，什么价格做）<br>8、定金<br>9、户口<br>10、租户<br>11、交房<br>12、过户<br>13、签约（定金协议、范本合同、补充协议）<br>14、付款</p><h4 id="合同如何签"><a href="#合同如何签" class="headerlink" title="合同如何签"></a>合同如何签</h4><p>注意事项：<br>1、抵押贷款、租赁合同<br>2、房子价格、房款支付方式<br>3、物业交割，需业主承担的费用<br>4、交房时间<br>5、违约金（逾期交房、逾期付款）<br>6、一房二卖，填写银行同期贷款利率<br>7、税费<br>8、过户违约金</p><p>补充协议：</p><p>1、共有权问题，如何规避风险<br>2、住房抵押贷款的问题<br>3、其他抵押权人的抵押<br>4、买方把钱支付给抵押权人，抵押权人配合解抵</p><pre><code>业主要承诺“甲乙任何一方提供的证件等购房所需的资料不完整、不真实或无效，导致无法完成房产交易的，则守约方有权解除合同，同时有权追究违约方总房价2%的违约金”乙方自愿承担过户的税费，但以XXXX元为限，超出部分由甲方承担</code></pre><h4 id="商品房买卖"><a href="#商品房买卖" class="headerlink" title="商品房买卖"></a>商品房买卖</h4><p>不建议买期房<br>提前确认商品房五证（国有土地使用证、建筑用地规划许可证、建设工程规划许可证、建筑工程施工许可证、商品房预售许可证）</p><pre><code>城市规划（容积率、层高、绿化）在前，项目规划在后</code></pre><p>地名：规划局办公司定义名<br>推广名：开发商楼盘名<br>项目名：开发商报给政府的名字<br>土地名：<br>拆迁、招拍挂时期，政府根据规划，给予的土地编号</p><pre><code>注意“代征”道路和绿地</code></pre><p>· 如何获取相关文件？</p><p>政府门户网站、去指定政府部门查询、城建档案馆</p><p>· 如何避开商品房的“坑”？</p><p>看看开发商其他楼盘情况、只买贵的不买最好的（邻居的能力越强，对你越有帮助）</p><p>· 售楼处怎么看怎么问？</p><p>手机风行模式，录音；<br>选一个话多，级别高的销售；<br>要对沙盘图高度敏感，小区内道路和绿化；<br>别太在意赠送面积，<code>阳台、设备平台、飘窗等位置是偷面积的重点区域</code>；<br>凡是我们关心的问题应该让销售进行充分的解释和说明；<br>收集广告信息，拍照留底；</p><pre><code>广告被认为是合同的一部分需要满足两个条件：广告内容明确具体、广告要对房屋价格构成重大影响；</code></pre><p>· 签认购书时留心眼</p><p>正式购房合同何时可以见到</p><h4 id="商品房合同"><a href="#商品房合同" class="headerlink" title="商品房合同"></a>商品房合同</h4><p>1、认购书</p><p>内容：成交价格、房号、定金、何时签订正式合同、不签合同会怎样</p><pre><code>防备明明没有见到正式合同，却说你已经看了，阻断了你以后协商合同条款的权利。通过保留录音证据进行规避风险。</code></pre><p>2、商品房预售合同</p><p>范本合同、五证的证号、房号</p><p>3、补充协议</p><p>律师帮开发商规避麻烦的协议藏在其中</p><pre><code>乙方已经清晰并充分地知晓一切甲方楼盘附近可能的噪声污染源、化工厂、垃圾焚烧站、地铁、轨道交通、高压线等一切有可能对楼盘造成影响的市政设施，乙方同意并认可这些内容。</code></pre><p>4、前期物业服务合同<br>5、业主大会公约<br>6、抵押贷款合同</p><h4 id="收房"><a href="#收房" class="headerlink" title="收房"></a>收房</h4><p>验房、先看房后签字、缴费（契税、公共维修基金、物业费、实测面积差价）</p><ul><li><p>有些房子不能卖！！！<br>没有产权的房子、商住房、售后包租的房子</p><p>  售后包租伴随的问题：租金不到位、物业管理不善、房产证无法办理、商铺经营不善、开发商跑路、管理公司跑路、楼盘烂尾</p></li></ul><h4 id="商品房维权"><a href="#商品房维权" class="headerlink" title="商品房维权"></a>商品房维权</h4><p>开发商对业务是有经验对无经验；<br>组织不起来是常态，组织起来是例外；<br>业主维权过程：导火索 → 平台 → 产生意见领袖 → 信访、谈判、找媒体 → 业主会分裂多个派系 → 产生1、2、3批意见领袖 → 不了了之</p><p>常见问题：<code>组织问题、集资问题、反搭便车</code></p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>投资中最简单的事 — 邱国鹭</title>
      <link href="2019/12/10/Other/%E6%8A%95%E8%B5%84%E4%B8%AD%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%8B/"/>
      <url>2019/12/10/Other/%E6%8A%95%E8%B5%84%E4%B8%AD%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="以实业的眼光做投资"><a href="#以实业的眼光做投资" class="headerlink" title="以实业的眼光做投资"></a>以实业的眼光做投资</h4><p>1、成长是未来的，难预测；门槛是既成的，易把握。<br>高门槛行业：新进入者难存活。行业供给受限，竞争有序，有利于企业盈利增长。<br>低门槛行业：行业供给增长快，无序竞争，谁也赚不到钱。</p><p>2、把客户的钱当作自己的钱来珍惜；把二级市场当作一级市场来分析对待。</p><blockquote><p>企业的商业模式和现金流状况</p></blockquote><p>考虑生意的现金流状况如何，毕竟做生意的最终目的使赚取现金流。</p><pre><code>好公司的标准：做的事情别人做不了。（门槛、决定利润率的高低和趋势）做的事情自己可以重复做。（成长的可复制性、决定销售增速）</code></pre><blockquote><p>行业的竞争格局和公司的比较优势</p></blockquote><p>作为后起之秀，想颠覆既有的龙头地位。自己能够为客户提供哪些不可比拟的价值，以及相对竞争对手的比较竞争优势在哪里</p><p>寡头垄断行业的利润增长往往不断超出预期</p><p>泥里的宝石与庙堂的砖头：市场经常对动态的、暂时的信息过度反应（政策打压、订单超预期），却对静态的、本质的信息反应严重不足（公司的核心竞争优势、行业竞争格局）。</p><h4 id="人弃我取、逆向投资"><a href="#人弃我取、逆向投资" class="headerlink" title="人弃我取、逆向投资"></a>人弃我取、逆向投资</h4><p>新兴行业需求快速成长，不必纠结于供给。传统行业只有控制供给，企业利润才能快速增长。</p><p>高估值买新兴行业而落入成长陷阱的是沉迷于“未得到”；<br>低估值买夕阳行业而落入价值陷阱的是沉迷于“已失去”；<br>投资中风险收益比最高的还是那些容易被低估的“正拥有”。</p><p>凡是盛极而衰，大好之后便是大坏。<br>买别人不买的东西，在没人买的时候买。<br>别人恐惧时我贪婪，别人贪婪时我恐惧。</p><blockquote><p>逆向投资关键</p></blockquote><pre><code>1、看估值是够够低、是否已经过度反应了可能的坏消息2、看遭遇的问题是否是短期问题、是否是可解决的问题3、看股价暴跌本身是否会导致公司的基本面进一步恶化，即是否有索罗斯所说的反身性（恶性循环）。</code></pre><p><code>不是任何行业都适合做逆向投资；</code>有无替代品：有则谨慎，无则积极；是个股问题还是行业问题：是则避开涉事个股，重点研究竞争对手。否则关注受影响相对较小的个股；是主动违规还是被动中枪：是则谨慎，否则积极；问题是否容易解决:是则积极，否则谨慎；<br>涉事企业是否有扎实的根基，悠久的历史传承和广泛的品牌美誉度在危机中往往有决定性作用。<br>是否有突出的受害者个例，这决定类事件对消费者的影响是否持久。</p><p>最一致的时候就是最危险的时候，人多的地方不去</p><h4 id="便宜是硬道理"><a href="#便宜是硬道理" class="headerlink" title="便宜是硬道理"></a>便宜是硬道理</h4><p>有销售半径的行业，重要的不是全国市场占有率，而是区域市场集中度。<br>无序竞争过渡到有序竞争，是值得关注的行业拐点。</p><blockquote><p>价格本质上是一种货币现象</p></blockquote><p>投资中影响股价涨跌的因素重要的两点：估值，流动性。</p><p>你只要买的便宜，就可以卖的便宜。</p><p>世界的特点是骗子越来越多，傻瓜不够用，不能总指望别人当傻瓜。</p><p>公司有四种：好的、平庸的、烂的、看不懂的；<br>股票也有四种：被低估的、合理的、被高估的、估不准的。</p><blockquote><p>要牢牢抓住定价权</p></blockquote><p>所谓的<code>投资，就是牢牢抓住定价权</code>。</p><p>1、投资，一定要先选行业（有门槛，有积累，有定价权的行业）。</p><p>定价权的来源：垄断、品牌、技术专利、资源矿产、相对稀缺的某种资产。</p><p>不要寄生式增长，要核心竞争力。</p><p>2、投资，还要想好你要做什么样的投资人。</p><p>快进快出：零和博弈、正和博弈</p><blockquote><p>三个层次悲观</p></blockquote><p>1、基于流动性和供求关系的悲观。<br>2、基本面的悲观。</p><pre><code>世界是不断变化的，你若静止不动，就会被人家落在后面。有一定资产的人，必须不断思考一个问题：我的财富以什么样的形式存在才最容易保值增值。投资风险：本金永久性丧失、价格波动的风险（投资者必须承担的风险）。</code></pre><p>3、长期悲观，对中国经济增长模式的悲观。</p><p>做投资真正想赚到比别人更多的收益，就要保持一个判断的独立性。</p><blockquote><p>市场情绪周期</p></blockquote><p>担忧、抵赖、害怕、绝望、恐惧、放弃、麻木、沮丧</p><blockquote><p>投资需谨慎的地方</p></blockquote><p>你看到的是你想看到的；你证明的是你想证明的；你听到的是你想听到的。<br>同一事情的不同解读，需要考虑时间跨度不同。</p><p>简洁不是把杂乱无章的东西变少或拿掉，而是挖掘复杂性的深度。你必须深刻的把握精髓，从而判断出哪些不重要的是可以拿掉的。</p><h4 id="投资的三个基本问题"><a href="#投资的三个基本问题" class="headerlink" title="投资的三个基本问题"></a>投资的三个基本问题</h4><p>为什么认为一家公司便宜，（估值的问题）<br>为什么认为一家公司好，（公司品质的问题）<br>为什么认为要现在买。（买卖时机的问题）</p><blockquote><p>估值</p></blockquote><p>市盈率、市净率、市销率，企业估值倍数等</p><p>价值投资是有效的；价值投资不是每年都有效。</p><p>投资理念：<code>在好行业中挑选好公司，等待好价格时买入</code>。</p><blockquote><p>分析工具</p></blockquote><p>1、波特五力分析</p><p>公司对上下游的议价权、与竞争对手的比较优势、行业对潜在进入者的门槛</p><p>2、杜邦分析</p><p>弄清楚公司盈利模式（高利润、高周转、高杠杆），然后看公司战略规划、团队背景和管理执行力是否和商业模式一致。<br>高利润：广告投入、研发投入、产品定位、差异化营销是否合理<br>高周转：运营管理能力、渠道管理能力、成本控制能力<br>高杠杆：风险控制能力、融资成本高低等</p><p>3、估值分析</p><p>同业横比和历史纵比，市值与成长空间比，被低估时买入。</p><pre><code>纠错能力，逆向投资</code></pre><blockquote><p>品质</p></blockquote><p>小公司骑师更重要，大公司就是机制和文化更重要。</p><p>你对你的竞争对手怎么看？<br>最近竞争对手有没有什么做法让你特别难受？<br>你最近有没有什么做法让你的竞争对感到难受？</p><pre><code>对政府扶植的新兴行业需谨慎</code></pre><p>差异化竞争和同质化竞争的区别</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>丰田一页纸极简思考法 — 浅田卓</title>
      <link href="2019/12/05/Other/%E4%B8%B0%E7%94%B0%E4%B8%80%E9%A1%B5%E7%BA%B8%E6%9E%81%E7%AE%80%E6%80%9D%E8%80%83%E6%B3%95/"/>
      <url>2019/12/05/Other/%E4%B8%B0%E7%94%B0%E4%B8%80%E9%A1%B5%E7%BA%B8%E6%9E%81%E7%AE%80%E6%80%9D%E8%80%83%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>Excel1 &amp; Logic3</p><h4 id="小贴士"><a href="#小贴士" class="headerlink" title="小贴士"></a>小贴士</h4><p>1、要将信息或资料整理成可以向别人解释说明的形式</p><pre><code>转换视角：从“我想表达什么”转换成“对方想知道什么”</code></pre><p>2、明确对象，明确目的</p><p>3、行动优先</p><p>一句话描述：整理信息和思维的技巧在于明确“对象”和“目标”之后，把对方想知道的信息“写”出来。</p><h4 id="Excel1"><a href="#Excel1" class="headerlink" title="Excel1"></a>Excel1</h4><p>1、制作框架<br>2、写日期和主题<br>3、关键字填空<br>4、以整理过的信息为基础整理思考</p><p><img src="/images/excel1.jpg" alt="excel1"></p><h4 id="Logic3"><a href="#Logic3" class="headerlink" title="Logic3"></a>Logic3</h4><p>1、制作框架<br>2、写日期、主题、“1P”、“Q1~3”<br>3、填空</p><p><img src="/images/logic3.jpg" alt="logic3"></p><ul><li><p>站在阅读“对象”的角度考虑问题？</p><p>  制作“吐槽清单”</p></li></ul><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><p>一览性、表格化、主体化</p><pre><code>资料有时需要重新整理：补充被省略的信息 -- “当事人意识”减少不均衡、勉强、无用功 -- “时间可视化”</code></pre>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>六顶思维帽 — 爱德华·德博诺</title>
      <link href="2019/11/26/Other/%E5%85%AD%E9%A1%B6%E6%80%9D%E7%BB%B4%E5%B8%BD/"/>
      <url>2019/11/26/Other/%E5%85%AD%E9%A1%B6%E6%80%9D%E7%BB%B4%E5%B8%BD/</url>
      
        <content type="html"><![CDATA[<p>西方思维是由希腊“三巨擎”基于辩论而设计，① 关注“是什么”，其结论是经过分析，判断和辩论而得出的。</p><p>苏格拉底：重视辩证法和辩论；<br>亚里士多德：容斥逻辑；</p><p>② 关注“能够怎样”，关注建设性思考、创造性思考。</p><p>六顶思维帽平行思考理论，<code>思考帽只是方向</code>，不是对先已发生的事件所做的描述。问题并不是每个人都说出了自己的喜欢，然后用帽子来描述他们说了什么，而是要<code>开始沿着那个特定的方向思考</code>。</p><p>效果：<br> 1、强大有力，聚焦问题<br> 2、节约时间<br> 3、摒弃自大<br> 4、逐一思考</p><pre><code>冲突和对抗思考让自大问题更加恶化。混乱是高效思考的最大敌人。</code></pre><h4 id="白帽子"><a href="#白帽子" class="headerlink" title="白帽子"></a>白帽子</h4><p>中立客观，关注客观事实和数据信息（现有信息、所需信息、要提出的问题、其他获得信息的方式） “律师思维模式”。<br>目的是集中精力寻找并列举出信息（请只讲事实—-不要辩论）。<br>不应平白无故将一件事情提高一个层次。<br>任何<code>信息</code>基于<code>两层结构体系</code>。<br>一层：已经核实或证实的事实<br>二层：据信为真但尚未充分核实的事实<br>概率范围：始终如此~绝非如此、大体上、有时、偶尔等</p><pre><code>事实和数据、事实？推断？解读？、日式输入、真理和哲学家</code></pre><h4 id="红帽子"><a href="#红帽子" class="headerlink" title="红帽子"></a>红帽子</h4><p>要求对某一个具体事项注入情感、直觉和情绪，提供感性的看法。<br>目的是表达现有的情感，而不会强迫任何人做出判断。<br>人对价值观的反应总是情绪化。<br>情感分为普通情感（恐惧、厌恶、喜欢等）、复杂的判断（预感、直觉、感觉、品味等）。<br>使用红帽时不应该试图为自己的情感辩解或提供符合逻辑的理由。</p><pre><code>情绪与情感、直觉和语感、时时刻刻、用对情绪</code></pre><h4 id="黑帽子"><a href="#黑帽子" class="headerlink" title="黑帽子"></a>黑帽子</h4><p>意味着小心谨慎，代表困难、危险和潜在的问题。强调批判性思维和谨慎态度指向一个想法的弱点。</p><pre><code>谨慎和小心、内容和过程、过去和未来、过度使用的问题</code></pre><h4 id="黄帽子"><a href="#黄帽子" class="headerlink" title="黄帽子"></a>黄帽子</h4><p>代表乐观，考虑优点、价值，提供希望和积极的思考。<br>需要培养一种“<code>价值敏感性</code>”。<br>价值和优点不可能始终浮在水面，必须努力找寻方可获得。<br>强调探索价值、利益和积极的假设。<br>建设性和启发性的想法、建议和方案是由黄帽思考生成的。</p><pre><code>冒险与积极探索、积极地范围、理由和逻辑证据、建设性思考、投机远见、与创造力的关系</code></pre><h4 id="绿帽子"><a href="#绿帽子" class="headerlink" title="绿帽子"></a>绿帽子</h4><p>代表创造力，寻找新点子，提供备选方案。</p><pre><code>创造性思考、水平思考、行动而非判断、激发的必要性、备选、性格与技能</code></pre><h4 id="蓝帽子"><a href="#蓝帽子" class="headerlink" title="蓝帽子"></a>蓝帽子</h4><p>思考的组织者，负责过程控制，对思考进行管理。<br>负责维持纪律，负责宣布更换思考帽。<br>控制和整理思考过程、有条理地使用其他思考帽。<br>负责小结、综述和总结。</p><pre><code>掌控思考、专注、程序设计、归纳和总结、控制和监控</code></pre><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>成对思考：<br> 1、白帽子和红帽子<br> 2、黄帽子和黑帽子<br> 3、绿帽子和蓝帽子</p><p>使用原则：<br> 1、记录<br> 2、定时，红帽子定时应当设置短时间</p><pre><code>利益、弊端、情感、事实</code></pre>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>22条商规 — 艾·里斯&amp;杰克·特劳特</title>
      <link href="2019/11/25/Other/22%E6%9D%A1%E5%95%86%E8%A7%84/"/>
      <url>2019/11/25/Other/22%E6%9D%A1%E5%95%86%E8%A7%84/</url>
      
        <content type="html"><![CDATA[<p><strong>领先定律</strong></p><p>成为第一，成为品类代名词。在顾客心智中先入为主，要比让顾客相信你的产品优于该领域的首创品牌容易的多。</p><p><strong>品类定律</strong></p><p>如果不能第一个进入某个品类，那就创造一个品类使自己成为第一。</p><p><strong>心智定律</strong></p><p>市场营销是一场争夺认知而不是产品的战场</p><p><strong>认知定律</strong></p><p>市场领域不存在客观现实性，也不存在事实，更不存在最好的产品。存在的只是顾客心智中的认知。只有这种认知才是事实，其他都是幻觉。</p><p><strong>聚焦定律</strong></p><p>收缩经营范围是你强大</p><p><strong>专有定律</strong></p><p>当你的竞争对手已经在客户心智中拥有一个代名词或定位时，你想再拥有同一个代名词，将是徒劳无益。</p><p><strong>阶梯定律</strong></p><p>产品不是平等的。顾客在做购买决策时总会对各品牌进行排序。对于每一个品类，顾客的心智中会形成一个有选购循序的阶梯，每个品牌占有一层阶梯。</p><p><strong>二元定律</strong></p><p>从总体和长远的角度来看，市场会演化成两个品牌竞争的局面：值得信赖的老品牌、后起之秀。—— “两匹马竞争”</p><p><strong>对立定律</strong></p><p>战略定位由对手决定。强势之中隐藏着弱势。</p><p><strong>分化定律</strong></p><p>每一个品类总是始于单一品类，但是一段时间后，这个品类开始分化成几个小品类。</p><p><strong>长效定律</strong></p><p>短期内，促销能增加公司的销售额；<br>长期来看，促销只会减少公司的销售额。<br>因为它教会顾客不要在“正常”价格时买东西。</p><p><strong>延伸定律</strong></p><p>多便是少。产品越多，市场越大，战线越长，赚的钱反而越少。</p><p><strong>牺牲定律</strong></p><p>更大的网可以捕捉更多的顾客。但事实证明，恰恰相反。</p><p><strong>特性定律</strong></p><p>必须有自己独特的认知或特性，并以此为中心展开营销。如果没有任何特性，那就用最低的价格。</p><p><strong>坦诚定律</strong></p><p>使自己的产品深入人心的最有效的方法是承认自己的不足，之后将其转变为优势。</p><p><strong>唯一定律</strong></p><p>大多数情况下，你的竞争者只有一个容易攻破的薄弱环节，全力攻击这个环节。</p><p><strong>莫测定律</strong></p><p>应对不可预见的未来情况的方法之一：建立具有极大灵活性的企业组织。<br>当你所经营品类的市场发生根本性变化时，若想长久地生存下去，必须做出变革，并且能够快递地进行变革。</p><p><strong>成功定律</strong></p><p>成功往往会导致贸然延时产品线。当一个品牌获得成功后，公司会急切的给其他产品冠以相同的名称。<br>自大是营销获得成功的敌人。</p><p><strong>失败定律</strong></p><p>面对错误的现实无所作为不利于你的事业。更佳的战略是尽早发现错误并及时采取措施止损。</p><p><strong>炒作定律</strong></p><p>真正的革命是悄无声息的到来。</p><p><strong>趋势定律</strong></p><p>一个正在迅速崛起的行业，具有时尚的一切特征，那么淡化时尚。通过淡化时尚，你能使之流行的时间延长，从而使它更像一种趋势。</p><p><strong>资源定律</strong></p><p>你需要资金使自己的想法进入顾客的心中，一旦进入，你还需要资金使自己的想法继续留在顾客的心中。</p><pre><code>总结：领先定律对于许多公司来讲，是难以接受的。他们认为自己登上顶峰是因为他们做的更好，而不是因为他们第一个进入市场。认知定律与大多数公司的企业文化相反。牺牲定律可能会给你带来麻烦。因为没有人愿意只提供一种产品或服务。聚焦定律建议在顾客心智中拥有一个代名词。长效定律会向那些希望尽快获得营销业绩的人泼冷水，公司想看到立竿见影的效果。延伸定律是所有法则中最危险的一条。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>世界上最伟大的推销员 — 尼莫</title>
      <link href="2019/11/25/Other/%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E4%BC%9F%E5%A4%A7%E7%9A%84%E6%8E%A8%E9%94%80%E5%91%98/"/>
      <url>2019/11/25/Other/%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E4%BC%9F%E5%A4%A7%E7%9A%84%E6%8E%A8%E9%94%80%E5%91%98/</url>
      
        <content type="html"><![CDATA[<p>· 我们与乞丐的区别并不在金钱的有无，而是目标的有无。乞丐是为果腹而活，我们是为不再挨饿而活。</p><p>· 穷人最缺少成为富翁的梦想</p><p>· 闲暇有时候是因为实力，有时候也是因为无知</p><p>· 没有明确目标的人为有目标的人制造商机，有目标的人利用商机为未来打拼</p><p>· 理想在人的一生中具有引导（<code>明确的目标</code>）和动力保障（<code>执着的追求</code>）的作用。</p><p>· 目标有执行的可能必须注意点：<code>自身力量和限度的了解；符合实际的愿望</code></p><p>· 世间唯有行动是有意义的</p><p>· 观察、斟酌、合作、规划、调整</p><p>· 客户的信任源于我们的承担</p><p>· 任何商品都有可能在关键时刻显露多多少少的缺陷，此时千万不要掩藏商品的缺陷，如果我们那样做了，我们在别人心中就会是一个缺口的盘子</p><p>· 语言不是藏在嘴巴里，而是从我们的大脑中输出的思维。妙语连珠一定是经过思维过滤的精华。</p><p>· “一三七”法则<br>· “一”：售出产品的第一天，应当与客户及时联系，询问客户是否使用了该产品<br>· “三”：成交隔三天后再与客户联系<br>· “七”：七天后与客户联系</p><p>· 重新创业的过程是艰辛的，让别人相信一个失败者会成功更是难上加难。</p><p>· 当机会来临时为什么我们无法确认，因为机会总是乔装成问题的样子，总是以职责范围外的形式出现在我们面前。</p><p>· 不断进步的人才有机遇</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何有效管理每一分钱 — 小山龙介</title>
      <link href="2019/11/25/Other/%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E7%AE%A1%E7%90%86%E6%AF%8F%E4%B8%80%E5%88%86%E9%92%B1/"/>
      <url>2019/11/25/Other/%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E7%AE%A1%E7%90%86%E6%AF%8F%E4%B8%80%E5%88%86%E9%92%B1/</url>
      
        <content type="html"><![CDATA[<h4 id="账本管理技巧"><a href="#账本管理技巧" class="headerlink" title="账本管理技巧"></a>账本管理技巧</h4><ul><li><p>利润表（P/L）</p><p>营业收入<br>营业成本<br>——毛利润<br>销售、管理费用<br>——营业利润<br>营业外收入<br>营业外支出<br>——利润总额<br>特别利润<br>特别损失<br>——税前净利润<br>税收<br>——净利润</p></li><li><p>资产负债表（B/S）</p></li></ul><p>① 记录资产<br>② 记录负责<br>③ 计算净资产</p><ul><li><p>余额法则 —— 小猪存钱罐效果</p><p><code>早上金额 - 晚上余额</code></p></li><li><p>无视零钱 “纸币法则” —— 经营者视角效果</p><p>单位：“百元”，“千元”，“万元”，“百万元” …</p></li><li><p>账本快照 “随意法则” —— 财务快照效果</p></li><li><p>习惯纸币单位</p><p><code>10，000，000，000</code></p></li></ul><h4 id="资产管理技巧"><a href="#资产管理技巧" class="headerlink" title="资产管理技巧"></a>资产管理技巧</h4><p>1、把握贷款余额，增强节约意识</p><p> <code>贷款余额法则：财政紧缩效果</code></p><p>2、固定资产需折旧</p><p>3、零残值法则</p><p> <code>固定资产残值归零：明智购物效果</code></p><p>4、固定资产换购</p><p> <code>固定资产换购法则：固定资产流动性效果</code></p><p>5、压缩“看不见的负责”</p><p> <code>停车费、保险、年检、油费、物业费、家庭财产保险、维修公积金等</code><br> <code>将浪费时间的东西视为负债</code></p><p> <code>出售资产，换取资金压缩负债</code></p><h4 id="开支管理技巧"><a href="#开支管理技巧" class="headerlink" title="开支管理技巧"></a>开支管理技巧</h4><p>重组三步：财务重组、经营重组和投资重组</p><blockquote><p>费用思维方式</p></blockquote><p>机会成本：由于某件事情而失去了原本应该得到的利润，并使之为费用。<br>成本：生产商品而产生的费用。<br>沉没成本：已经发生的费用，但这类费用在做经营判断时视为无视。</p><pre><code>决定之前优先考虑机会成本。</code></pre><h4 id="财务记录技巧"><a href="#财务记录技巧" class="headerlink" title="财务记录技巧"></a>财务记录技巧</h4><p>1、保留购物小票<br>2、复式记账法<br>3、制作浪费清单<br>4、设立专有账户</p><p> <code>日常消费专有账户、储蓄专有账户、投资专有账户</code></p><p>5、钱要优先使用在自己身上</p><h4 id="投资技巧"><a href="#投资技巧" class="headerlink" title="投资技巧"></a>投资技巧</h4><p>1、钱可以生钱<br>2、不存在低风险、高回报的投资<br>3、优先还贷原则<br>4、考虑长期投资<br>5、投资不分散，资产要分散<br>6、根据市场状况改变资产配置<br>7、长期复利投资，让时间帮你赚钱<br>8、自我投资，小投入大回报</p><h4 id="企业分析技巧"><a href="#企业分析技巧" class="headerlink" title="企业分析技巧"></a>企业分析技巧</h4><p>决定企业运作的三大齿轮：</p><p>① 购货与付款循环<br>② 销售与收款循环<br>③ 筹资与投资循环</p><p>①、②：时间间隔“月末结账次月末付款”</p><pre><code>活用信用期间，创造利润企业状态不好首先反应在销售与收款循环购货与付款循环的变化是亮黄灯应收账款不断变化的企业有问题不能相信流动比率（流动资金/负债*100%）劳动分配率（人事费用/附加价值*100%）是没有任何利润的无用指标现金流不会说谎时间观念与现金流</code></pre><p><strong>营业收入是企业的力量</strong></p><p>定价是经营者的工作<br>免费是最强武器<br>熟客是生意长久地根本之道</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 财务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>学会学习 — 斋藤孝</title>
      <link href="2019/11/25/Other/%E5%AD%A6%E4%BC%9A%E5%AD%A6%E4%B9%A0/"/>
      <url>2019/11/25/Other/%E5%AD%A6%E4%BC%9A%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><strong>德鲁克</strong></p><blockquote><p>“目标管理&amp;命名思考法”</p></blockquote><p>① 制定目标<br>② 决定期限<br>③ 根据实际情况进行调整</p><p>适用人群：<br> 1、有干劲，却看不到成果的人<br> 2、视野较狭，很难做到顾全大局的人<br> 3、想要尽快抓住事物本质的人<br> 4、喜欢命名或下定义的人<br> 5、想做创造性工作的人</p><p><strong>本田宗一郎</strong></p><blockquote><p>“不请自来学习法&amp;耳学与经验融合”</p></blockquote><p>OJT：on the job training</p><p>适用人群：<br> 1、感觉做事没有激情与热情的人<br> 2、想要摆脱学历自卑的人<br> 3、喜欢倾听的人<br> 4、学习目标非常明确的人<br> 5、实践比死读书更容易激发学习热情的人</p><p><strong>斯蒂芬·金</strong></p><blockquote><p>“外界屏蔽法”</p></blockquote><p>① 创造一个场景<br>② 与外界隔绝<br>③ 沉浸其中</p><p>适用人群：<br> 1、难以养成学习习惯的人<br> 2、喜欢找借口说事的人<br> 3、想做到注意力迅速集中的re</p><p><strong>夏目漱石</strong></p><blockquote><p>“个人主义学问”</p></blockquote><p>① 对环境的适应能力<br>② 彻底换个角度思考问题</p><p>适用人群：<br> 1、特别认真，容易郁闷的人<br> 2、容易因自卑陷入困境的人<br> 3、不愿意随波逐流的人<br> 4、想要创业的人</p><p><strong>歌德</strong></p><blockquote><p>“限定法”</p></blockquote><p>① 让自己专注于一件事<br>② 眼观六路、行为专一</p><p>适用人群：<br> 1、兴趣广泛，什么都想尝试的人<br> 2、虽然有自行，但不喜欢努力的人<br> 3、喜欢找捷径的人</p><p><strong>吉田松阴</strong></p><blockquote><p>“相互学习法”</p></blockquote><p>① 以“飞耳长目”为目标</p><pre><code>洽闻博见，即有卓越的观察力和情报收集能力</code></pre><p>适用人群：<br> 1、做事没有激情的人<br> 2、一个提不起干劲的人<br> 3、好奇心旺盛，想要到处走走、看看的人<br> 4、一懂得新知识就像分享给别人的人</p><p><strong>福泽谕吉</strong></p><blockquote><p>“切磋学习法”</p></blockquote><p>① 永不言败<br>② 苦中作乐<br>③ 同一屋檐下的学习干劲与羁绊</p><p>适用人群：<br> 1、容易找借口放松对自己要求的人<br> 2、想要习惯与他人相处的人<br> 3、想要增强自身实力的人<br> 4、想要提高团队凝聚力的人</p><p><strong>涩泽荣一</strong></p><blockquote><p>“古典学习法”</p></blockquote><p>① 把《论语》作为内心支柱 —— 论语与算盘<br>② 经济与道德相协调<br>③ 把前人的知识当做精神支柱</p><p>适用人群：<br> 1、缺少精神支柱的人<br> 2、决断时容易冲动的人<br> 3、想要找到坚定原则的人<br> 4、想要创业的人</p><p><strong>香奈儿</strong></p><blockquote><p>“对镜观察法”</p></blockquote><p>① 打破常识的想法——不掩饰缺点<br>② 在一流的人际关系中获得启示<br>③ 镜子</p><p>适用人群：<br> 1、叛逆、任性的人<br> 2、容易随波逐流、迷失自我的人<br> 3、不愿意亦步亦趋的人</p><p><strong>木田元</strong></p><blockquote><p>“外语背诵学习法”</p></blockquote><p>① 用记忆力学习语言</p><p>适用人群：<br> 1、希望每天能有规律、按计划学习的人<br> 2、培养自己短时间阅读能力的人<br> 3、学习中有必要阅读原作的人<br> 4、记忆力好的人</p><p><strong>坂口安吾</strong></p><blockquote><p>“翻字典断绝妄想学习法”</p></blockquote><p>适用人群：<br> 1、容易焦虑不安、内心苦闷的人<br> 2、想学习却不知道学什么的人<br> 3、想要明确看到自己进步的人<br> 4、想挑战高难度外语的人</p><p><strong>谢丽曼</strong></p><blockquote><p>“追求冒险学习法”</p></blockquote><p>适用人群：<br> 1、从不曾为学习而着迷的人<br> 2、曾放弃过梦想的人<br> 3、想为更大的冒险赌一次的人<br> 4、放弃经商，去其他领域打拼的人</p><p><strong>佐伯佑三</strong></p><blockquote><p>“激情点燃法”</p></blockquote><p>① 不断接受外界的刺激<br>② 不畏惧外界的批评</p><p>适用人群：<br> 1、觉得无法突破自我的人<br> 2、内心坚强、能接受批评和刺激的人</p><p><strong>爱因斯坦</strong></p><blockquote><p>“张驰有度学习法”</p></blockquote><p>① 兴趣与工作的互补</p><p>适用人群：<br> 1、容易陷入专业领域、困于狭小世界的人<br> 2、感情很少外露的人<br> 3、想找一个能解放内心的兴趣，幸福活下去的人</p><p><strong>南方熊楠</strong></p><blockquote><p>“图书馆抄阅法”</p></blockquote><p>① 通过抄写掌握知识</p><p>适用人群：<br> 1、独自学习就无法集中注意力的人<br> 2、没有体会过调查未知事物之乐的人<br> 3、喜欢图书馆氛围的人</p><p><strong>村上春树</strong></p><blockquote><p>“体能强化法”</p></blockquote><p>① 通过体能强化，锻炼自己的精神力与体力</p><p>适用人群：<br> 1、容易忽略身体重要性的人<br> 2、努力了却看不到成效而发愁的人<br> 3、喜欢朝着目标不断更新自我的人<br> 4、挖掘自身潜能的人</p><p><strong>斋藤孝</strong></p><blockquote><p>“立竿见影速效学习法” —— 把短板变成兴趣<br>“连休集训学习法” —— 短时间树立自信心<br>“集中学习法” —— 注意力集中，进入巅峰领域<br>“白纸活用法” —— 随时记录灵感<br>“身临其境学习法”<br>“简报学习法” —— 用简报构建自己的世界<br>“王牌参考书反复练习” —— 让“听懂”升华为“会做”</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用经济思维看世界格局 — 徐伯赢</title>
      <link href="2019/11/25/Other/%E7%94%A8%E7%BB%8F%E6%B5%8E%E6%80%9D%E7%BB%B4%E7%9C%8B%E4%B8%96%E7%95%8C%E6%A0%BC%E5%B1%80/"/>
      <url>2019/11/25/Other/%E7%94%A8%E7%BB%8F%E6%B5%8E%E6%80%9D%E7%BB%B4%E7%9C%8B%E4%B8%96%E7%95%8C%E6%A0%BC%E5%B1%80/</url>
      
        <content type="html"><![CDATA[<p>—— 1945年 二战结束</p><p>美国拥有全球3/4黄金，“布雷顿森林体系” -&gt; 双挂钩：美元直接与黄金挂钩，其他货币与美元挂钩，即固定汇率制<br>美元成了GATT，关税及贸易总协定体系的太上皇</p><p>—— 1973年 </p><p>美国支持以色列打赢第四次中东战争<br>苏联攻打阿富汗（帝国坟场）</p><p>“滞胀期”（经济停滞加通货膨胀）</p><p>—— 1980年 日元经济区</p><p>“雁阵模式”</p><p>“燕头”：日本<br>“燕翼”：亚洲四小龙（东亚、新加坡、韩国、香港台湾地区）、四小虎（泰国、马来西亚、印尼、菲律宾）<br>“燕尾”：中国</p><p>—— 1985年 “广场协议” -&gt; “经济泡沫” -&gt; 89年，政府采取紧缩政策</p><p>—— 1991年 苏联解体</p><p>乌克兰，俄罗斯的龙兴之地。</p><p>—— 1992年 老布什下台，克林顿当选总统</p><p>—— 1997年 东南亚金融危机</p><p>—— 1998年 车臣，达吉斯坦共和国</p><p>美国主导：夺取高加索及邻近地区数万亿美元的石油和天然气资源；永久剥夺俄罗斯在高加索地区及周边地区的影响力。</p><p>—— 1998年8月13日 俄罗斯金融危机</p><p>索罗斯“量子基金”，美国长期资本管理公司（LTCM），美国银行家信托公司</p><p>俄罗斯反击：关门打狗，卢布贬值50%<br>同时期中国香港：关门打狗</p><p>—— 1999年1月1日 欧元区成立</p><p>—— 1999年3月24日 “科索沃”战争 巴尔干半岛 –“欧洲火药桶”</p><p>—— 1999年5月8日 南斯拉夫联盟大使馆爆炸（“战略测试”）</p><p>中欧合作、俄罗斯维和部队入驻科索沃</p><p>—— 1999年6月11日 上海合作组织：联俄抗美</p><p>—— 2001年 小布什当选总统<br>—— 2001年12月 中国加入“WTO”</p><pre><code>如果有10%的利润，资本保证到处被使用；有20%的利润，资本就活跃起来；有50%的利润，资本就铤而走险；有100%的利润，资本就敢践踏一切人间法律；有300%的利润，资本就敢犯任何罪行。</code></pre><p>2001~2008·全球贸易体系经济框架：</p><p>“最高级”：美国 <code>全球化框架的构建和维持</code><br>“次高级”：发达国家（欧洲、美国） <code>负责提供信用货币、关键技术</code><br>“次低级”：中国，发展中国家 <code>负责组装</code><br>“最低级”：非洲，拉美州等 <code>为全球经济提供原材料、能源、矿产和半成品等</code></p><p>—— 2003年3月20日 美国宣战伊拉克</p><p>“中美经济小循环” + “全球经济大循环”</p><p>—— 2005年 人民币被迫升值（小幅度、渐进式），房地产开发（日本模式）</p><p>中国经济“宏观调控”介入:<br>1、房价必须保持上涨<br>2、房价的上涨幅度，不危机国家金融安全为上限</p><p>—— 2008年 </p><p>· 7月13日 地中海联盟（欧盟）</p><p>“最高级”：西欧各国提供资金和金融服务<br>“次高级”：西欧各国提供高素质劳动力和技术管理<br>“次低级”：中东欧国家提供廉价劳动力<br>“最低级”：中东欧+北非+剩余国家</p><p>欧元将美元挤出中东后，控制中东产油国，以石油为保证，实现“石油欧元”的基础。</p><p>· 中俄贸易启动以卢布和人民币结算的进程 <code>中俄贸易将会脱离美元</code></p><p>· 9月15日 金融风暴</p><p>· 11月15日 G20金融峰会 <code>改革国际货币金融体系</code></p><p>· 中国实行“货币互换协议”，“白衣骑士”进入欧洲</p><p>—— 2010年 希腊“48亿欧元紧缩方案”</p><p>—— 2012年1月3日 欧元区主权信用降级</p><p>—— “一带一路” 亚欧大陆经济整合</p><p>—— 2017年1月20日 特普朗废除奥巴马TPP（跨太平洋伙伴关系协定）</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图论</title>
      <link href="2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E5%9B%BE%E8%AE%BA/"/>
      <url>2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E5%9B%BE%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="柯尼斯堡问题"><a href="#柯尼斯堡问题" class="headerlink" title="柯尼斯堡问题"></a>柯尼斯堡问题</h4><p>1738年 欧拉（瑞士）</p><h4 id="汉密尔顿回路"><a href="#汉密尔顿回路" class="headerlink" title="汉密尔顿回路"></a>汉密尔顿回路</h4><p>1859年 汉密尔顿（英国）</p><p>一笔画条件：奇点数目是0或者2</p><h4 id="四色猜想"><a href="#四色猜想" class="headerlink" title="四色猜想"></a>四色猜想</h4>]]></content>
      
      
      <categories>
          
          <category> 数学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数论</title>
      <link href="2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/"/>
      <url>2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 数学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数论</title>
      <link href="2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%95%B0%E5%AD%A6/"/>
      <url>2019/11/25/Other/%E6%95%B0%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%95%B0%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 数学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 反射</title>
      <link href="2019/11/21/Java/Java%20%E5%8F%8D%E5%B0%84/"/>
      <url>2019/11/21/Java/Java%20%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<h4 id="reflect"><a href="#reflect" class="headerlink" title="reflect"></a>reflect</h4><p>反射机制用来描述所有的类，所有的类具有相同的特征（属性、方法、构造、权限修饰符）</p><p>Class       描述类本身<br>Package<br>Field       描述类中的属性<br>Method      描述类的方法<br>Constructor<br>Annotation  注解 @Override</p><blockquote><p>获取 Class </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">① Class clazz = Class.forName(<span class="string">&quot;类全名：包名.类名&quot;</span>); <span class="comment">//编译异常</span></span><br><span class="line">② Class clazz = 类名.class;</span><br><span class="line">③ Class clazz = 对象.getClass();</span><br></pre></td></tr></table></figure><p>常用方法：</p><p>clazz.getModifiers(); //修饰符（权限，特征）返回值 int:0-1-2-4-8-16-32-64-128-256-512-1024（默认-public-private-protected-static-final-synchronized-volatile-transient-native-interface-abstract）</p><p>clazz.getName(); //包名.类名<br>clazz.getSimpleName(); //类名</p><p>clazz.getPackage();</p><p>clazz.getSuperClass(); //获取父类</p><p>clazz.getInterfaces(); //获取父接口</p><p>clazz.newInstance(); //创建对象，返回值 Object 需要造型</p><p>Field field = clazz.getField(“属性名”);<br>clazz.getFields(); //以上两个方法只能获取公有的属性，包含继承的父类属性</p><p>Field f = clazz.getDeclaredField(); //可以获取本类中公有、私有属性，操作异常<br>f.setAccessible(true); //可以操作私有属性</p><p>field.getModifiers();<br>field.getType(); //获取属性类型<br>field.getName(); </p><p>field.set(对象，”属性值”);<br>field.get(对象);</p><p>Method m = clazz.getMethod(“方法名”,”参数类型.class”); //获取公有方法，包含继承的父类方法<br>m.getParameterTypes();<br>m.invoke(“对象”,…args:”参数”); //调用方法，返回值 Object</p><p>Method m = clazz.getDeclaredMethod(“方法名”,”参数类型.class”); //可以获取本类中公有、私有方法，操作异常<br>m.setAccessible(true); //可以操作私有方法</p><p>con = clazz.getConstructor([“参数类型.class”]);<br>con.newInstance(…”参数”);</p><h4 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h4><blockquote><p>格式 </p></blockquote><p>@注解说明[(一些信息)]</p><blockquote><p>放置</p></blockquote><p>类、属性、方法、构造方法上面，参数前面</p><blockquote><p>作用</p></blockquote><p>1、充当注释说明     @Deprecated<br>2、用来代码检测     @Override<br>3、携带一些信息内容<br>   信息不可以随便写，支持类型：基本类型、String、enum、注解类型、数组类型[以上类型]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Deprecated</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;信息&quot;)</span> <span class="comment">//少用</span></span><br><span class="line">    <span class="comment">//unused、serial、rawtypes、deprecation、unchecked</span></span><br></pre></td></tr></table></figure><ul><li>自定义注解类型</li></ul><p>@interface</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="comment">//import static java.lang.annotation.ElementType.*;</span></span><br><span class="line"><span class="comment">//@Target(&#123;FIELD,METHOD&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 元注解</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD,ElementType.METHOD&#125;)</span> <span class="comment">//描述当前的注解可以放置在哪里书写</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="comment">//作用域</span></span><br><span class="line"><span class="meta">@Inherited</span> <span class="comment">//当前的注解能否被子类对象继承</span></span><br><span class="line"><span class="meta">@Document</span> <span class="comment">//是否能被文档所记录</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> myAnnotation()&#123;</span><br><span class="line">    <span class="comment">//public static final String test = &quot;自定义注解&quot;;</span></span><br><span class="line">    <span class="comment">// 必须要有返回值（基本类型、String、enum、注解类型、数组类型）</span></span><br><span class="line">    <span class="comment">//test =&gt; value 使用时可以省略方法名；如果有多个方法，则每一个方法必须书写</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">test</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>示例</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mySelfannotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="comment">/*import java.lang.annotation.Retention;</span></span><br><span class="line"><span class="comment">import java.lang.annotation.RetentionPolicy;</span></span><br><span class="line"><span class="comment">import java.lang.annotation.Target;*/</span></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.CONSTRUCTOR,ElementType.METHOD,ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SelfAnnotation &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SelfAnnotation(&#123;&quot;陈小米&quot;,&quot;22&quot;,&quot;男&quot;&#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Human</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> mySelfannotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySpring</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getBean</span><span class="params">(String className)</span></span>&#123;</span><br><span class="line">        Object obj = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//获取类</span></span><br><span class="line">            Class clazz = Class.forName(className);</span><br><span class="line">            <span class="comment">//获取构造方法</span></span><br><span class="line">            Constructor con = clazz.getConstructor();</span><br><span class="line">            <span class="comment">//实例化</span></span><br><span class="line">            obj = con.newInstance();</span><br><span class="line">            <span class="comment">//获取注解</span></span><br><span class="line">            Annotation a = con.getAnnotation(SelfAnnotation.class);</span><br><span class="line">            <span class="comment">//获取注解对象</span></span><br><span class="line">            Class aclazz = a.getClass();</span><br><span class="line">            <span class="comment">//获取注解值</span></span><br><span class="line">            String[] values = (String[])aclazz.getMethod(<span class="string">&quot;value&quot;</span>).invoke(a);</span><br><span class="line">            <span class="comment">//获取类属性</span></span><br><span class="line">            Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;fields.length; i++)&#123;</span><br><span class="line">                <span class="comment">//获取类属性名</span></span><br><span class="line">                String fieldName = fields[i].getName();</span><br><span class="line">                String fLetter = fieldName.substring(<span class="number">0</span>,<span class="number">1</span>).toUpperCase();</span><br><span class="line">                String lLetter = fieldName.substring(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;set&quot;</span>);</span><br><span class="line">                sb.append(fLetter + lLetter);</span><br><span class="line">                Class type = fields[i].getType();</span><br><span class="line">                <span class="comment">//执行赋值方法，参数 obj 对象，参数类型</span></span><br><span class="line">                clazz.getMethod(sb.toString(), type).invoke(obj, </span><br><span class="line">type.getConstructor(String.class).newInstance(values[i]));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MySpring ms = <span class="keyword">new</span> MySpring();</span><br><span class="line">Human h = (Human) ms.getBean(<span class="string">&quot;mySelfannotation.Human&quot;</span>);</span><br><span class="line">System.out.println(h.getName() + <span class="string">&quot;/&quot;</span> + h.getAge() + <span class="string">&quot;/&quot;</span> + h.getSex());</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 反射 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 考试系统</title>
      <link href="2019/11/21/Java/Java%20%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F/"/>
      <url>2019/11/21/Java/Java%20%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h4 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h4><p>Graphical User Interface<br>图形用户接口：采用图形的方式，进行操作页面的展示</p><ul><li><p>AWT<br>Abstract Window Toolkit</p><p>窗体 -&gt; Frame<br>面板 -&gt; Panel<br>按钮 -&gt; Button<br>标签 -&gt; Label<br>文本域 -&gt; TextField<br>多行文本 -&gt; TextArea<br>…</p></li><li><p>Swing</p><p>窗体 -&gt; JFrame<br>面板 -&gt; JPanel<br>按钮 -&gt; JButton<br>标签 -&gt; JLabel<br>文本域 -&gt; JTextField<br>多行文本 -&gt; JTextArea<br>…</p></li></ul><blockquote><p>事件</p></blockquote><p> ActionListener 动作/响应事件<br> KeyListener 键盘事件<br> MouseListener 鼠标事件</p><h4 id="布局管理"><a href="#布局管理" class="headerlink" title="布局管理"></a>布局管理</h4><p>边界式 BorderLayout（JFrame）<br>流式 FlowLayout（JPanel）<br>网格式 GridLayout 自定义式（null）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Login</span><span class="params">(String account, String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(account.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp; password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;登录成功&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户名或密码不正确&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestGui</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">//创建窗体</span></span><br><span class="line">        JFrame jf = <span class="keyword">new</span> JFrame(<span class="string">&quot;登录窗口&quot;</span>);</span><br><span class="line">        <span class="comment">//jf.setTitle(&quot;设置窗体标题的一种方式&quot;);</span></span><br><span class="line">        <span class="comment">//设置窗体出现位置，宽高</span></span><br><span class="line">        jf.setBounds(<span class="number">200</span>,<span class="number">300</span>, <span class="number">480</span>,<span class="number">360</span>);</span><br><span class="line">        <span class="comment">//创建一个面板</span></span><br><span class="line">        JPanel panel = <span class="keyword">new</span> JPanel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建 title 标题</span></span><br><span class="line">        JLabel title = <span class="keyword">new</span> JLabel(<span class="string">&quot;在 线 考 试 系 统&quot;</span>);</span><br><span class="line">        <span class="comment">//创建账户标签</span></span><br><span class="line">        JLabel userLabel = <span class="keyword">new</span> JLabel(<span class="string">&quot;账 号：&quot;</span>);</span><br><span class="line">        <span class="comment">//创建密码标签</span></span><br><span class="line">        JLabel passLabel = <span class="keyword">new</span> JLabel(<span class="string">&quot;密 码：&quot;</span>);</span><br><span class="line">        <span class="comment">//创建账户输入框</span></span><br><span class="line">        JTextField userText = <span class="keyword">new</span> JTextField();</span><br><span class="line">        <span class="comment">//创建密码输入框</span></span><br><span class="line">        JPasswordField passText = <span class="keyword">new</span> JPasswordField();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建复选框</span></span><br><span class="line">        JCheckBox jcBox = <span class="keyword">new</span> JCheckBox(<span class="string">&quot;记住密码&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加按钮</span></span><br><span class="line">        JButton logIn = <span class="keyword">new</span> JButton(<span class="string">&quot;登 录&quot;</span>);</span><br><span class="line">        JButton logOut = <span class="keyword">new</span> JButton(<span class="string">&quot;退 出&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//布局</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 设置panel布局管理为自定义</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        panel.setLayout(<span class="keyword">null</span>);</span><br><span class="line">        title.setBounds(<span class="number">100</span>,<span class="number">10</span>,<span class="number">300</span>,<span class="number">50</span>);</span><br><span class="line">        title.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">26</span>));</span><br><span class="line"></span><br><span class="line">        userLabel.setBounds(<span class="number">60</span>,<span class="number">80</span>,<span class="number">100</span>,<span class="number">30</span>);</span><br><span class="line">        userLabel.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        passLabel.setBounds(<span class="number">60</span>,<span class="number">130</span>,<span class="number">100</span>,<span class="number">30</span>);</span><br><span class="line">        passLabel.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        userText.setBounds(<span class="number">135</span>,<span class="number">80</span>,<span class="number">220</span>,<span class="number">30</span>);</span><br><span class="line">        userText.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        passText.setBounds(<span class="number">135</span>,<span class="number">130</span>,<span class="number">220</span>,<span class="number">30</span>);</span><br><span class="line">        passText.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        jcBox.setBounds(<span class="number">130</span>,<span class="number">180</span>,<span class="number">120</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">        logIn.setBounds(<span class="number">135</span>,<span class="number">220</span>,<span class="number">80</span>,<span class="number">30</span>);</span><br><span class="line">        logIn.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">        logOut.setBounds(<span class="number">255</span>,<span class="number">220</span>,<span class="number">80</span>,<span class="number">30</span>);</span><br><span class="line">        logOut.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">        panel.add(title);</span><br><span class="line">        panel.add(userLabel);</span><br><span class="line">        panel.add(userText);</span><br><span class="line">        panel.add(passLabel);</span><br><span class="line">        panel.add(passText);</span><br><span class="line">        panel.add(jcBox);</span><br><span class="line">        panel.add(logIn);</span><br><span class="line">        panel.add(logOut);</span><br><span class="line">        jf.add(panel);</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加事件</span></span><br><span class="line">        ActionListener listener = <span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                String account = userText.getText();</span><br><span class="line">                String password = <span class="keyword">new</span> String(passText.getPassword());</span><br><span class="line">                UserService uservice = <span class="keyword">new</span> UserService();</span><br><span class="line">                String res = uservice.Login(account,password);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(res.equals(<span class="string">&quot;登陆成功&quot;</span>))&#123;</span><br><span class="line">                    System.out.println(res);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    JOptionPane.showMessageDialog(jf,res);</span><br><span class="line">                    userText.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    passText.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        logIn.addActionListener(listener);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置窗体状态，显示</span></span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设计点击关闭按钮，关闭窗口</span></span><br><span class="line">        jf.setDefaultCloseOperation(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>菜单</p></blockquote><pre><code>/*JMenuBar bar = new JMenuBar();JMenu menu = new JMenu(&quot;文件&quot;);JMenuItem newItem = new JMenuItem(&quot;新建&quot;);menu.add(newItem);bar.add(menu);jf.setJMenuBar(bar);*/</code></pre><h4 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h4><ul><li>BaseFrame</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> frames;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseFrame</span> <span class="keyword">extends</span> <span class="title">JFrame</span> </span>&#123;</span><br><span class="line">    <span class="comment">//模板模式</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setComponentConfig</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addElements</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addListener</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setFrameSelf</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseFrame</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseFrame</span><span class="params">(String title)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(title);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        setComponentConfig();</span><br><span class="line">        addElements();</span><br><span class="line">        addListener();</span><br><span class="line">        setFrameSelf();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>UserService</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Login</span><span class="params">(String account, String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(account.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp; password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;登录成功&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户名或密码不正确&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>LoginFrame</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> frames;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginFrame</span> <span class="keyword">extends</span> <span class="title">BaseFrame</span> </span>&#123;</span><br><span class="line">    <span class="comment">//布局管理</span></span><br><span class="line">    <span class="keyword">private</span> JPanel panel = <span class="keyword">new</span> JPanel();</span><br><span class="line">    <span class="comment">//标题</span></span><br><span class="line">    <span class="keyword">private</span> JLabel title = <span class="keyword">new</span> JLabel(<span class="string">&quot;在 线 考 试 系 统&quot;</span>);</span><br><span class="line">    <span class="comment">//账户标签</span></span><br><span class="line">    <span class="keyword">private</span> JLabel userLabel = <span class="keyword">new</span> JLabel(<span class="string">&quot;账 号：&quot;</span>);</span><br><span class="line">    <span class="comment">//密码标签</span></span><br><span class="line">    <span class="keyword">private</span> JLabel passLabel = <span class="keyword">new</span> JLabel(<span class="string">&quot;密 码：&quot;</span>);</span><br><span class="line">    <span class="comment">//账户输入框</span></span><br><span class="line">    <span class="keyword">private</span> JTextField userText = <span class="keyword">new</span> JTextField();</span><br><span class="line">    <span class="comment">//密码输入框</span></span><br><span class="line">    <span class="keyword">private</span> JPasswordField passText = <span class="keyword">new</span> JPasswordField();</span><br><span class="line">    <span class="comment">//复选框</span></span><br><span class="line">    <span class="keyword">private</span> JCheckBox jcBox = <span class="keyword">new</span> JCheckBox(<span class="string">&quot;记住密码&quot;</span>);</span><br><span class="line">    <span class="comment">//按钮</span></span><br><span class="line">    <span class="keyword">private</span> JButton logIn = <span class="keyword">new</span> JButton(<span class="string">&quot;登 录&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> JButton logOut = <span class="keyword">new</span> JButton(<span class="string">&quot;退 出&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置组件位置</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setComponentConfig</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 设置panel布局管理为自定义</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        panel.setLayout(<span class="keyword">null</span>);</span><br><span class="line">        title.setBounds(<span class="number">100</span>,<span class="number">10</span>,<span class="number">300</span>,<span class="number">50</span>);</span><br><span class="line">        title.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">26</span>));</span><br><span class="line"></span><br><span class="line">        userLabel.setBounds(<span class="number">60</span>,<span class="number">80</span>,<span class="number">100</span>,<span class="number">30</span>);</span><br><span class="line">        userLabel.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        passLabel.setBounds(<span class="number">60</span>,<span class="number">130</span>,<span class="number">100</span>,<span class="number">30</span>);</span><br><span class="line">        passLabel.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        userText.setBounds(<span class="number">135</span>,<span class="number">80</span>,<span class="number">220</span>,<span class="number">30</span>);</span><br><span class="line">        userText.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        passText.setBounds(<span class="number">135</span>,<span class="number">130</span>,<span class="number">220</span>,<span class="number">30</span>);</span><br><span class="line">        passText.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">18</span>));</span><br><span class="line"></span><br><span class="line">        jcBox.setBounds(<span class="number">130</span>,<span class="number">180</span>,<span class="number">120</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">        logIn.setBounds(<span class="number">135</span>,<span class="number">220</span>,<span class="number">80</span>,<span class="number">30</span>);</span><br><span class="line">        logIn.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">        logOut.setBounds(<span class="number">255</span>,<span class="number">220</span>,<span class="number">80</span>,<span class="number">30</span>);</span><br><span class="line">        logOut.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;黑体&quot;</span>,Font.BOLD,<span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//窗体添加元素</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">addElements</span><span class="params">()</span></span>&#123;</span><br><span class="line">        panel.add(title);</span><br><span class="line">        panel.add(userLabel);</span><br><span class="line">        panel.add(userText);</span><br><span class="line">        panel.add(passLabel);</span><br><span class="line">        panel.add(passText);</span><br><span class="line">        panel.add(jcBox);</span><br><span class="line">        panel.add(logIn);</span><br><span class="line">        panel.add(logOut);</span><br><span class="line">        <span class="keyword">this</span>.add(panel);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加事件</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">addListener</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ActionListener listener = <span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                String account = userText.getText();</span><br><span class="line">                String password = <span class="keyword">new</span> String(passText.getPassword());</span><br><span class="line">                UserService uservice = <span class="keyword">new</span> UserService();</span><br><span class="line">                String res = uservice.Login(account,password);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(res.equals(<span class="string">&quot;登陆成功&quot;</span>))&#123;</span><br><span class="line">                    <span class="comment">//new ExaminaSystem();</span></span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    JOptionPane.showMessageDialog(LoginFrame.<span class="keyword">this</span>,res);</span><br><span class="line">                    userText.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    passText.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        logIn.addActionListener(listener);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setFrameSelf</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setBounds(<span class="number">200</span>,<span class="number">300</span>, <span class="number">480</span>,<span class="number">360</span>);</span><br><span class="line">        <span class="comment">//设置窗体状态，显示</span></span><br><span class="line">        <span class="keyword">this</span>.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//点击关闭按钮，关闭窗口</span></span><br><span class="line">        <span class="keyword">this</span>.setDefaultCloseOperation(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginFrame</span><span class="params">()</span></span>&#123;</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginFrame</span><span class="params">(String title)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(title);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>UserService</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Login</span><span class="params">(String account, String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(account.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp; password.equals(<span class="string">&quot;123456&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;登录成功&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;用户名或密码不正确&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 逍遥游记</title>
      <link href="2019/11/18/Java/Java%20%E9%80%8D%E9%81%A5%E6%B8%B8%E8%AE%B0/"/>
      <url>2019/11/18/Java/Java%20%E9%80%8D%E9%81%A5%E6%B8%B8%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<ul><li><p>程序的运行过程</p><p>高级编程语言编写源程序，把它编译为可执行程序，然后在操作系统中运行可执行程序。</p></li><li><p>Java 语言的跨平台特性</p><p>同一个Java程序可以在多个操作系统中运行。Java语言的<code>跨平台特性</code>主要归功于<code>Java虚拟机</code>。</p></li><li><p>Java 虚拟机的主要功能</p><p>运行Java程序。Java虚拟机本身也是可执行程序，不同的系统中，Java虚拟机实现方式是不一样的。但是Java虚拟机都会按照同样的方式来解析和运行Java程序。</p></li><li><p>JDK 组成</p><p>Java虚拟机程序（java.exe）<br>Java编译器（javac.exe）<br>JDK类库</p></li><li><p>Java 程序的入口 main() 方法</p><p>  private static main(String[] args){}</p></li><li><p>程序的创建、编译和运行过程</p><p>.javac.exe  –&gt;  编译.java源文件  –&gt;  .class字节码文件<br>.java.exe  –&gt;  运行.class字节码文件  –&gt;  执行.class文件中的main()方法</p></li><li><p>Java 源文件结构</p><p>一个Java程序可以包含多个 Java 源文件，一个源文件可以定义多个类，<code>只有一个类是public类型</code>。<code>Java源文件以public类型的类的名字来命名</code>。</p></li><li><p>关键字</p><p>关键字是Java语言中的一些特使字符，public、class、import、package、void等。每个关键字都有特性的含义。关键字不能用来作为标识符。</p></li><li><p>标识符</p><p>标识符是程序中包、类、变量或者方法的名字。有编码人员命名。</p></li><li><p>包申明语句</p><p>import 关键字来声明类属于特定的包中。必须书写在Java源文件第一行。</p></li><li><p>包引入语句</p><p>如果类A和类B在不同的包，并且类A需要访问类B，那么类A需要通过 import 语句引入类B所在的包</p></li><li><p>方法的声明</p><p>一个方法可以有0或n个参数，可以有0或1个返回值，关键字void表示没有返回值。关键字return用于给定返回值，并且推出当前方法。</p></li><li><p>注释</p><p>‘/ … /‘ 单行注释<br>‘/* … */‘ 多行注释<br>‘/** … */‘ 文档注释<br>注释语句用于解释程序代码的作用，编译器会忽略程序中的注释语句。</p></li></ul><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><ul><li><p>基本数据类型</p><p>整数：byte、short、int、long<br>浮点：float、double<br>字符：char<br>布尔：boolean</p></li><li><p>引用类型</p><p>引用类型的变量用于引用特定的对象，程序通过引用类型的变量来访问特定对象的属性和方法。</p></li><li><p>基本类型和引用类型的区别</p><p>1、基本类型代表简单的数据类型；而引用类型所引用的对象能表示任意一种复杂的数据结构。<br>2、基本类型仅表示数据类型，而引用类型所引用的对象除了表示复杂数据类型，还能包括操纵这种数据类型的行为。<br>3、Java虚拟机处理引用类型变量和基本类型变量的方式是不一样的；<br>对于<code>基本类型的变量</code>，虚拟机会为其<code>分配数据类型实际占用的内存大小</code>，而对于<code>引用类型变量</code>，仅仅是一个<code>指向内存中某个对象的指针（地址）</code></p></li><li><p>直接数的类型</p><p>直接数是指直接赋给变量的具体数值，共7种：<br>int:123,-123<br>long:234L,4562,123141<br>float:7.8F,-0.254f<br>double:87.904,-98.34D<br>boolean:true,false<br>char:’a’,’\r’,’\u0041’<br>String:”HelloWorld”</p></li></ul><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul><li><p>变量的作用域</p><p>成员变量、局部变量、方法参数</p></li><li><p>实例变量和静态变量</p><p>实例变量和静态变量属于成员变量<br>静态变量：用static关键字修饰。类的静态变量在内存中仅有一份，被类的实例共享<br>实例变量：类的每个实例都有对应的实例变量</p></li><li><p>成员变量和局部变量同名</p><p>在一个作用域内不允许定义同名的多个变量。在一个方法内，可以定义和成员变量同名局部变量或参数，此时成员变量被屏蔽。此时访问实例变量，可以通过this关键字访问。</p></li><li><p>对象的默认引用：this</p><p>当一个对象创建好后，虚拟机会给它分配一个引用自身的指针：this。所有对象默认的引用都叫this。</p></li><li><p>变量初始化</p><p>Java语言要求变量遵循先定义，再初始化，再使用的规则。<br>1、成员变量初始化：对于类的成员变量，不管程序有没有显式的进行初始化，虚拟机会自动初始化默认值。<br>数字类型默认值：0；字符类型默认值：‘\u0000’；布尔类型默认值：false；引用类型默认值：null<br>2、局部变量初始化：局部变量声明后，虚拟机不会自动初始化，因此必须显式初始化才能使用。</p></li><li><p>new 关键字创建对象</p><p>对象分配内存空间，将对象的实例变量自动初始化为其变量类型的默认值<br>如果实例变量声明时显式初始化，那么将初始化值赋给实例变量<br>调用构造方法<br>返回对象的引用</p></li></ul><h4 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h4><p> 算术操作符、逻辑操作符、比较操作符、赋值操作符、特殊操作符</p><h4 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h4><p>if-else：最常用的分支语句<br>switch：多路分支语句<br>while：最常用的循环语句，先检查循环条件，再执行循环体<br>do-while：先执行循环体，再检查循环条件，循环体至少会执行一次<br>for：最常用的循环语句，先检查循环条件，再执行循环体，通常会事先确定循环次数</p><p>if-else、while、do-while和for语句的条件表达式都必须是布尔表达式，不能为数字类型；<br>switch表达式必须是byte、short、char或int类型，case表达式必须是常量</p><p>break：从switch语句或循环语句中退出<br>continue：跳过本次循环，执行下一次循环<br>return：退出本方法，跳到上层调用方法</p><h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><ul><li><p>继承的作用和语法</p><p>继承是提高代码的复用的手段。extends关键字用于声明一个子类继承某个父类，子类会自动拥有父类的一些属性和方法。一个类只能有一个直接父类，但是可以有多个间接父类。所有的类都是继承Object类。</p></li><li><p><code>重载方法</code>必须满足条件</p><p><code>方法名</code>必须相同；方法的<code>参数签名必须不相同</code>；</p></li><li><p><code>方法覆盖</code>必须满足条件</p><p>子类方法的<code>名称及参数签名</code>必须与所覆盖方法<code>相同</code>；<br>子类方法的<code>返回类型</code>必须与所覆盖方法<code>相同</code>；<br>子类方法<code>不能缩小所覆盖方法的访问级别</code>；<br>子类方法<code>不能抛出比覆盖方法更多的异常</code>；</p></li><li><p>super关键字的用途</p><p>当<code>子类</code>的某个<code>方法覆盖了父类</code>的一个<code>方法</code>，在子类范围内，父类的方法不可见；<br>当<code>子类中定义了和父类同名的成员变量</code>，子类的范围内，父类的成员变量不可见；<br>在这两种情况下，在子类中可通过super关键字来访问父类的被屏蔽的成员变量和方法。</p></li><li><p>多态</p><p>1、对于一个引用类型的变量，编译器按照声明的类型处理<br>2、运行时Java虚拟机按照实际引用的对象处理<br>3、运行环境中，通过引用类型变量来访问所引用对象的方法和属性，Java虚拟机采用以下绑定规则：实例方法与引用变量实际引用的对象的方法绑定；静态方法与引用变量所声明的类型的方法绑定；成员变量与引用变量所声明的类型的成员变量绑定。</p></li></ul><h4 id="引用类型操作符"><a href="#引用类型操作符" class="headerlink" title="引用类型操作符"></a>引用类型操作符</h4><ul><li><p>“+” 字符串连接操作</p><p>“String” + “(String)任意类型 / 引用类型.toString()” </p></li><li><p>“==” 操作符</p><p>比较两个引用类型变量是否引用同一个对象</p></li><li><p>equals()方法</p><p>Object类的equals(Object obj)方法和”==“比较规则一样；当参数obj引用的对象和当前对象为同一个对象，返回true，否则返回false<br>在JDK类库中，一些类覆盖了Object类的equals()方法，它们的比较规则为：两个对象的类型一致，并且内容一致，返回true。对于用户自定义的Java类，也可以覆盖Object类的equals()方法，重新定义比较规则。</p></li><li><p>“！=” 操作符</p></li><li><p>“=”操作符</p></li><li><p>“instanceof”</p><p>判断一个引用类型变量所引用的对象是否为一个类的实例。 </p></li></ul><h4 id="访问修饰符"><a href="#访问修饰符" class="headerlink" title="访问修饰符"></a>访问修饰符</h4><blockquote><p>访问级别 4种：</p></blockquote><p> 1、公开级别：public<br> 2、受保护级别：protected，向子类及同一个包中的类公开<br> 3、默认级别：没有访问控制修饰符，向同一个包中的类公开<br> 4、私有毕节：private，只有类本身可以访问，不对外公开</p><p>使用访问修饰符的注意事项</p><p>1、public访问级别最高，其次protected、默认和private<br>2、类的成员变量和成员方法可处于4个访问级别中的一个<br>3、顶层类可以处于公开或默认级别，不能被protected和private修饰<br>4、局部变量不能被访问修饰符修饰</p><blockquote><p>abstract修饰符</p></blockquote><p> 1、用abstract修饰的类表示抽象类，抽象类表示从具体子类中抽象出的概念，抽象类本身没有实例。<br> 2、用abstract修饰的方法表示抽象方法，抽象方法没有方法体。抽象方法用来描述类具有什么功能，不提供方法的具体实现。</p><p>abstract修饰符的语法规则</p><p> 1、抽象类中可以没有抽象方法<br> 2、包含了抽象方法的类必须定义为抽象类。如果子类没有实现父类中所有的抽象方法，子类也必须被定义为抽象类。<br> 3、abstract修饰符不能与static修饰符连用<br> 4、抽象类不能被实例化</p><blockquote><p>final修饰符</p></blockquote><p> 1、final修饰的类不能被继承，即没有子类<br> 2、不允许被子类的方法覆盖<br> 3、final修饰的变量表示常量，只允许被赋一次值</p><p>final修饰符的语法基础</p><p> 1、final修饰符可以修饰静态变量、实例变量和局部变量，分别表示静态常量、实例常量、局部常量<br> 2、final变量必须显式初始化，否则编译错误。final类型的实例变量：可以在定义变量时，构造方法中进行初始化。final类型的静态变量：只能在定义变量时进行初始化。<br> 3、final变量只能赋值一次，不允许改变final变量的值。</p><blockquote><p>static修饰符</p></blockquote><p> 1、static修饰的成员变量被成为静态变量或类变量，可以直接通过类名来访问<br> 2、修饰的成员方法为静态方法或类方法，可以直接通过类名访问<br> 3、修饰的代码块为静态代码块，当Java虚拟机加载类时，会执行该代码块</p><p>static修饰符的语法基础</p><p> 1、静态方法中不能使用引用当前实例的this关键字，也不能直接访问所属类的实例变量和实例方法，但是可以直接访问所属类的静态变量和静态方法<br> 2、在类的静态方法中，如果要访问该类的实例变量和实例方法，必须通过该类的特定实例的引用访问<br> 3、实例方法中可以直接访问所属类的静态变量、方法和实例变量、方法<br> 4、类被加载时，静态代码块只被执行一次。类中不同的静态代码块按照顺序依次执行</p><blockquote><p>interface修饰符</p></blockquote><p> 接口用于声明其实现类所具备的功能，但不能提供具体的实现</p><p> 1、为了确保外部程序能够访问到接口中所声明的功能，接口中成员变量和方法必须是public类型<br> 2、接口仅声明实现类能够做什么，不指明如何做，所以接口中的方法都是抽象的<br> 3、接口不涉及任何具体实例相关的实现细节，因此接口没有构造方法，不能被实例化，没有实例变量，接口中的变量都是静态常量</p><p>接口与抽象类的区别</p><p> 1、都位于软件系统的抽象层<br> 2、抽象类的优势在于可以部分方法提供默认的实现，避免子类重复实现它们，提高代码可重用。抽象类用来定制软件系统的扩展点。可以把抽象类看做介于“抽象”和“实现”的半成品，抽象类完成了部分实现，保留部分抽象供子类实现。</p><p> 1、接口可以多实现，获得这一优势的代价是不允许为任何方法提供实现<br> 2、可以将接口作为软件系统中最高层次的抽象类型</p><h4 id="对象生命周期"><a href="#对象生命周期" class="headerlink" title="对象生命周期"></a>对象生命周期</h4>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 反射</title>
      <link href="2019/11/13/Csharp/C%20sharp%20%E5%8F%8D%E5%B0%84/"/>
      <url>2019/11/13/Csharp/C%20sharp%20%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<p>可以通过类名、成员的名字来进行对象的实例化、操作类成员</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> b;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> c;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> d;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Person 类无参构造方法被调用&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">double</span> b, <span class="built_in">string</span> c)</span></span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Person 类有参构造方法被调用&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ShowA</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ShowB</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowC</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowD</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">double</span> b)</span></span>&#123; <span class="keyword">return</span> a;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">Show</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> b;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Program</span>&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">//如果类在命名空间中，类名必须加上命名空间</span></span><br><span class="line">        Type t = Type.GetType(<span class="string">&quot;命名空间.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//实例化一个对象，默认会使用 public 权限的无参构造方法</span></span><br><span class="line">        Object obj = Activator.CreateInstance(t);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//实例化一个对象，如果 true 可以匹配任何权限的无参构造方法</span></span><br><span class="line">        Object obj = Activator.CreateInstance(t, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//实例化一个对象，通过 public 权限的有参构造方法</span></span><br><span class="line">        Object obj = Activator.CreateInstance(t, <span class="number">1</span>, <span class="number">3.2</span>, <span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//实例化一个对象，通过非 public 权限的有参构造方法</span></span><br><span class="line">        Object obj = Activator.CreateInstance(t, </span><br><span class="line">System.Reflection.BindingFlags.NonPublic </span><br><span class="line">| System.Reflection.BindingFlags.Instance,</span><br><span class="line"> null, <span class="keyword">new</span> object[]&#123;<span class="number">1</span>, <span class="number">3.2</span>, <span class="string">&quot;hello&quot;</span>&#125;, null);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * BindingFlags：要访问的方法和字段的权限描述，必须具备两个描述</span></span><br><span class="line"><span class="comment">        * 1、要访问的成员的访问权限描述</span></span><br><span class="line"><span class="comment">        * 2、要访问的成员的归属</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//通过反射访问字段、方法</span></span><br><span class="line">        <span class="comment">//1、public 权限，非静态的字段a</span></span><br><span class="line">        FieldInfo a = t.GetField(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        a.SetValue(obj, <span class="number">1</span>); <span class="comment">//给 obj 对象赋值 1</span></span><br><span class="line">        object aa = a.GetValue(obj); <span class="comment">//获取 obj 对象 a 的值</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//2、private 权限，非静态的字段b</span></span><br><span class="line">        FieldInfo b = t.GetField(<span class="string">&quot;b&quot;</span>, BindingFlags.NonPublic </span><br><span class="line">| BindingFlags.Instance);</span><br><span class="line">        b.SetValue(obj, <span class="number">3</span>); <span class="comment">//给 obj 对象赋值 3</span></span><br><span class="line">        object bb = b.GetValue(obj); <span class="comment">//获取 obj 对象 b 的值</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//3、public 权限，静态的字段c</span></span><br><span class="line">        FieldInfo c = t.GetField(<span class="string">&quot;c&quot;</span>, BindingFlags.Public </span><br><span class="line">| BindingFlags.Static);</span><br><span class="line">        c.SetValue(null, <span class="number">3</span>); <span class="comment">//访问静态成员，访问的主体是 null</span></span><br><span class="line">        object cc = c.GetValue(null);</span><br><span class="line"></span><br><span class="line">         <span class="comment">//4、private 权限，静态的字段d</span></span><br><span class="line">        FieldInfo d = t.GetField(<span class="string">&quot;c&quot;</span>, BindingFlags.NonPublic </span><br><span class="line">|BindingFlags.Static);</span><br><span class="line">        d.SetValue(null, <span class="number">3</span>); <span class="comment">//访问静态成员，访问的主体是 null</span></span><br><span class="line">        object dd = d.GetValue(null);</span><br><span class="line"></span><br><span class="line">        MethodInfo method1 = t.GetMethod(<span class="string">&quot;ShowD&quot;</span>, BindingFlags.NonPublic </span><br><span class="line">| BindingFlags.Instance);</span><br><span class="line">        <span class="comment">//方法调用，第一个参数：谁在调用方法；第二个参数：调用的方法的实参列表</span></span><br><span class="line">        method1.Invoke(null, null);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取有参数有重载的方法，Type数组中传要访问的方法的参数类型列表</span></span><br><span class="line">        MethodInfo method2 = t.GetMethod(<span class="string">&quot;Show&quot;</span>, BindingFlags.Public </span><br><span class="line">| BindingFlags.Instance, null, </span><br><span class="line"><span class="keyword">new</span> Type[]&#123; typeof(<span class="keyword">int</span>), typeof(<span class="keyword">double</span>)&#125;, null);</span><br><span class="line">        object res = method2.Invoke(obj, <span class="keyword">new</span> Type[]&#123;<span class="number">1</span>, <span class="number">3.12</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C# </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 反射 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 线程</title>
      <link href="2019/11/11/Java/Java%20%E7%BA%BF%E7%A8%8B/"/>
      <url>2019/11/11/Java/Java%20%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.oracle.com/javase/8/docs/api/">官方文档API</a></p><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>程序 -&gt; 一组静态的代码<br>进程 -&gt; 正在进行的程序，静态代码运行起来<br><code>线程</code> -&gt; 正在执行的程序中的小单元</p><p>1、主线程 （系统线程）<br>2、用户线程 -&gt; main<br>3、守护线程（精灵） -&gt; GC</p><h4 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h4><ul><li><p>创建<br>new Thread</p></li><li><p>就绪<br>start()</p></li><li><p>执行<br>CPU分配调用run()</p></li><li><p>等待/挂起<br>wait()</p></li><li><p>恢复到 -&gt; 就绪状态<br>notify/notifyAll</p></li><li><p>异常/死亡<br>exception/over</p></li></ul><h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h4><blockquote><p>实现线程的过程：</p></blockquote><p>1、描述一个类<br>2、继承父类 Thread<br>3、重写 run()<br>4、new 线程对象，调用 start()，让线程进入就绪状态</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">①</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningMan</span> <span class="keyword">extends</span> <span class="title">Thread</span> ②</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RunningMan</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RunningMan</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    ③</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">&quot;跑到第&quot;</span> + i + <span class="string">&quot;米&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    ④</span><br><span class="line">    RunningMan r1 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;苏炳添&quot;</span>);</span><br><span class="line">    RunningMan r2 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;博尔特&quot;</span>);</span><br><span class="line">    RunningMan r2 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;加特林&quot;</span>);</span><br><span class="line"></span><br><span class="line">    r1.start();</span><br><span class="line">    r2.start();</span><br><span class="line">    r3.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>实现线程的第二种方法（避免单继承）</p></blockquote><p>1、描述一个类<br>2、实现一个父接口 Runnable<br>3、重写 run()<br>4、new 线程对象，调用 start()，让线程进入就绪状态</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">①</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningMan</span> <span class="keyword">implements</span> <span class="title">Runnable</span> ②</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RunningMan</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RunningMan</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    ③</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">&quot;跑到第&quot;</span> + i + <span class="string">&quot;米&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    ④</span><br><span class="line">    RunningMan r1 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;苏炳添&quot;</span>);</span><br><span class="line">    RunningMan r2 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;博尔特&quot;</span>);</span><br><span class="line">    RunningMan r2 = <span class="keyword">new</span> RunningMan(<span class="string">&quot;加特林&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Thread(r1).start();</span><br><span class="line">    <span class="keyword">new</span> Thread(r2).start();</span><br><span class="line">    <span class="keyword">new</span> Thread(r3).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h4><p>synchronized 关键字，一旦被锁定，不释放的情况，其他对象都需要等待 -&gt; “死锁”</p><p>1、放在方法的结构上<br>2、放在方法（构造方法、快）的内部</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 锁定的是调用该方法时的对象</span></span><br><span class="line"><span class="keyword">public</span> ① <span class="function"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    ② <span class="keyword">synchronized</span>(对象)&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Thread 常用方法</p></blockquote><p>sleep、setPriority、getPriority、join</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadO</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123; </span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        ThreadT tt = <span class="keyword">new</span> ThreadT();</span><br><span class="line">        tt.start();</span><br><span class="line">        tt.join(millis:<span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadT</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123; <span class="comment">//...&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    ThreadO to = <span class="keyword">new</span> ThreadO();</span><br><span class="line">    to.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>死锁：增加时间差</code></pre><h4 id="定时器-Timer"><a href="#定时器-Timer" class="headerlink" title="定时器 Timer"></a>定时器 Timer</h4><p>timer.schedule();</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java IO操作</title>
      <link href="2019/11/11/Java/Java%20IO/"/>
      <url>2019/11/11/Java/Java%20IO/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.oracle.com/javase/8/docs/api/">官方文档API</a></p><h4 id="File-类"><a href="#File-类" class="headerlink" title="File 类"></a>File 类</h4><p>1、java.io 包<br>2、file对象和真实文件的映射关系<br>   file对象（内存） …… 真实文件（硬盘）<br>3、常用方法<br>   canRead、canWrite、isHidden、length、isFile、isDirectory<br>   getAbsolutePath、getName<br>   createNewFile、mkdir、mkdirs<br>   getParentFile、getParent<br>   listFiles、list<br>   delete</p><h4 id="文件流"><a href="#文件流" class="headerlink" title="文件流"></a>文件流</h4><p>FileInputStream/FileOutputStream<br>FileReader/FileWriter（只能操作纯文本）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(<span class="string">&quot;d://test/test.txt&quot;</span>);</span><br><span class="line">FileInputStream fs = <span class="keyword">new</span> FileInputStream(file);</span><br></pre></td></tr></table></figure><p>常用方法：read、write、close、available、skip、flush</p><h4 id="缓冲流"><a href="#缓冲流" class="headerlink" title="缓冲流"></a>缓冲流</h4><p>BufferedInputStream/BufferedOutputStream<br>BufferedReader/BufferedWriter</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(<span class="string">&quot;d://test/test.txt&quot;</span>);</span><br><span class="line">FileInputStream fs = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line"></span><br><span class="line">BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(fs); </span><br></pre></td></tr></table></figure><p>构建方法需要使用低级流构建，缓冲流构建时没有 boolean 类型的参数<br>基本使用与低级流方法一致</p><p>常用方法：read、write、close、available、skip、flush</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(<span class="string">&quot;d://test/test.txt&quot;</span>);</span><br><span class="line">FileReader fs = <span class="keyword">new</span> FileReader(file);</span><br><span class="line"></span><br><span class="line">BufferedReader bis = <span class="keyword">new</span> BufferedReader(fs); </span><br></pre></td></tr></table></figure><p>常用方法多一个：readLine</p><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>文件流编译时异常，必须处理异常<br>文件流必须要关闭，finally 中 close()</p><blockquote><p>数组流</p></blockquote><p>ByteArrayInputStream/ByteArrayOutputStream<br>CharArrayReader/CharArrayWriter</p><blockquote><p>数据流</p></blockquote><p>DataInputStream/DataOutputStream</p><blockquote><p>字符串流</p></blockquote><p>StringReader/StringWriter</p><blockquote><p>对象流</p></blockquote><p>ObjectInputStream/ObjectOutputStream</p><p>实现 对象的序列化/反序列化<br>序列化：将一个完整的对象拆分成字节碎片，记录在文件中。（需要实现 Serializable 接口）<br>反序列化：将文件中记录的对象碎片，反过来组合成一个完整的对象。（需要给对象提供一个序列化的版本号）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">440948</span>;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="银行系统示例"><a href="#银行系统示例" class="headerlink" title="银行系统示例"></a>银行系统示例</h4>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 异常</title>
      <link href="2019/11/07/Java/Java%20%E5%BC%82%E5%B8%B8/"/>
      <url>2019/11/07/Java/Java%20%E5%BC%82%E5%B8%B8/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.oracle.com/javase/8/docs/api/">官方文档API</a></p><h4 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h4><p>Throwable 类 实现了 序列化接口</p><h4 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h4><p>(错误：物理性的，JVM 虚拟机本身的问题，程序指令处理不了)</p><p>StackOverflowError<br>OutOfMemoryError</p><h4 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h4><p>（异常：人为规定的不正常的现象）</p><ul><li><p>运行时异常</p><p>Error、RuntimeException</p></li></ul><p> <em>javac 编译时，不会发现和提示</em></p><pre><code>NegativeArraySizeException // 数组长度负数NullPointerException // 空指针ArithmeticException // 数字异常ClassCastException // 造型异常IllegalArgumentException // 非法参数IndexOutOfBoundsException // 集合越界StringIndexOutOfBoundsException // 字符串NumberFormatException // 数字格式化ArrayIndexOutOfBoundsException // 数组索引越界</code></pre><ul><li><p>编译时异常</p><p>除了 Error、RuntimeException 以外的其他异常<br>javac 编译的时候 强制要求我们必须处理 （try throws）</p></li></ul><pre><code>InterruptedException</code></pre><h4 id="处理异常方式"><a href="#处理异常方式" class="headerlink" title="处理异常方式"></a>处理异常方式</h4><blockquote><p>try catch finally</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">catch</span>(异常类型 e)&#123;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span>(异常类型 e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">    <span class="comment">//必须执行</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;a&quot;</span>;</span><br></pre></td></tr></table></figure><pre><code>try catch finallycatch 可以存在多个，捕获异常之间不能有继承关系，由小到大进行捕获不管 return 关键字在哪里，finally 一定会执行完毕返回值的具体结果，根据执行过程决定</code></pre><p><em>final：修饰符</em><br><em>finally：异常捕获的一部分</em><br><em>finalize：Object 类中的一个 protected 方法，对象没有任何引用的时候，垃圾回收时默认调用的方法</em></p><blockquote><p>throws</p></blockquote><p>异常只能在方法上抛出</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">myException</span><span class="params">()</span> <span class="keyword">throws</span> NullPointerException,<span class="title">NumberFormatException</span><span class="params">()</span></span>&#123;</span><br><span class="line">    String s = <span class="keyword">null</span>;</span><br><span class="line">    s.length();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法在哪里被调用，哪里抛出异常，方法可以抛出多个异常</span></span><br></pre></td></tr></table></figure><h4 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h4><p>自定义类 extends RuntimeException –&gt; 运行时异常<br>自定义类 extends Exception –&gt; 编译时异常</p><p>throw 抛出异常</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String myException extends <span class="title">RuntimeException</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">myException</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">myException</span><span class="params">(String msg)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如何使用</span></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> myException();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 工具类</title>
      <link href="2019/11/05/Java/Java%20%E5%B7%A5%E5%85%B7%E7%B1%BB/"/>
      <url>2019/11/05/Java/Java%20%E5%B7%A5%E5%85%B7%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.oracle.com/javase/8/docs/api/">官方文档API</a></p><h4 id="包装类"><a href="#包装类" class="headerlink" title="包装类"></a>包装类</h4><p>byte(Byte)、short(Short)、int(Integer)、long(Long)<br>float(Float)、double(Double)、char(Character)、boolean(Boolean)</p><ol><li>java.lang包，不需要import</li><li>6个和数字相关的包装类，默认继承 Number</li><li>8个包装类都实现了 Serializable,Comparable</li><li>构造函数重载 – 包装类（int\String）</li></ol><blockquote><p>常用方法</p></blockquote><p>intValue()、Integer.parseInt(“123”)、new Integer(“123”)</p><p><em>1.5版本以后，自动拆装包</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Integer i1 = <span class="number">10</span>;</span><br><span class="line">Integer i2 = <span class="number">10</span>;</span><br><span class="line">Integer i3 = <span class="keyword">new</span> Integer(<span class="number">10</span>);</span><br><span class="line">Integer i4 = <span class="keyword">new</span> Integer(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断结果</span></span><br><span class="line">i1==i2             <span class="comment">//true</span></span><br><span class="line">i1==i3             <span class="comment">//false </span></span><br><span class="line">i3==i4             <span class="comment">//false</span></span><br><span class="line">i1.equals(i2);     <span class="comment">//true</span></span><br><span class="line">i1.equals(i3);     <span class="comment">//true</span></span><br><span class="line">i3.equals(i4);     <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">Integer i1 = <span class="number">1000</span>;</span><br><span class="line">Integer i2 = <span class="number">1000</span>;</span><br><span class="line"><span class="comment">//private static IntegerCache </span></span><br><span class="line"><span class="comment">//Integer类静态元素区，空间内加载 Integer[] 值范围 -128~127，超出范围则new Integer();</span></span><br><span class="line"></span><br><span class="line">Integer i3 = <span class="keyword">new</span> Integer(<span class="number">1000</span>);</span><br><span class="line">Integer i4 = <span class="keyword">new</span> Integer(<span class="number">1000</span>);   </span><br><span class="line"></span><br><span class="line"><span class="comment">//判断结果</span></span><br><span class="line">i1==i2             <span class="comment">//false</span></span><br><span class="line">i1==i3             <span class="comment">//false </span></span><br><span class="line">i3==i4             <span class="comment">//false</span></span><br><span class="line">i1.equals(i2);     <span class="comment">//true</span></span><br><span class="line">i1.equals(i3);     <span class="comment">//true</span></span><br><span class="line">i3.equals(i4);     <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* “==” 比较的是变量存储的值</span></span><br><span class="line"><span class="comment">* equals 默认和 “==” 一样，重写的equals 一般比较的是数值</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h4 id="Math-类"><a href="#Math-类" class="headerlink" title="Math 类"></a>Math 类</h4><p>1、java.lang包<br>2、构造方法私有<br>3、提供的属性、方法都是私有<br>4、常用方法</p><p>abs() random()<br>ceil() floor() rint() 返回值 double<br>round() 返回值 int<br>max(a,b)<br>pow(a,b) squrt(a) 返回值 double</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0~9 之间的随机数</span></span><br><span class="line"><span class="keyword">int</span> val = (<span class="keyword">int</span>)(Math.random()*<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.0-10.9 之间的数</span></span><br><span class="line">(Math.random()*<span class="number">6</span>) + <span class="number">5</span> </span><br><span class="line"><span class="comment">//小数计算会丢失精度</span></span><br></pre></td></tr></table></figure><h4 id="Random-类"><a href="#Random-类" class="headerlink" title="Random 类"></a>Random 类</h4><p>1、java.util 需要 import 导包<br>2、没有任何继承关系，默认继承 Object<br>3、常用方法</p><p>nextInt()<br>nextInt(bound)  //bound 不可以去负值 IllegalArgumentException</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Random r = <span class="keyword">new</span> Random()</span><br><span class="line">r.nextInt()  <span class="comment">//返回随机整数，范围 -2的31次方 ~ 2的31次方</span></span><br><span class="line">r.nextInt(<span class="number">10</span>) <span class="comment">//返回随机整数，范围 [0 ~ 10)</span></span><br><span class="line"></span><br><span class="line">r.nextFloat() [<span class="number">0.0</span> ~ <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.0-10.9 之间的数</span></span><br><span class="line">r.nextInt(<span class="number">6</span>) + <span class="number">5</span> + r.nextFloat();</span><br></pre></td></tr></table></figure><h4 id="UUID-类"><a href="#UUID-类" class="headerlink" title="UUID 类"></a>UUID 类</h4><p>1、java.util 需要 import 导包<br>2、没有任何继承关系，默认继承 Object<br>3、无参数构造方法<br>4、常用方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//32位随机元素，每个位置16进制数 作为ID Key 使用</span></span><br><span class="line">UUID uuid = <span class="keyword">new</span> UUID.randomUUID();</span><br><span class="line">uuid.toString();</span><br><span class="line"></span><br><span class="line"><span class="comment">//d3b8885f-89f2-4cd5-bd33-70ab47dcab4e</span></span><br></pre></td></tr></table></figure><blockquote><p>BigInteger 类大整数，超出 long 范围</p></blockquote><p>本质 动态数组</p><p>1、java.math 需要 import 导包<br>2、继承自 Number<br>3、BigInteger bi = new BigInteger(“123”) 常使用 String 参数构造函数<br>4、常用方法</p><p>add()<br>subtract()<br>multiply()<br>divide()</p><blockquote><p>BigDecimal 类大小数，超出 double 范围</p></blockquote><p>同 BigInteger</p><p>setScale(newScale, BigDecimal.ROUND_DOWN)  //小数点后数据处理方式（位数，设置模式）</p><blockquote><p>DecimalFormat</p></blockquote><p>格式化数据，四舍五入</p><p>1、java.text 需要 import 导包</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DecimalFormat df = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;000.###&quot;</span>);  <span class="comment">//0 必须存在 # 可有可无</span></span><br><span class="line">String val = df.format(<span class="number">123.4584</span>);  <span class="comment">// 123.458</span></span><br></pre></td></tr></table></figure><h4 id="System-类"><a href="#System-类" class="headerlink" title="System 类"></a>System 类</h4><p>1、java.lang包<br>2、不需要创建对象<br>3、常用属性、方法</p><p>out、in、err<br>gc()、exit(0)、currentTimeMillis()：当前时间的毫秒值</p><h4 id="Date-类"><a href="#Date-类" class="headerlink" title="Date 类"></a>Date 类</h4><p>1、java.util 需要 import 导包<br>2、常用方法</p><p>before()、after()<br>setTime()、getTime()  —&gt;  long</p><blockquote><p>DateFormat 类</p></blockquote><p>Date 日期格式化</p><p>1、java.text 需要 import 导包<br>2、抽象类，需要使用子类 SimpleDateFormat</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class="line">sdf.format(System.currentTimeMillis);</span><br></pre></td></tr></table></figure><h4 id="Calendar-类"><a href="#Calendar-类" class="headerlink" title="Calendar 类"></a>Calendar 类</h4><p>1、java.util 需要 import 导包<br>2、受保护的类，需要使用 getInstance<br>3、常用方法</p><p><em>1.1 版本</em></p><p>before()、after()<br>setTime()、getTime()  —&gt;  Date<br>getTimeInMillis()  —&gt;  time<br>getTimeZone()  —&gt;  时区<br>get()、set()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Calendar calendar = Calendar.getInstance();  <span class="comment">//系统当前时间的 calendar 对象</span></span><br><span class="line">calendar.get(Calendar.YEAR);</span><br><span class="line">calendar.get(Calendar.MONTH);</span><br><span class="line">calendar.get(Calendar.DAY_OF_MONTH);</span><br><span class="line"></span><br><span class="line">calendar.set(Calendar.MONTH,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">TimeZone tz = TimeZone.getDefault();</span><br><span class="line">tz = calendar.getTimeZone();</span><br><span class="line"></span><br><span class="line">tz.getID();          <span class="comment">// 上海</span></span><br><span class="line">tz.getDisplayName(); <span class="comment">// 中国标准时间</span></span><br></pre></td></tr></table></figure><h4 id="String-类"><a href="#String-类" class="headerlink" title="String 类"></a>String 类</h4><p>1、java.lang包 不需要导包<br>2、String sa = “abc”<br>   String sa = new String(“abc”)<br>3、实现接口 Serializable、CharSequence、Comparable</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">String s1 = <span class="string">&quot;abc&quot;</span>；</span><br><span class="line">String s2 = <span class="string">&quot;abc&quot;</span>；</span><br><span class="line">String s3 = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">String s4 = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断结果</span></span><br><span class="line">s1==s2             <span class="comment">//true</span></span><br><span class="line">s1==s3             <span class="comment">//false </span></span><br><span class="line">s3==s4             <span class="comment">//false</span></span><br><span class="line">s1.equals(s2);     <span class="comment">//true</span></span><br><span class="line">s1.equals(s3);     <span class="comment">//true</span></span><br><span class="line">s3.equals(s4);     <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//String 类 重写了 equals 方法</span></span><br></pre></td></tr></table></figure><p><span style="color:red;">3、String 的不可变特性</span></p><pre><code>长度、地址、内容不可变String类中包含一个char[] 修饰符为 private final char[] value，存储 String 中的每一个字节</code></pre><p>4、常用方法</p><p>equals()、hashCode()  //继承 Object 重写，前者返回值 boolean 后者返回值 int<br>compareTo()  //实现 Comparable 接口<br>toString()<br>charAt(index)<br>codePointAt(index)  //获取 code 码<br>length()<br>concat(String)<br>contains()<br>startsWith()<br>endsWith()<br>getBytes()  // 字符串转成数组 byte[]<br>toCharArray()                char[]<br>indexOf()<br>isEmpty()<br>replace()<br>matches(regex)<br>split(regex)<br>substring()<br>trim()</p><h4 id="StringBuffer-Builder"><a href="#StringBuffer-Builder" class="headerlink" title="StringBuffer/Builder"></a>StringBuffer/Builder</h4><p><em>1.0 版本/1.5 版本</em></p><p>1、java.lang包 不需要导包<br>2、实现接口 Serializable、Appendable、CharSequence<br>3、可变字符串 char[] 动态扩容</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();  <span class="comment">//默认长度 16</span></span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="number">20</span>);  <span class="comment">//自定义长度</span></span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;abc&quot;</span>);  <span class="comment">//字符串长度 + 16</span></span><br></pre></td></tr></table></figure><p>4、常用方法</p><p>append()</p><p><em>200000次拼接字符串操作，“+”：10000ms “contact”：5000ms “StringBuilder–append”：7ms</em></p><p>substring(int,int)  //需要接受返回值<br>delete(int,int)<br>deleteCharAt()<br>setCharAt()<br>insert()<br>reverse()</p><blockquote><p>正则表达式</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Pattern p = Pattern.compile(<span class="string">&quot;regex&quot;</span>);</span><br><span class="line">Matcher m = p.matcher(str);</span><br><span class="line">m.matches()</span><br></pre></td></tr></table></figure><h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><p>java.util包 需要导包</p><p>用来存储一组元素</p><p>Collection \ Map<br>存储 value对象 \ 存储 Key-Value<br>List，Queue，Set</p><p>List：有序可重复<br>Set：无序无重复<br>Map：Key 无序无重复，Value 无序可重复</p><blockquote><p>List 集合</p></blockquote><ul><li>ArrayList \ Vector</li></ul><p>常用方法：add、remove、get、set、size、addAll、contains、indexOf<br>iterator（迭代器）、retainAll、subList、toArray</p><pre><code>ArrayList 底层是一个 Object[] 什么类型都可以存进去，取值多态，使用不方便JDK 1.5 增加泛型泛型类、泛型接口、泛型方法、高级泛型（规范边界、extends super）</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">list.add(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">list.add(<span class="number">17</span>);</span><br><span class="line">list.add(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Object x:list)&#123;</span><br><span class="line">    System.out.println(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ArrayList&lt;String&gt; str_list  = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">str_list.add(<span class="string">&quot;13&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>Stack 类 继承 Vector</li></ul><p>1、构造方法只有无参数的<br>2、常用方法</p><p>push（压入栈顶）、pop（取出并删掉）、peek(查看栈顶元素，不删除)、empty、search</p><ul><li>Queue 接口</li></ul><p>1、通常子类 LinkedList、ArrayDeque<br>2、构造方法只有无参数的<br>3、常用方法</p><p>add、element、remove<br>offer、peek、poll  //和上面方法用法一致，不同点在于异常时不会抛出</p><ul><li>LinkedList 类</li></ul><p>1、实现 List、Queue 接口<br>2、底层使用双向链表的数据结构存储<br>3、常用方法</p><p>List、Queue 的方法都可以使用</p><p><em>ArrayList 200000次操作 向后追加 5ms 向前插入 4000ms 遍历轮询 3ms 删除 4000ms</em><br><em>LinkedList 200000次操作 向后追加 4ms 向前插入 4ms 遍历轮询 3ms 删除 3ms</em></p><blockquote><p>Set 集合</p></blockquote><pre><code>发现重复数据拒绝存入，存储的是第一个</code></pre><p>1、常用方法</p><p>add、clear、clone、contains、isEmpty、remove、size</p><ul><li>HashSet 类</li></ul><p>底层 HashMap</p><pre><code>*无法修改值**无重复：equals、hashCode 重写*</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//取元素</span></span><br><span class="line">Iterator&lt;string&gt; it = set.iterator();</span><br><span class="line">it.hasNext();</span><br><span class="line">it.next();</span><br></pre></td></tr></table></figure><ul><li>TreeSet 类</li></ul><p>底层 TreeMap</p><pre><code>*无法修改值**无重复：compareTo 重写*</code></pre><blockquote><p>Map 集合</p></blockquote><p>映射 通过 Key 直接查找到 Value 的值</p><pre><code>发现重复数据直接覆盖</code></pre><ul><li>HashMap 类</li></ul><p>底层数据结构 （数组+链表）散列表</p><p>1、常用方法</p><p>containsKey、containsValue、put、get、keySet、entrySet、size、replace、remove、getOrDefault<br>putIfAbsent（如果 key 存在则不覆盖）</p><ul><li>treeMap 类</li></ul><p>底层数据结构 （数组+链表）二叉树</p><pre><code>Entry 实现 comparable 接口，key 比较，小放左边，大放右边，一致就覆盖</code></pre><p>1、常用方法</p><p>subMap、tailMap</p><p><em>红黑二叉树 左旋右旋</em></p><ul><li>Properties 类（读取文件中的信息）</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>StringBuilder 说明</title>
      <link href="2019/10/18/Csharp/StringBuilder%20%E8%AF%B4%E6%98%8E/"/>
      <url>2019/10/18/Csharp/StringBuilder%20%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h4 id="“-”-连接字符串"><a href="#“-”-连接字符串" class="headerlink" title="“+” 连接字符串"></a>“+” 连接字符串</h4><p>创建成功的字符串对象，长度是固定的，虽然“+”可以达到附加新字符串的目的，但“+”会产生一个新的 String 实例，会在内存中创建新的字符串对象。重复修改字符串，会极大的增加系统开销。</p><p>可变字符串序列应该使用 StringBuilder 类</p><h4 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a>StringBuilder</h4><p>StringBuffer是可变类，和线程安全的字符串操作类，任何对它指向的字符串的操作都不会产生新的对象。 每个StringBuffer对象都有一定的缓冲区容量，当字符串大小没有超过容量时，不会分配新的容量，当字符串大小超过容量时，会自动增加容量。</p><p><em>注意：StringBulider容量  （默认是16）</em></p><p>StringBuilder 类有6种构造函数，常用如下：</p><pre><code>StringBuilder（string value, int cap）</code></pre><h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder strB = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line"><span class="comment">//append(String str)/append(Char c)：字符串连接</span></span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder:&quot;</span>+strB.append(<span class="string">&quot;ch&quot;</span>).append(<span class="string">&quot;111&quot;</span>).append(<span class="string">&#x27;c&#x27;</span>));</span><br><span class="line"><span class="comment">//return &quot;StringBuilder:ch111c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//toString()：返回一个与构建起或缓冲器内容相同的字符串</span></span><br><span class="line">System.out.println(<span class="string">&quot;String:&quot;</span>+strB.toString());</span><br><span class="line"><span class="comment">//return &quot;String:ch111c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//appendcodePoint(int cp)：追加一个代码点，并将其转换为一个或两个代码单元并返回this</span></span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder.appendCodePoint:&quot;</span>+strB.appendCodePoint(<span class="number">2</span>));</span><br><span class="line"><span class="comment">//return &quot;StringBuilder.appendCodePoint:ch111c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//setCharAt(int i, char c)：将第 i 个代码单元设置为 c（可以理解为替换）</span></span><br><span class="line">strB.setCharAt(<span class="number">2</span>, <span class="string">&#x27;d&#x27;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder.setCharAt:&quot;</span> + strB);</span><br><span class="line"><span class="comment">//return &quot;StringBuilder.setCharAt:chd11c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//insert(int offset, String str)/insert(int offset, Char c)：在指定位置之前插入字符(串)</span></span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder.insertString:&quot;</span>+ strB.insert(<span class="number">2</span>, <span class="string">&quot;LS&quot;</span>));</span><br><span class="line"><span class="comment">//return &quot;StringBuilder.insertString:chLSd11c&quot;</span></span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder.insertChar:&quot;</span>+ strB.insert(<span class="number">2</span>, <span class="string">&#x27;L&#x27;</span>));</span><br><span class="line"><span class="comment">//return &quot;StringBuilder.insertChar:chLLSd11c&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//delete|remove(int startIndex,int endIndex)：删除起始位置（含）到结尾位置（不含）之间的字符串</span></span><br><span class="line">System.out.println(<span class="string">&quot;StringBuilder.delete:&quot;</span>+ strB.<span class="keyword">delete</span>(<span class="number">2</span>, <span class="number">4</span>));</span><br><span class="line"><span class="comment">//return &quot;StringBuilder.delete:chSd11c&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> StringBuilder </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Dubbo</title>
      <link href="2019/10/18/Apache%20Dubbo/"/>
      <url>2019/10/18/Apache%20Dubbo/</url>
      
        <content type="html"><![CDATA[<h4 id="应用程序通信"><a href="#应用程序通信" class="headerlink" title="应用程序通信"></a>应用程序通信</h4><p>应用程序A  ————————————— 应用程序B<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http、socket、NIO、RPC、文件共享、缓存、webservice</p><p>RPC 协议：远程过程调用协议</p><p>RPC 框架：webService\rmi\dubbo\hessian\grpc…</p><p>1、建立Socket通信<br>2、对传输的数据进行序列化和反序列化<br>3、动态代理</p>]]></content>
      
      
      <categories>
          
          <category> Dubbo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深入浅出 Storm</title>
      <link href="2019/10/18/Csharp/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%20Storm/"/>
      <url>2019/10/18/Csharp/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%20Storm/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>分布式实时容错流处理系统，用于大规模数据的实时处理</p><p>工作原理：<br>类似一个数据处理工厂，其中有多条流水线，流水线上有多个处理单元，从外部对接数据源，然后发送到流水线，经过各处理单元加工后交给客户</p><p>特点：<br>简单的编程模型、伸缩性高、保证无数据丢失、异常健壮、容错性好、语言无关性</p><pre><code>Strom 对于实时计算的意义，类似于 Hadoop 对于批处理的意义Hadoop：MapReduce原语</code></pre><p>应用场景：<br>实时数仓、实时监控、流数据分析、实时报表</p><p>典型架构：</p><p>数据产生（第三方、传感器、数据库日志、服务器日志）<br>流式数据处理（数据总线、实时计算、数据存储）<br>第三方应用</p><h4 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h4><p>Topology(计算拓扑)：<br>一个拓扑是一个DAG图的计算，由 Spout 组件和 Bolt 组件 通过 Stream Groupings 进行连接</p><p>数据模型：Tuple Stream</p><p>Spout(数据源)：可靠、不可靠两种模式<br>Bolt（消息处理单元）：处理业务逻辑-过滤、聚合、查询数据库</p><p>消息分发机制：<br>Shuffle分组：随机分配模式（常用）<br>Fields分组：哈希分布模式（常用）<br>Globa分组：单选发送模式<br>All分组：全量发送模式</p><p>+使用方式：</p><p>1、构建 Topology DAG图<br>2、创建一个 Configuration，指定当前 Topology 的 worker 数量<br>3、提交任务-本地模式、集群模式</p><p><strong>Spout 设计</strong><br><em>extends BaseRichSpout</em><br>open、nextTuple、ack、fail、declareOutputFields 方法</p><p>open：初始化<br>nextTuple：数据源拉取数据，向下游输送<br>ack：可靠性消息传输<br>fail：传输失败时，重发<br>declareOutputFields：输出字段的名称</p><p><strong>Bolt 设计</strong><br><em>extends BaseBasicBolt</em><br>prepare、execute（emit发送队列）、declareOutputFields、cleanup</p><h4 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h4><pre><code>Client     Master (nimbus)     UI    Zookeeper Cluster       Slaves(Worker-Task)</code></pre><h4 id="深度剖析"><a href="#深度剖析" class="headerlink" title="深度剖析"></a>深度剖析</h4><p>消息保证机制</p><p>At most Once：最多一次  关闭 ACK<br>At least Once：至少一次  启用 ACK ，实现可靠传输<br>Exactly Once：恰好一次   在 At least Once 的基础上进行状态存储，防止重复发送的数据被重复处理，Trident API 实现</p><p>并发机制</p><p>Worker(进程)、Executor(线程)、Task(Spout、Bolt)</p><p>通信机制</p><p>Worker 进程间的数据通信：Netty 基于 NIO 的网络架构，更加高效<br>Worker 内部的数据通信：Disruptor 实现“队列”功能，一种事件监听、消息处理机制；一边生产、一边消费<br>Topology 之间的通信：需要自己实现，kafka等</p><p>可靠性机制</p><p>Nimbus 故障<br>    Nimbus故障，Supervisor还正常运行，对应的Worker也正常运行，只是Supervisor不能接受Nimbus新任务分配</p><p>Supervisor 故障<br>    出故障的Supervisor对应的Worker也会故障，Nimbus监控，将对应的Worker重新分配到其他的Supervisor节点运行</p><p>Nimbus、Supervisor 故障<br>    Nimbus被设计成HA的，利用主从结构保证主节点故障后，从节点一样能服务</p><p>Worker 故障<br>    Supervisor重新创建Worker</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>中国史</title>
      <link href="2019/10/18/Other/%E4%B8%AD%E5%9B%BD%E5%8F%B2/"/>
      <url>2019/10/18/Other/%E4%B8%AD%E5%9B%BD%E5%8F%B2/</url>
      
        <content type="html"><![CDATA[<p>东周</p><blockquote><p>春秋</p></blockquote><p>东：齐、鲁、吴<br>南：楚<br>西：秦<br>北：晋、燕<br>中：周、郑、宋</p><blockquote><p>战国</p></blockquote><p>东：（吴、越） -&gt; 齐<br>南：楚<br>西：秦<br>北：晋 -&gt; （韩，魏、赵）、燕</p><blockquote><p>秦（15年）</p></blockquote><p>三公九卿、郡县制<br>统一度量衡、货币、文字<br>南征百越、北征匈奴<br>焚书坑儒</p><blockquote><p>西汉（200年）</p></blockquote><p>文景之治、暄昭中兴</p><blockquote><p>新朝（15年）</p></blockquote><p>王莽（货币改革、人人平等、井田制、市场改革）</p><blockquote><p>东汉（200年）</p></blockquote><p>光、明、章、和<br>窦、邓、阎、梁 4太后<br>宦官（党锢之争）</p>]]></content>
      
      
      <categories>
          
          <category> 杂说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 历史 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop</title>
      <link href="2019/10/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/Hadoop/"/>
      <url>2019/10/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/Hadoop/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>主要组成：HDFS，MapReduce</p><p>HDFS：实现分布式存储，达到高速并行读写与大容量的存储扩展</p><pre><code>NameNode、DataNode    </code></pre><p>MapReduce：实现分布式任务处理程序，保证高速分区处理数据</p><pre><code>JobTracker节点，分配工作以负责和用户程序通信</code></pre>]]></content>
      
      
      <categories>
          
          <category> Hadoop </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大数据</title>
      <link href="2019/10/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
      <url>2019/10/18/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84/%E5%A4%A7%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="大数据特点"><a href="#大数据特点" class="headerlink" title="大数据特点"></a>大数据特点</h4><p>Volume：数据量规模随时间增长<br>Variety：数据格式的多样化<br>Velocity：数据即时处理的速度<br>Validity：数据的合法性</p><p>爆发原因：大量的数据和应用场景<br>         Hadoop 分布式技术的出现，低成本的存储，计算资源</p><h4 id="应用数据阶段"><a href="#应用数据阶段" class="headerlink" title="应用数据阶段"></a>应用数据阶段</h4><p>数据整理、数据仓库、初级应用（统计、报表等）、智能应用（数据挖掘、智能驾驶、物联网）</p><h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4><p>信息过载、精准营销、各种预测、各种优化、系统智能化</p><h4 id="性能指标"><a href="#性能指标" class="headerlink" title="性能指标"></a>性能指标</h4><ul><li>RT</li></ul><p>响应时间：系统对请求作出响应的时间，通常统计的是平均响应时间、最大响应时间</p><ul><li>TPS</li></ul><p>吞吐量：系统单位时间内处理请求的数量</p><ul><li>并发数</li></ul><p>系统可以同时承载的正常使用系统功能的用户数，通常统计的是注册用户数、在线用户数、同时发请求用户数</p><ul><li>QPS</li></ul><p>每秒查询率是对一个特定查询服务器在规定时间内所处理流量多少的和衡量标准<br>fetches/sec：每秒响应请求数，即最大吞吐能力</p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java 基础</title>
      <link href="2019/10/18/Java/Java%20%E5%9F%BA%E7%A1%80/"/>
      <url>2019/10/18/Java/Java%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="Java体系"><a href="#Java体系" class="headerlink" title="Java体系"></a>Java体系</h4><p>JavaSE（J2SE）（Java2 Platform Standard Edition，java平台标准版）<br>JavaEE（J2EE）(Java 2 Platform,Enterprise Edition，java平台企业版)<br>JavaME（J2ME）(Java 2 Platform Micro Edition，java平台微型版)。</p><p>主要特点：</p><pre><code>简单、面向对象、分布式、健壮、安全、体系结构中立、可移植、解释型、高性能、多线程、动态的</code></pre><p>基本概念：</p><p>JDK（Java Development Kit ）：软件开发工具包，编写 Java 程序的程序员使用<br>JRE（Java Runtime Environment）：程序运行环境，运行别人写好的 Java 程序<br>JVM（Java Virtual Machine）：Java 虚拟机，源代码文件.java 编译成 字节码文件.class</p><p>Server JRE （Java SE Runtime Environment）：服务端使用的 Java 运行环境<br>SDK（Software Development Kit）：软件开发工具包，在Java中用于描述1998年~2006年之间的JDK<br>DAO（Data Access Object）：数据访问接口，数据访问，顾名思义就是与数据库打交道<br>MVC（Model View Controller）：模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范，用于组织代码用一种业务逻辑和数据显示分离的方法</p><p><strong>跨平台机制：</strong></p><style>.relation{ width:610px;}.relation *,.memary *:not(i){ box-sizing:border-box; padding:1rem; border:1px dotted #cdcdcd;}.relation p *{    display:inline-block;    margin:.5rem 0 0 3rem;    font-style:normal;}.memary i{ font-style:normal; color:red;}.memary span{    display:inline-block; width:200px; min-height:320px; vertical-align: top;}.memary span *{    display:block; width:100%;}</style><div class="relation"><p>JDK(Java Development Kit)：软件开发工具包</br>    javac.exe 编译工具 &nbsp; java.exe  执行工具    <span>JRE（Java Runtime Environment）：程序运行环境        <em>JVM（Java Virtual Machine）：</br> 源代码文件.java 编译成 字节码文件.class</em>    </span></p></div><p>程序计数器：当前线程正在执行的字节码指令的地址<br>虚拟机栈：存储当前线程运行方法时所需的数据、指令、返回地址</p><p><strong>JVM开辟内存：</strong></p><div class="memary"><span><i>栈内存</i></br>    FILO/LIFO：</br>先进后出，后进先出 </br>（子弹夹模型）</span><span><i>堆内存</i></span><span><i>方法区（存储区）</i>所有的数据只有一份，且不能更改    <em style="margin-top:10px;">常量缓冲区，常量池</em>    <em>方法区（类模块）</br>        字节码文件（类映射空间）    </em>    <em>静态元素区 static</em></span></div><p>默认执行过程：</p><pre><code>javac 源文件.java -&gt; 源文件.java 编译成 字节码文件.classjava 字节码文件.classJVM开辟内存 -&gt; 类加载器（从硬盘将 “字节码文件.class” 搬运到【内存】【方法区】“类映射空间”）所有执行都在“栈”内存javap -c 可以查看字节码文件</code></pre><h4 id="开发环境配置"><a href="#开发环境配置" class="headerlink" title="开发环境配置"></a>开发环境配置</h4><ul><li><p>安装 JDK<br>  <a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk13-downloads-5672538.html">JDK 下载</a></p><p>  命令行 查看是否已安装 java -version<br>  java -verbose 查看 JDK 安装路径</p></li></ul><ul><li><p>环境变量配置</p><p>  <strong>JAVA_HOME</strong><br>  C:\Program Files (x86)\Java\jdk1.8.0_91    //JDK 安装路径</p><p>  <strong>CLASSPATH</strong><br>  .;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;    //记得前面有个”.”</p><p>  <strong>Path</strong><br>  %JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;<br>  <em>在 Windows10 中，Path 变量里是分条显示的，我们需要将 %JAVA_HOME%\bin;%JAVA_HOME%\jre\bin; 分开添加</em></p></li></ul><blockquote><p>汉化</p></blockquote><p><a href="https://www.eclipse.org/babel/downloads.php">语言包地址</a></p><p>eclipse -&gt; help -&gt; install new software<br>install -&gt; work with：<code>https://download.eclipse.org/technology/babel/update-site/R0.17.0/2019-06/</code><br>点击 add -&gt; 选择 chinese -&gt; next next next</p><p><em>可以汉化，但是存在报错，不知道是不是版本问题，使用版本 2019-09</em></p><p>===========================================</p><h4 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h4><blockquote><p>Java 注释：</p></blockquote><pre><code>单行注释：//  .....多行注释：/*  ..... */文档注释：/** ..... */</code></pre><blockquote><p>数据类型</p></blockquote><p>基本类型：</p><p>&nbsp;&nbsp;&nbsp;整型（4）： byte short int long<br>浮点型（2）： float double<br>字符型（1）： char（Unicode编码）<br>布尔型（1）： boolean</p><p>byte（<code>8bit</code>）：范围 -2<sup>7</sup> ~ 2<sup>7</sup>-1<br>short（<code>16bit</code>）、int（<code>32bit</code>）、long（<code>64bit</code>）<br>float（<code>32bit</code>）&nbsp;&nbsp;&nbsp;&nbsp;： 0，0*9&nbsp;&nbsp;，0*22<br>double（<code>64bit</code>）： 0，0*19，0*44<br>char（<code>16bit</code>）、boolean（<code>1bit</code>）</p><p><em>1byte == 8bit（bit：敏感单元位） 0000，0000 （256种组合）</em></p><p>引用类型：</p><p>数组 []、类 class、接口 interface、枚举 enum、注解 @interface</p><blockquote><p>常量、变量</p></blockquote><p>标识符常量：final [数据类型] [变量名称] = 值；<code>常量不可更改</code><br>变量：[数据类型] [变量名称] = 值；</p><pre><code>*变量是一个内存空间，声明必须制定类型；未初始化值，不可以使用；“=” 初始化赋值；变量空间内容有且只有一个；空间内的内容的类型和定义时一致，值可以改变*常量 在内存（常量缓冲区，常量池）中 初始大小（int 类型） 32bit （double 类型） 64bit如果初始化的值超出范围，编译会报错：float a = 3.4F;long b = 2147483648L;</code></pre><p>类型转换：</p><pre><code>同种数据类型之间:    大空间类型 赋值 小空间类型 -&gt;  直接赋值    byte a = 1; int b = a;    小空间类型 赋值 大空间类型 -&gt; （小空间类型）强制转换    int a = 1; byte b = (byte)a; *如果a的值超出b的范围，强制转换编译可以，执行后b的值会发生改变*    整型和浮点型之间转换，比较精度程度    byte -&gt; short -&gt; int -&gt; long -（比较的是精确程度）&gt; float -&gt; double不同数据类型：    int -&gt; char Unicode码强制转换    布尔类型不能转换    包装类（Integer Character Byte Float Double Long...）</code></pre><blockquote><p>运算符</p></blockquote><pre><code>算术运算符、赋值运算符、关系运算符、逻辑运算符、位运算a = a++ 先备份赋值，后计算a = ++a 先计算，后备份赋值</code></pre><blockquote><p>语法结构</p></blockquote><p>分支结构：</p><pre><code>if switch</code></pre><p>循环结构：</p><pre><code>for while do...whilefor（；；）for（：） //加强 for 循环，用于遍历，只能取值，不能赋值，没有 index 索引</code></pre><p>break、continue 标记</p><blockquote><p>数组</p></blockquote><p>静态初始化：</p><pre><code>int[] arr = new int[]｛10，20，30，40｝;int[] arr = ｛10，20，30，40｝</code></pre><p>动态初始化：</p><pre><code>int[] arr = new int[8]有长度，有默认值整型:0浮点型：0.0字符型： &#39;0&#39; -&gt; 48 布尔型：false引用数据类型：null</code></pre><blockquote><p>动态参数列表</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">funName</span><span class="params">(<span class="keyword">int</span>...x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//动态参数列表，底层本质 数组</span></span><br><span class="line">    <span class="comment">//动态参数列表只能有一个，且放置在方法参数的末尾</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>类组成</p></blockquote><p>属性、方法、构造方法、程序块</p><pre><code>重写类构造方法，默认构造方法需要保留程序块：    没有修饰符、没有参数、没有返回值、没有名字的特殊方法    无法重载，块可以存在多个    块需要调用才能执行，每次调用构造方法之前，系统会自动调用程序块，执行一次</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类封装</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayBox</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//属性</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> Object[] arrDatas;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayBox</span><span class="params">()</span></span>&#123;</span><br><span class="line">        arrDatas = <span class="keyword">new</span> Object[DEFAULT_CAPACITY];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//构造方法重载</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayBox</span><span class="params">(<span class="keyword">int</span> capacity)</span></span>&#123;</span><br><span class="line">        arrDatas = <span class="keyword">new</span> Object[capacity];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    <span class="comment">//1、添加元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E ele)</span></span>&#123;</span><br><span class="line">        ensureCapacityInternal(size + <span class="number">1</span>);</span><br><span class="line">        arrDatas[size++] = ele;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2、容量校验</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(minCapacity - arrDatas.length &gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//需要空间超出剩余空间</span></span><br><span class="line">            grow(minCapacity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3、扩容</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span></span>&#123;</span><br><span class="line">        <span class="comment">//原有空间大小</span></span><br><span class="line">        <span class="keyword">int</span> oldCapacity = arrDatas.length;</span><br><span class="line">        <span class="comment">//扩容1.5倍</span></span><br><span class="line">        <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity&gt;&gt;<span class="number">1</span>);</span><br><span class="line">        newCapacity = newCapacity - minCapacity&lt;<span class="number">0</span> ? minCapacity : newCapacity;</span><br><span class="line">        arrDatas = copy(newCapacity, arrDatas);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4、数据转移</span></span><br><span class="line">    <span class="keyword">private</span> Object[] copy(<span class="keyword">int</span> newCapacity, Object[] oldArrDatas)&#123;</span><br><span class="line">        Object[] newArrDatas = <span class="keyword">new</span> Object[newCapacity];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;oldArrDatas.length; i++)&#123;</span><br><span class="line">            newArrDatas[i] = oldArrDatas[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> newArrDatas;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5、获取元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line">        <span class="keyword">return</span> (E)arrDatas[index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6、索引校验</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheck</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(index&lt;<span class="number">0</span> || index&gt;=size)&#123;</span><br><span class="line">            <span class="comment">//定义异常处理</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BoxIndexOutOfBoundsExection(<span class="string">&quot;索引超出范围:index:&quot;</span> + </span><br><span class="line">index + <span class="string">&quot;, size:&quot;</span> + size);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//7、删除元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">        rangeCheck(index);</span><br><span class="line">        E oldVal = (E)arrDatas[index];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = index; i&lt;size-<span class="number">1</span>; i++)&#123;</span><br><span class="line">            arrDatas[i] = arrDatas[i+<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        arrDatas[--size]=<span class="keyword">null</span>; <span class="comment">//末尾元素清空</span></span><br><span class="line">        <span class="keyword">return</span> oldVal;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//8、获取元素个数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义异常处理</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoxIndexOutOfBoundsExection</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span></span>&#123;</span><br><span class="line">    <span class="comment">//构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BoxIndexOutOfBoundsExection</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BoxIndexOutOfBoundsExection</span><span class="params">(String msg)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main方法使用</span></span><br><span class="line">ArrayBox&lt;Integer&gt; ab = <span class="keyword">new</span> ArrayBox&lt;Integer&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">11</span>; i++)&#123;</span><br><span class="line">        ab.add(i*<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="类和类的关系"><a href="#类和类的关系" class="headerlink" title="类和类的关系"></a>类和类的关系</h4><p>A is-a B 泛化(继承 实现)<br>A has-a B 包含(组合 聚合 关联)<br>A use-a B 依赖(依赖)</p><blockquote><p>继承</p></blockquote><ol><li>子类 extends 父类</li><li>子类可以调用父类中（public protected）的属性，方法</li><li>子类可以添加自己的属性和方法</li><li>子类可以重写父类方法内容 override</li><li>每一个类都有继承类，默认 Object:引用类型的父类</li><li>Java 单继承：目的类使用更安全，可以通过（传递、多实现）实现多继承</li><li>继承在内存中的存在形势*</li><li>this和super代替的对象*</li></ol><style>table,table td{ border:1px solid #cdcdcd; border-collapse: collapse;}table th,table td{ padding:.5rem; min-width:120px;}</style><table><thead><tr><th align="left">–</th><th align="left">方法重写override</th><th align="left">方法重载overload</th></tr></thead><tbody><tr><td align="left">类</td><td align="left">两个继承关系的类，子类重写父类的方法内容</td><td align="left">一个类中的一组方法</td></tr><tr><td align="left">权限</td><td align="left">子类可以大于等于父类</td><td align="left">无要求</td></tr><tr><td align="left">特征</td><td align="left">final static abstract<br/>父类final 子类不能重写<br/>父类static 子类不存在<br/>父类abstract 子类必须重写</td><td align="left">无要求</td></tr><tr><td align="left">返回值</td><td align="left">子类可以小于等于父类</td><td align="left">无要求</td></tr><tr><td align="left">名字</td><td align="left">子类父类一致</td><td align="left">一个类中的好多方法名必须一致</td></tr><tr><td align="left">参数</td><td align="left">子类父类一致</td><td align="left">每一个方法的参数必须不一致</td></tr><tr><td align="left">异常</td><td align="left">父类抛出运行时异常，子类可以不予理会；<br/>父类抛出编译时异常，子类抛出的异常个数、类型小于等于父类</td><td align="left">无要求</td></tr><tr><td align="left">方法体</td><td align="left">方法内容不一致</td><td align="left"></td></tr></tbody></table><blockquote><p>Object 类中的方法</p></blockquote><p>equals()、hashCode()、toString()、getClass()、notify()、notifyAll()、wait()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//equals()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//hashCode()</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">//toString()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> getClass().getName + <span class="string">&quot;@&quot;</span> + Interger.toHexString(hashCode());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//getClass() 获取对象对应的类映射（反射）</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">finalize</span><span class="params">()</span> 在对象被GC回收的时候，默认调用执行</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">clone</span><span class="params">()</span>    克隆对象</span></span><br></pre></td></tr></table></figure><blockquote><p>包含</p></blockquote><p>一个类的对象当做另一个类的属性来存储</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String brand;</span><br><span class="line">    <span class="keyword">public</span> String type;</span><br><span class="line">    <span class="keyword">public</span> String color;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Wheel wheel; <span class="comment">//包含关系</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(String brand, String type, String color, Wheel wheel)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">        <span class="keyword">this</span>.color = color;</span><br><span class="line">        <span class="keyword">this</span>.wheel = wheel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showCar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这是一辆&quot;</span> + brand + <span class="string">&quot;牌，&quot;</span> + type + <span class="string">&quot;型号, &quot;</span> + color + <span class="string">&quot;的小汽车！&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;车上搭载着&quot;</span> + wheel.brand + <span class="string">&quot;牌&quot;</span> + wheel.size + <span class="string">&quot;尺寸&quot;</span> + </span><br><span class="line">wheel.color + <span class="string">&quot;颜色的轮子！&quot;</span>);</span><br><span class="line">        wheel.turn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Wheel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String brand;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">public</span> String color;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Wheel</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Wheel</span><span class="params">(String brand, <span class="keyword">int</span> size, String color)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.brand = brand;</span><br><span class="line">        <span class="keyword">this</span>.size = size;</span><br><span class="line">        <span class="keyword">this</span>.color = color;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turn</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;车轮子可以旋转！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main方法使用</span></span><br><span class="line">Car car = <span class="keyword">new</span> Car();</span><br><span class="line">car.brand=<span class="string">&quot;奥迪&quot;</span>;</span><br><span class="line">car.type=<span class="string">&quot;Z4&quot;</span>;</span><br><span class="line">car.color=<span class="string">&quot;米蓝色&quot;</span>;</span><br><span class="line"></span><br><span class="line">car.wheel= <span class="keyword">new</span> Wheel(<span class="string">&quot;米其林&quot;</span>,<span class="number">400</span>,<span class="string">&quot;酷黑&quot;</span>);</span><br><span class="line">car.showCar();</span><br></pre></td></tr></table></figure><blockquote><p>依赖</p></blockquote><p>一个类的方法使用了另一个类的对象（方法中参数传递，方法中自己创建 new）</p><p>高内聚低耦合：紧密 继承（实现）&gt; 包含 &gt; 依赖</p><blockquote><p>面向对象三（四）大特性</p></blockquote><pre><code>继承 封装 多态 （抽象）</code></pre><h4 id="权限修饰符"><a href="#权限修饰符" class="headerlink" title="权限修饰符"></a>权限修饰符</h4><p>public<br>protected<br>默认<br>private</p><pre><code>可以修饰类和类成员（除了程序块）修饰类的时候 只允许 public 默认</code></pre><p>final</p><pre><code>修饰变量：变量没有赋值，给一次机会；变量有值，不予许再次更改        变量基本类型，值不可更改；变量引用类型，地址可以修改修饰属性：和修饰变量类似（修饰属性必须赋初始值，否则编译报错）修饰方法：方法的最终不可更改，方法不能被子类重写  修饰类：类不可以被继承（常见的工具类：String Math Scanner等）</code></pre><p>static（静态的）<br>abstract（抽象的）<br>native（本地的）<br>transient（短暂的—-&gt;序列化）<br>*synchronized（同步的）<br>*volatile（不稳定，保护属性、方法的线程安全）</p><blockquote><p>static</p></blockquote><pre><code>可以修饰属性、方法、程序块、类（内部类）静态元素在类加载时就初始化，此时没有创建对象静态元素存储在静态元素区，每个类有一个自己的区域静态元素只加载一次，不属于任何对象，只属于类，可以通过类名访问静态元素区 GarBage Collection 无法管理，可以认为常驻内存非静态成员中可以访问静态成员静态成员中不可以访问非静态成员</code></pre><blockquote><p>类的加载顺序</p></blockquote><pre><code>父类 -&gt; 父类静态空间（属性、方法、程序块）    执行静态程序块子类 -&gt; 子类静态空间（属性、方法、程序块）    执行静态程序块加载父类非静态成员    执行程序块，构造方法加载子类非静态成员    执行程序块，构造方法</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Box</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E item)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Box</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//构造方法，不能自己使用，只能子类使用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//程序块</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getSize</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//普通方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IBox</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String x = <span class="string">&quot;属性必须初始化，默认 public static final&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*&#123;</span></span><br><span class="line"><span class="comment">        不能存在程序块</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*public Animal()&#123;</span></span><br><span class="line"><span class="comment">        不能存在构造函数</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*public void showInfo()&#123;</span></span><br><span class="line"><span class="comment">        不能存在具体化方法</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showA</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showB</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showC</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">showC</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line">    <span class="comment">//不能用 static final 修饰</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">showDown</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1.8 修饰具体方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>interface  ——- 直接多继承 ——-   interface     接口定义规则<br>abstract     ——- 直接单继承 ——-   abstract      抽象类描述事物<br>class    ——- 直接单继承 ——-   class         具体描述细节</p><p>class   ——- 不能直接单继承 ——-  abstract    需要将抽象方法具体化<br>class  ——- 不能直接多实现 ——-  interface   需要将抽象方法具体化<br>abstract ——- 直接多实现 ——-  interface</p><blockquote><p>多态</p></blockquote><p>(Student\Teacher) extends Person extends Animal —&gt; Object</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Object o = <span class="keyword">new</span> Teacher();</span><br><span class="line">o.hashCode();</span><br><span class="line">o.toString();</span><br><span class="line"><span class="comment">//只能调用 Object 的方法</span></span><br><span class="line"></span><br><span class="line">Person p = (Person)o;</span><br><span class="line">System.out.println(p.name);  <span class="comment">//Person 的属性</span></span><br><span class="line">p.eat();</span><br><span class="line">p.sleep();</span><br><span class="line">p.talk();</span><br><span class="line">p.work();</span><br><span class="line"><span class="comment">//方法调用，Teacher重写的、独有的方法 &gt; Person &gt; Animal</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Student s = (Student)o;</span></span><br><span class="line"><span class="comment">//s.name;</span></span><br><span class="line"><span class="comment">//同级成员不能强制转化，向上、向下转型（造型）运行时 ClassCastException 报错</span></span><br><span class="line"></span><br><span class="line">Teacher t = (Teacher)o;</span><br><span class="line">System.out.println(t.name);  <span class="comment">//Teacher 的属性</span></span><br><span class="line">p.eat();</span><br><span class="line">p.sleep();</span><br><span class="line">p.talk();</span><br><span class="line">p.work();</span><br><span class="line"><span class="comment">//方法调用，Teacher重写的、独有的方法 &gt; Person &gt; Animal</span></span><br></pre></td></tr></table></figure><h4 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Week</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Monday(<span class="string">&quot;星期一&quot;</span>,<span class="number">1</span>),</span><br><span class="line">    Tuesday(<span class="string">&quot;星期二&quot;</span>,<span class="number">2</span>),</span><br><span class="line">    Wednesday,</span><br><span class="line">    Thursday,</span><br><span class="line">    Friday,</span><br><span class="line">    Saturday,</span><br><span class="line">    Sunday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Week</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Week</span><span class="params">(String name, <span class="keyword">int</span> index)</span></span>&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类中重写</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;对象被回收了...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//System.gc() 可以看到垃圾回收</span></span><br><span class="line">Person p = <span class="keyword">new</span> Person();</span><br><span class="line">System.out.println(<span class="string">&quot;Person对象被创建成功！&quot;</span>);</span><br><span class="line">p=<span class="keyword">null</span>;</span><br><span class="line">System.gc();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Runtime</span></span><br><span class="line">Runtime r = Runtime.getRuntime();</span><br><span class="line">r.maxMemory();</span><br><span class="line">r.totalMemory();</span><br><span class="line">r.freeMemory();</span><br></pre></td></tr></table></figure><h4 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h4><p>InputMisMatchException    输入异常<br>ArrayIndexOutOfBoundsException    数组越界<br>NegativeArraySizeException    负数<br>NullPointerException    空指针<br>NumberFormatException    数字格式<br>ClassCastException   类型转化<br>StackOverflowError   栈内存溢出</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HUE 工具使用</title>
      <link href="2019/10/14/HUE%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
      <url>2019/10/14/HUE%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>HUE=HadoopUser Experience，Hadoop用户体验，基于Python Web框架Django实现的。通过使用HUE我们可以在浏览器端的Web控制台上与Hadoop集群进行交互来分析处理数据。</p><p><a href="http://gethue.com/">官网网站</a></p><h4 id="安装HUE"><a href="#安装HUE" class="headerlink" title="安装HUE"></a>安装HUE</h4><p><a href="http://archive.cloudera.com/cdh5/cdh/5/hue-3.7.0-cdh5.3.0/manual.html">帮助文档</a></p><p><a href="http://archive.cloudera.com/cdh5/cdh/5/hue-3.7.0-cdh5.3.6.tar.gz">下载</a></p><blockquote><p>安装依赖</p></blockquote><p>yum -y install ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi gcc gcc-c++ krb5-devel libtidy libxml2-devel libxslt-devel openldap-devel python-devel sqlite-devel openssl-devel mysql-devel gmp-devel</p><pre><code>&gt; yum install lrzsz -ysz：将选定的文件发送（send）到本地机器rz：运行该命令会弹出一个文件选择窗口，从本地选择文件上传到服务器(receive)rz，sz是便是Linux/Unix同Windows进行ZModem文件传输的命令行工具，windows端需要支持ZModem的telnet/ssh客户端（比如SecureCRT）。注意：该方法的传输速度比较慢，推荐使用中小文件的传输。*rz -be 需要搭配客户端使用*</code></pre><blockquote><p>解压HUE，注意路径问题</p></blockquote><p>下载的HUE压缩包，上传Linux；或者 wget -c <code>http://archive.cloudera.com/cdh5/cdh/5/hue-3.7.0-cdh5.3.6.tar.gz</code></p><p>tar -zxvf /opt/softwares/hue-3.7.0-cdh5.3.6.tar.gz -C /opt/modules/</p><blockquote><p>编译HUE</p></blockquote><p>cd HUE解压安装目录<br>make apps</p><pre><code>OpenSSL/crypto/crl.c:6:23: error: static declaration of ‘X509_REVOKED_dup’ follows non-static declaration static X509_REVOKED * X509_REVOKED_dup(X509_REVOKED *orig)编译时错误：将/usr/include/openssl/x509.h文件下： 这两行删除，必须删除，采用注释的方式不行：X509_REVOKED *X509_REVOKED_dup(X509_REVOKED *rev);X509_REQ *X509_REQ_dup(X509_REQ *req);</code></pre><h4 id="配置-HUE"><a href="#配置-HUE" class="headerlink" title="配置 HUE"></a>配置 HUE</h4><p>cd desktop/conf/hue.ini</p><ul><li><p>secret_key=jFE93j;2[290-eiw.KEiwN2s3[‘d;/.q[eIW^y#e=+Iei*@Mn&lt;qW5o</p></li><li><p>Webserver listens on this address and port<br>http_host=master<br>http_port=8888</p></li><li><p>Time zone name’<br>time_zone=Asia/Shanghai</p></li></ul><blockquote><p>启动</p></blockquote><p>cd HUE：build/env/bin/supervisor</p><pre><code>Couldn&#39;t get user id for user hue解决方法：普通用户启动，修改权限</code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HUE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux WEB 服务器搭建</title>
      <link href="2019/10/14/Linux/Linux%20WEB%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/"/>
      <url>2019/10/14/Linux/Linux%20WEB%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="服务器搭建"><a href="#服务器搭建" class="headerlink" title="服务器搭建"></a>服务器搭建</h4><p>安装</p><pre><code>yum -y install httpd</code></pre><p>验证 httpd 是否安装</p><pre><code>rpm -qa|grep httpd</code></pre><p>查看 httpd 版本</p><pre><code>httpd -v</code></pre><p>查看 httpd 进程</p><pre><code>ps -ef|grep httpd</code></pre><p>查看 httpd 运行状态</p><pre><code>systemctl status httpd.service service httpd status</code></pre><p>启动 httpd 服务</p><pre><code>systemctl start httpd.service service httpd start</code></pre><p>测试 httpd 服务</p><pre><code>curl 127.0.0.1</code></pre><p>停止 httpd 服务</p><pre><code>systemctl stop httpd.serviceservice httpd stop </code></pre><p>卸载 Apache httpd</p><pre><code>yum erase httpd.x86_64</code></pre><h4 id="配置说明"><a href="#配置说明" class="headerlink" title="配置说明"></a>配置说明</h4><p>Apache 的所有配置文件都位于 /etc/httpd/conf 和 /etc/httpd/conf.d 。网站的数据默认位于 /var/www 。<br>Apache 主要的配置文件是 /etc/httpd/conf/httpd.conf</p><p>配置文件包括三部分：<br>1）Global Environment          —全局环境配置，决定Apache服务器的全局参数<br>2）Main server configuration   —主服务配置，相当于是Apache中的默认Web站点，如果我们的服务器中只有一个站点，那么就只需在这里配置就可以了。<br>3）Virtual Hosts               —虚拟主机，虚拟主机不能与Main Server主服务器共存，当启用了虚拟主机之后，Main Server就不能使用了</p><p>+显示服务器操作系统的名称：<br>在出现错误页的时候是否显示服务器操作系统的名称</p><pre><code>ServerTokens OS  //ServerTokens Prod为不显示</code></pre><p>+指定Apache的运行目录：<br>服务启动之后自动将目录改变为当前目录，在后面使用到的所有相对路径都是想对这个目录</p><pre><code>ServerRoot &quot;/etc/httpd&quot;</code></pre><p>+其它全局环境配置：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#记录httpd守护进程的pid号码，这是系统识别一个进程的方法，系统中httpd进程可以有多个，但这个PID对应的进程是其他的父进程</span></span><br><span class="line">PidFile run/httpd.pid  </span><br><span class="line"></span><br><span class="line"><span class="comment">#服务器与客户端断开的时间</span></span><br><span class="line">Timeout 60</span><br><span class="line"></span><br><span class="line"><span class="comment">#是否持续连接（因为每次连接都得三次握手，如果是访问量不大，建议打开此项，如果网站访问量比较大关闭此项比较好），</span></span><br><span class="line"><span class="comment">#修改为：KeepAlive On 表示允许程序性联机</span></span><br><span class="line">KeepAlive Off  </span><br><span class="line"></span><br><span class="line"><span class="comment">#表示一个连接的最大请求数  </span></span><br><span class="line">MaxKeepAliveRequests 100</span><br><span class="line"></span><br><span class="line"><span class="comment">#断开连接前的时间  </span></span><br><span class="line">KeepAliveTimeout 15</span><br><span class="line"></span><br><span class="line"><span class="comment">#系统默认的模块，表示为每个访问启动一个进程（多个连接公用一个进程的时候，在同一时刻只能有一个获得服务）</span></span><br><span class="line"><span class="comment">#&lt;IfModule prefork.c&gt;   </span></span><br><span class="line"><span class="comment">#&lt;IfModule worker.c&gt;    配置线程访问</span></span><br></pre></td></tr></table></figure><p>+Listen 配置，监听端口：</p><pre><code>Listen IP:PORT (IP不写即默认：0.0.0.0)</code></pre><p>+Dynamic Shared Object (DSO) Support(动态共享对象支持)<br>    添加 Apache 动态模块，如：php 支持模块，重定向模块，认证模块支持等</p><pre><code>LoadModule foo_module modules/mod_foo.so</code></pre><p>Include conf.modules.d/*.conf</p><p>+Apache运行用户配置：</p><pre><code>User apacheGroup apache</code></pre><p>+Apache服务默认管理员地址配置：</p><pre><code>ServerAdmin root@localhost</code></pre><p>+Apache的默认服务名及端口设置：</p><pre><code>ServerName localhost:80</code></pre><p>+Apache的根目录访问控制设置：<br>    默认Apache对根目录访问都是拒绝访问</p><pre><code>&lt;Directory /&gt;    AllowOverride none    Require all denied&lt;/Directory&gt;</code></pre><p>+Apache的默认网站根目录设置及访问控制：<br>    默认对网站的根目录具有访问权限，此选项默认值即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DocumentRoot <span class="string">&quot;/var/www/html&quot;</span></span><br><span class="line">&lt;Directory <span class="string">&quot;/var/www&quot;</span>&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory <span class="string">&quot;/var/www/html&quot;</span>&gt;</span><br><span class="line">    Options Indexes FollowSymLinks</span><br><span class="line">    AllowOverride None  //使用.htaccess会严重影响到Apache的性能，如果不是特殊需要，建议关闭</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>+Apache的默认首页设置：<br>    默认只支持:index.html首页，如要支持其他类型的首页，需要在此区域添加:如index.php表示支持index.php类型首页</p><pre><code>&lt;IfModule dir_module&gt;    DirectoryIndex index.html&lt;/IfModule&gt;</code></pre><p>+Apache关于.ht文件访问配置：<br>    默认为具有访问权限，此区域文件默认即可</p><pre><code>&lt;Files &quot;.ht*&quot;&gt;    Require all denied&lt;/Files&gt;</code></pre><p>+Apache关于日志文件配置：<br>    默认的日志级别，默认的访问日志路径，默认的错误日志路径等相关设置，此选项内容默认即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ErrorLog <span class="string">&quot;logs/error_log&quot;</span>    //错误日志存放的位置</span><br><span class="line">LogLevel warn    //日志的级别</span><br><span class="line">&lt;IfModule log_config_module&gt;</span><br><span class="line">    LogFormat <span class="string">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot;</span> combined</span><br><span class="line">    LogFormat <span class="string">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot;</span> common</span><br><span class="line"></span><br><span class="line">    &lt;IfModule logio_module&gt;</span><br><span class="line">      LogFormat <span class="string">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot; %I %O&quot;</span> combinedio</span><br><span class="line">    &lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">    CustomLog <span class="string">&quot;logs/access_log&quot;</span> combined</span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure><p>+URL重定向，cgi模块配置说明：<br>包含一些URL重定向，别名，脚本别名等相关设置，以及一些特定的处理程序，比如cgi设置说明</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule alias_module&gt;</span><br><span class="line">    <span class="comment">#Alias /testWeb /var/www/testWeb</span></span><br><span class="line">    ScriptAlias /cgi-bin/ <span class="string">&quot;/var/www/cgi-bin/&quot;</span>    //对CGI模块儿的的别名</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory <span class="string">&quot;/var/www/cgi-bin&quot;</span>&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Options None</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>+MIME媒体文件，以及相关http文件解析配置说明：<br>包含一些mime文件支持，以及添加一些指令在给定的文件扩展名与特定的内容类型之间建立映射关系，比如添加对php文件扩展名映射关系</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mime_module&gt;</span><br><span class="line">    TypesConfig /etc/mime.types     //设置保存有不同MIME类型数据的文件名</span><br><span class="line">    <span class="comment">#AddType application/x-gzip .tgz</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#AddEncoding x-compress .Z</span></span><br><span class="line">    <span class="comment">#AddEncoding x-gzip .gz .tgz</span></span><br><span class="line"></span><br><span class="line">    AddType application/x-compress .Z</span><br><span class="line">    AddType application/x-gzip .gz .tgz</span><br><span class="line"></span><br><span class="line">    <span class="comment">#AddHandler cgi-script .cgi .pl 表示允许扩展名为.pl的CGI脚本运行</span></span><br><span class="line"><span class="comment">#AddHandler type-map var</span></span><br><span class="line"></span><br><span class="line">    AddType text/html .shtml</span><br><span class="line">    AddOutputFilter INCLUDES .shtml</span><br><span class="line"></span><br><span class="line">    <span class="comment">#ErrorDocument 404 /missing.html    //服务器出现404错误的时候，返回missing.html页面</span></span><br><span class="line">&lt;/IfModule&gt;</span><br></pre></td></tr></table></figure><p>+服务器页面提示设置：<br>    可定制的访问错误响应提示，支持三种方式：1明文 ，2本地重定向 3，外部重定向；另外还包括内存映射或“发送文件系统调用”可被用于分发文件等配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule mime_magic_module&gt;</span><br><span class="line">    MIMEMagicFile conf/magic    //判断文件真实MIME类型功能的模块</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ErrorDocument 500 &quot;The server made a boo boo.&quot;</span></span><br><span class="line"><span class="comment">#ErrorDocument 404 /missing.html</span></span><br><span class="line"><span class="comment">#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;</span></span><br><span class="line"><span class="comment">#ErrorDocument 402 http://www.example.com/subscription_info.html</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#EnableMMAP off    //是否允许内存映射</span></span><br><span class="line">EnableSendfile on</span><br></pre></td></tr></table></figure><p>+Apache服务器补充设置：<br>    服务器池管理，多语言错误消息，动态目录列表形式配置，语言设置，用户家庭目录，请求和配置上的实时信息，虚拟主机，Apache Http Server手册，分布式创作和版本控制，多种类默认设置，mod_proxy_html，使其支持HTML4/XHTML1等等补充配置的补充</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IncludeOptional conf.d/*.conf</span><br></pre></td></tr></table></figure><p>+Apache服务器安全连接设置：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule ssl_module&gt;</span><br><span class="line">    SSLRandomSeed startup <span class="built_in">builtin</span></span><br><span class="line">SSLRandomSeed connect <span class="built_in">builtin</span></span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">ServerSignature Off    //当客户请求的网页不存在，或者错误的时候是否提示apache的版本的一些信息</span><br><span class="line">TraceEnable Off</span><br></pre></td></tr></table></figure><p>+启用虚拟主机：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&lt;VirtualHost *:80&gt; </span></span><br><span class="line"><span class="comment">#ServerAdmin webmaster@www.linuxidc.com </span></span><br><span class="line"><span class="comment">#DocumentRoot /www/docs/www.linuxidc.com </span></span><br><span class="line"><span class="comment">#ServerName www.linuxidc.com </span></span><br><span class="line"><span class="comment">#ErrorLog logs/www.linuxidc.com-error_log </span></span><br><span class="line"><span class="comment">#CustomLog logs/www.linuxidc.com-access_log common </span></span><br><span class="line"><span class="comment">#&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/Renyi-Fan/p/9976867.html">参考文档</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux FTP 服务器搭建</title>
      <link href="2019/10/10/Linux/Linux%20FTP%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/"/>
      <url>2019/10/10/Linux/Linux%20FTP%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="安装-vsftpd"><a href="#安装-vsftpd" class="headerlink" title="安装 vsftpd"></a>安装 vsftpd</h4><p>yum install -y vsftpd</p><p>cd /etc/vsftpd<br>ls</p><p>目录说明：<br>/etc/vsftpd/vsftpd.conf 是核心配置文件<br>/etc/vsftpd/ftpusers 是黑名单文件，此文件里的用户不允许访问 FTP 服务器<br>/etc/vsftpd/user_list  是白名单文件，是允许访问 FTP 服务器的用户列表<br>/etc/vsftpd/vsftpd_conf_migrate.sh  是vsftpd操作的一些变量和设置</p><p><strong>+开机自启动。</strong><br>systemctl enable vsftpd</p><p><strong>+启动 FTP 服务。</strong><br>systemctl start vsftpd</p><p><strong>+查看 FTP 服务端口。</strong><br>netstat -antup | grep ftp<br>netstat -tnulp | grep vsftpd</p><pre><code>常见问题：netstat 未找到命令yum install -y net-toolsnetstat 命令：netstat -tln 用来查看linux的端口使用情况</code></pre><h4 id="配置用户"><a href="#配置用户" class="headerlink" title="配置用户"></a>配置用户</h4><p><strong>+创建、删除 ftptest 用户</strong><br>useradd ftptest<br>sudo userdel -r newuser</p><p><strong>+修改用户密码</strong><br>passwd ftptest</p><h4 id="其它配置"><a href="#其它配置" class="headerlink" title="其它配置"></a>其它配置</h4><p><strong>+修改/etc/vsftpd/vsftpd.conf</strong></p><pre><code>vim /etc/vsftpd/vsftpd.conf“i” 进入编辑模式是否允许匿名登录 FTP 的参数修改为anonymous enable=NO是否允许本地用户登录 FTP 的参数修改为local_enable=YESpasv_enable=YES       pasv_min_port=8800pasv_max_port=8899</code></pre><p><strong>+关闭防火墙</strong><br>centoos 7操作为 systemctl stop firewalld.service<br>centoos 6操作位 service stop iptables;</p><p><strong>+启动ftp服务器</strong><br>cetoos 7操作为 systemctl restart vsftpd.service<br>centoos 6操作为 service vsftpd restart</p><p><strong>+赋权，将ftp指定的根目录赋权为777权限</strong><br>chmod 777 /var/ftp/pub</p><p><strong>+检查SElinux状态并关闭</strong><br>getsebool -a|grep ftp</p><pre><code>若centoos 6 则在设置几个权限：setsebool httpd_enable_ftp_server 1 +[参考资料](https://www.cnblogs.com/LHWorldBlog/p/8516837.html)</code></pre><p><strong>扩展知识</strong></p><p>FTP的连接一般是有两个连接：<br>    1.客户程和服务器传输命令的连接。<br>    2.数据传送的连接。</p><p>FTP服务程序一般会支持两种不同的模式：<br>    1.Port模式<br>    2.Passive模式(Pasv Mode)</p><p><strong>+区别</strong></p><p>Port模式:<br>当客户端C向服务端S连接后，使用的是Port模式,那么客户端C会发送一条命令告诉服务端S(客户端C在本地打开了一个端口N在等着你进行数据连接),当服务端S收到这个Port命令后 就会向客户端打开的那个端口N进行连接，这种数据连接就生成了。<br>Pasv模式:<br>当客户端C向服务端S连接后，服务端S会发信息给客户端C,这个信息是(服务端S在本地打开了一个端口M,你现在去连接我吧),当客户端C收到这个信息后，就可以向服务端S的M端口进行连接,连接成功后，数据连接也建立了。</p><h4 id="FTP-账户访问限制"><a href="#FTP-账户访问限制" class="headerlink" title="FTP 账户访问限制"></a>FTP 账户访问限制</h4><pre><code>vim /etc/vsftpd/vsftpd.conf  chroot chroot_local_user=YESchroot_list_enable=YESallow_writeable_chroot=YES</code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux 基础</title>
      <link href="2019/10/09/Linux/Linux%20%E5%9F%BA%E7%A1%80/"/>
      <url>2019/10/09/Linux/Linux%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="Linux-介绍"><a href="#Linux-介绍" class="headerlink" title="Linux 介绍"></a>Linux 介绍</h4><blockquote><p>发行版</p></blockquote><p>市面上较知名的发行版有：Ubuntu、RedHat、CentOS、Debian、Fedora、SuSE、OpenSUSE、Arch Linux、SolusOS</p><blockquote><p>应用领域</p></blockquote><p>LAMP（Linux + Apache + MySQL + PHP）<br>LNMP（Linux + Nginx+ MySQL + PHP）</p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p><a href="https://blog.csdn.net/babyxue/article/details/80970526">Centos 7 安装</a></p><h4 id="系统启动过程"><a href="#系统启动过程" class="headerlink" title="系统启动过程"></a>系统启动过程</h4><ol><li>内核的引导。</li><li>运行 init。</li><li>系统初始化。</li><li>建立终端 。</li><li>用户登录系统。</li></ol><ul><li><p>init程序的类型：<br>  SysV: init, CentOS 5之前, 配置文件： /etc/inittab。<br>  Upstart: init,CentOS 6, 配置文件： /etc/inittab, /etc/init/*.conf。<br>  Systemd： systemd, CentOS 7,配置文件： /usr/lib/systemd/system、 /etc/systemd/system。</p></li><li><p>运行级别<br>  运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动<br>  运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆<br>  运行级别2：多用户状态(没有NFS)<br>  运行级别3：完全的多用户状态(有NFS)，登陆后进入控制台命令行模式<br>  运行级别4：系统未使用，保留<br>  运行级别5：X11控制台，登陆后进入图形GUI模式<br>  运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动</p></li><li><p>图形模式与文字模式的切换方式<br>  Linux预设提供了六个命令窗口终端机让我们来登录。<br>  默认登录第一个，tty1，Ctrl + Alt + F1 ~ F6 切换命令窗口<br>  如果安装了图形界面，进入命令窗口界面后再返回图形界面只要按下Ctrl + Alt + F7</p></li></ul><h4 id="关机流程"><a href="#关机流程" class="headerlink" title="关机流程"></a>关机流程</h4><p>sync &gt; shutdown &gt; reboot &gt; halt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sync 将数据由内存同步到硬盘中。</span><br><span class="line">shutdown 关机指令，你可以man shutdown 来看一下帮助文档。例如你可以运行如下命令关机：</span><br><span class="line"></span><br><span class="line">这个命令告诉大家，计算机将在10分钟后关机，并且会显示在登陆用户的当前屏幕中。</span><br><span class="line">shutdown –h 10 ‘This server will shutdown after 10 mins’ </span><br><span class="line">shutdown –h now 立马关机</span><br><span class="line">shutdown –h 20:25 系统会在今天20:25关机</span><br><span class="line">shutdown –h +10 十分钟后关机</span><br><span class="line">shutdown –r now 系统立马重启</span><br><span class="line">shutdown –r +10 系统十分钟后重启</span><br><span class="line">reboot 就是重启，等同于 shutdown –r now</span><br><span class="line">halt 关闭系统，等同于shutdown –h now 和 poweroff</span><br></pre></td></tr></table></figure><h4 id="系统目录结构"><a href="#系统目录结构" class="headerlink" title="系统目录结构"></a>系统目录结构</h4><p><strong>/bin：</strong><br>bin是Binary的缩写, 这个目录存放着最经常使用的命令。</p><p>/boot：<br>这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。</p><p>/dev ：<br>dev是Device(设备)的缩写, 该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。</p><p><strong>/etc：</strong><br>这个目录用来存放所有的系统管理所需要的配置文件和子目录。</p><p>/home：<br>用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。</p><p>/lib：<br>这个目录里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。</p><p>/lost+found：<br>这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。</p><p>/media：<br>linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。</p><p>/mnt：<br>系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。</p><p>/opt：<br> 这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。</p><p>/proc：<br>这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。<br>这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：</p><pre><code>echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</code></pre><p>/root：<br>该目录为系统管理员，也称作超级权限者的用户主目录。</p><p><strong>/sbin：</strong><br>s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。</p><p>/selinux：<br> 这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。</p><p>/srv：<br> 该目录存放一些服务启动之后需要提取的数据。</p><p>/sys：</p><p> 这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。</p><p>sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。<br>该文件系统是内核设备树的一个直观反映。</p><p>当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。</p><p>/tmp：<br>这个目录是用来存放一些临时文件的。</p><p>/usr：<br> 这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。</p><p><strong>/usr/bin：</strong><br>系统用户使用的应用程序。</p><p><strong>/usr/sbin：</strong><br>超级用户使用的比较高级的管理程序和系统守护程序。</p><p>/usr/src：<br>内核源代码默认的放置目录。</p><p><strong>/var：</strong><br>这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。</p><p>/run：<br>是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。</p><p>+系统启动必须：</p><pre><code>/boot /etc /lib /sys</code></pre><p>+指令集合：</p><pre><code>/bin /sbin</code></pre><p>+外部文件管理：</p><pre><code>/dev /media /mnt</code></pre><p>+临时文件：</p><pre><code>/run /lost+found /tmp</code></pre><p>+账户：<br>    /root /home /usr /usr/bin /usr/sbin /usr/src</p><h4 id="忘记密码解决方法"><a href="#忘记密码解决方法" class="headerlink" title="忘记密码解决方法"></a>忘记密码解决方法</h4><p>进入单用户模式</p><h4 id="远程登录"><a href="#远程登录" class="headerlink" title="远程登录"></a>远程登录</h4><p><a href="https://www.putty.org/">putty 下载</a></p><p>Linux 查看 ip 信息：ip a s</p><h4 id="文件基本属性"><a href="#文件基本属性" class="headerlink" title="文件基本属性"></a>文件基本属性</h4><p>命令行：ls -l</p><pre><code>drwxr-xr-x 3 mysql mysql 4096 Apr 21  2014 mysql</code></pre><p>Linux中第一个字符代表这个文件是目录、文件或链接文件等</p><pre><code>当为[ d ]则是目录；当为[ - ]则是文件；若是[ l ]则表示为链接文档(link file)；若是[ b ]则表示为装置文件里面的可供储存的接口设备(可随机存取装置)；若是[ c ]则表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)。</code></pre><p>接下来的位置：[ r ]代表可读(read)、[ w ]代表可写(write)、[ x ]代表可执行(execute)。 要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号[ - ]而已</p><pre><code>文件     属主      属组    其他用户类型     权限      权限      权限 0     1，2，3   4，5，6   7，8，9 d       rwx       r-x       r-x</code></pre><blockquote><p>更改文件属组</p></blockquote><pre><code>chgrp [-R] 属组名 文件名  //-R：递归更改文件属组</code></pre><blockquote><p>更改文件属主，也可以同时更改文件属组</p></blockquote><pre><code>chown [–R] 属主名 文件名chown [-R] 属主名：属组名 文件名</code></pre><blockquote><p>更改文件9个属性</p></blockquote><pre><code>/* 方法一 */各权限的分数对照表：r:4 w:2 x:1chmod [-R] 权限数字 文件或目录/* 方法二 */身份：u g o a赋值：+ - =权限：r w xchmod u=rwx,g=rx,o=r  文件或目录chmod a-x 文件或目录</code></pre><h4 id="文件与目录管理"><a href="#文件与目录管理" class="headerlink" title="文件与目录管理"></a>文件与目录管理</h4><p>处理目录的常用命令：</p><pre><code>ls: 列出目录            // -a -d -l --full-time cd：切换目录pwd：显示目前的目录      // -P 显示正确的完整路径mkdir：创建一个新的目录  // -m 设置权限 -p 创建多层目录rmdir：删除一个空的目录cp: 复制文件或目录rm: 移除文件或目录mv: 移动文件与目录，或修改文件与目录的名称</code></pre><p>文件内容常用命令：</p><pre><code>cat  由第一行开始显示文件内容tac  从最后一行开始显示，可以看出 tac 是 cat 的倒著写！nl   显示的时候，顺道输出行号！more 一页一页的显示文件内容less 与 more 类似，但是比 more 更好的是，他可以往前翻页！head 只看头几行tail 只看尾巴几行</code></pre><h4 id="用户账号的管理"><a href="#用户账号的管理" class="headerlink" title="用户账号的管理"></a>用户账号的管理</h4><p>useradd 选项 用户名</p><pre><code>-c comment 指定一段注释性描述。-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。-g 用户组 指定用户所属的用户组。-G 用户组，用户组 指定用户所属的附加组。-s Shell文件 指定用户的登录Shell。-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。</code></pre><p>userdel,usermod </p><p>passwd 选项 用户名</p><pre><code>-l 锁定口令，即禁用账号。-u 口令解锁。-d 使账号无口令。-f 强迫用户下次登录时修改口令。</code></pre><blockquote><p>用户组的管理</p></blockquote><pre><code>groupadd ,groupdel ,groupmod ,newgrp </code></pre><p>与用户和用户组相关的信息都存放在一些系统文件中，这些文件包括/etc/passwd, /etc/shadow, /etc/group等。</p><pre><code>sam:x:200:50:Sam san:/home/sam:/bin/sh用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell</code></pre><h4 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h4><pre><code>df：列出文件系统的整体磁盘使用量du：检查磁盘空间使用量fdisk：用于磁盘分区</code></pre><h4 id="vi-vim"><a href="#vi-vim" class="headerlink" title="vi/vim"></a>vi/vim</h4><p><a href="https://www.runoob.com/w3cnote/all-vim-cheatsheat.html">史上最全Vim快捷键键位图 — 入门到进阶</a></p><p>命令模式（Command mode）</p><pre><code>i 切换到输入模式，以输入字符。x 删除当前光标所在处的字符。: 切换到底线命令模式，以在最底一行输入命令。</code></pre><p>输入模式（Insert mode）</p><pre><code>字符按键以及Shift组合，输入字符ENTER，回车键，换行BACK SPACE，退格键，删除光标前一个字符DEL，删除键，删除光标后一个字符方向键，在文本中移动光标HOME/END，移动光标到行首/行尾Page Up/Page Down，上/下翻页Insert，切换光标为输入/替换模式，光标将变成竖线/下划线ESC，退出输入模式，切换到命令模式</code></pre><p>底线命令模式（Last line mode）</p><pre><code>q 退出程序w 保存文件</code></pre><blockquote><p>vim 命令的安装</p></blockquote><pre><code>yum -y install vim*常见问题: is not in the sudoers file$ su</code></pre><h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><p>Linux 的 Shell 种类众多，常见的有：</p><p>Bourne Shell（/usr/bin/sh或/bin/sh）<br>Bourne Again Shell（/bin/bash）<br>C Shell（/usr/bin/csh）<br>K Shell（/usr/bin/ksh）<br>Shell for Root（/sbin/sh）</p><p>运行 Shell 脚本</p><p>1、作为可执行程序</p><pre><code>chmod +x ./test.sh  #使脚本具有执行权限./test.sh  #执行脚本</code></pre><p>2、作为解释器参数</p><pre><code>/bin/sh test.sh/bin/php test.php</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#变量赋值，使用</span></span><br><span class="line">your_name=<span class="string">&quot;qinjx&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$your_name</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;your_name&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除变量</span></span><br><span class="line">myUrl=<span class="string">&quot;http://www.runoob.com&quot;</span></span><br><span class="line"><span class="built_in">unset</span> myUrl</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$myUrl</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字符串</span></span><br><span class="line">your_name=<span class="string">&#x27;runoob&#x27;</span></span><br><span class="line">str=<span class="string">&quot;Hello, I know you are \&quot;<span class="variable">$your_name</span>\&quot;! \n&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="variable">$str</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#拼接字符串</span></span><br><span class="line">greeting=<span class="string">&quot;hello, &quot;</span><span class="variable">$your_name</span><span class="string">&quot; !&quot;</span></span><br><span class="line">greeting_1=<span class="string">&quot;hello, <span class="variable">$&#123;your_name&#125;</span> !&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$greeting</span>  <span class="variable">$greeting_1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取字符串长度</span></span><br><span class="line">string=<span class="string">&quot;abcd&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#string&#125;</span> <span class="comment">#输出 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#截取字符串</span></span><br><span class="line">string=<span class="string">&quot;runoob is a great site&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;string:1:4&#125;</span> <span class="comment"># 从左边第几个字符开始，及字符的个数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;var:7&#125;</span>      <span class="comment"># 从左边第几个字符开始，一直到结束</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;string#*//&#125;</span> <span class="comment"># 删除左边字符，保留右边字符</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;var%/*&#125;</span>     <span class="comment"># 删除右边字符，保留左边字符</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;#&quot;</span>、<span class="string">&quot;##&quot;</span> 表示从左边开始删除。一个 <span class="string">&quot;#&quot;</span> 表示从左边删除到第一个指定的字符；两个 <span class="string">&quot;#&quot;</span> 表示从左边删除到最后一个指定的字符。</span><br><span class="line">%、%% 表示从右边开始删除。一个 % 表示从右边删除到第一个指定的字符；两个 % 表示从左边删除到最后一个指定的字符。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#查找字符串</span></span><br><span class="line">string=<span class="string">&quot;runoob is a great site&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `expr index <span class="string">&quot;<span class="variable">$string</span>&quot;</span> io`  <span class="comment"># 输出 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#支持一维数组（不支持多维数组）</span></span><br><span class="line">array_name=(value0 value1 value2 value3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取数组元素</span></span><br><span class="line">valuen=<span class="variable">$&#123;array_name[n]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历数组所有元素</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;array_name[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取数组的长度</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[@]&#125;</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[*]&#125;</span></span><br><span class="line">lengthn=<span class="variable">$&#123;#array_name[n]&#125;</span></span><br><span class="line"></span><br><span class="line">:&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">多行注释</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">:&lt;&lt;!</span><br><span class="line">多行注释</span><br><span class="line">!</span><br><span class="line"></span><br><span class="line"><span class="comment">#参数传递</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Shell 传递参数实例！&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;执行的文件名：<span class="variable">$0</span>&quot;</span>;   <span class="comment"># $0 为执行的文件名</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第一个参数为：<span class="variable">$1</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第二个参数为：<span class="variable">$2</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第三个参数为：<span class="variable">$3</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> condition1</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    command1</span><br><span class="line"><span class="keyword">elif</span> condition2 </span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">    command2</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    commandN</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> item1 item2 ... itemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>\until condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">command</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$aNum</span> <span class="keyword">in</span></span><br><span class="line">    1)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 1&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    2)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 2&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    3)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 3&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    4)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 4&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    *)  <span class="built_in">echo</span> <span class="string">&#x27;你没有输入 1 到 4 之间的数字&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fun</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;这是一个函数！&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">funWithParam</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第一个参数为 <span class="variable">$1</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第二个参数为 <span class="variable">$2</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十个参数为 <span class="variable">$10</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十个参数为 <span class="variable">$&#123;10&#125;</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十一个参数为 <span class="variable">$&#123;11&#125;</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;参数总数有 <span class="variable">$#</span> 个!&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;作为一个字符串输出所有参数 $* !&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">funWithParam 1 2 3 4 5 6 7 8 9 34 73</span><br></pre></td></tr></table></figure><p><a href="https://www.runoob.com/linux/linux-command-manual.html">Linux 命令大全</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>前端工具链</title>
      <link href="2019/10/09/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7%E9%93%BE/"/>
      <url>2019/10/09/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://www.jianshu.com/p/e248a94c35eb">前端工具链</a></li></ul><h4 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h4><p>解决问题：解决版本差异</p><p>创建一个叫做 babel-test 的文件夹</p><pre><code>npm init -ynpm install --save-dev babel-cli</code></pre><p>babel 默认的配置文件名为 .babelrc</p><pre><code>.babelrc 文件&#123;    &quot;presets&quot;: [      &quot;es2015&quot;    ],    &quot;plugins&quot;: []&#125;</code></pre><p>转码规则是以附加规则包的形式出现</p><pre><code>/*安装规则包*/npm install --save-dev babel-preset-es2015</code></pre><p>babel 是以命令行的形式使用的，常用命令</p><pre><code># 转码结果打印到控制台 babel es6.js# 转码结果写入一个文件 babel es6.js -o es5.js # 将 es6.js 的转码结果写入 es5.js 中# 转码整个目录到指定路径 babel es6js -d es5js # 将 es6js 路径下的 js 文件转码到 es5js 路径下</code></pre><p><em>由于我们的 babel 是安装在 babel-test 的 node_modules 中的，所以需要使用 npm run 来方便运行以上命令。</em></p><p>编辑 package.json</p><pre><code>&quot;scripts&quot;: &#123;    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,    &quot;build&quot;: &quot;babel inputs -d outputs&quot;  &#125;</code></pre><p>在 babel-test 下创建一个新的目录 inputs ，在其中写入新的文件 a.js:</p><pre><code>// es6 语法，模板字符串let name = &#39;ucag&#39;let greeting = `hello my name is $&#123;name&#125;`npm run build</code></pre><p>转换完成之后，我们在 outputs 下找到 a.js</p><pre><code>&#39;use strict&#39;;var name = &#39;ucag&#39;;var greeting = &#39;hello my name is &#39; + name;</code></pre><h4 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h4><p>解决问题：整合资源，把相互依赖的模块打包</p><p>创建一个叫做 babel-test 的文件夹</p><pre><code>npm init -ynpm install --save-dev webpack</code></pre><p>入口 entry：不管一个项目有多复杂，它总是有一个入口的。这个入口就被称为 entry 。这就像是我们的模块有个 index.js 一样。</p><p>出口 output：webpack 根据入口文件将被依赖的文件按照一定的规则打包在一起，最终需要一个输出打包文件的地方，这就是 output 。</p><blockquote><p>加载配置的方法<br>1.写一个独立的配置文件<br>2.在命令行内编写配置</p></blockquote><p>webpack-test 下创建一个新的文件 webpack.config.js</p><pre><code>module.exports = &#123;    entry:&#39;./main.js&#39;, // 入口文件为当前路径下的 main.js 为文件    output:&#123;        path:__dirname, // __dirname 是 node 中的全局变量，代表当前路径。        filename:&#39;index.js&#39; // 打包之后的文件名    &#125;&#125;</code></pre><p><em>当我们在 webpack-test 下不带任何参数运行 webpack 命令时，webpack 会自动去寻找名为 webpack.config.js 的文件，这就是它默认的配置文件名了。</em></p><p>编辑 package.json</p><pre><code>&quot;scripts&quot;&#123;    &#39;pkg&#39;:&#39;webpack&#39; // 编辑快捷命令&#125;</code></pre><p>在 webpack-test 下运行</p><pre><code>npm run pkg # 运行 webpack</code></pre><h4 id="模块化的方式"><a href="#模块化的方式" class="headerlink" title="模块化的方式"></a>模块化的方式</h4><p>1.CommonJS 的模块化方式<br>2.es6 的模块化方式</p><p>CommonJS 规范：</p><blockquote><p>使用 module.exports 或 exports 来导出内部变量<br>使用 require 导入变量。当被导入对象是路径时，require 会自动搜寻并引入目录下的 index.js 文件，会把这个文件作为整个文件的入口。</p></blockquote><p>es6 规范：</p><blockquote><p>使用 import 与 export 来导出内部变量<br>当导入命名导出变量时，使用基于 import { varName } from ‘model’ 的语法；当导入匿名或默认导入时，使用 import varName from ‘model’ 语法；</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python Celery</title>
      <link href="2019/09/28/python/Python%20Celery/"/>
      <url>2019/09/28/python/Python%20Celery/</url>
      
        <content type="html"><![CDATA[<h4 id="Celery"><a href="#Celery" class="headerlink" title="Celery"></a>Celery</h4>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Celery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>T-SQL 操作数据库</title>
      <link href="2019/09/28/%E6%95%B0%E6%8D%AE%E5%BA%93/T-SQL%20%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>2019/09/28/%E6%95%B0%E6%8D%AE%E5%BA%93/T-SQL%20%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h4 id="创建、删除表"><a href="#创建、删除表" class="headerlink" title="创建、删除表"></a>创建、删除表</h4><ul><li>创建<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [<span class="keyword">USER</span>](</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">address <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">phone <span class="built_in">varchar</span>(<span class="number">11</span>),</span><br><span class="line">primary <span class="keyword">key</span>(<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--验证表是否已经创建成功</span></span><br><span class="line">exec sp_columns CUSTOMERS</span><br></pre></td></tr></table></figure></li><li>删除<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [<span class="keyword">USER</span>]</span><br></pre></td></tr></table></figure></li></ul><h4 id="增删改查记录"><a href="#增删改查记录" class="headerlink" title="增删改查记录"></a>增删改查记录</h4><ul><li><p>增加</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customer(<span class="keyword">id</span>,<span class="keyword">name</span>,age,cardId) <span class="keyword">VALUES</span>(<span class="number">123</span>,<span class="string">&#x27;测试&#x27;</span>,<span class="number">19</span>,<span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Customer <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;Muffy&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;18551032548&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> first_table</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">columns</span> <span class="keyword">from</span> second_table [<span class="keyword">where</span> condition]</span><br></pre></td></tr></table></figure></li><li><p>删除</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name </span><br><span class="line"><span class="keyword">WHERE</span> [condition]; </span><br></pre></td></tr></table></figure></li><li><p>修改</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name </span><br><span class="line"><span class="keyword">SET</span> column1 = value1, column2 = value2...., columnN = valueN </span><br><span class="line"><span class="keyword">WHERE</span> [condition];</span><br></pre></td></tr></table></figure></li><li><p>查询</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">columns</span> <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure></li></ul><p>** where 条件过滤**</p><h4 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h4><p>LIKE子句用于使用通配符运算符将值与类似值进行比较。 有两个通配符与LIKE运算符结合使用:</p><p>百分号（％）<br>下划线（_）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Customer <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%三&#x27;</span>; </span><br></pre></td></tr></table></figure><h4 id="排序方式"><a href="#排序方式" class="headerlink" title="排序方式"></a>排序方式</h4><p>ORDER BY子句用于根据一个或多个列以升序或降序[ASC | DESC]对数据进行排序。 默认情况按升序排列。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Customer <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">name</span> <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><h4 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h4><p>GROUP BY子句与SELECT语句协作使用，以将相同的数据分组。GROUP BY子句位于SELECT语句中的WHERE子句之后，位于ORDER BY子句之前。</p><h4 id="去重复"><a href="#去重复" class="headerlink" title="去重复"></a>去重复</h4><p>DISTINCT关键字与SELECT语句一起使用，以消除所有重复记录并仅提取唯一记录。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> age <span class="keyword">FROM</span> Customer <span class="keyword">ORDER</span> <span class="keyword">BY</span> age </span><br></pre></td></tr></table></figure><h4 id="连接表"><a href="#连接表" class="headerlink" title="连接表"></a>连接表</h4><p>Joins子句用于合并数据库中两个或多个表的记录。 JOIN是通过使用每个表共有的值来组合两个表的字段的手段。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ID</span>, <span class="keyword">NAME</span>, AGE, AMOUNT </span><br><span class="line">   <span class="keyword">FROM</span> CUSTOMERS, ORDERS </span><br><span class="line">   <span class="keyword">WHERE</span>  CUSTOMERS.ID = ORDERS.CUSTOMER_ID </span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> A.ID, A.NAME, A.AGE, B.AMOUNT </span><br><span class="line">   <span class="keyword">FROM</span> CUSTOMERS A <span class="keyword">inner</span> <span class="keyword">join</span>  ORDERS B <span class="keyword">on</span> A.ID = B.Customer_ID </span><br></pre></td></tr></table></figure><ol><li>INNER JOIN -当两个表中都有匹配项时返回行。</li><li>LEFT JOIN -返回左侧表中的所有行，即使右表中没有匹配项。</li><li>RIGHT JOIN -返回右表中的所有行，即使左表中没有匹配项。</li><li>FULL JOIN -在其中一个表中存在匹配项时返回行。</li><li>SELF JOIN -这用于将表连接到自身，就像该表是两个表，临时重命名MS SQL Server语句中的至少一个表。</li><li>CARTESIAN JOIN -返回两个或多个联接表中的记录集的笛卡尔乘积。</li></ol><h4 id="子查询、嵌套查询"><a href="#子查询、嵌套查询" class="headerlink" title="子查询、嵌套查询"></a>子查询、嵌套查询</h4><p>子查询语句必须写在括号内。<br>子查询必须包括SELECT子句和FROM子句。<br>子查询可以使用WHERE，GROUP BY和HAVING子句。<br>子查询不能使用COMPUTE或FOR BROWSE子句。<br>只有在使用了TOP子句时，才能使用ORDER BY子句。<br>可以嵌套最多32个级别的子查询。</p><h4 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> StuProc</span><br><span class="line">@sname <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">@IsRight <span class="built_in">int</span>  <span class="keyword">output</span> //传出参数</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exists</span> (<span class="keyword">select</span> S<span class="comment">#,Sname,Sage,Ssex from student where sname=@sname)</span></span><br><span class="line"><span class="keyword">set</span> @IsRight =<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">set</span> @IsRight=<span class="number">0</span></span><br><span class="line"><span class="keyword">go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> @IsRight <span class="built_in">int</span> </span><br><span class="line">exec StuProc <span class="string">&#x27;赵雷&#x27;</span> , @IsRight <span class="keyword">output</span></span><br><span class="line"><span class="keyword">select</span> @IsRight</span><br><span class="line"></span><br><span class="line"><span class="comment">--------------调用存储过程-----------------</span></span><br><span class="line"><span class="keyword">EXECUTE</span> Procedure_name <span class="string">&#x27;&#x27;</span>    <span class="comment">--存储过程如果有参数，后面加参数格式为：@参数名=value，也可直接为参数值value</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--------------删除存储过程-----------------</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> procedure_name    <span class="comment">--在存储过程中能调用另外一个存储过程，而不能删除另外一个存储过程</span></span><br></pre></td></tr></table></figure><ul><li><p>查看存储过程</p><p>  数据库 -&gt; 可编程性 -&gt; 存储过程</p></li><li><p>存储过程的优点</p><p>  存储过程只在创造时进行编译，以后每次执行存储过程都不需再重新编译，而一般SQL语句每执行一次就编译一次,所以使用存储过程可提高数据库执行速度，效率要比T-SQL语句高。<br>  当对数据库进行复杂操作时，可将此复杂操作用存储过程封装起来与数据库提供的事务处理结合一起使用。<br>  一个存储过程在程序在网络中交互时可以替代大堆的T-SQL语句，所以也能降低网络的通信量，提高通信速率。<br>  存储过程可以重复使用,可减少数据库开发人员的工作量。<br>  安全性高,可设定只有某些用户才具有对指定存储过程的使用权 </p></li></ul><p><a href="https://www.w3cschool.cn/sql/sql-storage.html">详细实例全面解析SQL存储过程</a></p><h4 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h4><p>事务是将一个或多个执行命令发送到数据库。事务对于确保数据完整性和处理数据库错误是非常重要。</p><blockquote><p>事务属性，通常由首字母缩写ACID简称</p></blockquote><p>原子性 -确保工作单元内的所有操作成功完成; 否则，事务在故障点处中止，并且先前的操作被回滚到它们的原先状态。<br>一致性 -确保数据库在成功提交的事务后正确更改状态。<br>隔离性 -事务之间是独立运行互不相关的。<br>持久性 -事务一旦被执行,即使系统故障,其结果依然有效。</p><blockquote><p>事务控制</p></blockquote><p>COMMIT-提交事务。<br>ROLLBACK -回滚事务。<br>SAVEPOINT -创建事务的回滚节点。<br>SET TRANSACTION -设置事务名称。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> Tran </span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> CUSTOMERS <span class="keyword">WHERE</span> AGE = <span class="number">25</span> </span><br><span class="line"><span class="keyword">COMMIT</span>/<span class="keyword">ROLLBACK</span></span><br></pre></td></tr></table></figure><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--单列索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> singlecolumnindex <span class="keyword">ON</span> Customer (<span class="keyword">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--唯一索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> uniqueindex <span class="keyword">on</span> Customer (<span class="keyword">name</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--复合索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> compositeindex <span class="keyword">on</span> customers (<span class="keyword">name</span>, <span class="keyword">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> tablename.index_name</span><br></pre></td></tr></table></figure><blockquote><p>什么时候避免索引？</p></blockquote><ul><li>不应在小表上使用索引。</li><li>经常进行大批量更新或插入操作的表不应设置索引。</li><li>不应在可能含大量NULL值的列上使用索引。</li><li>频繁操作的列不应设置索引。</li></ul><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>count()<br>max() min()<br>avg()<br>sum()<br>sqrt()<br>rand()<br>concat()</p><p><a href="https://www.w3cschool.cn/sql/sql-sentence.html">SQL语句大全</a><br><a href="https://www.w3cschool.cn/sql/">参考资料</a><br><a href="https://www.w3cschool.cn/t_sql/t_sql_quick_guide.html">快速指南</a></p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SqlServer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python DRF</title>
      <link href="2019/09/28/python/Python%20DRF/"/>
      <url>2019/09/28/python/Python%20DRF/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>将数据库的东西通过ORM的映射取出来，通过view和serializers文件绑定REST接口，当前端请求时，返回序列化好的json。利用DRF框架快速的实现RestAPI接口的设计，大大提高RestAPI接口开发效率。<br>DRF是Django的超集，去掉了模板的部分，提供了一个REST的接口，同时也提供了满足该接口的代码工作流。同时，在REST的规范下，升级了权限和分页等功能，增加了限流和过滤搜索等功能。</p><h4 id="安装、配置"><a href="#安装、配置" class="headerlink" title="安装、配置"></a>安装、配置</h4><pre><code>pip install django-rest-frameworkINSTALLED_APPS = [······    &#39;rest_framework&#39;,]</code></pre><h4 id="RestAPI接口"><a href="#RestAPI接口" class="headerlink" title="RestAPI接口"></a>RestAPI接口</h4><ul><li><p>REST<br>  Representational State Transfer： 资源的表现层状态转换</p><p>  一切皆是资源<br>  每一个资源的每一个状态都应该有唯一的操作方式</p><ul><li>POST 增加资源</li><li>GET 请求资源</li><li>PUT 修改资源</li><li>DELETE 删除资源</li></ul></li><li><p>RestAPI接口核心工作<br>  1.将数据库数据序列化为前端所需要的格式，并返回<br>  2.将前端发送的数据反序列化为模型类对象，并保存到数据库中</p></li></ul><h4 id="序列化器"><a href="#序列化器" class="headerlink" title="序列化器"></a>序列化器</h4><p>Serializer 功能：进行数据的序列化和反序列化，继承自serializers.Serializer</p><blockquote><p>创建序列化器</p></blockquote><p>app目录下新建一个文件serializers.py，因为是做序列化，而序列化是针对模型的，所以需要跟模型文件models.py在同一个目录下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoSerializer</span>(<span class="params">serializers.ModelSerializer</span>):</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = BookInfo</span><br><span class="line">        fields = <span class="string">&#x27;__all__&#x27;</span></span><br></pre></td></tr></table></figure><p>model 指明该序列化器处理的数据字段从模型类BookInfo参考生成<br>fields 指明该序列化器包含模型类中的哪些字段，’<strong>all</strong>‘指明包含所有字段</p><p>** 定义视图路由 **</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router = DefaultRouter()  <span class="comment"># 可以处理视图的路由器</span></span><br><span class="line">router.register(<span class="string">r&#x27;books&#x27;</span>, views.BookInfoViewSet)  <span class="comment"># 向路由器中注册视图集</span></span><br><span class="line">urlpatterns += router.urls  <span class="comment"># 将路由器中的所以路由信息追到到django的路由列表中</span></span><br></pre></td></tr></table></figure><blockquote><p>序列化</p></blockquote><p>1）序列化单个对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">book = BookInfo.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">serializer = BookInfoSerializer(book)</span><br><span class="line">res = json.dumps(serializer.data,ensure_ascii=<span class="literal">False</span>,indent=<span class="number">4</span>)</span><br></pre></td></tr></table></figure><p>2）序列化多个对象，其实就是添加了一个many参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">books = BookInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">serializer = BookInfoSerializer(books,many=<span class="literal">True</span>)</span><br><span class="line">res = json.dumps(serializer.data,ensure_ascii=<span class="literal">False</span>,indent=<span class="number">4</span>)</span><br></pre></td></tr></table></figure><p>3）关联对象的嵌套序列化</p><p>1.将关联对象序列化为关联对象的主键</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbook = serializers.PrimaryKeyRelatedField(label=<span class="string">&#x27;图书&#x27;</span>，read_only=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>2.采用指定的序列化器将关联对象进行序列化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbook = BookInfoSerializer(label=<span class="string">&#x27;图书&#x27;</span>)   </span><br></pre></td></tr></table></figure><p>3.将关联对象序列化为关联对象模型类_str_方法的返回值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbook = serializers.StringRelatedField(label=<span class="string">&#x27;图书&#x27;</span>)</span><br></pre></td></tr></table></figure><p><em>转换成标准Json数据的另一种方式：JSONRenderer().render(serializer.data)</em></p><blockquote><p>反序列化</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = JSONRenderer().parse(content)</span><br><span class="line">serializer = IdcSerializer(data=data)</span><br><span class="line">serializer.is_valid()</span><br><span class="line">serializer.save()</span><br></pre></td></tr></table></figure><blockquote><p>使用序列化器改写RestAPI接口</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookListView</span>(<span class="params">View</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        获取所有的图书的信息：</span></span><br><span class="line"><span class="string">        1. 查询所有的图书的数据</span></span><br><span class="line"><span class="string">        2. 返回所有图书的json的数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 1. 查询所有的图书的数据</span></span><br><span class="line">        books = BookInfo.objects.<span class="built_in">all</span>() <span class="comment"># QuerySet</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 返回所有图书的json的数据，状态码: 200</span></span><br><span class="line">        books_li = []</span><br><span class="line">        <span class="keyword">for</span> book <span class="keyword">in</span> books:</span><br><span class="line">            <span class="comment"># 将book对象转换成dict</span></span><br><span class="line">            book_dict = &#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>: book.<span class="built_in">id</span>,</span><br><span class="line">                <span class="string">&#x27;btitle&#x27;</span>: book.btitle,</span><br><span class="line">                <span class="string">&#x27;bpub_date&#x27;</span>: book.bpub_date,</span><br><span class="line">                <span class="string">&#x27;bread&#x27;</span>: book.bread,</span><br><span class="line">                <span class="string">&#x27;bcomment&#x27;</span>: book.bcomment,</span><br><span class="line">                <span class="string">&#x27;image&#x27;</span>: book.image.url <span class="keyword">if</span> book.image <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            books_li.append(book_dict)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(books_li, safe=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        新增一本图书的信息：</span></span><br><span class="line"><span class="string">        1. 获取参数btitle和bpub_date并进行校验</span></span><br><span class="line"><span class="string">        2. 创建图书信息并添加进数据表中</span></span><br><span class="line"><span class="string">        3. 返回新增的图书的json数据，状态码: 201</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 需求: 前端需要传递新增图书的信息(btitle, bpub_date)，通过json传递</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1. 获取参数btitle和bpub_date并进行校验</span></span><br><span class="line">        <span class="comment"># 获取json的原始数据</span></span><br><span class="line">        req_data = request.body <span class="comment"># bytes</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将bytes转换为str</span></span><br><span class="line">        json_str = req_data.decode()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将json字符串转换dict</span></span><br><span class="line">        req_dict = json.loads(json_str)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取btitle和bpub_date</span></span><br><span class="line">        btitle = req_dict.get(<span class="string">&#x27;btitle&#x27;</span>)</span><br><span class="line">        bpub_date = req_dict.get(<span class="string">&#x27;bpub_date&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> 省略参数校验过程...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 创建图书信息并添加进数据表中</span></span><br><span class="line">        book = BookInfo.objects.create(</span><br><span class="line">            btitle=btitle,</span><br><span class="line">            bpub_date=bpub_date</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 返回新增的图书的json数据，状态码: 201</span></span><br><span class="line">        <span class="comment"># 将book对象转换成dict</span></span><br><span class="line">        book_dict = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: book.<span class="built_in">id</span>,</span><br><span class="line">            <span class="string">&#x27;btitle&#x27;</span>: book.btitle,</span><br><span class="line">            <span class="string">&#x27;bpub_date&#x27;</span>: book.bpub_date,</span><br><span class="line">            <span class="string">&#x27;bread&#x27;</span>: book.bread,</span><br><span class="line">            <span class="string">&#x27;bcomment&#x27;</span>: book.bcomment,</span><br><span class="line">            <span class="string">&#x27;image&#x27;</span>: book.image.url <span class="keyword">if</span> book.image <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(book_dict, status=<span class="number">201</span>)</span><br></pre></td></tr></table></figure><p>修改后：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookListView</span>(<span class="params">View</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        books = BookInfo.objects.<span class="built_in">all</span>() <span class="comment"># QuerySet</span></span><br><span class="line">        serializer = BookInfoSerializer(books, many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(serializer.data, safe=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        req_data = request.body <span class="comment"># bytes</span></span><br><span class="line">        json_str = req_data.decode()</span><br><span class="line">        req_dict = json.loads(json_str)</span><br><span class="line">        </span><br><span class="line">        serializer = BookInfoSerializer(data=req_dict)</span><br><span class="line">        serializer.is_valid(raise_exception=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 反序列化-数据保存(新增) -&gt; create</span></span><br><span class="line">        serializer.save()</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(serializer.data, status=<span class="number">201</span>)</span><br></pre></td></tr></table></figure><blockquote><p>编写序列化验证、创建、更新、保存规则：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Idc  <span class="comment"># 需要导入Idc模型</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IdcSerializer</span>(<span class="params">serializers.Serializer</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Idc, 序列化类</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">id</span>      = serializers.IntegerField(read_only=<span class="literal">True</span>) <span class="comment"># 处理只读</span></span><br><span class="line">    name    = serializers.CharField(required=<span class="literal">True</span>, max_length=<span class="number">32</span>) <span class="comment"># 字段必须传, 最大限制32个字符</span></span><br><span class="line">    address = serializers.CharField(required=<span class="literal">True</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    phone  = serializers.CharField(required=<span class="literal">True</span>, max_length=<span class="number">15</span>)</span><br><span class="line">    email  = serializers.CharField(required=<span class="literal">True</span>)</span><br><span class="line">    letter  = serializers.CharField(required=<span class="literal">True</span>, max_length=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self, validated_data</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Idc.objects.create(**validated_data)  <span class="comment"># 调用Idc模型进行create操作</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, instance, validated_data</span>):</span> <span class="string">&#x27;&#x27;&#x27; 参数介绍：instance是当前的对象，</span></span><br><span class="line"><span class="string">validated_data是处理过的干净数据&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        update方法可以允许修改什么字段，如果有不需要修改的字段，不写即可</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        instance.name      = validated_data.get(<span class="string">&quot;name&quot;</span>,instance.name)</span><br><span class="line">        instance.address    = validated_data.get(<span class="string">&quot;address&quot;</span>,instance.name)</span><br><span class="line">        instance.phone      = validated_data.get(<span class="string">&quot;phone&quot;</span>,instance.name)</span><br><span class="line">        instance.email      = validated_data.get(<span class="string">&quot;email&quot;</span>,instance.name)</span><br><span class="line">        instance.save()</span><br><span class="line">        <span class="keyword">return</span> instance</span><br></pre></td></tr></table></figure><p>在“正向序列化”的时候，CharField字段里的参数都没有作用，只有在“反向序列化”是才会有作用。<br>Django能自动判断你提交的请求是需要增加，判断的标准是基于ID，如果传入的数据里有ID的话，那么认为你是需要进行修改，没有ID则认为是需要进行创建</p><blockquote><p>补充知识</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_cdoe</span>(<span class="params">code</span>):</span></span><br><span class="line">     <span class="keyword">try</span>:</span><br><span class="line">        output = subprocess.check_output(</span><br><span class="line"><span class="comment"># 用 python 脚本来执行 python 字符串</span></span><br><span class="line">[<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,code],</span><br><span class="line"><span class="comment"># 自动将输出解码为字符串</span></span><br><span class="line">universal_newlines=<span class="literal">True</span>,</span><br><span class="line"><span class="comment"># 控制错误输出流</span></span><br><span class="line">stderr=subprocess.STDOUT,</span><br><span class="line"><span class="comment"># 控制客户端代码执行时间</span></span><br><span class="line">timeout=<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">except</span> subprocess.CalledProcessError <span class="keyword">as</span> e:</span><br><span class="line">        output = e.output</span><br><span class="line">    <span class="keyword">except</span> subprocess.TimeoutExpired <span class="keyword">as</span> e:</span><br><span class="line">       output = <span class="string">&#x27;\r\n&#x27;</span>.join([<span class="string">&#x27;Time Out!!!&#x27;</span>,e.output])</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line">code = <span class="string">&quot;&quot;&quot;print(&#x27;Test success&#x27;)&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>跨域问题</p></blockquote><pre><code>模板表单：给表单加 &#123;% csrf_tokne %&#125; REST 架构，禁用 csrf 功能</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.decorators.csrf <span class="keyword">import</span> csrf_exempt</span><br><span class="line"></span><br><span class="line"><span class="meta">@csrf_exempt</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api</span>(<span class="params">request</span>):</span></span><br><span class="line">    code = request.POST.get(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    output = run_code(code)</span><br><span class="line">    <span class="keyword">return</span> JsonResponse(data=&#123;<span class="string">&#x27;output&#x27;</span>:output&#125;)</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/1d6ac9cb3cd5">RESTful</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MS SqlServer</title>
      <link href="2019/09/28/%E6%95%B0%E6%8D%AE%E5%BA%93/MS%20SqlServer/"/>
      <url>2019/09/28/%E6%95%B0%E6%8D%AE%E5%BA%93/MS%20SqlServer/</url>
      
        <content type="html"><![CDATA[<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p><strong>数据库发展阶段：</strong></p><pre><code>人工管理阶段、文件系统阶段、数据库系统阶段</code></pre><p>数据库系统：采用数据库技术的计算机系统，运行实体：</p><pre><code>数据库（数据）、数据库管理系统（软件）、数据库管理员（人员）、硬件平台（硬件）、软件平台（软件）</code></pre><p>数据库管理员（DBA）负责对数据库进行规划、设计、维护和监视等</p><blockquote><p>三级模式结构</p></blockquote><p>++ 模式</p><p>逻辑模式或概念模式，是数据库中全体数据的逻辑结构和特征的描述，所有用户的公共数据视图</p><pre><code>一个数据库只有一个模式    ，模式处于三层结构的中间层</code></pre><p>++ 外模式</p><p>用户模式，数据库用户能够看见和使用的局部数据的逻辑结构和特征的描述，是数据用户的数据视图</p><pre><code>一个数据库可以有多个外模式</code></pre><p>++ 内模式</p><p>存储模式，是数据物理结构和存储方式的描述，是数据在数据库内的表示方式</p><pre><code>一个数据库只有一个内模式</code></pre><blockquote><p>三层模式间的映射</p></blockquote><pre><code>外模式、模式的映射模式、内模式的映射</code></pre><h4 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h4><p><strong>由数据结构、数据操作和完整性约束3部分组成</strong></p><blockquote><p>常见数据模型</p></blockquote><pre><code>层次模型、网状模型、关系模型</code></pre><blockquote><p>主流的数据库数据模型：关系模型</p></blockquote><pre><code>关系：一个二维表就是一个关系元组：行数据，表中的记录属性：列数据，类型和值表示  域：值变化范围</code></pre><blockquote><p>关系数据库的规范化</p></blockquote><pre><code>1NF：一个关系中，消除重复字段，各字段都是最小逻辑存储单元2NF：关系中每一个非主关键字段都完全依赖主关键字段，不能只部分依赖3NF：去除传递依赖</code></pre><h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><blockquote><p>常用对象</p></blockquote><pre><code>表、字段、索引、视图、存储过程</code></pre><blockquote><p>组成</p></blockquote><pre><code>  文件：.mdf .ndf .ldf文件组：主文件组、用户定义文件组</code></pre><blockquote><p>系统数据库</p></blockquote><pre><code>Master：sqlserver 实例的所有系统信息，包含实例范围的元数据、端点、连接服务器和系统配置设置Tempdb：临时对象和中间结果集 Model：数据库的模板  Msdb：sqlserver 代理计划警报和作业</code></pre><blockquote><p>命名规则</p></blockquote><p>++ 标识符</p><p>首字母必须是 Unicode 2.0 定义的字母，”_”，”@”，”#”</p><p>“@”：局部变量或参数<br>“#”：临时表或过程<br>“##”：全局临时对象<br>“@@”：Transact-SQL 函数名</p><p>后续字符：Unicode 2.0 定义的字母，十进制数字，”_”，”@”，”#”，“$”<br>不可以使用 Transact-SQL 保留字，不允许使用空格和其他特殊符号</p><p>分类：常规标识符，分割标识符（“”、[]）</p><p>++ 对象</p><p>完整的数据库对象名：[服务器名].[数据库名].[拥有者名].[对象名]</p><pre><code>[sqlserver].[Django].[dbo].[hello_children]</code></pre><h4 id="用户自定义类型"><a href="#用户自定义类型" class="headerlink" title="用户自定义类型"></a>用户自定义类型</h4><ul><li><p>企业管理器创建</p><p>  数据库 -&gt; 可编程性 -&gt; 类型 -&gt; 用户定义数据类型</p></li><li><p>Transact-SQL</p><p>  use Learn exec sp_addtype phone,’int’,null</p></li></ul><h4 id="操作数据表、视图"><a href="#操作数据表、视图" class="headerlink" title="操作数据表、视图"></a>操作数据表、视图</h4><blockquote><p>表无法更改设计</p></blockquote><pre><code>工具 -&gt; 选项 -&gt; 设计 -&gt; 阻止保护要求重新创建表的更改</code></pre><blockquote><p>列名无效，查询分析器里面是红色的下划线</p></blockquote><pre><code>Ctrl+Shift+R：SQL Server的 intellisense（智能感知功能），没有感知到更改，需要重新整理</code></pre><blockquote><p>使用视图修改数据、插入数据，实际上是<strong>存储在与视图相关的表中</strong></p></blockquote><h4 id="维护数据库"><a href="#维护数据库" class="headerlink" title="维护数据库"></a>维护数据库</h4><ul><li><p>脱机，联机</p><p>  暂时关闭，重新启动某个数据库的服务</p></li><li><p>分离，附加</p><p>  实现对数据库的复制。数据库脱离服务器管理的同时，保持数据文件和日志文件的完整性和一致性。</p></li><li><p>导入，导出</p><p>  常用数据格式（数据库，Excel，文本文件）</p></li><li><p>备份，恢复</p><p>  备份：完整备份、差异备份、文件备份<br>  恢复：简单恢复模式、完整恢复模式、大容量日志恢复</p></li></ul><h4 id="T-SQL"><a href="#T-SQL" class="headerlink" title="T-SQL"></a>T-SQL</h4><p><strong>数据定义语言（DDL）、数据控制语言（DCL）、数据操纵语言（DML）</strong></p><blockquote><p>常量</p></blockquote><pre><code>数字常量、字符串常量、日期和时间常量、符号常量</code></pre><blockquote><p>变量</p></blockquote><ul><li>局部变量</li></ul><p>局部变量申明使用 DECLARE 语句,变量名必须以“@”开头</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @songname <span class="built_in">char</span>(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>1.SELECT 语句赋值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @customer_name <span class="built_in">char</span>(<span class="number">50</span>)</span><br><span class="line"><span class="keyword">select</span> @customer_name = [<span class="keyword">name</span>] <span class="keyword">from</span> Customer <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">2</span></span><br><span class="line">print @customer_name</span><br></pre></td></tr></table></figure><p>2.SET 语句赋值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @a <span class="built_in">int</span></span><br><span class="line"><span class="keyword">select</span> @a = <span class="number">1332</span></span><br><span class="line">print @a</span><br></pre></td></tr></table></figure><p>多个变量赋值，只能使用 select 赋值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> @b <span class="built_in">int</span>, @c <span class="built_in">char</span>(<span class="number">10</span>), @a <span class="built_in">char</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">select</span> @b = <span class="number">1</span>, @c = <span class="string">&#x27;love&#x27;</span>, @a = <span class="string">&#x27;B&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>全局变量</li></ul><p>系统定义的变量，全局变量名以”@@”开头</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print @@CONNECTIONS</span><br><span class="line">print @@CPU_BUSY</span><br></pre></td></tr></table></figure><blockquote><p>注释</p></blockquote><pre><code>单行注释：-- xxxxxx多行注释：/* xxxxxx */快捷键：ctrl+k+c ctrl+k+u</code></pre><blockquote><p>通配符</p></blockquote><pre><code>     %：任意个字符     _：单个字符 [x~y]: 范围内的单个字符[^x~y]:不在范围内的单个字符</code></pre><blockquote><p>流程控制</p></blockquote><pre><code>BEGIN ... ENDIF/IF ... ELSE ...CASEWHILECONTINUEBREAKRETURNGOTOWAITFOR DELAY &#39;00:00:03&#39;</code></pre><blockquote><p>常用命令</p></blockquote><pre><code>DBCC CHECKALLOC(&#39;数据库名&#39;)  //查询数据库磁盘空间分配情况DBCC SHOWCONTIG(&#39;表Id&#39;，&#39;索引&#39;)CHECKPOINT     //检查当前数据库中被更改过得数据页或日志页并将这些数据强制写入硬盘DECLAREPRINTRAISERROR   //返回错误信息同时返回用户指定信息READTEXT    //读取 text、ntext、image 列的值，从指定位置读取指定的字符数BACKUP        //备份数据库内容或事务处理日志RESTORE     //还原示例：backu DATABASE db_learn to disk=&#39;d:\backup.bak&#39;restore DATABASE db_learn from disk=&#39;d:\backup.bak&#39; with replaceSELECTSETSHUTDOWN (with nowait 对进行中的事务进行回滚)WRITETEXTUSE</code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SqlServer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript 使用指南</title>
      <link href="2019/09/23/%E5%89%8D%E7%AB%AF/TypeScript%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2019/09/23/%E5%89%8D%E7%AB%AF/TypeScript%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h4 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h4><blockquote><p><a href="https://www.tslang.cn/docs/home.html">官方文档</a><br><a href="https://ts.xcatliu.com/">参考文档</a><br><a href="https://ts.xcatliu.com/advanced/further-reading">扩展阅读</a></p></blockquote><p>TypeScript 是给 JavaScript 添加特性的语言扩展，支持 ECMAScript 6 标准。通过类型注解提供编译时的静态类型检查，遵循强类型。</p><p>++ 增加功能</p><pre><code>类型批注和编译时类型检查类型推断类型擦除接口枚举Mixin泛型编程名字空间元组Await</code></pre><p>++ ECMA 2015 反向移植</p><pre><code>类模块lambda 函数的箭头语法可选参数以及默认参数</code></pre><blockquote><p>TypeScript 安装</p></blockquote><pre><code>npm install -g typescript# 查看版本号tsc -v # TypeScript 转换为 JavaScript 代码tsc test.ts</code></pre><h4 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h4><pre><code>any、number、string、boolean、数组、元组、枚举、void、null、undefined、never</code></pre><ul><li>声明为 never 类型的变量只能被 never 类型所赋值，在函数中它通常表现为抛出异常或无法执行到终止点</li><li>undefined 和 null 是所有类型的子类型</li><li>数组的项中不允许出现其他的类型，数组的一些方法的参数也会根据数组在定义时约定的类型进行限制</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name: <span class="built_in">string</span> = <span class="string">&quot;Runoob&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> years: <span class="built_in">number</span> = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 模板字符串</span></span><br><span class="line"><span class="keyword">let</span> words: <span class="built_in">string</span> = <span class="string">`您好，今年是 <span class="subst">$&#123; name &#125;</span> 发布 <span class="subst">$&#123; years + <span class="number">1</span>&#125;</span> 周年`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myName: <span class="built_in">string</span> = <span class="string">&#x27;Tom&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> myAge: <span class="built_in">number</span> = <span class="number">25</span>;</span><br><span class="line"><span class="comment">// 模板字符串</span></span><br><span class="line"><span class="keyword">let</span> sentence: <span class="built_in">string</span> = <span class="string">`Hello, my name is <span class="subst">$&#123;myName&#125;</span>.</span></span><br><span class="line"><span class="string">I&#x27;ll be <span class="subst">$&#123;myAge + <span class="number">1</span>&#125;</span> years old next month.`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> flag: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="comment">//数组泛型</span></span><br><span class="line"><span class="keyword">let</span> arr: <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt; = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x: [<span class="built_in">string</span>, <span class="built_in">number</span>];</span><br><span class="line">x = [<span class="string">&#x27;Runoob&#x27;</span>, <span class="number">1</span>];  </span><br><span class="line"></span><br><span class="line"><span class="built_in">enum</span> Color &#123;Red, Green, Blue&#125;;</span><br><span class="line"><span class="keyword">let</span> c: Color = Color.Blue;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    alert(<span class="string">&quot;Hello Runoob&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类数组</span></span><br><span class="line"><span class="keyword">interface</span> IArguments &#123;</span><br><span class="line">    [index: <span class="built_in">number</span>]: <span class="built_in">any</span>;</span><br><span class="line">    length: <span class="built_in">number</span>;</span><br><span class="line">    callee: <span class="built_in">Function</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="any-使用场景"><a href="#any-使用场景" class="headerlink" title="any 使用场景"></a>any 使用场景</h4><p>++ 变量的值会动态改变</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x: <span class="built_in">any</span> = <span class="number">1</span>;</span><br><span class="line">x = <span class="string">&#x27;I am who I am&#x27;</span>;</span><br><span class="line">x = <span class="literal">false</span>;  </span><br><span class="line">x.toFixed(); </span><br><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">++ 定义存储各种类型数据的数组</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>ts</span><br><span class="line"><span class="keyword">let</span> arrayList: <span class="built_in">any</span>[] = [<span class="number">1</span>, <span class="literal">false</span>, <span class="string">&#x27;fine&#x27;</span>];</span><br><span class="line">arrayList[<span class="number">1</span>] = <span class="number">100</span>; </span><br><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">++ 未声明类型的变量</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>ts</span><br><span class="line"><span class="keyword">let</span> something;</span><br><span class="line">something = <span class="string">&#x27;seven&#x27;</span>;</span><br><span class="line">something = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">something.setName(<span class="string">&#x27;Tom&#x27;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>变量声明</p></blockquote><pre><code>var [变量名] : [类型] = 值;      //类型，初始值可选</code></pre><blockquote><p>类型断言</p></blockquote><pre><code>&lt;类型&gt;值 \ 值 as 类型类型断言纯粹是一个编译时语法，不被称为类型转换</code></pre><blockquote><p>类型推断</p></blockquote><pre><code>由于缺乏声明而不能推断出类型，那么它的类型被视作默认的动态 any 类型</code></pre><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><pre><code>// 函数声明（Function Declaration）function sum(x: number, y: number): number &#123;    return x + y;&#125;// 函数表达式（Function Expression）let mySum: (x: number, y: number) =&gt; number = function (x: number, y: number): number &#123;    return x + y;&#125;=&gt; 用来表示函数的定义，左边是输入类型，需要用括号括起来，右边是输出类型。</code></pre><blockquote><p>可选参数</p></blockquote><p>在 TypeScript 函数里，如果我们定义了参数，则我们必须传入这些参数，除非将这些参数设置为可选，可选参数使用问号标识 ？。可选参数必须跟在必需参数后面。<br>TypeScript 会将添加了默认值的参数识别为可选参数，此时就不受「可选参数必须接在必需参数后面」的限制</p><pre><code>function buildName(firstName: string, lastName？: string) &#123;    return firstName + &quot; &quot; + lastName;&#125;</code></pre><blockquote><p>剩余参数</p></blockquote><p>剩余参数语法允许我们将一个不确定数量的参数作为一个数组传入。rest 参数只能是最后一个参数</p><pre><code>function buildName(firstName: string, ...restOfName: string[]) &#123;    return firstName + &quot; &quot; + restOfName.join(&quot; &quot;);&#125;</code></pre><blockquote><p>函数重载</p></blockquote><p>TypeScript 会优先从最前面的函数定义开始匹配，所以多个函数定义如果有包含关系，需要优先把精确的定义写在前面。</p><pre><code>function disp(s1:string):void; function disp(n1:number,s1:string):void; function disp(x:any,y?:any):void &#123;     console.log(x);     console.log(y); &#125; </code></pre><h4 id="联合类型"><a href="#联合类型" class="headerlink" title="联合类型"></a>联合类型</h4><pre><code>var val:string|number var arr:number[]|string[]; </code></pre><h4 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h4><blockquote><p>接口不能转换为 JavaScript。 它只是 TypeScript 的一部分。</p></blockquote><pre><code>interface IPerson &#123;     firstName:string,     lastName:string,     sayHi: ()=&gt;string &#125; var customer:IPerson = &#123;     firstName:&quot;Tom&quot;,    lastName:&quot;Hanks&quot;,     sayHi: ():string =&gt;&#123;return &quot;Hi there&quot;&#125; &#125; </code></pre><blockquote><p>接口中我们可以将数组的索引值和元素设置为不同类型，索引值可以是数字或字符串。</p></blockquote><pre><code>interface namelist &#123;    [index:number]:string &#125; interface ages &#123;    [index:string]:number &#125; </code></pre><blockquote><p>接口继承</p></blockquote><pre><code># 单继承interface Person &#123;    age:number &#125; interface Musician extends Person &#123;    instrument:string &#125; # 多继承interface IParent1 &#123;     v1:number &#125; interface IParent2 &#123;     v2:number &#125; interface Child extends IParent1, IParent2 &#123; &#125; </code></pre><h4 id="类"><a href="#类" class="headerlink" title="类"></a>类</h4><pre><code>class Car &#123;     // 字段     engine:string;     // 构造函数     constructor(engine:string) &#123;         this.engine = engine     &#125;      // 方法     disp():void &#123;         console.log(&quot;发动机为 :   &quot;+this.engine)     &#125; &#125;</code></pre><blockquote><p>TypeScript 一次只能继承一个类，不支持继承多个类，但 TypeScript 支持多重继承（A 继承 B，B 继承 C）。</p></blockquote><pre><code>class Shape &#123;    Area:number    constructor(a:number) &#123;       this.Area = a    &#125; &#125; class Circle extends Shape &#123;    disp():void &#123;       console.log(&quot;圆的面积:  &quot;+this.Area)    &#125; &#125;</code></pre><blockquote><p>继承类的方法重写</p></blockquote><p>++  super 关键字是对父类的直接引用，该关键字可以引用父类的属性和方法。</p><pre><code>class PrinterClass &#123;    doPrint():void &#123;      console.log(&quot;父类的 doPrint() 方法。&quot;)    &#125; &#125; class StringPrinter extends PrinterClass &#123;    doPrint():void &#123;       super.doPrint() // 调用父类的函数      console.log(&quot;子类的 doPrint()方法。&quot;)   &#125; &#125;</code></pre><blockquote><p>static 关键字</p></blockquote><pre><code>static 关键字用于定义类的数据成员（属性和方法）为静态的，静态成员可以直接通过类名调用。</code></pre><blockquote><p>instanceof 运算符</p></blockquote><pre><code>判断对象是否是指定的类型的实例</code></pre><blockquote><p>访问控制修饰符</p></blockquote><pre><code>public（默认） : 公有，可以在任何地方被访问。protected : 受保护，可以被其自身以及其子类和父类访问。private : 私有，只能被其定义所在的类访问。</code></pre><blockquote><p>类和接口</p></blockquote><p>类可以实现接口，使用关键字 implements，并将 interest 字段作为类的属性使用。</p><pre><code>interface ILoan &#123;    interest:number &#125; class AgriLoan implements ILoan &#123;    interest:number    rebate:number    constructor(interest:number,rebate:number) &#123;       this.interest = interest       this.rebate = rebate    &#125; &#125; </code></pre><h4 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h4><p>Typescript 中的对象必须是特定类型的实例。</p><pre><code>var sites = &#123;    site1: &quot;Runoob&quot;,    site2: &quot;Google&quot;,    sayHello: function () &#123; &#125; // 类型模板&#125;;sites.sayHello = function () &#123;    console.log(&quot;hello &quot; + sites.site1);&#125;;</code></pre><h4 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h4><p>命名空间使用 namespace 来定义，如果我们需要在外部可以调用 命名空间 中的类和接口，则需要在类和接口添加 export 关键字。 命名空间可以嵌套。</p><pre><code>namespace Drawing &#123;     export interface IShape &#123;         draw();     &#125;&#125;</code></pre><h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><p>模块导出使用关键字 export 关键字<br>另外一个文件使用该模块就需要使用 import 关键字来导入</p><pre><code>export interface IShape &#123;    draw(); &#125;import shape = require(&quot;./IShape&quot;); export class Circle implements shape.IShape &#123;    public draw() &#123;       console.log(&quot;Cirlce is drawn (external module)&quot;);    &#125; &#125;</code></pre><h4 id="声明文件"><a href="#声明文件" class="headerlink" title="声明文件"></a>声明文件</h4><p>declare 定义的类型只会用于编译时的检查，编译结果中会被删除。</p><blockquote><p>常用语法</p></blockquote><pre><code>declare var 声明全局变量declare function 声明全局方法declare class 声明全局类declare enum 声明全局枚举类型declare namespace 声明（含有子属性的）全局对象interface 和 type 声明全局类型export 导出变量export namespace 导出（含有子属性的）对象export default ES6 默认导出export = commonjs 导出模块export as namespace UMD 库声明全局变量declare global 扩展全局变量declare module 扩展模块/// &lt;reference /&gt; 三斜线指令declare var jQuery: (selector: string) =&gt; any;声明文件以 .d.ts 为后缀declare module Runoob &#123;    export class Calc &#123;       doSum(limit:number) : number;    &#125;&#125; 引入声明文件/// &lt;reference path = &quot;Calc.d.ts&quot; /&gt; var obj = new Runoob.Calc(); </code></pre><blockquote><p>第三方声明文件</p></blockquote><pre><code>npm install @types/jquery --save-dev</code></pre><p>++ <a href="https://microsoft.github.io/TypeSearch/">声明文件检索</a></p><h4 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h4><blockquote><p>ECMAScript 的内置对象</p></blockquote><pre><code>Boolean、Error、Date、RegExp</code></pre><blockquote><p>DOM 和 BOM 的内置对象</p></blockquote><pre><code>Document、HTMLElement、Event、NodeListlet body: HTMLElement = document.body;let allDiv: NodeList = document.querySelectorAll(&#39;div&#39;);document.addEventListener(&#39;click&#39;, function(e: MouseEvent) &#123;    // Do something&#125;);</code></pre><p>TypeScript 核心库的定义中不包含 Node.js 部分。</p><pre><code>//用 TypeScript 写 Node.jsnpm install @types/node --save-dev</code></pre>]]></content>
      
      
      <categories>
          
          <category> TypeScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Emmet 使用指南</title>
      <link href="2019/09/22/Css/Emmet%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2019/09/22/Css/Emmet%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h4 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h4><blockquote><p><a href="https://docs.emmet.io/abbreviations/syntax/">官方文档</a></p></blockquote><h4 id="常用语法"><a href="#常用语法" class="headerlink" title="常用语法"></a>常用语法</h4><p>++ <a href="https://docs.emmet.io/cheat-sheet/">常用语法</a></p><blockquote><p>vsCode 配置 emmet</p></blockquote><pre><code>setting -&gt; &quot;emmet.triggerExpansionOnTab&quot;: true,其他配置//显式弹出语法展开提示&quot;emmet.showSuggestionsAsSnippets&quot;: true,//将语法展开提示在提示列表中置顶&quot;editor.snippetSuggestions&quot;: &quot;top&quot;,//emmet只显示标记语言和样式表的展开提示&quot;emmet.showExpandedAbbreviation&quot;: &quot;inMarkupAndStylesheetFilesOnly&quot;,//emmet能识别缩写语法的场景&quot;emmet.includeLanguages&quot;: &#123;    &quot;javascript&quot;: &quot;javascriptreact&quot;,    &quot;vue-html&quot;: &quot;html&quot;,    &quot;plaintext&quot;: &quot;jade&quot;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Emmet </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Angular 使用指南</title>
      <link href="2019/09/22/%E5%89%8D%E7%AB%AF/Angular%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2019/09/22/%E5%89%8D%E7%AB%AF/Angular%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://angular.io/start">官方文档</a></p></blockquote><h4 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h4><pre><code>安装 Augularnpm install -g @angular/cli项目初始化ng new projectNamecd projectNameng serve --open浏览器中查看 http：//localhost：4200</code></pre><h4 id="主题应用"><a href="#主题应用" class="headerlink" title="主题应用"></a>主题应用</h4><pre><code>安装 Angular Materialnpm install --save @angular/material @angular/cdk @angular/animations hammerjs在创建的项目中安装Angular Material模块及其相关组件import &#123;BrowserAnimationsModule&#125; from &#39;@angular/platform-browser/animations&#39;;import &#123;FormsModule, ReactiveFormsModule&#125; from &#39;@angular/forms&#39;;imports: [    ...   FormsModule,   ReactiveFormsModule,   BrowserAnimationsModule],在styles.css文件中添加以下条目以获得主题@import &quot;~@angular/material/prebuilt-themes/indigo-pink.css&quot;;在index.htm文件中添加以下条目以获得 material 图标支持&lt;link href = &quot;https://fonts.googleapis.com/icon?family=Material+Icons&quot; rel = &quot;stylesheet&quot;&gt;</code></pre><h4 id="备忘单"><a href="#备忘单" class="headerlink" title="备忘单"></a>备忘单</h4><p>++ <a href="https://angular.io/guide/cheatsheet">常用模板语法、类装饰器、指令、组件、路由、导航</a></p><blockquote><p>关于angular引用第三方组件库无法改变其组件样式</p></blockquote><pre><code>:host ::ng-deep 样式</code></pre>]]></content>
      
      
      <categories>
          
          <category> Angular </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Angular </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Material 使用指南</title>
      <link href="2019/09/22/%E5%89%8D%E7%AB%AF/Material%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>2019/09/22/%E5%89%8D%E7%AB%AF/Material%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://material.angular.cn/components/categories">官方文档</a></p></blockquote><h4 id="Stepper"><a href="#Stepper" class="headerlink" title="Stepper"></a>Stepper</h4><blockquote><p>图标更改</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mat-step</span> <span class="attr">label</span>=<span class="string">&quot;Step 1&quot;</span> <span class="attr">state</span>=<span class="string">&quot;phone&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Put down your phones.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">mat-button</span> <span class="attr">matStepperNext</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mat-step</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> <span class="attr">matStepperIcon</span>=<span class="string">&quot;phone&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mat-icon</span>&gt;</span>call_end<span class="tag">&lt;/<span class="name">mat-icon</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: STEPPER_GLOBAL_OPTIONS,</span><br><span class="line">      useValue: &#123; <span class="attr">displayDefaultIndicatorType</span>: <span class="literal">false</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>++ <a href="https://material.io/tools/icons/?icon=sd_storage&style=baseline">Material Icons</a><br>++ <a href="https://www.cnblogs.com/lishidefengchen/p/10691442.html">资源参考</a></p>]]></content>
      
      
      <categories>
          
          <category> Angular </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Material </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python Django</title>
      <link href="2019/09/19/python/Python%20Django/"/>
      <url>2019/09/19/python/Python%20Django/</url>
      
        <content type="html"><![CDATA[<h4 id="一句话描述"><a href="#一句话描述" class="headerlink" title="一句话描述"></a>一句话描述</h4><p>将数据库的东西通过ORM的映射取出来，通过view文件，按照template文件排出的模板渲染成HTML。当用户请求相应的url时，返回相应的结果。</p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre><code>pip install django</code></pre><h4 id="获取版本号"><a href="#获取版本号" class="headerlink" title="获取版本号"></a>获取版本号</h4><pre><code>import djangodjango.VERSION</code></pre><h4 id="配置使用"><a href="#配置使用" class="headerlink" title="配置使用"></a>配置使用</h4><p>++ Django 所提供的命令</p><pre><code>django-admin</code></pre><p>++ 创建项目</p><pre><code>django-admin startproject projectName</code></pre><p>manage.py：命令行工具，可以用多种方式与该django项目进行交互；<br>projectName 文件夹里面有4个.py文件　<br>    + <strong>init</strong>.py：一个空的文件，用它标识一个目录为Python的标准包<br>    + settings.py：Django项目的配置文件，包括Django模块应用配置、数据库配置、模板配置等<br>    + urls.py：Django项目的URL声明<br>    + wsgi.py：与WSGI兼容的Web服务器，为你的项目提供服务的入口点</p><p>++ 创建应用</p><pre><code>python manage.py startapp webName</code></pre><p>migrations：用于记录models中数据的变更<br>admin.py：映射models中的数据到Django自带的admin后台<br>apps.py：用于应用程序的配置，在新的Django版本中新增文件<br>models.py：Django的模型文件，创建应用程序数据表模型(对应数据库的相关操作)<br>tests.py：创建Django测试用例<br>views.py：Django的视图文件，控制向前端页面展示的内容</p><h4 id="Django-的管理"><a href="#Django-的管理" class="headerlink" title="Django 的管理"></a>Django 的管理</h4><pre><code>python manage.py createsuperuser，按提示输入用户名、邮箱、密码</code></pre><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># zebk/zebk/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> include, url</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^hello/&#x27;</span>, include(<span class="string">&#x27;hello.urls&#x27;</span>)),</span><br><span class="line">    url(<span class="string">r&#x27;^admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># zebk/hello/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># zebk/hello/views.py</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>(<span class="params">request</span>):</span></span><br><span class="line">    context = &#123;&#125;</span><br><span class="line">    context[<span class="string">&#x27;hello&#x27;</span>] = <span class="string">&#x27;Hello Django!&#x27;</span>;</span><br><span class="line">    context[<span class="string">&#x27;title&#x27;</span>] = <span class="string">&#x27;中二病控丶!&#x27;</span>;</span><br><span class="line">    context[<span class="string">&#x27;menuLists&#x27;</span>]=[</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;首页&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Hello&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Admin&#x27;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;hello.html&#x27;</span>, context)</span><br><span class="line"></span><br><span class="line"><span class="comment"># zebk/templates/base.html</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;&#123;&#123;title&#125;&#125;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;ul class=&#x27;menu&#x27;&gt;</span><br><span class="line">    &#123;% <span class="keyword">for</span> menu <span class="keyword">in</span> menuLists %&#125;</span><br><span class="line">        &lt;li&gt;&lt;a href=&quot;javascript:;&quot;&gt;&#123;&#123; menu.name &#125;&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&#x27;main&#x27;&gt;</span><br><span class="line">&#123;% block mainbody %&#125;</span><br><span class="line">   &lt;p&gt;这是一个 Django 样例！&lt;/p&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># zebk/templates/hello.html</span></span><br><span class="line">&#123;%extends <span class="string">&quot;base.html&quot;</span> %&#125;</span><br><span class="line">&#123;% block mainbody %&#125;</span><br><span class="line">&lt;h1&gt;&#123;&#123;hello&#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;p&gt; Django 模板应用实例 ... &lt;/p&gt;</span><br><span class="line">&lt;p&gt; 继承了 base.html 文件 ... &lt;/p&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问地址</span></span><br><span class="line"><span class="comment"># localhost：10888/hello</span></span><br><span class="line"><span class="comment"># localhost：10888/admin</span></span><br></pre></td></tr></table></figure><blockquote><p>settings.py 配置</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.auth&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.contenttypes&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.staticfiles&#x27;</span>,</span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;应用名称&#x27;</span>, //新建的 app 如果不加到 INSTALL_APPS 中的话, django 就不能自动找到app中的模板文件</span><br><span class="line"></span><br><span class="line">//管理界面本地化，设置编码、时区</span><br><span class="line">LANGUAGE_CODE = <span class="string">&#x27;zh-Hans&#x27;</span> <span class="comment">#&#x27;en-us&#x27;</span></span><br><span class="line">TIME_ZONE = <span class="string">&#x27;Asia/Shanghai&#x27;</span> <span class="comment">#&#x27;UTC&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// 数据库配置</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: os.path.join(BASE_DIR, <span class="string">&#x27;db.sqlite3&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;mysql&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;USER&#x27;</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PASSWORD&#x27;</span>: <span class="string">&#x27;test123&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>:<span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PORT&#x27;</span>:<span class="string">&#x27;3306&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>启动 Django</p></blockquote><pre><code>python manage.py runserver 0.0.0.0:10888url $ 警告：$ 修改成 /</code></pre><p>++ Django 采用了MVC的软件设计模式，即模型M，视图V和控制器C。</p><h4 id="Django-模板标签"><a href="#Django-模板标签" class="headerlink" title="Django 模板标签"></a>Django 模板标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># if/else 标签</span></span><br><span class="line">&#123;% <span class="keyword">if</span> condition1 %&#125;</span><br><span class="line">   ... display <span class="number">1</span></span><br><span class="line">&#123;% <span class="keyword">elif</span> condition2 %&#125;</span><br><span class="line">   ... display <span class="number">2</span></span><br><span class="line">&#123;% <span class="keyword">else</span> %&#125;</span><br><span class="line">   ... display <span class="number">3</span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># for 标签</span></span><br><span class="line">&#123;% <span class="keyword">for</span> athlete <span class="keyword">in</span> athlete_list %&#125;</span><br><span class="line">    &lt;li&gt;&#123;&#123; athlete.name &#125;&#125;&lt;/li&gt;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ifequal/ifnotequal 标签</span></span><br><span class="line">&#123;% ifequal user currentuser %&#125;</span><br><span class="line">    &lt;h1&gt;Welcome!&lt;/h1&gt;</span><br><span class="line">&#123;% endifequal %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注释标签</span></span><br><span class="line">&#123;<span class="comment"># 这是一个注释 #&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤器</span></span><br><span class="line">&#123;&#123; my_list|first|upper &#125;&#125;</span><br><span class="line">&#123;&#123; bio|truncatewords:<span class="string">&quot;30&quot;</span> &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># include 标签</span></span><br><span class="line">&#123;% include <span class="string">&quot;nav.html&quot;</span> %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 继承模板</span></span><br><span class="line">&#123;%extends <span class="string">&quot;base.html&quot;</span> %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% block mainbody %&#125;</span><br><span class="line">     &lt;p&gt;继承了 base.html 文件&lt;/p&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>访问配置文件</p></blockquote><pre><code>from django.conf import settingssql_str = settings.DATABASES</code></pre><blockquote><p>使用外部样式，脚本，第三方库控件</p></blockquote><pre><code>STATIC_URL = &#39;/static/&#39;STATICFILES_DIRS=(    os.path.join(BASE_DIR,&#39;static&#39;),  #注意括号后面的还有个逗号)项目目录，创建 static -&gt; css/imgs/jscript/plugins</code></pre><blockquote><p>Django for循环计数器：forloop</p></blockquote><pre><code>forloop.counterforloop.revcounterforloop.firstforloop.lastforloop.parentloop</code></pre><h4 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h4><p>高性能的HTTP和反向代理服务器，同时也是一个 IMAP/POP3/SMTP 代理服务器<br>在高并发连接的情况下，Nginx 是 Apache 服务器不错的替代品。Nginx 同时也可以作为7层负载均衡服务器来使用。</p><p>++ <a href="http://nginx.org/en/download.html">下载 Nginx</a><br>++ 解压后,进入目录下，start nginx.exe</p><pre><code>**注意：80端口是否被占用**</code></pre><blockquote><p>Nginx相应命令</p></blockquote><pre><code>nginx.exe -s stop           //停止nginxnginx.exe -s reload         //重新加载nginxnginx.exe -s quit           //退出nginxnginx.exe -s reopen         //重新打开日志文件nginx –v</code></pre><style>    details .info{ padding-left:2rem;}</style><details>    <summary>uwsgi 不支持 windows</summary><div class="info">    ++ Uwsgi 配置<pre><code>pip install uwsgi报错:AttributeError: module &#39;os&#39; has no attribute &#39;uname&#39;原因：os.uname()是不支持windows系统的，platform模块是支持任何系统。</code></pre><p>++ <a href="https://pypi.python.org/pypi/uWSGI/">下载uwsgi离线安装</a><br>++ 解压后,进入目录下，修改 uwsgiconfig.py 文件中的os.uname()为platform.uname()<br>++ cd进入目录执行：python setup.py install</p><pre><code>报错:Exception: you need a C compiler to builduWSGI本机上没有C编译环境,需要下载一个编译器</code></pre><p>++ <a href="https://osdn.net/projects/mingw/releases/">推荐下载：MinGW</a><br>++ 配置环境变量：path=MinGW安装目录/bin<br>++ python setup.py install</p></div></details><details>    <summary>1.9以上的 django 移除了 FastCGI 支持</summary><div class="info">    ++ FastCGI配置<p>++ flup - Python的FastCGI组件下载</p><pre><code>pip install fluppython manage.py runfcgi method=threaded host=127.0.0.1 port=8051报错：Unknown command: &#39;runfcgi&#39; 。</code></pre></div></details><h4 id="Window-IIS-Django"><a href="#Window-IIS-Django" class="headerlink" title="Window IIS Django"></a>Window IIS Django</h4><ul><li>安装 wfastcgi</li></ul><pre><code>pip install wfastcgi</code></pre><ul><li>复制一份 wfastcgi.py 文件到项目根目录</li></ul><pre><code>wfastcgi-enable  //wfastcgi.py 安装路径</code></pre><ul><li>IIS 发布网站</li><li>添加处理程序映射的模块映射，CGI组件必须安装</li></ul><pre><code>填写模块映射参数：请求路径为 *，模块为 FastCgiModule，可执行文件选择 [你的python安装路径]|[项目中wfastcgi.py的路径]，示例：&quot;D:\Python36\python.exe&quot;|D:\web\wfastcgi.py名称随意</code></pre><ul><li>请求限制，去掉勾选</li><li>IIS 根节点，修改FastCGI设置，编辑FastCGI应用程序的环境变量</li></ul><pre><code>WSGI_HANDLER：django.core.wsgi.get_wsgi_application()PYTHONPATH：项目路径DJANGO_SETTINGS_MODULE：项目名称.settings</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp; ** 静态文件访问设置 **</p><ul><li>static 目录创建 web.config</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">system.webServer</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- this configuration overrides the FastCGI handler to let IIS serve the static files --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">handlers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">clear</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">add</span> <span class="attr">name</span>=<span class="string">&quot;StaticFile&quot;</span> <span class="attr">path</span>=<span class="string">&quot;*&quot;</span> <span class="attr">verb</span>=<span class="string">&quot;*&quot;</span> <span class="attr">modules</span>=<span class="string">&quot;StaticFileModule&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">resourceType</span>=<span class="string">&quot;File&quot;</span> <span class="attr">requireAccess</span>=<span class="string">&quot;Read&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">handlers</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">system.webServer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Admin 管理样式丢失</li></ul><pre><code>设置 settings.py：STATIC_ROOT = os.path.join(BASE_DIR,&#39;static&#39;)执行python命令：python manage.py collectstatic</code></pre><ul><li><p>IIS 网站虚拟路径设置</p><p>  右键 -&gt; 添加虚拟目录 -&gt; static/创建 web.config 的 static 目录路径</p></li><li><p>重启 IIS，运行</p></li></ul><h4 id="SqlServer-Models"><a href="#SqlServer-Models" class="headerlink" title="SqlServer Models"></a>SqlServer Models</h4><p>++ <a href="https://www.cnblogs.com/pythonkids/p/7943376.html">Django 中使用 Microsoft SQL SERVER</a><br>++ <a href="https://code.ziqiangxuetang.com/django/django-queryset-api.html">扩展资料</a><br>++ <a href="https://www.jianshu.com/p/2afe31f53677">QuerySet</a></p><blockquote><p>安装三方库</p></blockquote><pre><code>pip install pyodbc django-pyodbc-azure</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://jingyan.baidu.com/article/c1a3101e579cbede656deb17.html?qq-pf-to=pcqq.group">ODBC 驱动配置</a></p><blockquote><p>DATABASES 数据库连接串配置</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">       <span class="comment">#数据库引擎设置</span></span><br><span class="line">       <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;sql_server.pyodbc&#x27;</span>,</span><br><span class="line">       <span class="comment">#数据库主机地址</span></span><br><span class="line">       <span class="string">&#x27;HOST&#x27;</span>: <span class="string">&#x27;xxx&#x27;</span>,</span><br><span class="line">       <span class="comment">#数据库端口号，默认可以不写</span></span><br><span class="line">       <span class="string">&#x27;PORT&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">       <span class="comment">#要连接的数据库名</span></span><br><span class="line">       <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;xxx&#x27;</span>,</span><br><span class="line">       <span class="comment">#数据库用户名</span></span><br><span class="line">       <span class="string">&#x27;USER&#x27;</span>: <span class="string">&#x27;sa&#x27;</span>,</span><br><span class="line">       <span class="comment">#数据库密码</span></span><br><span class="line">       <span class="string">&#x27;PASSWORD&#x27;</span>: <span class="string">&#x27;xxx&#x27;</span>,</span><br><span class="line">       <span class="comment">#选项，这个要先在操作系统上完成ODBC的连接创建，并连接成功，注意 DRIVER 这个地方，要和自己的ODBC版本一致</span></span><br><span class="line">       <span class="string">&#x27;OPTIONS&#x27;</span>: &#123;</span><br><span class="line">           <span class="string">&#x27;DRIVER&#x27;</span>:<span class="string">&#x27;SQL Server&#x27;</span>,</span><br><span class="line">           <span class="comment">#使用MARS (multiple active result sets)，支持异步</span></span><br><span class="line">           <span class="comment"># &#x27;MARS_Connection&#x27;: True,</span></span><br><span class="line">       &#125;,</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure><blockquote><p>模型使用</p></blockquote><p>将变更的 models.py 登记到当前APP的 migrations 文件夹中的_init.py文件中</p><pre><code>python manage.py makemigrations　 </code></pre><p>将登记的改动信息转换成SQL语句，转移到数据库中执行 </p><pre><code>python manage.py migrate　　　 　 　</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="comment"># 创建的对象必须继承 Model</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Children</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="built_in">id</span> = models.AutoField(primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">&quot;Hello_Children&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__tuple__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">id</span> = self.<span class="built_in">id</span></span><br><span class="line">        name = self.name</span><br><span class="line">        age = self.age</span><br><span class="line">        phone = self.phone</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">id</span>,name,age,phone</span><br></pre></td></tr></table></figure><blockquote><p>Django 中常用返回查询集</p></blockquote><pre><code>all() 返回所有数据get() 获取符号条件的数据filter() 返回符合条件的数据exclude() 返回符合条件之外的数据order_by() 对结果进行排序 </code></pre><h4 id="补充知识"><a href="#补充知识" class="headerlink" title="补充知识"></a>补充知识</h4><details><summary>单文件 Django</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line">setting = &#123;</span><br><span class="line">    <span class="string">&#x27;DEBUG&#x27;</span>:<span class="literal">True</span>,</span><br><span class="line">    <span class="string">&#x27;ROOT_URLCONF&#x27;</span>:__name__</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">settings.configure(**setting)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;Hello world!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">urlpatterns = [url(<span class="string">&#x27;^$&#x27;</span>,home,name=<span class="string">&#x27;home&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    <span class="keyword">from</span> django.core.management <span class="keyword">import</span> execute_from_command_line</span><br><span class="line">    execute_from_command_line(sys.argv)</span><br></pre></td></tr></table></figure><ul><li><p>django 中，加载配置文件有两种方式:<br>  settings.configure(**settings)<br>  django.setup()</p></li><li><p>python test.py runserver </p></li></ul></details><details><summary>pipreqs</summary><p>可以帮你找到当前项目的所有组件及其版本</p><pre><code># 安装pip install pipreqs# 生成 requirements.txtpipreqs ./ --encoding=utf-8# 安装项目组件pip3 install -r requirements.txt</code></pre></details><details><summary>其他</summary><ul><li><p>DRF<br>  <a href="https://www.jianshu.com/p/e8ede9e24a67">DRF框架</a></p></li><li><p>Celery<br>  <a href="https://blog.csdn.net/cuomer/article/details/81214438">并行分布式框架</a></p></li><li><p>Gunicron<br>  <a href="https://www.jianshu.com/p/69e75fc3e08e">Python WSGI UNIX HTTP Server</a></p><p>  ** Nginx == Apache Gunicorn == uWSGI **</p></li></ul></details><style>    details{margin:.5rem 0;}</style>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 数据库操作</title>
      <link href="2019/09/19/python/Python%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
      <url>2019/09/19/python/Python%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>DB-API是一个规范,它定义一个系列必须的对象和数据库存取方式,以便各种各样的底层数据库系统和多种多样的数据库接口程序提供一致的访问接口.</p><p>通用步骤:</p><p>1.引入模块<br>2.获取与数据库的连接<br>3.执行SQL语句和存储过程<br>4.关闭数据库连接</p><h4 id="SQL-Server数据库"><a href="#SQL-Server数据库" class="headerlink" title="SQL Server数据库"></a>SQL Server数据库</h4><p>++ <a href="http://www.pymssql.org/en/stable/index.html">pymssql 官方文档</a></p><pre><code>pip install pymssql </code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymssql </span><br><span class="line"></span><br><span class="line">server = <span class="string">&quot;187.32.43.13&quot;</span>    <span class="comment"># 连接服务器地址</span></span><br><span class="line">user = <span class="string">&quot;root&quot;</span>　　　　　　　　 <span class="comment"># 连接帐号</span></span><br><span class="line">password = <span class="string">&quot;1234&quot;</span>　　　　　　<span class="comment"># 连接密码</span></span><br><span class="line"></span><br><span class="line">conn = pymssql.connect(server, user, password, <span class="string">&quot;连接默认数据库名称&quot;</span>)  <span class="comment">#获取连接</span></span><br><span class="line"></span><br><span class="line">cursor = conn.cursor()     <span class="comment"># 获取光标</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建表</span></span><br><span class="line">cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">IF OBJECT_ID(&#x27;persons&#x27;, &#x27;U&#x27;) IS NOT NULL</span></span><br><span class="line"><span class="string">    DROP TABLE persons</span></span><br><span class="line"><span class="string">CREATE TABLE persons (</span></span><br><span class="line"><span class="string">    id INT NOT NULL,</span></span><br><span class="line"><span class="string">    name VARCHAR(100),</span></span><br><span class="line"><span class="string">    salesrep VARCHAR(100),</span></span><br><span class="line"><span class="string">    PRIMARY KEY(id)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)　　</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入多行数据</span></span><br><span class="line">cursor.executemany(</span><br><span class="line">    <span class="string">&quot;INSERT INTO persons VALUES (%d, %s, %s)&quot;</span>,</span><br><span class="line">    [(<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>),</span><br><span class="line">     (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;Joe Dog&#x27;</span>),</span><br><span class="line">     (<span class="number">3</span>, <span class="string">&#x27;Mike T.&#x27;</span>, <span class="string">&#x27;Sarah H.&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你必须调用 commit() 来保持你数据的提交如果你没有将自动提交设置为true</span></span><br><span class="line">conn.commit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询数据</span></span><br><span class="line">cursor.execute(<span class="string">&#x27;SELECT * FROM persons WHERE salesrep=%s&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历数据（存放到元组中） 方式1</span></span><br><span class="line">row = cursor.fetchone()</span><br><span class="line"><span class="keyword">while</span> row:</span><br><span class="line">    print(<span class="string">&quot;ID=%d, Name=%s&quot;</span> % (row[<span class="number">0</span>], row[<span class="number">1</span>]))</span><br><span class="line">    row = cursor.fetchone()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历数据（存放到元组中） 方式2</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    print(<span class="string">&#x27;row = %r&#x27;</span> % (row,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历数据（存放到字典中）</span></span><br><span class="line"><span class="comment"># cursor = conn.cursor(as_dict=True)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cursor.execute(&#x27;SELECT * FROM persons WHERE salesrep=%s&#x27;, &#x27;John Doe&#x27;)</span></span><br><span class="line"><span class="comment"># for row in cursor:</span></span><br><span class="line"><span class="comment">#     print(&quot;ID=%d, Name=%s&quot; % (row[&#x27;id&#x27;], row[&#x27;name&#x27;]))</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># conn.close()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">conn.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注：在任何时候，在一个连接下，一次正在执行的数据库操作只会出现一个cursor对象</span></span><br></pre></td></tr></table></figure><blockquote><p>with 来避免手动关闭cursors和connection连接</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymssql </span><br><span class="line"></span><br><span class="line">server = <span class="string">&quot;187.32.43.13&quot;</span>    <span class="comment"># 连接服务器地址</span></span><br><span class="line">user = <span class="string">&quot;root&quot;</span>　　　　　　　　 <span class="comment"># 连接帐号</span></span><br><span class="line">password = <span class="string">&quot;1234&quot;</span>　　　　　　<span class="comment"># 连接密码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> pymssql.connect(server, user, password, <span class="string">&quot;你的连接默认数据库名称&quot;</span>) <span class="keyword">as</span> conn:</span><br><span class="line">    <span class="keyword">with</span> conn.cursor(as_dict=<span class="literal">True</span>) <span class="keyword">as</span> cursor:   <span class="comment"># 数据存放到字典中</span></span><br><span class="line">        cursor.execute(<span class="string">&#x27;SELECT * FROM persons WHERE salesrep=%s&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">            print(<span class="string">&quot;ID=%d, Name=%s&quot;</span> % (row[<span class="string">&#x27;id&#x27;</span>], row[<span class="string">&#x27;name&#x27;</span>]))</span><br></pre></td></tr></table></figure><blockquote><p>调用存储空间</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> pymssql.connect(server, user, password, <span class="string">&quot;tempdb&quot;</span>) <span class="keyword">as</span> conn:</span><br><span class="line">    <span class="keyword">with</span> conn.cursor(as_dict=<span class="literal">True</span>) <span class="keyword">as</span> cursor:</span><br><span class="line">        cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        CREATE PROCEDURE FindPerson</span></span><br><span class="line"><span class="string">            @name VARCHAR(100)</span></span><br><span class="line"><span class="string">        AS BEGIN</span></span><br><span class="line"><span class="string">            SELECT * FROM persons WHERE name = @name</span></span><br><span class="line"><span class="string">        END</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line">        cursor.callproc(<span class="string">&#x27;FindPerson&#x27;</span>, (<span class="string">&#x27;Jane Doe&#x27;</span>,))</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">            print(<span class="string">&quot;ID=%d, Name=%s&quot;</span> % (row[<span class="string">&#x27;id&#x27;</span>], row[<span class="string">&#x27;name&#x27;</span>]))</span><br></pre></td></tr></table></figure><blockquote><p>_mssql连接sql server数据库并实现操作</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _mssql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建连接</span></span><br><span class="line">conn = _mssql.connect(server=<span class="string">&#x27;SQL01&#x27;</span>, user=<span class="string">&#x27;user&#x27;</span>, password=<span class="string">&#x27;password&#x27;</span>, \</span><br><span class="line">    database=<span class="string">&#x27;mydatabase&#x27;</span>)</span><br><span class="line">print(conn.timeout)</span><br><span class="line">print(conn.login_timeout)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建table</span></span><br><span class="line">conn.execute_non_query(<span class="string">&#x27;CREATE TABLE persons(id INT, name VARCHAR(100))&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># insert数据</span></span><br><span class="line">conn.execute_non_query(<span class="string">&quot;INSERT INTO persons VALUES(1, &#x27;John Doe&#x27;)&quot;</span>)</span><br><span class="line">conn.execute_non_query(<span class="string">&quot;INSERT INTO persons VALUES(2, &#x27;Jane Doe&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询操作</span></span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM persons WHERE salesrep=%s&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> conn:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;ID=%d, Name=%s&quot;</span> % (row[<span class="string">&#x27;id&#x27;</span>], row[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#查询数量count()</span></span><br><span class="line">numemployees = conn.execute_scalar(<span class="string">&quot;SELECT COUNT(*) FROM employees&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询一条数据</span></span><br><span class="line">employeedata = conn.execute_row(<span class="string">&quot;SELECT * FROM employees WHERE id=%d&quot;</span>, <span class="number">13</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 带参数查询的几个例子：</span></span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE id=%d&#x27;</span>, <span class="number">13</span>)</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE name=%s&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>)</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE id IN (%s)&#x27;</span>, ((<span class="number">5</span>, <span class="number">6</span>),))</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE name LIKE %s&#x27;</span>, <span class="string">&#x27;J%&#x27;</span>)</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE name=%(name)s AND city=%(city)s&#x27;</span>, \</span><br><span class="line">    &#123; <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;John Doe&#x27;</span>, <span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;Nowhere&#x27;</span> &#125; )</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM cust WHERE salesrep=%s AND id IN (%s)&#x27;</span>, \</span><br><span class="line">    (<span class="string">&#x27;John Doe&#x27;</span>, (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)))</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE id IN (%s)&#x27;</span>, (<span class="built_in">tuple</span>(xrange(<span class="number">4</span>)),))</span><br><span class="line">conn.execute_query(<span class="string">&#x27;SELECT * FROM empl WHERE id IN (%s)&#x27;</span>, \</span><br><span class="line">    (<span class="built_in">tuple</span>([<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>]),))</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭连接</span></span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><p>++ pyodbc</p><pre><code>pip install pyodbc</code></pre><blockquote><p>修改配置文件  /etc/odbcinst.ini</p></blockquote><pre><code>[SQL Server]Description     = FreeTDS ODBC driver for MSSQLDriver          = /usr/lib64/libtdsodbc.soSetup           = /usr/lib64/libtdsS.so.2FileUsage       = 1</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pyodbc</span><br><span class="line"> </span><br><span class="line"><span class="comment">#创建数据库连接</span></span><br><span class="line">conn = pyodbc.connect(<span class="string">&quot;DRIVER=&#123;SQL Server&#125;;SERVER=192.168.142.11,1433;</span></span><br><span class="line"><span class="string">DATABASE=master;UID=sa;PWD=hu_wen@2019&quot;</span>)</span><br><span class="line">cursor = conn.cursor() <span class="comment"># 获取光标</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 创建表</span></span><br><span class="line">cursor.execute(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">IF OBJECT_ID(&#x27;persons&#x27;, &#x27;U&#x27;) IS NOT NULL</span></span><br><span class="line"><span class="string">    DROP TABLE persons</span></span><br><span class="line"><span class="string">CREATE TABLE persons (</span></span><br><span class="line"><span class="string">    id INT NOT NULL,</span></span><br><span class="line"><span class="string">    name VARCHAR(100),</span></span><br><span class="line"><span class="string">    salesrep VARCHAR(100),</span></span><br><span class="line"><span class="string">    PRIMARY KEY(id)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 插入多行数据</span></span><br><span class="line">cursor.executemany(</span><br><span class="line">    <span class="string">&quot;INSERT INTO persons VALUES (%d, &#x27;%s&#x27;, &#x27;%s&#x27;)&quot;</span>,</span><br><span class="line">    [(<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>),</span><br><span class="line">     (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;Joe Dog&#x27;</span>),</span><br><span class="line">     (<span class="number">3</span>, <span class="string">&#x27;Mike T.&#x27;</span>, <span class="string">&#x27;Sarah H.&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交数据</span></span><br><span class="line">conn.commit()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 查询数据</span></span><br><span class="line">cursor.execute(<span class="string">&#x27;SELECT * FROM persons WHERE salesrep=%s&#x27;</span>, <span class="string">&#x27;John Doe&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 遍历数据（存放到元组中） 方式1</span></span><br><span class="line">row = cursor.fetchone()</span><br><span class="line"><span class="keyword">while</span> row:</span><br><span class="line">    print(<span class="string">&quot;ID=%d, Name=%s&quot;</span> % (row[<span class="number">0</span>], row[<span class="number">1</span>]))</span><br><span class="line">    row = cursor.fetchone()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 遍历数据（存放到元组中） 方式2</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    print(<span class="string">&#x27;row = %r&#x27;</span> % (row,))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 关闭连接</span></span><br></pre></td></tr></table></figure><h4 id="Mysql数据库"><a href="#Mysql数据库" class="headerlink" title="Mysql数据库"></a>Mysql数据库</h4><pre><code>pip install pymysql</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myconn <span class="keyword">import</span> myconn</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sql</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,db=<span class="literal">None</span></span>):</span></span><br><span class="line"><span class="comment"># 初始化连接数据库</span></span><br><span class="line">self.conn = pymysql.connect(db=dataName, user=<span class="string">&quot;user&quot;</span>, passwd=<span class="string">&quot;passwd&quot;</span>, </span><br><span class="line">host=<span class="string">&quot;host&quot;</span>,charset=<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_databases</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  获取所有数据库名 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">return</span> self.getSqlData(<span class="string">&quot;show databases&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_tables</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  获取所有表名 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">return</span> self.getSqlData(<span class="string">&quot;show tables&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_table</span>(<span class="params">self,table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 创建表 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line"><span class="comment"># id：无符号整数，主键，自增；name：字符串；age：无符号整数</span></span><br><span class="line">sql = <span class="string">&quot;&quot;&quot;create table &#123;&#125; (id int unsigned primary key auto_increment name varchar(10),</span></span><br><span class="line"><span class="string">age int unsigned)&quot;&quot;&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line">cur.execute(sql)</span><br><span class="line">self.conn.commit()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert_data</span>(<span class="params">self,table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 增加一条数据到数据表 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line">sql = <span class="string">&quot;insert into &#123;&#125;(name,age) values(%s,%s)&quot;</span></span><br><span class="line">cur.execute(sql,(<span class="string">&#x27;myName&#x27;</span>,<span class="number">80</span>))</span><br><span class="line">self.conn.commit()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update_data</span>(<span class="params">self,table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 修改表中的数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line">sql = <span class="string">&quot;update &#123;&#125; set age=18 where name=&#x27;myName&#x27;&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line">cur.execute(sql)</span><br><span class="line">self.conn.commit()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">select_data</span>(<span class="params">self, table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  从数据库表查询数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line">sql = <span class="string">&quot;select name,age from &#123;&#125;&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line">cur.execute(sql)</span><br><span class="line"><span class="keyword">return</span> cur.fetchall()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete_data</span>(<span class="params">self, table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  从数据库表删除数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line">sql = <span class="string">&quot;delete from &#123;&#125; where name=&#x27;myName&#x27;&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line">cur.execute(sql)</span><br><span class="line">self.conn.commit()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_fields</span>(<span class="params">self,table</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;  获取指定表的字段 &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line">sql = <span class="string">&quot;SELECT * FROM &#123;&#125; LIMIT 1&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line">cur.execute(sql)</span><br><span class="line">v = cur.description</span><br><span class="line">zds = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> v]</span><br><span class="line">self.conn.commit()</span><br><span class="line"><span class="keyword">return</span> zds</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unique</span>(<span class="params">self,table,*fields</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 唯一设置 </span></span><br><span class="line"><span class="string">table：表名，fields：字段名列表； &#x27;&#x27;&#x27;</span></span><br><span class="line">cur = self.conn.cursor()</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(fields) == <span class="number">1</span>:</span><br><span class="line">sql = <span class="string">&quot;ALTER TABLE &#123;&#125; ADD unique(&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sql = <span class="string">&quot;ALTER TABLE &#123;&#125; ADD UNIQUE KEY(&quot;</span>.<span class="built_in">format</span>(table)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> fields:</span><br><span class="line">sql += i</span><br><span class="line"><span class="keyword">if</span> i != fields[-<span class="number">1</span>]:</span><br><span class="line">sql += <span class="string">&#x27;,&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">sql += <span class="string">&#x27;)&#x27;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">cur.execute(sql)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> exc:</span><br><span class="line">print(exc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">self.conn.commit()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">closeSql</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 关闭数据库连接 &#x27;&#x27;&#x27;</span></span><br><span class="line">self.conn.close()</span><br></pre></td></tr></table></figure><h4 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h4><p>++ <a href="https://www.mongodb.com/download-center?jmp=nav#community">MongoDB官网下载</a></p><pre><code>pip install pymongo</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mongodb</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Python MangoDB 的简单操作 &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="comment"># 1、建立连接</span></span><br><span class="line"><span class="comment"># client = pymongo.MongoClient(&#x27;localhost&#x27;,27017) # 第一种方法</span></span><br><span class="line">client = pymongo.MongoClient(<span class="string">&#x27;mongodb://localhost:27017&#x27;</span>) <span class="comment"># 第二种方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、获取数据库</span></span><br><span class="line"><span class="comment"># db = client.db_name # 第一种方法</span></span><br><span class="line">db = client[<span class="string">&#x27;db_name&#x27;</span>] <span class="comment"># 第二种方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、获取一个集合</span></span><br><span class="line"><span class="comment"># self.collection = db.table # 第一种方法</span></span><br><span class="line">self.collection = db[<span class="string">&#x27;table&#x27;</span>] <span class="comment"># 第二种方法</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 插入文档 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># name：姓名；age：年龄；datetime：存储时间</span></span><br><span class="line">user = &#123;</span><br><span class="line"><span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>,</span><br><span class="line"><span class="string">&quot;age&quot;</span>:<span class="number">18</span>,</span><br><span class="line"><span class="string">&quot;datetime&quot;</span>:datetime.datetime.utcnow()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 插入后，如果文档内没有_id这个键值，则系统会自动添加_id；其中user可以是多个user组成的列表</span></span><br><span class="line">user_id = self.collection.insert(user)</span><br><span class="line"><span class="keyword">return</span> user_id</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_one_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 查询一条文档 &#x27;&#x27;&#x27;</span></span><br><span class="line">data = self.collection.find_one(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>&#125;) <span class="comment"># 查询name为myName的</span></span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 查询多个文档 &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># data = [d for d in self.collection.find()] # 查询所有</span></span><br><span class="line"><span class="comment"># 查询所有指定name的文档</span></span><br><span class="line">data = [d <span class="keyword">for</span> d <span class="keyword">in</span> self.collection.find(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>&#125;)]</span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_limit_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 根据条件查询数据：</span></span><br><span class="line"><span class="string">MongoDB中条件操作符有：</span></span><br><span class="line"><span class="string">(&gt;)   大于 - $gt</span></span><br><span class="line"><span class="string">(&lt;)   小于 - $lt</span></span><br><span class="line"><span class="string">(&gt;=)  大于等于 - $gte</span></span><br><span class="line"><span class="string">(&lt;= ) 小于等于 - $lte &#x27;&#x27;&#x27;</span></span><br><span class="line">data = self.collection.find(&#123;<span class="string">&quot;age&quot;</span>:&#123;<span class="string">&quot;$gt&quot;</span>: <span class="number">12</span>&#125;&#125;) <span class="comment"># 查询年龄大于12岁的</span></span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_size</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 查询符合条件的文档条数 &#x27;&#x27;&#x27;</span></span><br><span class="line">size = self.collection.find(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>&#125;).count()</span><br><span class="line"><span class="keyword">return</span> size</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_names</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 查询所有 name 的值，不重复的。返回list &#x27;&#x27;&#x27;</span></span><br><span class="line">names = self.collection.distinct(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> names</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 修改文档 &#x27;&#x27;&#x27;</span></span><br><span class="line">self.collection.update(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>&#125;,&#123;<span class="string">&quot;$set&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:<span class="number">28</span>&#125;&#125;)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 删除文档 &#x27;&#x27;&#x27;</span></span><br><span class="line">self.collection.remove(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;myName&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><h4 id="Redis-数据库"><a href="#Redis-数据库" class="headerlink" title="Redis 数据库"></a>Redis 数据库</h4><pre><code>pip install redis</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRedis</span>:</span></span><br><span class="line"><span class="string">&quot;&quot;&quot; Redis 数据库简单使用 &quot;&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 1、建立 Redis连接</span></span><br><span class="line"><span class="comment"># 第一种方式</span></span><br><span class="line"><span class="comment"># self.red = redis.Redis(host=&#x27;localhost&#x27;,port=6379,db=0)</span></span><br><span class="line"><span class="comment"># 第二种方式(以连接池的方式)</span></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">                self.red = redis.Redis(connection_pool=pool)  </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 插入数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">self.red.<span class="built_in">set</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 查询数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">data = self.red.get(<span class="string">&quot;key&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete_data</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; 删除数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">self.red.delete(<span class="string">&#x27;key&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>Redis 之 消息推送</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### 服务端发布数据</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">resis_server</span>(<span class="params">host,port</span>):</span></span><br><span class="line">pool = redis.ConnectionPool(host=host,port=port,db=<span class="number">1</span>)</span><br><span class="line">r = redis.StrictRedis(connection_pool=pool)</span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">dt = datetime.now()</span><br><span class="line">print(dt) <span class="comment"># 要发布的数据</span></span><br><span class="line"><span class="comment"># 发布到指定频道</span></span><br><span class="line">r.publish(<span class="string">&#x27;channel_name&#x27;</span>,dt)</span><br><span class="line"><span class="keyword">if</span> count &gt;= <span class="number">10</span>:</span><br><span class="line"><span class="comment"># 只是为了测试，所以限制为10次后，发布结束通知</span></span><br><span class="line">r.publish(<span class="string">&#x27;channel_name&#x27;</span>,<span class="string">&#x27;end&#x27;</span>) </span><br><span class="line">print(<span class="string">&#x27;停止发布&#x27;</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">resis_server(<span class="string">&#x27;192.168.88.64&#x27;</span>,<span class="number">6379</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 客户端接收数据</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redis_client</span>(<span class="params">host,port</span>):</span></span><br><span class="line">pool = redis.ConnectionPool(host=host,port=port,db=<span class="number">1</span>)</span><br><span class="line">r = redis.StrictRedis(connection_pool=pool)</span><br><span class="line">p = r.pubsub()</span><br><span class="line">p.subscribe(<span class="string">&#x27;channel_name&#x27;</span>) <span class="comment"># 订阅频道</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> p.listen():</span><br><span class="line">print(item)  <span class="comment"># 输出字典</span></span><br><span class="line"><span class="keyword">if</span> item[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;message&#x27;</span>:</span><br><span class="line">data = item[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">print(data)  <span class="comment"># 输出发送过来的消息</span></span><br><span class="line"><span class="keyword">if</span> item[<span class="string">&#x27;data&#x27;</span>] == <span class="string">b&#x27;end&#x27;</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">p.unsubscribe(<span class="string">&#x27;channel_name&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;取消订阅&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">redis_client(<span class="string">&#x27;192.168.88.64&#x27;</span>,<span class="number">6379</span>)</span><br></pre></td></tr></table></figure><h4 id="hdf5-快速存取数据"><a href="#hdf5-快速存取数据" class="headerlink" title="hdf5 快速存取数据"></a>hdf5 快速存取数据</h4><pre><code>pip install h5py</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> h5py</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_h5</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 写入数据，写入一个list &#x27;&#x27;&#x27;</span></span><br><span class="line">    h5 = h5py.File(<span class="string">&#x27;test.hdf5&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    h5[<span class="string">&#x27;/test/t1&#x27;</span>] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">    h5.close()</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_h5</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 读取数据 &#x27;&#x27;&#x27;</span></span><br><span class="line">    h5 = h5py.File(<span class="string">&#x27;test.hdf5&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    v = h5[<span class="string">&#x27;/test/t1&#x27;</span>].value</span><br><span class="line">    h5.close()</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    write_h5()</span><br><span class="line">    v = read_h5()</span><br><span class="line">    print(v)</span><br></pre></td></tr></table></figure><h4 id="Oracle-数据库"><a href="#Oracle-数据库" class="headerlink" title="Oracle 数据库"></a>Oracle 数据库</h4><p>1.用户名，密码和监听分别作为参数</p><pre><code>conn=cx_Oracle.connect(&#39;用户名&#39;,&#39;密码&#39;,&#39;数据库地址:数据库端口/SID&#39;)</code></pre><p>2.用户名，密码和监听共同作为一个参数</p><pre><code>conn=cx_Oracle.connect(&#39;用户名/密码@数据库地址:数据库端口/SID&#39;)</code></pre><p>3.使用tns配置信息</p><pre><code>tns=cx_Oracle.makedsn(&#39;数据库地址&#39;,&#39;数据库端口&#39;, &#39;SID&#39;)conn=cx_Oracle.connect(&#39;用户名&#39;,&#39;密码&#39;,tns)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> cx_Oracle</span><br><span class="line"><span class="comment"># 封装的类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cxOracle</span>:</span></span><br><span class="line">  <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  tns的取值tnsnames.ora对应的配置项的值，如：</span></span><br><span class="line"><span class="string">  tns = &#x27;(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)</span></span><br><span class="line"><span class="string">(HOST=10.16.18.23)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=MYDB)))&#x27;</span></span><br><span class="line"><span class="string">  &#x27;&#x27;&#x27;</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self ,uname, upwd,tns </span>):</span></span><br><span class="line">    self ._uname = uname</span><br><span class="line">    self ._upwd = upwd</span><br><span class="line">    self ._tns = tns</span><br><span class="line">    self ._conn = <span class="literal">None</span></span><br><span class="line">    self ._ReConnect()</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">_ReConnect</span>(<span class="params">self </span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self._conn :</span><br><span class="line">      self ._conn = cx_Oracle.connect (self. _uname, self ._upwd, self._tns)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">pass</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self </span>):</span></span><br><span class="line">    <span class="keyword">if</span> self. _conn:</span><br><span class="line">      self ._conn. close()</span><br><span class="line">      self ._conn = <span class="literal">None</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">_NewCursor</span>(<span class="params">self </span>):</span></span><br><span class="line">    cur = self. _conn.cursor ()</span><br><span class="line">    <span class="keyword">if</span> cur:</span><br><span class="line">      <span class="keyword">return</span> cur</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="built_in">print</span> <span class="string">&quot;#Error# Get New Cursor Failed.&quot;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">_DelCursor</span>(<span class="params">self , cur</span>):</span></span><br><span class="line">    <span class="keyword">if</span> cur:</span><br><span class="line">      cur .close()</span><br><span class="line">  <span class="comment"># 检查是否允许执行的sql语句</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">_PermitedUpdateSql</span>(<span class="params">self ,sql</span>):</span></span><br><span class="line">    rt = <span class="literal">True</span></span><br><span class="line">    lrsql = sql. lower()</span><br><span class="line">    sql_elems = [ lrsql.strip ().split()]</span><br><span class="line">    <span class="comment"># update和delete最少有四个单词项</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>( sql_elems) &lt; <span class="number">4</span> :</span><br><span class="line">      rt = <span class="literal">False</span></span><br><span class="line">    <span class="comment"># 更新删除语句，判断首单词，不带where语句的sql不予执行</span></span><br><span class="line">    <span class="keyword">elif</span> sql_elems[<span class="number">0</span>] <span class="keyword">in</span> [ <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>]:</span><br><span class="line">      <span class="keyword">if</span> <span class="string">&#x27;where&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> sql_elems :</span><br><span class="line">        rt = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">  <span class="comment"># 导出结果为文件</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">Export</span>(<span class="params">self , sql, file_name, colfg =<span class="string">&#x27;||&#x27;</span></span>):</span></span><br><span class="line">    rt = self. Query(sql )</span><br><span class="line">    <span class="keyword">if</span> rt:</span><br><span class="line">      <span class="keyword">with</span> <span class="built_in">open</span>( file_name, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> rt:</span><br><span class="line">          ln_info = <span class="string">&#x27;&#x27;</span></span><br><span class="line">          <span class="keyword">for</span> col <span class="keyword">in</span> row:</span><br><span class="line">             ln_info += <span class="built_in">str</span>( col) + colfg</span><br><span class="line">          ln_info += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">          fd .write( ln_info)</span><br><span class="line">  <span class="comment"># 查询</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">Query</span>(<span class="params">self , sql, nStart=<span class="number">0</span> , nNum=- <span class="number">1</span></span>):</span></span><br><span class="line">    rt = []</span><br><span class="line">    <span class="comment"># 获取cursor</span></span><br><span class="line">    cur = self. _NewCursor()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cur:</span><br><span class="line">      <span class="keyword">return</span> rt</span><br><span class="line">    <span class="comment"># 查询到列表</span></span><br><span class="line">    cur .execute(sql)</span><br><span class="line">    <span class="keyword">if</span> ( nStart==<span class="number">0</span> ) <span class="keyword">and</span> (nNum==<span class="number">1</span> ):</span><br><span class="line">      rt .append( cur.fetchone ())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      rs = cur. fetchall()</span><br><span class="line">      <span class="keyword">if</span> nNum==- <span class="number">1</span>:</span><br><span class="line">        rt .extend( rs[nStart:])</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">        rt .extend( rs[nStart:nStart +nNum])</span><br><span class="line">    <span class="comment"># 释放cursor</span></span><br><span class="line">    self ._DelCursor(cur)</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">  <span class="comment"># 更新</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">Exec</span>(<span class="params">self ,sql</span>):</span></span><br><span class="line">    <span class="comment"># 获取cursor</span></span><br><span class="line">    rt = <span class="literal">None</span></span><br><span class="line">    cur = self. _NewCursor()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cur:</span><br><span class="line">      <span class="keyword">return</span> rt</span><br><span class="line">    <span class="comment"># 判断sql是否允许其执行</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> _PermitedUpdateSql(sql ):</span><br><span class="line">      <span class="keyword">return</span> rt</span><br><span class="line">    <span class="comment"># 执行语句</span></span><br><span class="line">    rt = cur. execute(sql )</span><br><span class="line">    <span class="comment"># 释放cursor</span></span><br><span class="line">    self ._DelCursor(cur)</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类使用示例</span></span><br><span class="line">    tns = <span class="string">&#x27;(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=10.16.17.46)</span></span><br><span class="line"><span class="string">    (PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=MYDB)))&#x27;</span></span><br><span class="line">    ora = cxOracle (<span class="string">&#x27;nicker&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, tns)</span><br><span class="line"><span class="comment"># 导出结果为文件</span></span><br><span class="line">    rs = ora .Export(<span class="string">&quot;SELECT * FROM org&quot;</span>, <span class="string">&#x27;1.txt&#x27;</span>)</span><br><span class="line"><span class="comment"># 查询结果到列表</span></span><br><span class="line">    rs = ora.Query(<span class="string">&quot;SELECT * FROM org&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span> rs</span><br><span class="line"><span class="comment"># 更新数据</span></span><br><span class="line">    ora.Exec(<span class="string">&quot;update org set org_name=&#x27;NewNameForUpdate&#x27; where org_id=123456;&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python CGI编程</title>
      <link href="2019/09/19/python/Python%20CGI%E7%BC%96%E7%A8%8B/"/>
      <url>2019/09/19/python/Python%20CGI%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="CGI"><a href="#CGI" class="headerlink" title="CGI"></a>CGI</h4><pre><code>CGI（Common Gateway Interface）也叫通用网关接口，它是一个web服务器主机提供信息服务的标准接口，只要遵循这个接口，web服务器就能获取客户端提交的信息，转交给服务端的CGI程序进行处理，然后将处理结果返回给客户端。CGI通讯是由两部分组成的：一部分是用户的浏览器显示的页面，也就是html页面，另一部分则是运行在服务器上的CGI程序。</code></pre><h4 id="Python3-x"><a href="#Python3-x" class="headerlink" title="Python3.x"></a>Python3.x</h4><pre><code>windows下运行找一个目录，新建一个文件夹，叫做“www”，在“www”文件夹下面新建一个目录，叫做“cgi-bin”管理员打开cmd命令行工具，进入到“www”目录python -m http.server --cgi 8001 **端口号注意不要冲突**在浏览器中，输入 http://localhost:8001</code></pre><h4 id="IIS-部署"><a href="#IIS-部署" class="headerlink" title="IIS 部署"></a>IIS 部署</h4><pre><code>Windows键+R，appwiz.cpl打开控制面板的“卸载或更改程序”，打开或关闭Windows功能”，打开“Windows功能窗口”选中IIS的组件，CGI一定要选中“添加网站”，选中 CGI 程序“功能视图”下的“IIS”组下选择“模块”，看到有一个“CgiModule”模块“IIS”组双击“处理程序映射”，单击右边的“添加模块映射...”“请求路径”中输入“*.cgi”“模块”这个框填“CgiModule” 或者 “cgi”“可执行文件” 选择 python.exe名称自己取常见问题：用户访问权限问题：更改目录访问权限即可ISAPI和CGI限制问题：解除IIS的CGI功能限制即可，“IIS”组中双击“ISAPI和CGI限制”，“编辑功能设置”，选中“允许未指定的CGI模块”HTTP错误403.14 - Forbidden：启用目录浏览即可</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;Content-type: text/html&quot;</span>)</span><br><span class="line">print()</span><br><span class="line">print(<span class="string">&quot;&lt;b&gt;环境变量&lt;/b&gt;&lt;br&gt;&quot;</span>;)</span><br><span class="line">print(<span class="string">&quot;&lt;ul&gt;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> os.environ.keys():</span><br><span class="line">    print(<span class="string">&quot;&lt;li&gt;&lt;span style=&#x27;color:green&#x27;&gt;%30s &lt;/span&gt; : %s &lt;/li&gt;&quot;</span> % (key,os.environ[key]))</span><br><span class="line">print(<span class="string">&quot;&lt;/ul&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 中文乱码问题</span></span><br><span class="line"><span class="comment"># &quot;&lt;meta charset=&quot;utf-8&quot;&gt; 不要添加这一行</span></span><br></pre></td></tr></table></figure><h4 id="Apache-部署"><a href="#Apache-部署" class="headerlink" title="Apache 部署"></a>Apache 部署</h4><p><a href="https://www.cnblogs.com/feifeidxl/p/5556696.html">Python+Apache+CGI完全配置</a></p><p><a href="https://my.oschina.net/Samyan/blog/2966431">搭建CGI编程调试环境</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>文件流转换、zip压缩</title>
      <link href="2019/09/12/Csharp/%E6%96%87%E4%BB%B6%E6%B5%81%E8%BD%AC%E6%8D%A2%E3%80%81zip%E5%8E%8B%E7%BC%A9/"/>
      <url>2019/09/12/Csharp/%E6%96%87%E4%BB%B6%E6%B5%81%E8%BD%AC%E6%8D%A2%E3%80%81zip%E5%8E%8B%E7%BC%A9/</url>
      
        <content type="html"><![CDATA[<h4 id="文件流转换"><a href="#文件流转换" class="headerlink" title="文件流转换"></a>文件流转换</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> BasePath = AppDomain.CurrentDomain.BaseDirectory;</span><br><span class="line"><span class="built_in">string</span> path = @<span class="string">&quot;d:\demo\测试.zip&quot;</span>;</span><br><span class="line">byte[] buff = FileBinaryConvertHelper.File2Bytes(path);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> JarContent = Convert.ToBase64String(buff);</span><br><span class="line">File.WriteAllText(@<span class="string">&quot;d:\demo\测试.txt&quot;</span>, JarContent);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> data = File.ReadAllText(@<span class="string">&quot;d:\demo\测试.txt&quot;</span>, Encoding.Default);</span><br><span class="line">FileBinaryConvertHelper.Bytes2File(Convert.FromBase64String(data), BasePath + @<span class="string">&quot;\Files\测试.zip&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>FileBinaryConvertHelper</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileBinaryConvertHelper</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 将文件转换为byte数组</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;path&quot;&gt;文件地址&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;returns&gt;转换后的byte数组&lt;/returns&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> byte[] File2Bytes(<span class="built_in">string</span> path)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!System.IO.File.Exists(path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> byte[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(path);</span><br><span class="line">        byte[] buff = <span class="keyword">new</span> byte[fi.Length];</span><br><span class="line"></span><br><span class="line">        FileStream fs = fi.OpenRead();</span><br><span class="line">        fs.Read(buff, <span class="number">0</span>, Convert.ToInt32(fs.Length));</span><br><span class="line">        fs.Close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> buff;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 将byte数组转换为文件并保存到指定地址</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;buff&quot;&gt;byte数组&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;savepath&quot;&gt;保存地址&lt;/param&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bytes2File</span><span class="params">(byte[] buff, <span class="built_in">string</span> savepath)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (System.IO.File.Exists(savepath))</span><br><span class="line">        &#123;</span><br><span class="line">            System.IO.File.Delete(savepath);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FileStream fs = <span class="keyword">new</span> FileStream(savepath, FileMode.CreateNew);</span><br><span class="line">        BinaryWriter bw = <span class="keyword">new</span> BinaryWriter(fs);</span><br><span class="line">        bw.Write(buff, <span class="number">0</span>, buff.Length);</span><br><span class="line">        bw.Close();</span><br><span class="line">        fs.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="zip-压缩"><a href="#zip-压缩" class="headerlink" title="zip 压缩"></a>zip 压缩</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ZipFile</span><span class="params">(<span class="built_in">string</span> strFile, <span class="built_in">string</span> strZip)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strFile[strFile.Length - <span class="number">1</span>] != Path.DirectorySeparatorChar)</span><br><span class="line">        strFile += Path.DirectorySeparatorChar;</span><br><span class="line">    ZipOutputStream s = <span class="keyword">new</span> ZipOutputStream(File.Create(strZip));</span><br><span class="line">    s.SetLevel(<span class="number">6</span>); <span class="comment">// 0 - store only to 9 - means best compression</span></span><br><span class="line">    zip(strFile, s, strFile);</span><br><span class="line">    s.Finish();</span><br><span class="line">    s.Close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">zip</span><span class="params">(<span class="built_in">string</span> strFile, ZipOutputStream s, <span class="built_in">string</span> staticFile)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strFile[strFile.Length - <span class="number">1</span>] != Path.DirectorySeparatorChar) strFile </span><br><span class="line">+= Path.DirectorySeparatorChar;</span><br><span class="line">    Crc32 crc = <span class="keyword">new</span> Crc32();</span><br><span class="line">    <span class="built_in">string</span>[] filenames = Directory.GetFileSystemEntries(strFile);</span><br><span class="line">    foreach (<span class="built_in">string</span> file in filenames)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Directory.Exists(file))</span><br><span class="line">        &#123;</span><br><span class="line">            zip(file, s, staticFile);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// 否则直接压缩文件</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//打开压缩文件</span></span><br><span class="line">            FileStream fs = File.OpenRead(file);</span><br><span class="line"></span><br><span class="line">            byte[] buffer = <span class="keyword">new</span> byte[fs.Length];</span><br><span class="line">            fs.Read(buffer, <span class="number">0</span>, buffer.Length);</span><br><span class="line">            <span class="built_in">string</span> tempfile = file.Substring(staticFile.LastIndexOf(<span class="string">&quot;\\&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">            ZipEntry entry = <span class="keyword">new</span> ZipEntry(tempfile);</span><br><span class="line"></span><br><span class="line">            entry.DateTime = DateTime.Now;</span><br><span class="line">            entry.Size = fs.Length;</span><br><span class="line">            fs.Close();</span><br><span class="line">            crc.Reset();</span><br><span class="line">            crc.Update(buffer);</span><br><span class="line">            entry.Crc = crc.Value;</span><br><span class="line">            s.PutNextEntry(entry);</span><br><span class="line"></span><br><span class="line">            s.Write(buffer, <span class="number">0</span>, buffer.Length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="zip-解压"><a href="#zip-解压" class="headerlink" title="zip 解压"></a>zip 解压</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">public static Dictionary&lt;string, string&gt; UnZip(string zipFilePath, string unZipDir)</span><br><span class="line">&#123;</span><br><span class="line">    Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; files = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">    <span class="keyword">if</span> (zipFilePath == <span class="built_in">string</span>.Empty)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;压缩文件不能为空！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!File.Exists(BasePath + zipFilePath))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">&quot;压缩文件不存在！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//解压文件夹为空时默认与压缩文件同一级目录下，跟压缩文件同名的文件夹  </span></span><br><span class="line">    <span class="keyword">if</span> (unZipDir == <span class="built_in">string</span>.Empty)</span><br><span class="line">        unZipDir = zipFilePath.Replace(Path.GetFileName(zipFilePath), </span><br><span class="line">Path.GetFileNameWithoutExtension(zipFilePath));</span><br><span class="line">    <span class="keyword">if</span> (!unZipDir.EndsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        unZipDir += <span class="string">&quot;/&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!Directory.Exists(BasePath + unZipDir))</span><br><span class="line">        Directory.CreateDirectory(BasePath + unZipDir);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (var s = <span class="keyword">new</span> ZipInputStream(File.OpenRead(BasePath + zipFilePath)))</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            ZipEntry theEntry;</span><br><span class="line">            <span class="keyword">while</span> ((theEntry = s.GetNextEntry()) != null)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> directoryName = Path.GetDirectoryName(theEntry.Name);</span><br><span class="line">                <span class="built_in">string</span> fileName = Path.GetFileName(theEntry.Name);</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(directoryName))</span><br><span class="line">                &#123;</span><br><span class="line">                    Directory.CreateDirectory(BasePath + unZipDir + directoryName);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (directoryName != null &amp;&amp; !directoryName.EndsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (fileName != String.Empty)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">using</span> (FileStream streamWriter = File.Create(BasePath + unZipDir + theEntry.Name))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">int</span> size;</span><br><span class="line">                        byte[] data = <span class="keyword">new</span> byte[<span class="number">2048</span>];</span><br><span class="line">                        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            size = s.Read(data, <span class="number">0</span>, data.Length);</span><br><span class="line">                            <span class="keyword">if</span> (size &gt; <span class="number">0</span>)</span><br><span class="line">                            &#123;</span><br><span class="line">                                streamWriter.Write(data, <span class="number">0</span>, size);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        files.Add(fileName, unZipDir + theEntry.Name);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;压缩文件解压失败！\n&quot;</span> + ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> files;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ByteToFile"><a href="#ByteToFile" class="headerlink" title="ByteToFile"></a>ByteToFile</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ByteToFile</span><span class="params">(<span class="built_in">string</span> fileName, byte[] pReadByte)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FileStream pFileStream = null;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        pFileStream = <span class="keyword">new</span> FileStream(BasePath + fileName, FileMode.OpenOrCreate);</span><br><span class="line">        pFileStream.Write(pReadByte, <span class="number">0</span>, pReadByte.Length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ex.Message;</span><br><span class="line">    &#125;</span><br><span class="line">    finally</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (pFileStream != null)</span><br><span class="line">            pFileStream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fileName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C# </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 空气质量指数计算</title>
      <link href="2019/09/12/python/Python%20%E7%A9%BA%E6%B0%94%E8%B4%A8%E9%87%8F%E6%8C%87%E6%95%B0%E8%AE%A1%E7%AE%97/"/>
      <url>2019/09/12/python/Python%20%E7%A9%BA%E6%B0%94%E8%B4%A8%E9%87%8F%E6%8C%87%E6%95%B0%E8%AE%A1%E7%AE%97/</url>
      
        <content type="html"><![CDATA[<h4 id="计算方法"><a href="#计算方法" class="headerlink" title="计算方法"></a>计算方法</h4><blockquote><p>分指数</p></blockquote><ul><li>IAQI<sub>p</sub> = (IAQI<sub>Hi</sub> - IAQI<sub>Lo</sub>)/(BP<sub>Hi</sub> - BP<sub>Lo</sub>)(C<sub>p</sub> - BP<sub>Lo</sub>) + IAQI<sub>Lo</sub></li></ul><style>    .info{margin-left:2rem;}    .info p{margin:0.25rem;}</style><div class="info">    <p>IAQI<sub>p</sub>：污染物项目P的空气质量分指数</p>    <p>C<sub>p</sub>：污染物项目P的质量浓度值</p>    <p>BP<sub>Hi</sub>：C<sub>p</sub>相近的污染物浓度限值的高位值</p>    <p>BP<sub>Lo</sub>：C<sub>p</sub>相近的污染物浓度限值的低位值</p>    <p>IAQI<sub>Hi</sub>：BP<sub>Hi</sub>对应的空气质量分指数</p>    <p>IAQI<sub>Lo</sub>：BP<sub>Lo</sub>对应的空气质量分指数</p></div><blockquote><p>指数</p></blockquote><ul><li><p>AQI = max｛IAQI<sub>1</sub>，IAQI<sub>2</sub>，···，IAQI<sub>n</sub>｝</p><p>  IAQI：单项污染物的空气质量指数<br>  AQI：定量描述空气质量状况的无量纲指数</p><p>  本质：线性缩放</p></li></ul><h4 id="AQI"><a href="#AQI" class="headerlink" title="AQI"></a>AQI</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#线性缩放</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_linear</span>(<span class="params">C_p, BP_Lo, BP_Hi, IAQI_Lo, IAQI_Hi</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (IAQI_Hi-IAQI_Lo)/(BP_Hi-BP_Lo)*(C_p-BP_Lo) + IAQI_Lo</span><br><span class="line"><span class="comment">#分指数计算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_iaqi</span>(<span class="params">val, <span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;</span><br><span class="line">        <span class="string">&quot;pm&quot;</span>:[<span class="string">&quot;0-0&quot;</span>,<span class="string">&quot;35-50&quot;</span>,<span class="string">&quot;75-100&quot;</span>,<span class="string">&quot;115-150&quot;</span>,<span class="string">&quot;150-200&quot;</span>,<span class="string">&quot;250-300&quot;</span>,<span class="string">&quot;350-400&quot;</span>,<span class="string">&quot;500-500&quot;</span>],</span><br><span class="line">        <span class="string">&quot;co&quot;</span>:[<span class="string">&quot;0-0&quot;</span>,<span class="string">&quot;5-50&quot;</span>,<span class="string">&quot;10-100&quot;</span>,<span class="string">&quot;35-150&quot;</span>,<span class="string">&quot;60-200&quot;</span>,<span class="string">&quot;90-300&quot;</span>,<span class="string">&quot;120-400&quot;</span>,<span class="string">&quot;150-500&quot;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    C_p = val</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">dict</span>[<span class="built_in">type</span>]:</span><br><span class="line">        currIndex = <span class="built_in">dict</span>[<span class="built_in">type</span>].index(i)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>] != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                _lo = <span class="built_in">float</span>(i.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">                _hi = <span class="built_in">float</span>(<span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>].split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">if</span> _lo &lt;= C_p &lt; _hi:</span><br><span class="line">                    BP_Lo = _lo</span><br><span class="line">                    BP_Hi = _hi</span><br><span class="line"></span><br><span class="line">                    IAQI_Lo = <span class="built_in">float</span>(i.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">                    IAQI_Hi = <span class="built_in">float</span>(<span class="built_in">dict</span>[<span class="built_in">type</span>][currIndex+<span class="number">1</span>].split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">&quot;IAQI 超过 500！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> TypeError:</span><br><span class="line">            print(<span class="string">&quot;数值类型错误！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;分指数计算错误！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cal_linear(C_p, BP_Lo, BP_Hi, IAQI_Lo, IAQI_Hi)</span><br><span class="line"><span class="comment">#指数计算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_AQI</span>(<span class="params">params</span>):</span></span><br><span class="line">    </span><br><span class="line">    pm_iaqi = cal_iaqi(params[<span class="number">0</span>], <span class="string">&quot;pm&quot;</span>)</span><br><span class="line">    co_iaqi = cal_iaqi(params[<span class="number">1</span>], <span class="string">&quot;co&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(pm_iaqi,co_iaqi)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="built_in">input</span>(<span class="string">&quot;请输入以下信息，用空格分割。&quot;</span>);</span><br><span class="line">    <span class="built_in">str</span> = <span class="built_in">input</span>(<span class="string">&quot;(1)PM2.5 (2)CO:&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pmVal = <span class="built_in">float</span>(<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        coVal = <span class="built_in">float</span>(<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        params = []</span><br><span class="line">        params.append(pmVal)</span><br><span class="line">        params.append(coVal)</span><br><span class="line"></span><br><span class="line">        aqiVal = cal_AQI(params)</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;空气质量指数为：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(aqiVal))</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        print(<span class="string">&quot;输入参数值数量不够！&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;主程序报错！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="JSON-数据文件"><a href="#JSON-数据文件" class="headerlink" title="JSON 数据文件"></a>JSON 数据文件</h4><pre><code>轻量级数据交换格式对复杂数据进行表达和存储，易于阅读和理解示例：json = &#123;    &#39;a&#39;:[1,2,3,4,5],    &#39;b&#39;:&quot;123&quot;&#125;</code></pre><blockquote><p>JSON 库</p></blockquote><pre><code>import json编码（encoding） 将 python 数据转化成 JSON 数据解码（decoding） 将 JSON 数据解析到 python 数据类型dumps()  //编码loads()  //解码dump()   //输出到文件load()   //从文件读入</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从文件读入</span></span><br><span class="line">f = <span class="built_in">open</span>(filepath, mode = <span class="string">&quot;r&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">_list = json.load(f)</span><br><span class="line"><span class="comment"># -&gt; 输出结果为字典类型</span></span><br><span class="line"></span><br><span class="line">_list.sort(key = <span class="keyword">lambda</span> city: city[<span class="string">&#x27;api&#x27;</span>])</span><br><span class="line"><span class="comment"># 输出到文件</span></span><br><span class="line">json.dump(_list[:<span class="number">5</span>], f, ensure_ascii = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h4 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h4><pre><code>通用，简单文本文件适用商业、科学领域规则：    以行为单位，每行表示一条数据，以英文逗号分割每列数据，列名通常放置在第一行import csvcsv.writerow(list)  //将列表中的元素写入文件的一行中csv.reader()        //将每行记录作为列表返回with open(filepath) as somefile:    for line in somefile:        print(line)*使用 with 语句，不管是否发生异常，最后都会关闭文件，不用写 close()*示例：api, area, pm2_547, 北京, 3263, 上海, 37</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#写入CSV</span></span><br><span class="line">lines =[]</span><br><span class="line">lines.append(<span class="built_in">list</span>(_list[<span class="number">0</span>].keys()))</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> _list:</span><br><span class="line">    lines.append(<span class="built_in">list</span>(item.values()))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(csvfilepath, <span class="string">&quot;w&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>, newline = <span class="string">&quot;&quot;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines</span><br><span class="line">    csv.writerow(line)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h4 id="os-模块"><a href="#os-模块" class="headerlink" title="os 模块"></a>os 模块</h4><pre><code>os.remove()          //删除文件os.makedirs()        //创建多层目录os.rmdir()           //删除单级目录os.remame()          //重命名文件os.path.isfile()     //判断是否为文件os.path.isdir()      //判断是否为目录os.path.join()       //连接目录# -&gt; os.path.join(path1,path2)# -&gt; path1/path2os.path.splitext()   //分割文件名和扩展名# -&gt; os.path.splitext(tmp.txt)# -&gt; tmp，.txt</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">os_switch</span>:</span></span><br><span class="line">    <span class="comment">#初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, params</span>):</span></span><br><span class="line">        self.funs = &#123;</span><br><span class="line">            <span class="string">&quot;json&quot;</span>: self.jsonFun,</span><br><span class="line">            <span class="string">&quot;csv&quot;</span>: self.csvFun,</span><br><span class="line">            &#125;</span><br><span class="line">        self.params = params</span><br><span class="line">        self.funs.get(self.params[<span class="string">&quot;moden&quot;</span>], self.other)()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jsonFun</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(self.params[<span class="string">&quot;filepath&quot;</span>], mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="comment"># load 方法</span></span><br><span class="line">                _list = json.load(f, strict=<span class="literal">False</span>)</span><br><span class="line">                <span class="comment"># loads 方法</span></span><br><span class="line">                <span class="comment"># data = f.read();</span></span><br><span class="line">                <span class="comment"># _list = json.loads(data)</span></span><br><span class="line">                print(_list)</span><br><span class="line">        <span class="keyword">except</span> json.decoder.JSONDecodeError:</span><br><span class="line">            print(<span class="string">&quot;jsonFun 运行 JSONDecodeError 报错！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;jsonFun 运行报错！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">csvFun</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(self.params[<span class="string">&quot;filepath&quot;</span>], mode=<span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            reader = csv.reader(f)</span><br><span class="line">            <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">                print(<span class="string">&#x27;，&#x27;</span>.join(row))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">other</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;暂不支持当前格式的文件！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">osFun</span>():</span></span><br><span class="line">    filepath = <span class="built_in">input</span>(<span class="string">&quot;请输入文件路径：&quot;</span>);</span><br><span class="line">    file_name, file_ext = os.path.splitext(filepath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&#x27;moden&#x27;</span>: file_ext[<span class="number">1</span>:],</span><br><span class="line">            <span class="string">&#x27;filepath&#x27;</span>: filepath</span><br><span class="line">            &#125;</span><br><span class="line">        os_switch(params)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;osFun 运行错误！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    osFun()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="自定义-switch"><a href="#自定义-switch" class="headerlink" title="自定义 switch"></a>自定义 switch</h4><ol><li>类模式</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">os_switch</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, params</span>):</span></span><br><span class="line">        self.funs = &#123;</span><br><span class="line">            <span class="string">&quot;json&quot;</span>: self.jsonFun,</span><br><span class="line">            <span class="string">&quot;csv&quot;</span>: self.csvFun,</span><br><span class="line">            &#125;</span><br><span class="line">        self.params = params</span><br><span class="line">        self.funs.get(self.params[<span class="string">&quot;moden&quot;</span>], self.other)()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">json</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">csv</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">other</span>():</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><ol start="2"><li>字典模式</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">switch = &#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span> = a,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span> = b</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h4 id="requests-模块"><a href="#requests-模块" class="headerlink" title="requests 模块"></a>requests 模块</h4><pre><code>简洁、简单的处理 HTTP 请求的工具支持丰富的链接访问功能，包括 URL 获取，HTTP 回话，Cookie 记录等get() post()status_code    // HTTP 请求的返回状态，200表示成功，400表示失败text           // HTTP 相应内容的字符串形式，即 URL 对应的页面内容</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtmlText</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    print(r.status_code)</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> r.text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    city = <span class="built_in">input</span>(<span class="string">&quot;请输入城市拼音：&quot;</span>)</span><br><span class="line">    url = <span class="string">&#x27;http://www.86kongqi.com/city/&#x27;</span> + city + <span class="string">&#x27;.html&#x27;</span></span><br><span class="line">    text = getHtmlText(url)</span><br><span class="line"></span><br><span class="line">    print(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><blockquote><p>中文乱码问题</p></blockquote><ul><li><a href="https://www.cnblogs.com/sheng-247/p/7686014.html">参考解决方案</a></li></ul><pre><code>#方法1r = requests.get(url)html=r.contenthtml_doc=str(html,&#39;utf-8&#39;)#方法2r=requests.get(url)r.encoding=&#39;utf-8&#39;</code></pre><h4 id="beautifulsoup4"><a href="#beautifulsoup4" class="headerlink" title="beautifulsoup4"></a>beautifulsoup4</h4><pre><code>解析 HTML 或者 XMLpip install beautifulsoup4import bs4find       //查找第一个满足条件的节点find_all   //查找所有满足条件的节点bs = BeautifulSoup(    url,    html_parser   //指定解析器    enoding       //编码格式，确保和网页编码格式一致)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;a href=&quot;a.html&quot; class=&quot;a_link&quot;&gt;next page&lt;/a&gt;</span></span><br><span class="line"><span class="comment"># 可按节点类型，属性或内容访问</span></span><br><span class="line"></span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, href = <span class="string">&#x27;a.html&#x27;</span>)</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, href = <span class="string">&#x27;a.html&#x27;</span>, string = <span class="string">&#x27;next page&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, class_ = <span class="string">&#x27;a_link&#x27;</span>)</span><br><span class="line">bs.find_all(<span class="string">&#x27;a&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;a_link&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"></span><br><span class="line">r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line"></span><br><span class="line">soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> soup.find_all(<span class="string">&#x27;div&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;weilai&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;table&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>批量抓取</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAllCity</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    cities = soup.find_all(<span class="string">&#x27;dl&#x27;</span>, &#123;<span class="string">&#x27;id&#x27;</span>:<span class="string">&#x27;clist&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;dd&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> cities.find_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtmlText</span>(<span class="params">url</span>):</span></span><br><span class="line">    r = requests.get(url, timeout = <span class="number">30</span>);</span><br><span class="line">    r.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line"></span><br><span class="line">    soup = bs4.BeautifulSoup(r.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> soup.find_all(<span class="string">&#x27;div&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;weilai&#x27;</span>&#125;)[<span class="number">0</span>].find(<span class="string">&#x27;table&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    </span><br><span class="line">    url = <span class="string">&#x27;http://www.86kongqi.com&#x27;</span></span><br><span class="line"></span><br><span class="line">    cities = getAllCity(url)</span><br><span class="line">    <span class="keyword">for</span> city <span class="keyword">in</span> cities:</span><br><span class="line">        ciry_url = url + <span class="string">&quot;/&quot;</span> + city[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        text = getHtmlText(ciry_url)</span><br><span class="line">        print(ciry_url)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h4><pre><code>分析结构化数据的工具集基础是 Numpy 提供了高性能的矩阵运算应用：数据挖掘，数据分析，数据清洗功能</code></pre><blockquote><p>数据分析</p></blockquote><pre><code>ser_obj = pd.Series(range(10))  // 一维数组对象，索引自动创建，索引在左，数据在右ser_obj.index                   // 获取索引ser_obj.values                  // 获取值ser_obj.head(n)                 // 预览数据，n 前几行ser_obj.tail(n)                 // 预览数据，n 后几行ser_obj[index]Data.Frame通过 ndarray，dict 创建data[&#39;列名&#39;]                           // 获取单列数据data[[&#39;列名1&#39;，&#39;列名2&#39;]]                // 获取多列数据sort_values(by = [&#39;列名&#39;]).head(10)     // 获取前 10 名，降序 ascending = Falsepd.to_csv(&#39;topTen.csv&#39;，index = False)  // 保存为 CSV</code></pre><blockquote><p>数据清洗</p></blockquote><pre><code>dropna()    // 丢失缺失数据fillna()    // 填充缺失数据df[过滤条件]</code></pre><blockquote><p>数据可视化</p></blockquote><pre><code>plot(kind，x，y，title，figsize)plt.savefig()</code></pre><ul><li><a href="https://pandas.pydata.org/pandas-docs">官方地址</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# 调用 python</title>
      <link href="2019/09/11/Csharp/C%20sharp%20%E8%B0%83%E7%94%A8%20python/"/>
      <url>2019/09/11/Csharp/C%20sharp%20%E8%B0%83%E7%94%A8%20python/</url>
      
        <content type="html"><![CDATA[<h4 id="PTVS"><a href="#PTVS" class="headerlink" title="PTVS"></a>PTVS</h4><pre><code>Python tools for Visual Studio 免费开源的VisualStudio的插件，支持 VisualStudio 2010/2012/2013</code></pre><h4 id="IronPython"><a href="#IronPython" class="headerlink" title="IronPython"></a>IronPython</h4><pre><code>NuGet 包管理器 -&gt; NuGet 包，搜索 IronPython 包安装</code></pre><h4 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h4><pre><code>using IronPython.Hosting;using Microsoft.Scripting.Hosting;</code></pre><h4 id="创建，环境配置"><a href="#创建，环境配置" class="headerlink" title="创建，环境配置"></a>创建，环境配置</h4><blockquote><p>不包含第三方模块的调用方式</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建Python解释器对象</span></span><br><span class="line">ScriptRuntime pyRunTime = Python.CreateRuntime();</span><br><span class="line"><span class="comment">//读取脚本文件</span></span><br><span class="line">dynamic py = pyEngine.ExecuteFile(@<span class="string">&quot;test.py&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用脚本文件中对应的函数</span></span><br><span class="line"><span class="keyword">int</span>[] <span class="built_in">array</span> = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">9</span>] &#123; <span class="number">9</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">8</span> &#125;;</span><br><span class="line"><span class="built_in">string</span> reStr = py.main(<span class="built_in">array</span>);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">arr</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        arr = <span class="built_in">set</span>(arr)</span><br><span class="line">        arr = <span class="built_in">sorted</span>(arr)</span><br><span class="line">        arr = arr[<span class="number">0</span>:]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(arr)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(err)</span><br></pre></td></tr></table></figure><blockquote><p>包含第三方模块的调用</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Process p = <span class="keyword">new</span> Process();</span><br><span class="line">    <span class="comment">//待处理python文件的路径，本例中放在debug文件夹下</span></span><br><span class="line">    <span class="built_in">string</span> path = <span class="string">&quot;reset_ipc.py&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> sArguments = path;</span><br><span class="line">    ArrayList arrayList = <span class="keyword">new</span> ArrayList()&#123;</span><br><span class="line">        <span class="string">&quot;com4&quot;</span>, <span class="number">57600</span>, <span class="string">&quot;password&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加参数</span></span><br><span class="line">    foreach (var param in arrayList)</span><br><span class="line">    &#123;</span><br><span class="line">        sArguments += <span class="string">&quot; &quot;</span> + sigstr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//python2.7的安装路径</span></span><br><span class="line">    p.StartInfo.FileName = @<span class="string">&quot;D:\Python2\python.exe&quot;</span>; </span><br><span class="line">    <span class="comment">//python命令的参数</span></span><br><span class="line">    p.StartInfo.Arguments = sArguments;</span><br><span class="line">    p.StartInfo.UseShellExecute = <span class="literal">false</span>;</span><br><span class="line">    p.StartInfo.RedirectStandardOutput = <span class="literal">true</span>;</span><br><span class="line">    p.StartInfo.RedirectStandardInput = <span class="literal">true</span>;</span><br><span class="line">    p.StartInfo.RedirectStandardError = <span class="literal">true</span>;</span><br><span class="line">    p.StartInfo.CreateNoWindow = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//启动进程</span></span><br><span class="line">    p.Start();</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> serial</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">resetIPC</span>(<span class="params">com, baudrate, password, timeout=<span class="number">0.5</span></span>):</span></span><br><span class="line">    ser = serial.Serial(com, baudrate, timeout=timeout)</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ser.close()</span><br><span class="line">        ser.<span class="built_in">open</span>()</span><br><span class="line">        ser.write(<span class="string">&quot;\n&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        ser.write(<span class="string">&quot;root\n&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        passwordStr=<span class="string">&quot;%s\n&quot;</span> % password</span><br><span class="line">        ser.write(passwordStr.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        ser.write(<span class="string">&quot;killall -9 xxx\n&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        ser.write(<span class="string">&quot;rm /etc/xxx/xxx_user.*\n&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        ser.write(<span class="string">&quot;reboot\n&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        ser.close()</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line">resetIPC(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>], sys.argv[<span class="number">3</span>])</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/Hard/p/csharp-python-pyinstaller.html">c#项目调用Python模块</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 掷骰子</title>
      <link href="2019/09/10/python/Python%20%E6%8E%B7%E9%AA%B0%E5%AD%90/"/>
      <url>2019/09/10/python/Python%20%E6%8E%B7%E9%AA%B0%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<h4 id="random-模块"><a href="#random-模块" class="headerlink" title="random 模块"></a>random 模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#random()   生成一个 [0, 1.0) 之间的随机 &quot;浮点数&quot;</span></span><br><span class="line"><span class="comment">#uniform(a, b)   生成一个 a - b 之间的随机 &quot;浮点数&quot;</span></span><br><span class="line"><span class="comment">#randint(a, b)   生成一个 a - b 之间的随机 &quot;整数&quot;</span></span><br><span class="line"><span class="comment">#choice(&lt;list&gt;)   从列表中随机返回一个元素</span></span><br><span class="line"><span class="comment">#shuffle(&lt;list&gt;)    将列表中元素随机打乱</span></span><br><span class="line"><span class="comment">#sample(&lt;list&gt;, k)   从指定列表中随机获取 k 个元素</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">roll_dice</span>():</span></span><br><span class="line">    roll = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">    <span class="keyword">return</span> roll</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"><span class="comment">#单个骰子</span></span><br><span class="line">    <span class="built_in">list</span> = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line"></span><br><span class="line">    count = <span class="built_in">input</span>(<span class="string">&quot;请输入掷骰子次数：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        roll = roll_dice()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">           <span class="keyword">if</span> roll == j:</span><br><span class="line">                <span class="built_in">list</span>[j-<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    print(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">list</span>):</span><br><span class="line">        print(<span class="string">&quot;&#123;&#125; --- &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i,x))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><blockquote><p>enumerate()</p></blockquote><pre><code>遍历列表，同时获取每个元素的索引号和值</code></pre><blockquote><p>小数点保留位数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">round</span>(<span class="number">1.254545</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># -&gt; 1.25</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;%.2f&#x27;</span> % <span class="number">1.251215</span></span><br><span class="line"><span class="comment"># -&gt; &#x27;1.25&#x27;</span></span><br><span class="line"></span><br><span class="line">Decimal(<span class="string">&#x27;5.026&#x27;</span>).quantize(Decimal(<span class="string">&#x27;0.00&#x27;</span>))</span><br><span class="line"><span class="comment"># -&gt; 5.02</span></span><br><span class="line"><span class="comment">#from decimal import *</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">roll_dice</span>(<span class="params">number</span>):</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(number):</span><br><span class="line">        <span class="built_in">dict</span>[i] = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dict</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">list</span> = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    number = <span class="built_in">input</span>(<span class="string">&quot;请输入骰子个数：&quot;</span>)</span><br><span class="line">    count = <span class="built_in">input</span>(<span class="string">&quot;请输入掷骰子次数：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count)):</span><br><span class="line">        roll = roll_dice(<span class="built_in">int</span>(number))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(number)):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">dict</span>.keys():</span><br><span class="line">                <span class="built_in">dict</span>[i].append(roll[i])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">dict</span>[i] = [roll[i]];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">                <span class="keyword">if</span> roll[i] == j:</span><br><span class="line">                    <span class="built_in">list</span>[j-<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;\n &#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(<span class="built_in">list</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">list</span>):</span><br><span class="line">        print(<span class="string">&quot;点数为 &#123;&#125; 的次数是 &#123;&#125; ，概率为 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>, x,</span><br><span class="line">    <span class="built_in">round</span>(x/<span class="built_in">sum</span>(<span class="built_in">list</span>),<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">dict</span>.items():</span><br><span class="line">        print(<span class="string">&quot;\n 第 &#123;&#125; 个骰子，每次掷的点数为 \n &#123;&#125;&quot;</span>.<span class="built_in">format</span>(k+<span class="number">1</span>, v))</span><br><span class="line">    </span><br><span class="line">    print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="zip"><a href="#zip" class="headerlink" title="zip()"></a>zip()</h4><pre><code>将对应的元素打包成一个个元组l1 = [1,2,3,4,5]l2 = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;]zip(l1,l2)# -&gt; [(1,&quot;a&quot;), (2,&quot;b&quot;), (3,&quot;c&quot;), (4,&quot;d&quot;), (5,&quot;e&quot;)]</code></pre><h4 id="dict"><a href="#dict" class="headerlink" title="dict()"></a>dict()</h4><pre><code>数据转换成字典dict(zip(l1,l2))# -&gt; [1:&quot;a&quot;, 2:&quot;b&quot;, 3:&quot;c&quot;, 4:&quot;d&quot;, 5:&quot;e&quot;]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">_list = [<span class="number">0</span>]*<span class="number">11</span></span><br><span class="line">roll_list = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">2</span>,<span class="number">13</span>))</span><br><span class="line">roll_dict = <span class="built_in">dict</span>(<span class="built_in">zip</span>(roll_list, _list))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    roll_1 = roll_dice();</span><br><span class="line">roll_2 = roll_dice();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">13</span>):</span><br><span class="line">    <span class="keyword">if</span> (roll_1+roll_1) == j:</span><br><span class="line">        roll_dict[j] += <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="matplotlib-模块"><a href="#matplotlib-模块" class="headerlink" title="matplotlib 模块"></a>matplotlib 模块</h4><pre><code>数据可视化库</code></pre><blockquote><p>Vstudio 安装 matplotlib</p></blockquote><ul><li><p><a href="https://bootstrap.pypa.io/get-pip.py">下载 pip get-pip.py</a></p><p>  安装 pip<br>  python get-pip.py  <em>cmd 定位到 get-pip.py 目录</em></p><p>  升级 pip<br>  python -m pip install -U pip</p><p>  安装matplotlib<br>  python -m pip install matplotlib</p><p>  安装Pillow(Python Imageing Library，用于读取和保存jpeg、bmp、tiff图像)<br>  pip install pillow </p></li></ul><blockquote><p>散点图 scatter</p></blockquote><pre><code>import matplotlib.pyplot as pltplt.scatter(x,y)plt.show()</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">roll_dice</span>(<span class="params">number</span>):</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(number):</span><br><span class="line">        <span class="built_in">dict</span>[i] = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dict</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">list</span> = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    <span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    number = <span class="built_in">input</span>(<span class="string">&quot;请输入骰子个数：&quot;</span>)</span><br><span class="line">    count = <span class="built_in">input</span>(<span class="string">&quot;请输入掷骰子次数：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count)):</span><br><span class="line">        roll = roll_dice(<span class="built_in">int</span>(number))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(number)):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">dict</span>.keys():</span><br><span class="line">                <span class="built_in">dict</span>[i].append(roll[i])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">dict</span>[i] = [roll[i]];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">                <span class="keyword">if</span> roll[i] == j:</span><br><span class="line">                    <span class="built_in">list</span>[j-<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;\n &#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(<span class="built_in">list</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">list</span>):</span><br><span class="line">        print(<span class="string">&quot;点数为 &#123;&#125; 的次数是 &#123;&#125; ，概率为 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>, x,</span><br><span class="line">    <span class="built_in">round</span>(x/<span class="built_in">sum</span>(<span class="built_in">list</span>),<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#数据可视化</span></span><br><span class="line">    x = <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">int</span>(count)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">dict</span>.items():</span><br><span class="line">        print(<span class="string">&quot;\n 第 &#123;&#125; 个骰子，每次掷的点数为 \n &#123;&#125;&quot;</span>.<span class="built_in">format</span>(k+<span class="number">1</span>, v))</span><br><span class="line">        </span><br><span class="line">        plt.scatter(x, v, alpha = <span class="number">0.5</span>)</span><br><span class="line">    </span><br><span class="line">    plt.show()</span><br><span class="line">    print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><blockquote><p>直方图 hist</p></blockquote><pre><code>plt.hist(data, bins)data：数据列表bins：分组边界data = [20, 30, 45, 58, 99, 48]bins = [0, 10, 20, 30]plt.hist(data, bins)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 编码注意,解决中文显示问题</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.sans-serif&quot;</span>] = [<span class="string">&quot;SimHei&quot;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.scatter(x, v, alpha = 0.5)</span></span><br><span class="line">plt.hist(v, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], </span><br><span class="line">    density=<span class="number">1</span>, edgecolor = <span class="string">&#x27;black&#x27;</span>, linewidth = <span class="number">1</span>, rwidth = <span class="number">0.8</span>)</span><br><span class="line">plt.title(<span class="string">&quot;骰子点数统计&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;点数&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;频率&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="科学计算库"><a href="#科学计算库" class="headerlink" title="科学计算库"></a>科学计算库</h4><blockquote><p>Numpy </p></blockquote><pre><code>强大的 N 维数组对象 array成熟的科学函数库实用的线性代数、随机数生成函数等ndarray.shape //数组的维度np.array(&lt;list&gt;)np.range()  //创建数组reshape() //改变数组形状</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建随机数组，[a, b) 间形状为 size 的数组</span></span><br><span class="line"><span class="comment">#np.random.randint(a, b, size)</span></span><br><span class="line"></span><br><span class="line">roll_arr_1 = np.random.randint(<span class="number">1</span>, <span class="number">7</span>, size = count)</span><br><span class="line">roll_arr_2 = np.random.randint(<span class="number">1</span>, <span class="number">7</span>, size = count)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Numpy 运算，向量化操作</span></span><br><span class="line">roll_arr = roll_arr_1 + roll_arr_2</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出直方图的统计结果</span></span><br><span class="line">hist, bins = np.histogram(roll_arr, bins = <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">14</span>))</span><br><span class="line">print(hist)</span><br><span class="line">print(bins)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x 轴坐标点设置</span></span><br><span class="line">tick_labels = [<span class="string">&quot;2点&quot;</span>，<span class="string">&quot;3点&quot;</span>，<span class="string">&quot;4点&quot;</span>，<span class="string">&quot;5点&quot;</span>，<span class="string">&quot;6点&quot;</span>，</span><br><span class="line"><span class="string">&quot;7点&quot;</span>，<span class="string">&quot;8点&quot;</span>，<span class="string">&quot;9点&quot;</span>，<span class="string">&quot;10点&quot;</span>，<span class="string">&quot;11点&quot;</span>，<span class="string">&quot;12点&quot;</span>]</span><br><span class="line">tick_pos = np.arange(<span class="number">2</span>,<span class="number">13</span>) + <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">plt.xtitcks(tick_pos, tick_labels)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 密码强度</title>
      <link href="2019/09/09/python/Python%20%E5%AF%86%E7%A0%81%E5%BC%BA%E5%BA%A6/"/>
      <url>2019/09/09/python/Python%20%E5%AF%86%E7%A0%81%E5%BC%BA%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<h4 id="密码规则"><a href="#密码规则" class="headerlink" title="密码规则"></a>密码规则</h4><pre><code>长度至少8位，必须含有数字，字母</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#长度判断：len()</span></span><br><span class="line"><span class="comment">#全是数字：isnumeric()</span></span><br><span class="line"><span class="comment">#全是字母：isalpha()</span></span><br><span class="line"><span class="comment">#全是小写：islower()</span></span><br><span class="line"><span class="comment">#全是大写：isupper()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    level = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#规则1：密码长度至少8</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(password) &gt;= <span class="number">8</span>:</span><br><span class="line">        level+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;密码长度要求至少8位！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#规则2：密码包含数字</span></span><br><span class="line">    hasNumber = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#规则3：密码包含字母</span></span><br><span class="line">    hasAlpha = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> password:</span><br><span class="line">        <span class="keyword">if</span> i.isnumeric():</span><br><span class="line">            hasNumber+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i.isalpha():</span><br><span class="line">            hasAlpha+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> hasNumber!=<span class="number">0</span> <span class="keyword">and</span> hasAlpha!=<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hasNumber != <span class="number">0</span>:</span><br><span class="line">        level+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;密码必须包含数字！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> hasAlpha != <span class="number">0</span>:</span><br><span class="line">        level+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;密码必须包含字母！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;密码强度 &#123;&#125;级！&quot;</span>.<span class="built_in">format</span>(level))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="循环终止"><a href="#循环终止" class="headerlink" title="循环终止"></a>循环终止</h4><pre><code>break 终止整个循环continue 只终止本次循环，而不终止整个循环</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_number</span>(<span class="params">password</span>):</span></span><br><span class="line">    has_number = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> password:</span><br><span class="line">        <span class="keyword">if</span> c.isnumeric():</span><br><span class="line">            has_number = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> has_number</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#增加次数限制</span></span><br><span class="line">try_time = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> try_time &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="comment">#主代码</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> level == <span class="number">3</span>：</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">&quot;密码强度不合格！&quot;</span>)</span><br><span class="line">try_time -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> try_time &lt;= <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">&quot;尝试次数过多，设置密码失败！&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="文件基础"><a href="#文件基础" class="headerlink" title="文件基础"></a>文件基础</h4><pre><code>文件：存储在外部介质（硬盘，U盘）上的数据或信息的集合文本文件：一般只有字符编码存储的文件 ，能够被最简单的文本编辑器直接读取编码：信息从一种形式转换为另一种形式的过程常见编码：ASCII, Unicode, UTF-8</code></pre><h4 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h4><pre><code>open（filename，mode）mode: r   只读，文件不存在则报错      w   只写，文件不存在则自动创建      a   在文件末尾附加      r+  读写write()writelines(string)close()</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#保存文件</span></span><br><span class="line"><span class="keyword">if</span> level == <span class="number">3</span>：</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;d:\password.txt&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;密码：&#123;&#125;, 强度：&#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(password, level))</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure><pre><code>read()       读取整个文件内容，返回字符串readline()   文件下一行内容，返回字符串readlines()  返回整个文件内容的列表，每项是以换行符为结尾的一行字符串</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取文件</span></span><br><span class="line">f = onpe(<span class="string">&quot;d:\password.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line">content = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">content = f.read()</span><br><span class="line">print(content)</span><br><span class="line"></span><br><span class="line">content = f.readline()</span><br><span class="line">print(content)</span><br><span class="line"></span><br><span class="line">content = f.readlines()</span><br><span class="line">print(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">    print(line)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h4 id="类-对象"><a href="#类-对象" class="headerlink" title="类, 对象"></a>类, 对象</h4><blockquote><p>密码工具类</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PassWordTool</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, password</span>):</span></span><br><span class="line">        <span class="comment">#类的属性</span></span><br><span class="line">        self.password = password</span><br><span class="line">        self.level = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#类的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify_password</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment">#规则1：密码长度至少8</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.password) &gt;= <span class="number">8</span>:</span><br><span class="line">            self.level+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;密码长度要求至少8位！&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#规则2：密码包含数字</span></span><br><span class="line">        <span class="keyword">if</span> self.check_number():</span><br><span class="line">            self.level+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;密码必须包含数字！&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#规则3：密码包含字母</span></span><br><span class="line">        <span class="keyword">if</span> self.check_letter():</span><br><span class="line">            self.level+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;密码必须包含字母！&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_number</span>(<span class="params">self</span>):</span></span><br><span class="line">        has_number = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> self.password:</span><br><span class="line">            <span class="keyword">if</span> c.isnumeric():</span><br><span class="line">                has_number = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> has_number</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_letter</span>(<span class="params">self</span>):</span></span><br><span class="line">        has_letter = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> self.password:</span><br><span class="line">            <span class="keyword">if</span> c.isalpha():</span><br><span class="line">                has_letter = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> has_letter</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用，实例化 PassWordTool</span></span><br><span class="line">passwordTool = PassWordTool(password)</span><br><span class="line">passwordTool.verify_password();</span><br><span class="line">print(<span class="string">&quot;密码强度：&#123;&#125; &quot;</span>.<span class="built_in">format</span>(passwordTool.level))</span><br></pre></td></tr></table></figure><blockquote><p>文件工具类</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileTool</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, filepath</span>):</span></span><br><span class="line">        self.filepath = filepath</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_to_file</span>(<span class="params">self, line</span>):</span></span><br><span class="line">        f = <span class="built_in">open</span>(self.filepath, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        f.write(line)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_from_file</span>(<span class="params">self</span>):</span></span><br><span class="line">        f = <span class="built_in">open</span>(self.filepath, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        lins = f.readlines()</span><br><span class="line">        f.close()</span><br><span class="line">        <span class="keyword">return</span> lines   </span><br><span class="line"></span><br><span class="line"><span class="comment">#调用，实例化 FileTool</span></span><br><span class="line">fileTool = FileTool(<span class="string">&quot;d:\password.txt&quot;</span>)</span><br><span class="line">line = <span class="string">&quot;密码：&#123;&#125;, 强度：&#123;&#125; \n&quot;</span>.<span class="built_in">format</span>(password, passwordTool.level)</span><br><span class="line">fileTool.write_to_file(line)</span><br><span class="line"></span><br><span class="line">lines = fileTool.read_from_file();</span><br><span class="line">print(<span class="string">&quot;文本内容为：\n &#123;&#125;&quot;</span>.<span class="built_in">format</span>(lines))</span><br></pre></td></tr></table></figure><pre><code>面向对象的特点：封装 -&gt; 数据及相关操作打包，支持代码复用继承 -&gt; 子类借用父类的行为，避免重复操作         定义：class ClassName(SuperClassName)多态 -&gt; 在不同情况下用一个函数名启用不同方法，增强灵活性</code></pre>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 判断天数</title>
      <link href="2019/09/09/python/Python%20%E5%88%A4%E6%96%AD%E5%A4%A9%E6%95%B0/"/>
      <url>2019/09/09/python/Python%20%E5%88%A4%E6%96%AD%E5%A4%A9%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_leap_year</span>(<span class="params">year</span>):</span></span><br><span class="line">    <span class="comment">#判断是否闰年</span></span><br><span class="line">    is_leap = <span class="literal">False</span>;</span><br><span class="line">    <span class="keyword">if</span> year %<span class="number">4</span>==<span class="number">0</span> <span class="keyword">and</span> year %<span class="number">100</span> !=<span class="number">0</span> <span class="keyword">or</span> year %<span class="number">400</span> ==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    input_data_str = <span class="built_in">input</span>(<span class="string">&quot;请输入日期（yyyy/mm/dd）:&quot;</span>)</span><br><span class="line">    input_data = datetime.datetime.strptime(input_data_str, <span class="string">&quot;%Y/%m/%d&quot;</span>)</span><br><span class="line">    <span class="comment">#print(input_data)</span></span><br><span class="line"></span><br><span class="line">    year = input_data.year</span><br><span class="line">    month = input_data.month</span><br><span class="line">    day = input_data.day</span><br><span class="line"></span><br><span class="line">    <span class="comment">#使用元组</span></span><br><span class="line">    days_in_month_tup = (<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>)</span><br><span class="line">    <span class="comment">#计算月份天数总和</span></span><br><span class="line">    days = <span class="built_in">sum</span>(days_in_month_tup[:month-<span class="number">1</span>]) + day</span><br><span class="line">    <span class="keyword">if</span> month&gt;=<span class="number">2</span> <span class="keyword">and</span> is_leap_year(year):</span><br><span class="line">        days+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#使用列表</span></span><br><span class="line">    days_in_month_list = [<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>]</span><br><span class="line">    <span class="keyword">if</span> is_leap_year(year):</span><br><span class="line">        days_in_month_list[<span class="number">1</span>] = <span class="number">29</span></span><br><span class="line">    <span class="comment">#计算月份天数总和</span></span><br><span class="line">    days = <span class="built_in">sum</span>(days_in_month[:month-<span class="number">1</span>]) + day</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;&#123;0&#125;, 这是第 &#123;1&#125; 天&quot;</span>.<span class="built_in">format</span>(input_data_str,days))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h4><pre><code>示例：（&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;）(2,5,67,8,9)一旦被创建就不能被改变，元组元素可以是不同类型的，列表通常由相同类型数据组成元素存在先后关系，可以通过索引访问元组中的元素元组表示结构，列表表示顺序</code></pre><h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><pre><code>0或多个无序的组合，元素不可重复不可以通过索引获取元素set()函数用于集合的生成，集合表示成员间的关系、元素去重</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s = &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;</span><br><span class="line">t = &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line">s - <span class="number">7</span> </span><br><span class="line"><span class="comment"># -&gt;  4,6</span></span><br><span class="line"></span><br><span class="line">s &amp; t</span><br><span class="line"><span class="comment"># -&gt;  1,8</span></span><br><span class="line"></span><br><span class="line">s | t</span><br><span class="line"><span class="comment"># -&gt;  1,3,4,6,7,8</span></span><br><span class="line"></span><br><span class="line">s ^ t</span><br><span class="line"><span class="comment"># -&gt;  3,4,6,7</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_days_in_month</span>(<span class="params">year,month</span>):</span></span><br><span class="line">    <span class="keyword">if</span> month <span class="keyword">in</span> &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>&#125;:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">31</span></span><br><span class="line">    <span class="keyword">elif</span> month <span class="keyword">in</span> &#123;<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>&#125;:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">30</span></span><br><span class="line">    <span class="keyword">elif</span> is_leap_year(year):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">29</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">28</span></span><br></pre></td></tr></table></figure><h4 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h4><pre><code>“键-值” 组合，通过映射查找数据项映射：通过任意键查找集合中的值得过程字典类型以键为索引，一个键对应一个值，字典类型的数据是无序的</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">&quot;Eggs&quot;</span>:<span class="number">2.59</span>, <span class="string">&quot;Milk&quot;</span>:<span class="number">3.16</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 增加</span></span><br><span class="line">dic[<span class="string">&quot;Cheese&quot;</span>] = <span class="number">4.80</span></span><br><span class="line"><span class="comment"># -&gt; &#123;&quot;Eggs&quot;:2.59, &quot;Milk&quot;:3.16, &quot;Cheese&quot;:4.80&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问</span></span><br><span class="line">print(dic[<span class="string">&quot;Eggs&quot;</span>])</span><br><span class="line"><span class="comment"># -&gt; 2.59</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改</span></span><br><span class="line">dic[<span class="string">&quot;Eggs&quot;</span>] = <span class="number">8.80</span></span><br><span class="line"><span class="comment"># -&gt; &#123;&quot;Eggs&quot;:8.80, &quot;Milk&quot;:3.16, &quot;Cheese&quot;:4.80&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line"><span class="keyword">del</span> dic[<span class="string">&quot;Eggs&quot;</span>]</span><br><span class="line"><span class="comment"># -&gt; &#123;&quot;Milk&quot;:3.16, &quot;Cheese&quot;:4.80&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否存在</span></span><br><span class="line">“Eggs” <span class="keyword">in</span> dic</span><br><span class="line"><span class="comment"># -&gt; False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有的 key</span></span><br><span class="line">dic.keys()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有的 values</span></span><br><span class="line">dic.values()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历所有的数据项</span></span><br><span class="line">dic.items()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">month_day_dict = &#123;</span><br><span class="line"><span class="number">1</span>:<span class="number">31</span>, <span class="number">2</span>:<span class="number">28</span>, <span class="number">3</span>:<span class="number">31</span>, <span class="number">4</span>:<span class="number">30</span>, <span class="number">5</span>:<span class="number">31</span>, <span class="number">6</span>:<span class="number">30</span>,</span><br><span class="line"><span class="number">7</span>:<span class="number">31</span>, <span class="number">8</span>:<span class="number">31</span>, <span class="number">9</span>:<span class="number">30</span>, <span class="number">10</span>:<span class="number">31</span>, <span class="number">11</span>:<span class="number">30</span>, <span class="number">12</span>:<span class="number">31</span></span><br><span class="line">&#125;</span><br><span class="line">days = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_total_days</span>(<span class="params">year,month</span>):</span></span><br><span class="line">    <span class="keyword">global</span> month_day_dict</span><br><span class="line">    <span class="keyword">global</span> days</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, month):</span><br><span class="line">        days += month_day_dict[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> month&gt;<span class="number">2</span> <span class="keyword">and</span> is_leap_year(year):</span><br><span class="line">        days +=<span class="number">1</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# 多线程编程 - 线程池</title>
      <link href="2019/09/05/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
      <url>2019/09/05/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
      
        <content type="html"><![CDATA[<h4 id="常用技术"><a href="#常用技术" class="headerlink" title="常用技术"></a>常用技术</h4><p>线程池中调用委托<br>向线程池中放入异步操作<br>线程池与并行度<br>实现一个取消选项<br>线程池中使用等待事件处理器和超时<br>计时器<br>BackgroundWorker组件</p><pre><code>线程池中的工作线程都是后台线程保持线程中的操作都是短暂的</code></pre><h4 id="异步编程模型"><a href="#异步编程模型" class="headerlink" title="异步编程模型"></a>异步编程模型</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> delegate <span class="built_in">string</span> <span class="title">RunOnThreadPool</span><span class="params">(out <span class="keyword">int</span> threadId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CallBack</span><span class="params">(IAsyncResult ar)</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;\nstarting a callback ...&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;state passed to a callback: &#123;0&#125;&quot;</span>, ar.AsyncState);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;CallBack is threadpool thread: &#123;0&#125;&quot;</span>, Thread.CurrentThread.IsThreadPoolThread);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;CallBack ThreadPool worker thread id: &#123;0&#125;&quot;</span>, </span><br><span class="line">Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Test</span><span class="params">(out <span class="keyword">int</span> threadId)</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;\nTest Starting ...&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Test is threadpool thread: &#123;0&#125;&quot;</span>, Thread.CurrentThread.IsThreadPoolThread);</span><br><span class="line">    Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">    threadId = Thread.CurrentThread.ManagedThreadId;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">string</span>.Format(<span class="string">&quot;Test ThreadPool worker thread id: &#123;0&#125;&quot;</span>, threadId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestPoolDelegate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId = <span class="number">0</span>;</span><br><span class="line">    RunOnThreadPool poolDelegate = Test;</span><br><span class="line"></span><br><span class="line">    Thread t = <span class="keyword">new</span> Thread(() =&gt; Test(out threadId));</span><br><span class="line">    t.Start();</span><br><span class="line">    t.Join();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;TestPoolDelegate ThreadId: &#123;0&#125;&quot;</span>, threadId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 异步编程模型 APM，推荐使用任务并行库 TPL</span></span><br><span class="line">    IAsyncResult r = poolDelegate.BeginInvoke(out threadId, CallBack, <span class="string">&quot;a delegate asynchronous call&quot;</span>);</span><br><span class="line">    r.AsyncWaitHandle.WaitOne();</span><br><span class="line">    <span class="built_in">string</span> result = poolDelegate.EndInvoke(out threadId, r);</span><br><span class="line">    <span class="comment">// *****************************************************</span></span><br><span class="line">    </span><br><span class="line">    Console.WriteLine(<span class="string">&quot;TestPoolDelegate ThreadPool worker thread id: &#123;0&#125;&quot;</span>, threadId);</span><br><span class="line">    Console.WriteLine(result);</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>向线程池中放入异步操作</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AsyncOperation</span><span class="params">(object state)</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;\n******************************************\n状态: &#123;0&#125;&quot;</span>, state ?? <span class="string">&quot;(null)&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Worker thread id: &#123;0&#125;&quot;</span>, Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">    Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestPoolAsync</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> y = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">string</span> lambdaState = <span class="string">&quot;state 2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    ThreadPool.QueueUserWorkItem(AsyncOperation, <span class="string">&quot;async state&quot;</span>);</span><br><span class="line">    Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    ThreadPool.QueueUserWorkItem(state =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\nOperation state: &#123;0&#125;&quot;</span>, state);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Worker Thread id: &#123;0&#125;&quot;</span>, Thread.CurrentThread.ManagedThreadId);</span><br><span class="line"></span><br><span class="line">        Thread.Sleep(<span class="number">5000</span>);</span><br><span class="line">    &#125;, <span class="string">&quot;lambda state&quot;</span>);</span><br><span class="line"></span><br><span class="line">    ThreadPool.QueueUserWorkItem(_ =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\nOperation state: &#123;0&#125;, &#123;1&#125;&quot;</span>, x + y, lambdaState);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;********** Worker Thread id: &#123;0&#125;&quot;</span>, Thread.CurrentThread.ManagedThreadId);</span><br><span class="line"></span><br><span class="line">        Thread.Sleep(<span class="number">10000</span>);</span><br><span class="line">    &#125;, <span class="string">&quot;lambda _&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 多线程编程 - 线程同步</title>
      <link href="2019/09/05/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/"/>
      <url>2019/09/05/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<h4 id="常用技术"><a href="#常用技术" class="headerlink" title="常用技术"></a>常用技术</h4><p>原子操作<br>Mutex 类<br>SemaphoreSlim 类<br>AutoResetEvent 类<br>ManualResetEventSlim 类<br>CountDownEvent 类<br>Barrier 类<br>ReaderWriterLockSlim 类<br>SpinWait 类</p><h4 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h4><blockquote><p>多线程</p></blockquote><pre><code>线程是程序中一个单一的顺序控制流程.在单个程序中同时运行多个线程完成不同的工作,称为多线程。如果某个线程进行一次长延迟操作， 处理器就切换到另一个线程执行。这样，多个线程的并行(并发)执行隐藏了长延迟，提高了处理器资源利用率，从而提高了整体性能。多线程是为了同步完成多项任务，不是为了提高运行效率，而是为了提高资源使用效率来提高系统的效率</code></pre><blockquote><p>多线程的优势</p></blockquote><pre><code>进程有独立的地址空间，同一进程内的线程共享进程的地址空间。启动一个线程所花费的空间远远小于启动一个进程所花费的空间，而且，线程间彼此切换所需的时间也远远小于进程间切换所需要的时间。</code></pre><blockquote><p>进程</p></blockquote><pre><code>进程,是操作系统进行资源调度和分配的基本单位。是由进程控制块、程序段、数据段三部分组成。一个进程可以包含若干线程(Thread)，线程可以帮助应用程序同时做几件事。在程序被运行后中，系统首先要做的就是为该程序进程建立一个默认线程，然后程序可 以根据需要自行添加或删除相关的线程。它是可并发执行的程序。在一个数据集合上的运行过程，是系统进行资源分配和调度的一个独立单位，也是称活动、路径或任务，它有两方面性质：活动性、并发性。进程可以划分为运行、阻塞、就绪三种状态，并随一定条件而相互转化：就绪--运行，运行--阻塞，阻塞--就绪。</code></pre><blockquote><p>线程(thread)</p></blockquote><pre><code>线程是CPU调度和执行的最小单位。有时被称为轻量级进程(Lightweight Process，LWP)，是程序执行流的最小单元。一个标准的线程由线程ID，当前指令指针(PC)，寄存器集合和堆栈组成。线程是进程中的一个实体，是被系统独立调度和分派的基本单位，线程自己不拥有系统资源，只拥有一点在运行中必不可少的资源，但它可与同属一个进程的其它线程共享进程所拥有的全部资源。一个线程可以创建和撤消另一个线程，同一进程中的多个线程之间可以并发执行。由于线程之间的相互制约，致使线程在运行中呈现出间断性。线程也有就绪、阻塞和运行三种基本状态。</code></pre><blockquote><p>主线程</p></blockquote><pre><code>进程创建时，默认创建一个线程，这个线程就是主线程。主线程是产生其他子线程的线程，同时，主线程必须是最后一个结束执行的线程，它完成各种关闭其他子线程的操作。尽管主线程是程序开始时自动创建的，它也可以通过Thead类对象来控制，通过调用CurrentThread方法获得当前线程的引用</code></pre><blockquote><p>原子操作</p></blockquote><pre><code>在多线程环境中，不会被线程调度机制打断的操作；这种操作一旦开始，就一直运行到结束，中间不会有任何 context switch（上下文切换） System.Threading.Interlocked 静态类</code></pre><blockquote><p>context switch（上下文切换） </p></blockquote><pre><code>在多任务处理系统中，CPU需要处理所有程序的操作，当用户来回切换它们时，需要记录这些程序执行到哪里。上下文切换就是这样一个过程，它允许CPU记录并恢复各种正在运行程序的状态，使它能够完成切换操作。上下文切换过程中的“页码”信息是保存在进程控制块（PCB）中的。即 “切换桢”（switchframe）。在三种情况下可能会发生上下文切换：中断处理，多任务处理，用户态切换。</code></pre><blockquote><p>内核模式</p></blockquote><pre><code>CPU将线程置于阻塞状态,线程挂起时间比较长</code></pre><blockquote><p>用户模式</p></blockquote><pre><code>线程等待时间较短，不用将线程切换到阻塞状态</code></pre><blockquote><p>混合模式</p></blockquote><pre><code>先尝试用户模式，如果等待时间较长，则将线程切换到阻塞状态，以节省CPU资源</code></pre><p>线程同步有：临界区、互斥区、事件、信号量四种方式<br>临界区（Critical Section）、互斥量（Mutex）、信号量（Semaphore）、事件（Event）的区别<br>1、临界区：通过对多线程的串行化来访问公共资源或一段代码，速度快，适合控制数据访问。在任意时刻只允许一个线程对共享资源进行访问，如果有多个线程试图访问公共资源，那么在有一个线程进入后，其他试图访问公共资源的线程将被挂起，并一直等到进入临界区的线程离开，临界区在被释放后，其他线程才可以抢占。<br>2、互斥量：采用互斥对象机制。 只有拥有互斥对象的线程才有访问公共资源的权限，因为互斥对象只有一个，所以能保证公共资源不会同时被多个线程访问。互斥不仅能实现同一应用程序的公共资源安全共享，还能实现不同应用程序的公共资源安全共享<br>3、信号量：它允许多个线程在同一时刻访问同一资源，但是需要限制在同一时刻访问此资源的最大线程数目<br>4、事 件： 通过通知操作的方式来保持线程的同步，还可以方便实现对多个线程的优先级比较的操作</p><h4 id="Interlocked-类"><a href="#Interlocked-类" class="headerlink" title="Interlocked 类"></a>Interlocked 类</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CounterModule</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestCounter</span><span class="params">(CounterBase c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (var i=<span class="number">0</span>; i&lt;<span class="number">100000</span>; i++) &#123;</span><br><span class="line">            c.Increment();</span><br><span class="line">            c.Decrement();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> abstract <span class="class"><span class="keyword">class</span> <span class="title">CounterBase</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> abstract <span class="keyword">void</span> <span class="title">Increment</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> abstract <span class="keyword">void</span> <span class="title">Decrement</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span> :</span> CounterBase</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> _count;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Count</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _count;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Decrement</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            _count--;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Increment</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            _count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CounterNoLock</span> :</span> CounterBase</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> _count;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Count</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _count;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Decrement</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">           Interlocked.Decrement(ref _count);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Increment</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Interlocked.Increment(ref _count);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestInterlocked</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Incorrect counter&quot;</span>);</span><br><span class="line">    Counter c = <span class="keyword">new</span> Counter();</span><br><span class="line"></span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line">    Thread t3 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line"></span><br><span class="line">    t1.Start();</span><br><span class="line">    t2.Start();</span><br><span class="line">    t3.Start();</span><br><span class="line"></span><br><span class="line">    t1.Join();</span><br><span class="line">    t2.Join();</span><br><span class="line">    t3.Join();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;TotalCount:&#123;0&#125;&quot;</span>, c.Count);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;-----------------------&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    Console.WriteLine(<span class="string">&quot;correct counter&quot;</span>);</span><br><span class="line">    CounterNoLock d = <span class="keyword">new</span> CounterNoLock();</span><br><span class="line"></span><br><span class="line">    t1 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line">    t2 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line">    t3 = <span class="keyword">new</span> Thread(() =&gt; TestCounter(c));</span><br><span class="line"></span><br><span class="line">    t1.Start();</span><br><span class="line">    t2.Start();</span><br><span class="line">    t3.Start();</span><br><span class="line"></span><br><span class="line">    t1.Join();</span><br><span class="line">    t2.Join();</span><br><span class="line">    t3.Join();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;TotalCount:&#123;0&#125;&quot;</span>, c.Count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>Interlocked 提供了 Increment、Decrement 和 Add 等基于数据操作的原子方法</code></pre><ul><li>共享打印机</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrinterWithInterlockTest</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 正在使用的打印机</span></span><br><span class="line">    <span class="comment">/// 0代表未使用，1代表正在使用</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> UsingPrinter = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 计算机数量</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> readonly <span class="keyword">int</span> ComputerCount = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 测试</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestPrint</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread thread;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ComputerCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            thread = <span class="keyword">new</span> Thread(MyThreadProc);</span><br><span class="line">            thread.Name = <span class="built_in">string</span>.Format(<span class="string">&quot;Thread&#123;0&#125;&quot;</span>,i);</span><br><span class="line">            Thread.Sleep(random.Next(<span class="number">3</span>));</span><br><span class="line">            thread.Start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 线程执行操作</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyThreadProc</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//使用打印机进行打印</span></span><br><span class="line">        UsePrinter();</span><br><span class="line">        <span class="comment">//当前线程等待1秒</span></span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 使用打印机进行打印</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">UsePrinter</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//检查大引进是否在使用，如果原始值为0，则为未使用，可以进行打印，否则不能打印，继续等待</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> == Interlocked.Exchange(ref UsingPrinter, <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;&#123;0&#125; acquired the lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Code to access a resource that is not thread safe would go here.</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//Simulate some work</span></span><br><span class="line">            Thread.Sleep(<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">            Console.WriteLine(<span class="string">&quot;&#123;0&#125; exiting lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//释放打印机</span></span><br><span class="line">            Interlocked.Exchange(ref UsingPrinter, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;   &#123;0&#125; was denied the lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>共享打印机，使用 lock</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 正在使用的打印机</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> object UsingPrinterLocker = <span class="keyword">new</span> object();</span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 使用打印机进行打印</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UsePrinter</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//临界区</span></span><br><span class="line">    lock (UsingPrinterLocker)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; acquired the lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">        <span class="comment">//模拟打印操作</span></span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; exiting lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>共享打印机，使用 Monitor “监视器”</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 使用打印机进行打印</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UsePrinterWithMonitor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    System.Threading.Monitor.Enter(UsingPrinterLocker);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; acquired the lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">        <span class="comment">//模拟打印操作</span></span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; exiting lock&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">    &#125;</span><br><span class="line">    finally</span><br><span class="line">    &#123;</span><br><span class="line">        System.Threading.Monitor.Exit(UsingPrinterLocker);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>lock 关键字就是用 Monitor 类来实现的，使用 lock 关键字通常比直接使用 Monitor 类更可取，一方面是因为 lock 更简洁，另一方面是因为 lock 确保了即使受保护的代码引发异常，也可以释放基础监视器。这是通过 finally 关键字来实现的，无论是否引发异常它都执行关联的代码块。</code></pre><h4 id="Mutex-类"><a href="#Mutex-类" class="headerlink" title="Mutex 类"></a>Mutex 类</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestMutex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">string</span> MutexName = <span class="string">&quot;CSharpThreadingCookBook&quot;</span>;</span><br><span class="line">    <span class="comment">//定义互斥量</span></span><br><span class="line">    <span class="keyword">using</span> (var m = <span class="keyword">new</span> Mutex(<span class="literal">false</span>, MutexName))&#123;</span><br><span class="line">    <span class="comment">//获取互斥量</span></span><br><span class="line">        <span class="keyword">if</span> (!m.WaitOne(TimeSpan.FromSeconds(<span class="number">5</span>), <span class="literal">false</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Second instance is running!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Running!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//释放Mutex</span></span><br><span class="line">            m.ReleaseMutex();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>Mutex 类，只对一个线程授予对共享资源的独占访问具名的互斥量是全局的操作系统对象，务必正确关闭互斥量。最好使用 using 代码块包裹互斥量对象跨进程，win32封装的，所以它所需要的互操作转换更耗资源。</code></pre><h4 id="SemaphoreSlim-类"><a href="#SemaphoreSlim-类" class="headerlink" title="SemaphoreSlim 类"></a>SemaphoreSlim 类</h4><blockquote><p>信号量，可用于在一个预计等待时间会非常短的进程内进行等待。 SemaphoreSlim 会尽可能多地依赖由公共语言运行时 (CLR) 提供的同步基元。 但是，它也会根据需要提供延迟初始化的、基于内核的等待句柄，以支持等待多个信号量。 SemaphoreSlim 还支持使用取消标记，但它不支持命名信号量或使用等待句柄来进行同步。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestSemaphoreSlim</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> threadName = <span class="string">&quot;Thread&quot;</span> + i;</span><br><span class="line">        <span class="keyword">int</span> secondsToWait = <span class="number">2</span> * (i + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//运行 10 个，不同名称和初始运行时间的线程</span></span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(() =&gt; AccessDataBase(threadName, secondsToWait));</span><br><span class="line">        t.Start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建实例，限制并发线程数量为 4</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SemaphoreSlim m_semaphore = <span class="keyword">new</span> SemaphoreSlim(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AccessDataBase</span><span class="params">(<span class="built_in">string</span> name, <span class="keyword">int</span> seconds)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; 等待访问数据库！&quot;</span>, name);</span><br><span class="line">    m_semaphore.Wait();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; 获得访问数据库的权限！&quot;</span>, name);</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; 访问数据库完成！&quot;</span>, name);</span><br><span class="line">    m_semaphore.Release();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>SemaphoreSlim 类，限制并发线程数量，并不适用 Windows 内核信号量，也不支持进程间同步。因此在跨程序同步的场景下可以使用 Semaphore 类。</code></pre><ul><li>支付流程</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PaymentWithSemaphore</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 声明收银员总数为3个，但是当前空闲的个数为0，可能还没开始上班。</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Semaphore IdleCashiers = <span class="keyword">new</span> Semaphore(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 测试支付过程</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestPay</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ParameterizedThreadStart start = <span class="keyword">new</span> ParameterizedThreadStart(Pay);</span><br><span class="line">        <span class="comment">//假设同时有5个人来买票</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Thread thread = <span class="keyword">new</span> Thread(start);</span><br><span class="line">            thread.Start(i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//主线程等待，让所有的的线程都激活</span></span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="comment">//释放信号量，2个收银员开始上班了或者有两个空闲出来了</span></span><br><span class="line">        IdleCashiers.Release(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// </span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;obj&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Pay</span><span class="params">(object obj)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread &#123;0&#125; begins and waits for the semaphore.&quot;</span>, obj);</span><br><span class="line">        IdleCashiers.WaitOne();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread &#123;0&#125; starts to Pay.&quot;</span>,obj);</span><br><span class="line">        <span class="comment">//结算</span></span><br><span class="line">        Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread &#123;0&#125;: The payment has been finished.&quot;</span>,obj);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread &#123;0&#125;: Release the semaphore.&quot;</span>, obj);</span><br><span class="line">        IdleCashiers.Release();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>同步事件有两种：AutoResetEvent 和 ManualResetEvent。它们之间唯一的不同在于，无论何时，只要 AutoResetEvent 激活线程，它的状态将自动从终止变为非终止。相反，ManualResetEvent 允许它的终止状态激活任意多个线程，只有当它的 Reset 方法被调用时才还原到非终止状态。</p></blockquote><h4 id="AutoResetEvent-类"><a href="#AutoResetEvent-类" class="headerlink" title="AutoResetEvent 类"></a>AutoResetEvent 类</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestAutoResetEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t = <span class="keyword">new</span> Thread(() =&gt; AutoResetProcess(<span class="number">10</span>));</span><br><span class="line">    t.Start();</span><br><span class="line">    </span><br><span class="line">    Console.WriteLine(<span class="string">&quot;等待另一个线程完成工作 ......&quot;</span>);</span><br><span class="line">    m_workerEvent.WaitOne();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;第一个工作完成！&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    Console.WriteLine(<span class="string">&quot;工作运行在主线程 ......&quot;</span>);</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">5</span>));</span><br><span class="line">    m_mainEvent.Set();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;开启第二个线程运行第二个工作 ......&quot;</span>);</span><br><span class="line">    m_workerEvent.WaitOne();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;第二个工作完成！&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> AutoResetEvent m_workerEvent = <span class="keyword">new</span> AutoResetEvent(<span class="literal">false</span>);</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> AutoResetEvent m_mainEvent = <span class="keyword">new</span> AutoResetEvent(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AutoResetProcess</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;开启一个延时工作 ......&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;工作完成！&quot;</span>);</span><br><span class="line">    m_workerEvent.Set();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;等待主线程完成工作！&quot;</span>);</span><br><span class="line">    m_mainEvent.WaitOne();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;开启第二个工作 ......&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;工作完成！&quot;</span>);</span><br><span class="line">    m_workerEvent.Set();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>AutoResetEvent 类，从一个线程向另一个线程发送通知，可以通知等待的线程有某事件发生。AutoResetEvent 构造函数中传入 false，定义了两个实例的初始状态为 unsignaled 意味着任何线程调用这两个对象中的任何一个 WaitOne 方法将会被阻塞，直到我们调用了 Set 方法；如果构造函数中传入 true，定义了两个实例的初始状态为 signaled 线程调用 WaitOne 方法则会被立即执行，然后事件状态自动变成 unsignaled，需要对该实例调用 Set 方法，以便其他线程对该实例调用 WaitOne 方法从而继续执行。类似旋转门，一次只能通过一个</code></pre><ul><li>熬粥、蒸鱼 </li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CookResetEvent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// </span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">private</span> AutoResetEvent resetEvent = <span class="keyword">new</span> AutoResetEvent(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 做饭</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Cook</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread porridgeThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(Porridge));</span><br><span class="line">        porridgeThread.Name = <span class="string">&quot;Porridge&quot;</span>;</span><br><span class="line">        porridgeThread.Start();</span><br><span class="line"></span><br><span class="line">        Thread makeFishThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(MakeFish));</span><br><span class="line">        makeFishThread.Name = <span class="string">&quot;MakeFish&quot;</span>;</span><br><span class="line">        makeFishThread.Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//等待5秒</span></span><br><span class="line">        Thread.Sleep(<span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">        resetEvent.Reset();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 熬粥</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Porridge</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="comment">//选材</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始选材&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//淘米</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始淘米&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//熬制</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始熬制，需要2秒钟&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">        <span class="comment">//需要2秒钟</span></span><br><span class="line">        Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,粥已经做好，锅闲了&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        resetEvent.Set();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 做鱼</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MakeFish</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="comment">//洗鱼</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始洗鱼&quot;</span>,Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//腌制</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始腌制&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//等待锅空闲出来</span></span><br><span class="line">        resetEvent.WaitOne();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//烹调</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,终于有锅了&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,开始做鱼,需要5秒钟&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line">        Thread.Sleep(<span class="number">5000</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Thread:&#123;0&#125;,鱼做好了，好香&quot;</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">        resetEvent.Set();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ManualResetEventSlim"><a href="#ManualResetEventSlim" class="headerlink" title="ManualResetEventSlim"></a>ManualResetEventSlim</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestManualResetEventSlim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(() =&gt; TravelThroughGates(<span class="string">&quot;Thread1&quot;</span>, <span class="number">5</span>));</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(() =&gt; TravelThroughGates(<span class="string">&quot;Thread2&quot;</span>, <span class="number">6</span>));</span><br><span class="line">    Thread t3 = <span class="keyword">new</span> Thread(() =&gt; TravelThroughGates(<span class="string">&quot;Thread3&quot;</span>, <span class="number">7</span>));</span><br><span class="line"></span><br><span class="line">    t1.Start();</span><br><span class="line">    t2.Start();</span><br><span class="line">    t3.Start();</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">6</span>));</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;The gates are now open!&quot;</span>);</span><br><span class="line">    _mainEvent.Set();</span><br><span class="line">    </span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">1</span>));</span><br><span class="line">    _mainEvent.Reset();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;The gates have been closed!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">10</span>));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;The gates are now open for the second!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    _mainEvent.Set();</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;The gates have been closed!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    _mainEvent.Reset();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ManualResetEventSlim _mainEvent = <span class="keyword">new</span> ManualResetEventSlim(<span class="literal">false</span>);</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TravelThroughGates</span><span class="params">(<span class="built_in">string</span> threadName, <span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; falls to sleep&quot;</span>, threadName);</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; waits for the gates to open&quot;</span>, threadName);</span><br><span class="line"></span><br><span class="line">    _mainEvent.Wait();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; enters the gates&quot;</span>, threadName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>类似人群通过大门，set（）大门打开，reset（）大门关闭</code></pre><h4 id="CountDownEvent"><a href="#CountDownEvent" class="headerlink" title="CountDownEvent"></a>CountDownEvent</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestCountdownEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(() =&gt; PerformOperation(<span class="string">&quot;Operation 1 is completed!&quot;</span>, <span class="number">4</span>));</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(() =&gt; PerformOperation(<span class="string">&quot;Operation 2 is completed!&quot;</span>, <span class="number">8</span>));</span><br><span class="line"></span><br><span class="line">    t1.Start();</span><br><span class="line">    t2.Start();</span><br><span class="line"></span><br><span class="line">    _countdown.Wait();</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Both operation have been completed!&quot;</span>);</span><br><span class="line">    _countdown.Dispose();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> CountdownEvent _countdown = <span class="keyword">new</span> CountdownEvent(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PerformOperation</span><span class="params">(<span class="built_in">string</span> msg, <span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(msg);</span><br><span class="line">    _countdown.Signal();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>如果调用 _countdown.Signal() 没达到指定次数，_countdown.Wait() 将会一直等待，请确保使用 CountdownEvent 时，所有线程完成后都要调用 Signal()</code></pre><h4 id="Barrier"><a href="#Barrier" class="headerlink" title="Barrier"></a>Barrier</h4><pre><code>Barrier(a, b)a -&gt; 调用 SignalAndWait() 的次数b -&gt; 回调函数    SignalAndWait() 调用 a 次后，立即执行 b 回调函数</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestBarrier</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(() =&gt; PlayMusic(<span class="string">&quot;侧脸！&quot;</span>, <span class="string">&quot;于果&quot;</span>, <span class="number">5</span>));</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(() =&gt; PlayMusic(<span class="string">&quot;万物生！&quot;</span>, <span class="string">&quot;沙丁丁&quot;</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    Thread t3 = <span class="keyword">new</span> Thread(() =&gt; PlayMusic(<span class="string">&quot;岁月神偷！&quot;</span>, <span class="string">&quot;金玟岐&quot;</span>, <span class="number">6</span>));</span><br><span class="line">    Thread t4 = <span class="keyword">new</span> Thread(() =&gt; PlayMusic(<span class="string">&quot;老谁小谁！&quot;</span>, <span class="string">&quot;天堂乐队&quot;</span>, <span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">    t1.Start();</span><br><span class="line">    t2.Start();</span><br><span class="line">    t3.Start();</span><br><span class="line">    t4.Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PlayMusic</span><span class="params">(<span class="built_in">string</span> name, <span class="built_in">string</span> msg, <span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">    Barrier _barrier = <span class="keyword">new</span> Barrier(<span class="number">2</span>, b =&gt; Console.WriteLine(<span class="string">&quot;End of phase &#123;0&#125;&quot;</span>, </span><br><span class="line">b.CurrentPhaseNumber + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;------------------------------&quot;</span>);</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; starts to &#123;1&#125;&quot;</span>, name, msg);</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(seconds));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;&#123;0&#125; starts to &#123;1&#125;&quot;</span>, name, msg);</span><br><span class="line"></span><br><span class="line">    _barrier.SignalAndWait();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ReaderWriterLockSlim"><a href="#ReaderWriterLockSlim" class="headerlink" title="ReaderWriterLockSlim"></a>ReaderWriterLockSlim</h4><blockquote><p>读取器/编写器锁，允许多个线程同时读取一个资源，但在向该资源写入时要求线程等待以获得独占锁</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestReaderWriterLockSlim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> Thread(Read) &#123; IsBackground = <span class="literal">true</span> &#125;.Start();</span><br><span class="line">    <span class="keyword">new</span> Thread(Read) &#123; IsBackground = <span class="literal">true</span> &#125;.Start();</span><br><span class="line">    <span class="keyword">new</span> Thread(Read) &#123; IsBackground = <span class="literal">true</span> &#125;.Start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Thread(() =&gt; Write(<span class="string">&quot;Thread 1&quot;</span>)) &#123; IsBackground = <span class="literal">true</span> &#125;.Start();</span><br><span class="line">    <span class="keyword">new</span> Thread(() =&gt; Write(<span class="string">&quot;Thread 2&quot;</span>)) &#123; IsBackground = <span class="literal">true</span> &#125;.Start();</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">30</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> ReaderWriterLockSlim _rw = <span class="keyword">new</span> ReaderWriterLockSlim();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; _items = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Reading contents of a dictornary&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            _rw.EnterReadLock();</span><br><span class="line">            foreach (var key in _items.Keys) &#123;</span><br><span class="line">                Thread.Sleep(TimeSpan.FromSeconds(<span class="number">0.2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        finally &#123;</span><br><span class="line">            _rw.ExitReadLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Write</span><span class="params">(<span class="built_in">string</span> threadName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> intNewKey = <span class="keyword">new</span> Random().Next(<span class="number">250</span>);</span><br><span class="line">            _rw.EnterUpgradeableReadLock();</span><br><span class="line">            <span class="keyword">if</span> (!_items.ContainsKey(intNewKey)) &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    _rw.EnterWriteLock();</span><br><span class="line">                    _items[intNewKey] = <span class="number">1</span>;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;new key &#123;0&#125; is added to a dictionary by a &#123;1&#125;&quot;</span>,</span><br><span class="line">                        intNewKey, threadName);</span><br><span class="line">                &#125;</span><br><span class="line">                finally &#123;</span><br><span class="line">                    _rw.ExitWriteLock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Thread.Sleep(TimeSpan.FromSeconds(<span class="number">0.1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            _rw.ExitUpgradeableReadLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>构造一个线程安全的缓存</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 同步Cache</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SynchronizedCache</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> ReaderWriterLockSlim cacheLock = <span class="keyword">new</span> ReaderWriterLockSlim();</span><br><span class="line">    <span class="keyword">private</span> Dictionary&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt; innerCache = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 读取</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Read</span><span class="params">(<span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cacheLock.EnterReadLock();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> innerCache[key];</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            cacheLock.ExitReadLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 添加项</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> key, <span class="built_in">string</span> value)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cacheLock.EnterWriteLock();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            innerCache.Add(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            cacheLock.ExitWriteLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 添加项，有超时限制</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;timeout&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">AddWithTimeout</span><span class="params">(<span class="keyword">int</span> key, <span class="built_in">string</span> value, <span class="keyword">int</span> timeout)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cacheLock.TryEnterWriteLock(timeout))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                innerCache.Add(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">            finally</span><br><span class="line">            &#123;</span><br><span class="line">                cacheLock.ExitWriteLock();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 添加或者更新</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AddOrUpdateStatus <span class="title">AddOrUpdate</span><span class="params">(<span class="keyword">int</span> key, <span class="built_in">string</span> value)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cacheLock.EnterUpgradeableReadLock();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> result = null;</span><br><span class="line">            <span class="keyword">if</span> (innerCache.TryGetValue(key, out result))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (result == value)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> AddOrUpdateStatus.Unchanged;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    cacheLock.EnterWriteLock();</span><br><span class="line">                    <span class="keyword">try</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        innerCache[key] = value;</span><br><span class="line">                    &#125;</span><br><span class="line">                    finally</span><br><span class="line">                    &#123;</span><br><span class="line">                        cacheLock.ExitWriteLock();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> AddOrUpdateStatus.Updated;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                cacheLock.EnterWriteLock();</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    innerCache.Add(key, value);</span><br><span class="line">                &#125;</span><br><span class="line">                finally</span><br><span class="line">                &#123;</span><br><span class="line">                    cacheLock.ExitWriteLock();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> AddOrUpdateStatus.Added;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            cacheLock.ExitUpgradeableReadLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 删除项</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;key&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Delete</span><span class="params">(<span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cacheLock.EnterWriteLock();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            innerCache.Remove(key);</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            cacheLock.ExitWriteLock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// </span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">AddOrUpdateStatus</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Added,</span><br><span class="line">        Updated,</span><br><span class="line">        Unchanged</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="SpinWait-类"><a href="#SpinWait-类" class="headerlink" title="SpinWait 类"></a>SpinWait 类</h4><blockquote><p>轻量同步类型，可以在低级别方案中使用它来避免内核事件所需的高开销的上下文切换和内核转换。 在多核计算机上，当预计资源不会保留很长一段时间时，如果让等待线程以用户模式旋转数十或数百个周期，然后重新尝试获取资源，则效率会更高。 如果在旋转后资源变为可用的，则可以节省数千个周期。 如果资源仍然不可用，则只花费了少量周期，并且仍然可以进行基于内核的等待。 这一旋转-等待的组合有时称为“两阶段等待操作”。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestSpinWait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Console.Write(<span class="string">&quot;Running UserModeWait&quot;</span>);</span><br><span class="line">    <span class="keyword">new</span> Thread(UserModeWait).Start();</span><br><span class="line">    Thread.Sleep(<span class="number">20</span>);</span><br><span class="line">    _isCompleted = <span class="literal">true</span>;</span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">1</span>));</span><br><span class="line">    _isCompleted = <span class="literal">false</span>;</span><br><span class="line">    Console.Write(<span class="string">&quot;Running HybridSpinWait&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Thread(HybridSpinWait).Start();</span><br><span class="line">    Thread.Sleep(<span class="number">20</span>);</span><br><span class="line">    _isCompleted = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">bool</span> _isCompleted = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UserModeWait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!_isCompleted) &#123;</span><br><span class="line">        Console.Write(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Waiting is complete&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HybridSpinWait</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SpinWait w = <span class="keyword">new</span> SpinWait();</span><br><span class="line">    <span class="keyword">while</span> (!_isCompleted)</span><br><span class="line">    &#123;</span><br><span class="line">        w.SpinOnce();</span><br><span class="line">        Console.Write(<span class="string">&quot;\n&quot;</span> + w.NextSpinWillYield);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Waiting is complete&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>无锁堆栈</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LockFreeStack</span>&lt;</span>T&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> Node m_head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> &#123;</span> <span class="keyword">public</span> Node Next; <span class="keyword">public</span> T Value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Push</span><span class="params">(T item)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        SpinWait spin = <span class="keyword">new</span> SpinWait();</span><br><span class="line">        Node node = <span class="keyword">new</span> Node &#123; Value = item &#125;, head;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            head = m_head;</span><br><span class="line">            node.Next = head;</span><br><span class="line">            <span class="keyword">if</span> (Interlocked.CompareExchange(ref m_head, node, head) == head) <span class="keyword">break</span>;</span><br><span class="line">            spin.SpinOnce();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">TryPop</span><span class="params">(out T result)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        result = <span class="keyword">default</span>(T);</span><br><span class="line">        SpinWait spin = <span class="keyword">new</span> SpinWait();</span><br><span class="line"></span><br><span class="line">        Node head;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            head = m_head;</span><br><span class="line">            <span class="keyword">if</span> (head == null) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (Interlocked.CompareExchange(ref m_head, head.Next, head) == head)</span><br><span class="line">            &#123;</span><br><span class="line">                result = head.Value;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            spin.SpinOnce();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 存钱挑战</title>
      <link href="2019/09/05/python/Python%20%E5%AD%98%E9%92%B1%E6%8C%91%E6%88%98/"/>
      <url>2019/09/05/python/Python%20%E5%AD%98%E9%92%B1%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h4 id="存钱挑战"><a href="#存钱挑战" class="headerlink" title="存钱挑战"></a>存钱挑战</h4><pre><code>第一周存钱10块，每一周比上一周多存10块钱，一共存52周</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    totalWeek = <span class="built_in">input</span>(<span class="string">&quot;请输入存钱周数：&quot;</span>)</span><br><span class="line">    week = <span class="number">0</span></span><br><span class="line">    saveMoney = <span class="number">0</span></span><br><span class="line">    totalMoney = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> week &lt; <span class="built_in">int</span>(totalWeek):</span><br><span class="line">            week += <span class="number">1</span></span><br><span class="line">            saveMoney += <span class="number">10</span></span><br><span class="line">            totalMoney += saveMoney</span><br><span class="line">            print(<span class="string">&quot;第 &#123;&#125; 周，存钱 &#123;&#125;，共存钱 &#123;&#125; 块&quot;</span>.<span class="built_in">format</span>(week, saveMoney, totalMoney))</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">&quot;请输入正确的数字！&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;程序异常&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="list-列表"><a href="#list-列表" class="headerlink" title="list 列表"></a>list 列表</h4><pre><code>列表是有序的元素集合，每个元素类型可以不同可以通过索引访问单个元素，list[2]可以通过区间索引访问子列表内容，list[2:4]、list[-3:]list1 + list2 合并两个列表list * n 重复 n 次列表内容len(list) 返回列表长度x in list 检查元素是否在列表中</code></pre><iframe src="https://tool.lu/coderunner/embed/79U.html" style="width:100%;" height="550" frameborder="0" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe><h4 id="list-常用方法"><a href="#list-常用方法" class="headerlink" title="list 常用方法"></a>list 常用方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">2</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">25</span>, <span class="number">13</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#将x添加到列表末尾</span></span><br><span class="line"><span class="built_in">list</span>.append(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># -&gt; [2, 8, 6, 25, 13, 100]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#列表排序</span></span><br><span class="line"><span class="built_in">list</span>.sort();</span><br><span class="line"><span class="comment"># -&gt; [2, 6, 8, 13, 25, 100]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#列表逆序</span></span><br><span class="line"><span class="built_in">list</span>.reverse()</span><br><span class="line"><span class="comment"># -&gt; [100, 25, 13, 8, 6, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回第一次出现元素x的索引值</span></span><br><span class="line"><span class="built_in">list</span>.index(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># -&gt; 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在位置i处插入新元素x</span></span><br><span class="line"><span class="built_in">list</span>.insert(<span class="number">1</span>,<span class="number">8</span>)</span><br><span class="line"><span class="comment"># -&gt; [100, 8, 25, 13, 8, 6, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回列表中元素x的数量</span></span><br><span class="line"><span class="built_in">list</span>.count(<span class="number">8</span>)</span><br><span class="line"><span class="comment"># -&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除第一次出现的元素x</span></span><br><span class="line"><span class="built_in">list</span>.remove(<span class="number">8</span>)</span><br><span class="line"><span class="comment"># -&gt; [100, 25, 13, 8, 6, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回i位置上的数，并且删除列表中i位置上的元素</span></span><br><span class="line"><span class="built_in">list</span>.pop(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># -&gt; 25</span></span><br><span class="line"><span class="comment"># -&gt; [100, 13, 8, 6, 2]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>使用列表，实现存钱挑战</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    totalWeek = <span class="built_in">input</span>(<span class="string">&quot;请输入存钱周数：&quot;</span>)</span><br><span class="line">    week = <span class="number">0</span></span><br><span class="line">    saveMoney = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    money_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> week &lt; <span class="built_in">int</span>(totalWeek):</span><br><span class="line">            week += <span class="number">1</span></span><br><span class="line">            saveMoney += <span class="number">10</span></span><br><span class="line">            money_list.append(saveMoney)</span><br><span class="line">            totalMoney = math.fsum(money_list)</span><br><span class="line">            print(<span class="string">&quot;第 &#123;&#125; 周，存钱 &#123;&#125;，共存钱 &#123;&#125; 块&quot;</span>.<span class="built_in">format</span>(week, saveMoney, totalMoney))</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">&quot;请输入正确的数字！&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;程序异常&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    totalWeek = <span class="built_in">input</span>(<span class="string">&quot;请输入存钱周数：&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    totalMoney = <span class="number">0</span></span><br><span class="line">    money_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(totalWeek)):</span><br><span class="line">            saveMoney = (i+<span class="number">1</span>) * <span class="number">10</span></span><br><span class="line">            money_list.append(saveMoney)</span><br><span class="line">            </span><br><span class="line">            totalMoney = math.fsum(money_list)</span><br><span class="line">            print(<span class="string">&quot;第 &#123;&#125; 周，存钱 &#123;&#125;，共存钱 &#123;&#125; 块&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>, saveMoney, totalMoney))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        print(<span class="string">&quot;请输入正确的数字！&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;程序异常&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;函数内局部变量，totalMoney：&quot;</span>, totalMoney)</span><br><span class="line">    <span class="keyword">return</span> totalMoney</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    totalMoney = <span class="number">0</span>;</span><br><span class="line">    print(<span class="string">&quot;函数外全局变量，totalMoney：&quot;</span>, totalMoney)</span><br><span class="line">    totalMoney = main()</span><br><span class="line">    print(<span class="string">&quot;函数外全局变量，totalMoney，接收函数返回值：&quot;</span>, totalMoney)</span><br></pre></td></tr></table></figure><blockquote><p>range</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">range</span>(<span class="number">15</span>)</span><br><span class="line"><span class="comment"># -&gt; [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]</span></span><br></pre></td></tr></table></figure><h4 id="math-常用方法"><a href="#math-常用方法" class="headerlink" title="math 常用方法"></a>math 常用方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#取大于等于x的最小的整数值</span></span><br><span class="line">math.ceil(<span class="number">4.12</span>) </span><br><span class="line"><span class="comment"># -&gt; 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#floor()取小于等于x的最大的整数值</span></span><br><span class="line">math.floor(<span class="number">4.999</span>) </span><br><span class="line"><span class="comment"># -&gt; 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fmod()得到x/y的余数，其值是一个浮点数</span></span><br><span class="line">math.fmod(<span class="number">20</span>,<span class="number">3</span>) </span><br><span class="line"><span class="comment"># -&gt; 2.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#e表示一个常量</span></span><br><span class="line">math.e </span><br><span class="line"><span class="comment"># -&gt; 2.718281828459045</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#fabs()返回x的绝对值</span></span><br><span class="line">math.factorial(-<span class="number">0.03</span>) </span><br><span class="line"><span class="comment"># -&gt; 0.03</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#factorial()取x的阶乘的值</span></span><br><span class="line">math.factorial(<span class="number">3</span>) </span><br><span class="line"><span class="comment"># -&gt; 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#isnan()如果x不是数字True,否则返回False</span></span><br><span class="line">math.isnan(<span class="number">23</span>) </span><br><span class="line"><span class="comment"># -&gt; False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pow()返回x的y次方</span></span><br><span class="line">math.<span class="built_in">pow</span>(<span class="number">3</span>,<span class="number">4</span>) </span><br><span class="line"><span class="comment"># -&gt; 81.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#trunc()返回x的整数部分</span></span><br><span class="line">math.trunc(<span class="number">6.789</span>) </span><br><span class="line"><span class="comment"># -&gt; 6</span></span><br></pre></td></tr></table></figure><h4 id="datetime"><a href="#datetime" class="headerlink" title="datetime"></a>datetime</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment">#获取当前日期和时间</span></span><br><span class="line">datetime.datetime.now()</span><br><span class="line"></span><br><span class="line"><span class="comment">#解析时间字符串</span></span><br><span class="line">datetime.datetime.strptime(<span class="string">&quot;2017-08-05&quot;</span>, <span class="built_in">format</span>(<span class="string">&quot;%Y-%m-%d&quot;</span>))</span><br><span class="line"><span class="comment"># -&gt; datetime.datetime(2017, 8, 5, 0, 0)</span></span><br><span class="line"></span><br><span class="line">datetime.datetime.strftime(now, <span class="string">&quot;%d/%m/%Y&quot;</span>)</span><br><span class="line"><span class="comment"># -&gt; &quot;05/08/2017&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#返回年，周数，周几</span></span><br><span class="line">isocalendar()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python BMR计算器</title>
      <link href="2019/09/05/python/Python%20BMR%E8%AE%A1%E7%AE%97%E5%99%A8/"/>
      <url>2019/09/05/python/Python%20BMR%E8%AE%A1%E7%AE%97%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="基础代谢率"><a href="#基础代谢率" class="headerlink" title="基础代谢率"></a>基础代谢率</h4><pre><code>BMR（男） = （13.7*体重（kg））+（5.0*身高（cm））-（6.8*年龄）+ 66BMR（女） = （9.6*体重（kg））+（1.8*身高（公分））-（4.7*年龄）+ 655</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    gender = <span class="built_in">input</span>(<span class="string">&quot;请输入性别：&quot;</span>);</span><br><span class="line">    weight = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入体重（kg）：&quot;</span>));</span><br><span class="line"></span><br><span class="line">    height = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入身高（cm）：&quot;</span>));</span><br><span class="line">    age = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入年龄：&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gender == <span class="string">&quot;男&quot;</span>:</span><br><span class="line">        bmr = (<span class="number">13.7</span>*weight) + (<span class="number">5.0</span>*height) - (<span class="number">6.8</span>*age) + <span class="number">66</span></span><br><span class="line">    <span class="keyword">elif</span> gender == <span class="string">&quot;女&quot;</span>:</span><br><span class="line">        bmr = (<span class="number">9.6</span>*weight) + (<span class="number">1.8</span>*height) - (<span class="number">4.7</span>*age) + <span class="number">655</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bmr = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> bmr!=-<span class="number">1</span>:</span><br><span class="line">        print(<span class="string">&quot;BMR 基础代谢率：&quot;</span>, bmr)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;不支持该性别计算！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><iframe src="https://tool.lu/coderunner/embed/79U.html" style="width:100%;" height="550" frameborder="0" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe><h4 id="综合示例"><a href="#综合示例" class="headerlink" title="综合示例"></a>综合示例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    quit = <span class="built_in">input</span>(<span class="string">&quot;是否退出y/n：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> quit != <span class="string">&quot;y&quot;</span>:</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&quot;请输入以下信息，用空格分割&quot;</span>)</span><br><span class="line">        param = <span class="built_in">input</span>(<span class="string">&quot;性别 体重（kg） 身高（cm） 年龄：&quot;</span>)</span><br><span class="line"></span><br><span class="line">        params = param.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            gender = params[<span class="number">0</span>]</span><br><span class="line">            weight = <span class="built_in">float</span>(params[<span class="number">1</span>])</span><br><span class="line">            height = <span class="built_in">float</span>(params[<span class="number">2</span>])</span><br><span class="line">            age = <span class="built_in">int</span>(params[<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> gender == <span class="string">&quot;男&quot;</span>:</span><br><span class="line">                bmr = (<span class="number">13.7</span>*weight) + (<span class="number">5.0</span>*height) - (<span class="number">6.8</span>*age) + <span class="number">66</span></span><br><span class="line">            <span class="keyword">elif</span> gender == <span class="string">&quot;女&quot;</span>:</span><br><span class="line">                bmr = (<span class="number">9.6</span>*weight) + (<span class="number">1.8</span>*height) - (<span class="number">4.7</span>*age) + <span class="number">655</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bmr = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> bmr!=-<span class="number">1</span>:</span><br><span class="line">                print(<span class="string">&quot;您的性别：&#123;&#125;，体重：&#123;&#125; kg，身高：&#123;&#125; cm，年龄：&#123;&#125;，岁。&quot;</span>.<span class="built_in">format</span>(gender, weight, height, age))</span><br><span class="line">                print(<span class="string">&quot;BMR 基础代谢率：&#123;&#125; 大卡&quot;</span>.<span class="built_in">format</span>(bmr))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">&quot;不支持该性别计算！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            print(<span class="string">&quot;请输入正确的信息！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> IndexError:</span><br><span class="line">            print(<span class="string">&quot;输入信息参数不足！&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            print(<span class="string">&quot;程序异常！&quot;</span>);</span><br><span class="line"></span><br><span class="line">        quit = <span class="built_in">input</span>(<span class="string">&quot;是否退出y/n：&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="字符串分割"><a href="#字符串分割" class="headerlink" title="字符串分割"></a>字符串分割</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;男 75 180 26&quot;</span></span><br><span class="line">strs = <span class="built_in">str</span>.split(<span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据类型转化</span></span><br><span class="line">a = <span class="built_in">float</span>(<span class="string">&quot;3242.25&quot;</span>)</span><br><span class="line">b = <span class="built_in">int</span>(<span class="string">&quot;234&quot;</span>)</span><br><span class="line"><span class="comment">#获取数据类型</span></span><br><span class="line"><span class="built_in">type</span>(a)</span><br><span class="line"><span class="built_in">type</span>(b)</span><br></pre></td></tr></table></figure><h4 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;您的性别：&#123;&#125;，体重：&#123;&#125; kg，身高：&#123;&#125; cm，年龄：&#123;&#125;，岁。&quot;</span>.<span class="built_in">format</span>(gender, weight, height, age)</span><br><span class="line"><span class="string">&quot;您的基础代谢率：&#123;&#125; 大卡&quot;</span>.<span class="built_in">format</span>(bmr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;格式化顺序：&#123;0&#125; &#123;2&#125; &#123;1&#125; &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line"><span class="comment"># -&gt; 5 15 10 5</span></span><br></pre></td></tr></table></figure><h4 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  <span class="comment">#代码段</span></span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">  print(<span class="string">&quot;错误信息&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> IndexError:</span><br><span class="line">  print(<span class="string">&quot;错误信息&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">  print(<span class="string">&quot;错误信息&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 分形树绘制</title>
      <link href="2019/09/03/python/Python%20%E5%88%86%E5%9E%8B%E6%A0%91%E7%BB%98%E5%88%B6/"/>
      <url>2019/09/03/python/Python%20%E5%88%86%E5%9E%8B%E6%A0%91%E7%BB%98%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="绘制五角星"><a href="#绘制五角星" class="headerlink" title="绘制五角星"></a>绘制五角星</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引用第三方图形绘制库，时间库</span></span><br><span class="line"><span class="keyword">import</span> turtle</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="comment">#绘制画布</span></span><br><span class="line">    turtle.screensize(<span class="number">800</span>,<span class="number">600</span>, <span class="string">&quot;OldLace&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#设置画笔属性，线宽，黄色，图形填充红色</span></span><br><span class="line">    turtle.pensize(<span class="number">2</span>)</span><br><span class="line">    turtle.pencolor(<span class="string">&quot;yellow&quot;</span>)</span><br><span class="line">    turtle.fillcolor(<span class="string">&quot;red&quot;</span>)</span><br><span class="line">  </span><br><span class="line">    turtle.begin_fill()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#循环5次，线长200，向右旋转144°</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">      turtle.forward(<span class="number">200</span>)</span><br><span class="line">      turtle.right(<span class="number">144</span>)</span><br><span class="line"></span><br><span class="line">    turtle.end_fill()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#延迟2秒</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment">#画笔抬起，移动到（-180，-120）</span></span><br><span class="line">    turtle.penup()</span><br><span class="line">    turtle.goto(-<span class="number">180</span>,-<span class="number">120</span>)</span><br><span class="line">    turtle.color(<span class="string">&quot;RoyalBlue&quot;</span>) <span class="comment">#设置文字颜色</span></span><br><span class="line">    turtle.write(<span class="string">&quot;绘制完成！&quot;</span>, font=(<span class="string">&#x27;Arial&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;normal&#x27;</span>)) <span class="comment">#设置书写内容，字体，字号</span></span><br><span class="line">  </span><br><span class="line">    turtle.exitonclick()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main();</span><br></pre></td></tr></table></figure><blockquote><p>turtle 方向</p></blockquote><pre><code>           左侧 y            |后退 ---------------- 前进 x            |           右侧</code></pre><blockquote><p>绘制多个五角星，由小及大</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DrawPentagram</span>(<span class="params">size</span>):</span></span><br><span class="line">    count=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; <span class="number">5</span>:</span><br><span class="line">        turtle.forward(size)</span><br><span class="line">        turtle.right(<span class="number">144</span>)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#迭代实现</span></span><br><span class="line">    size+=<span class="number">50</span></span><br><span class="line">    <span class="keyword">if</span> size &lt;= <span class="number">200</span>:</span><br><span class="line">        DrawPentagram(size)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    turtle.penup()</span><br><span class="line">    turtle.backward(<span class="number">100</span>)</span><br><span class="line">    turtle.pendown()</span><br><span class="line"></span><br><span class="line">    size = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#循环实现</span></span><br><span class="line">    <span class="keyword">while</span> size&lt;=<span class="number">200</span>:</span><br><span class="line">        size+=<span class="number">50</span></span><br><span class="line">        DrawPentagram(size)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#迭代实现</span></span><br><span class="line">    DrawPentagram(size)</span><br><span class="line"></span><br><span class="line">    turtle.exitonclick()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><iframe src="https://tool.lu/coderunner/embed/79U.html" style="width:100%;" height="550" frameborder="0" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe><h4 id="分形树"><a href="#分形树" class="headerlink" title="分形树"></a>分形树</h4><ul><li>客观事物具有自相似的层次结构。自相似性：局部是整体的比例缩放</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FractalBranch</span>(<span class="params">branchLen</span>):</span></span><br><span class="line">    <span class="keyword">if</span> branchLen &gt; <span class="number">5</span>:</span><br><span class="line">        turtle.forward(branchLen)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#右分支</span></span><br><span class="line">        turtle.right(<span class="number">20</span>)</span><br><span class="line">        FractalBranch(branchLen - <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#左分支</span></span><br><span class="line">        turtle.left(<span class="number">40</span>)</span><br><span class="line">        FractalBranch(branchLen - <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#回退主干</span></span><br><span class="line">        turtle.right(<span class="number">20</span>)</span><br><span class="line">        turtle.backward(branchLen)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span> </span><br><span class="line">    turtle.penup()</span><br><span class="line">    turtle.backward(<span class="number">25</span>)</span><br><span class="line">    turtle.left(<span class="number">90</span>)</span><br><span class="line">    turtle.backward(<span class="number">220</span>)</span><br><span class="line">    turtle.pendown()</span><br><span class="line"></span><br><span class="line">    FractalBranch(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    turtle.exitonclick()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Python 时钟</title>
      <link href="2019/09/03/python/Python%20%E7%BB%98%E5%88%B6%E6%97%B6%E9%92%9F/"/>
      <url>2019/09/03/python/Python%20%E7%BB%98%E5%88%B6%E6%97%B6%E9%92%9F/</url>
      
        <content type="html"><![CDATA[<h4 id="绘制时钟"><a href="#绘制时钟" class="headerlink" title="绘制时钟"></a>绘制时钟</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> *</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 抬起画笔，向前运动一段距离放下</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Skip</span>(<span class="params">step</span>):</span></span><br><span class="line">    turtle.penup()</span><br><span class="line">    turtle.forward(step)</span><br><span class="line">    turtle.pendown()</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mkHand</span>(<span class="params">name, length</span>):</span></span><br><span class="line">    <span class="comment"># 注册Turtle形状，建立表针Turtle</span></span><br><span class="line">    turtle.reset()</span><br><span class="line">    Skip(-length * <span class="number">0.1</span>)</span><br><span class="line">    <span class="comment"># 开始记录多边形的顶点。当前的乌龟位置是多边形的第一个顶点。</span></span><br><span class="line">    turtle.begin_poly()</span><br><span class="line">    turtle.forward(length * <span class="number">1.1</span>)</span><br><span class="line">    <span class="comment"># 停止记录多边形的顶点。当前的乌龟位置是多边形的最后一个顶点。将与第一个顶点相连。</span></span><br><span class="line">    turtle.end_poly()</span><br><span class="line">    <span class="comment"># 返回最后记录的多边形。</span></span><br><span class="line">    handForm = turtle.get_poly()</span><br><span class="line">    turtle.register_shape(name, handForm)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Init</span>():</span></span><br><span class="line">    <span class="keyword">global</span> secHand, minHand, hurHand, printer</span><br><span class="line">    <span class="comment"># 重置Turtle指向北</span></span><br><span class="line">    turtle.mode(<span class="string">&quot;logo&quot;</span>)</span><br><span class="line">    <span class="comment"># 建立三个表针Turtle并初始化</span></span><br><span class="line">    mkHand(<span class="string">&quot;secHand&quot;</span>, <span class="number">135</span>)</span><br><span class="line">    mkHand(<span class="string">&quot;minHand&quot;</span>, <span class="number">125</span>)</span><br><span class="line">    mkHand(<span class="string">&quot;hurHand&quot;</span>, <span class="number">90</span>)</span><br><span class="line">    secHand = turtle.Turtle()</span><br><span class="line">    secHand.shape(<span class="string">&quot;secHand&quot;</span>)</span><br><span class="line">    minHand = turtle.Turtle()</span><br><span class="line">    minHand.shape(<span class="string">&quot;minHand&quot;</span>)</span><br><span class="line">    hurHand = turtle.Turtle()</span><br><span class="line">    hurHand.shape(<span class="string">&quot;hurHand&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> hand <span class="keyword">in</span> secHand, minHand, hurHand:</span><br><span class="line">        hand.shapesize(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line">        hand.speed(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 建立输出文字Turtle</span></span><br><span class="line">    printer = turtle.Turtle()</span><br><span class="line">    <span class="comment"># 隐藏画笔的turtle形状</span></span><br><span class="line">    printer.hideturtle()</span><br><span class="line">    printer.penup()</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SetupClock</span>(<span class="params">radius</span>):</span></span><br><span class="line">    <span class="comment"># 建立表的外框</span></span><br><span class="line">    turtle.reset()</span><br><span class="line">    turtle.pensize(<span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">        Skip(radius)</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">            turtle.forward(<span class="number">20</span>)</span><br><span class="line">            Skip(-radius - <span class="number">20</span>)</span><br><span class="line">            </span><br><span class="line">            Skip(radius + <span class="number">20</span>)</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                turtle.write(<span class="built_in">int</span>(<span class="number">12</span>), align=<span class="string">&quot;center&quot;</span>, font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">30</span>:</span><br><span class="line">                Skip(<span class="number">25</span>)</span><br><span class="line">                turtle.write(<span class="built_in">int</span>(i/<span class="number">5</span>), align=<span class="string">&quot;center&quot;</span>, font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">                Skip(-<span class="number">25</span>)</span><br><span class="line">            <span class="keyword">elif</span> (i == <span class="number">25</span> <span class="keyword">or</span> i == <span class="number">35</span>):</span><br><span class="line">                Skip(<span class="number">20</span>)</span><br><span class="line">                turtle.write(<span class="built_in">int</span>(i/<span class="number">5</span>), align=<span class="string">&quot;center&quot;</span>, font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">                Skip(-<span class="number">20</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                turtle.write(<span class="built_in">int</span>(i/<span class="number">5</span>), align=<span class="string">&quot;center&quot;</span>, font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">            Skip(-radius - <span class="number">20</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            turtle.dot(<span class="number">5</span>)</span><br><span class="line">            Skip(-radius)</span><br><span class="line">        turtle.right(<span class="number">6</span>)</span><br><span class="line">         </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Week</span>(<span class="params">t</span>):</span>  </span><br><span class="line">    week = [<span class="string">&quot;星期一&quot;</span>, <span class="string">&quot;星期二&quot;</span>, <span class="string">&quot;星期三&quot;</span>,</span><br><span class="line">            <span class="string">&quot;星期四&quot;</span>, <span class="string">&quot;星期五&quot;</span>, <span class="string">&quot;星期六&quot;</span>, <span class="string">&quot;星期日&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> week[t.weekday()]</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Date</span>(<span class="params">t</span>):</span></span><br><span class="line">    y = t.year</span><br><span class="line">    m = t.month</span><br><span class="line">    d = t.day</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;%s %d%d&quot;</span> % (y, m, d)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Tick</span>():</span></span><br><span class="line">    <span class="comment"># 绘制表针的动态显示</span></span><br><span class="line">    t = datetime.today()</span><br><span class="line">    second = t.second + t.microsecond * <span class="number">0.000001</span></span><br><span class="line">    minute = t.minute + second / <span class="number">60.0</span></span><br><span class="line">    hour = t.hour + minute / <span class="number">60.0</span></span><br><span class="line">    secHand.setheading(<span class="number">6</span> * second)</span><br><span class="line">    minHand.setheading(<span class="number">6</span> * minute)</span><br><span class="line">    hurHand.setheading(<span class="number">30</span> * hour)</span><br><span class="line">     </span><br><span class="line">    turtle.tracer(<span class="literal">False</span>)</span><br><span class="line">    printer.forward(<span class="number">65</span>)</span><br><span class="line">    printer.write(Week(t), align=<span class="string">&quot;center&quot;</span>,</span><br><span class="line">                  font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">    printer.back(<span class="number">130</span>)</span><br><span class="line">    printer.write(Date(t), align=<span class="string">&quot;center&quot;</span>,</span><br><span class="line">                  font=(<span class="string">&quot;Courier&quot;</span>, <span class="number">14</span>, <span class="string">&quot;bold&quot;</span>))</span><br><span class="line">    printer.home()</span><br><span class="line">    turtle.tracer(<span class="literal">True</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 100ms后继续调用tick</span></span><br><span class="line">    turtle.ontimer(Tick, <span class="number">100</span>)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="comment"># 打开/关闭龟动画，并为更新图纸设置延迟。</span></span><br><span class="line">    turtle.tracer(<span class="literal">False</span>)</span><br><span class="line">    Init()</span><br><span class="line">    SetupClock(<span class="number">160</span>)</span><br><span class="line">    turtle.tracer(<span class="literal">True</span>)</span><br><span class="line">    Tick()</span><br><span class="line">    turtle.mainloop()</span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# 多线程编程 - 基本用法</title>
      <link href="2019/09/02/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
      <url>2019/09/02/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%20-%20%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h4 id="创建线程"><a href="#创建线程" class="headerlink" title="创建线程"></a>创建线程</h4><details>    <summary>创建线程</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintNumbers</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;PrintNumbers 方法调用 ********************&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (var i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;PrintNumbers: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(Print.PrintNumbers);</span><br><span class="line">        Thread s = <span class="keyword">new</span> Thread(Print.PrintNumbersWithDelay);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;s 线程 调用：PrintNumbersWithDelay&quot;</span>);</span><br><span class="line">        s.Start();</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;t 线程 调用：PrintNumbers&quot;</span>);</span><br><span class="line">        t.Start();</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主 线程 调用：PrintNumbers&quot;</span>);</span><br><span class="line">        Print.PrintNumbers();</span><br><span class="line"></span><br><span class="line">        Console.ReadLine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>正在执行中的程序实例可被称为一个进程。</li><li>进程由一个或多个线程组成</li><li>意味着当运行程序时，始终有一个执行程序代码的主线程</li><li>当我们构造一个线程时，ThreadStart 或 ParameterizedThreadStart 的实例委托会传给构造函数，我们只需指定在不同线程中运行的方法名，C#编译器后台创建这些对象。</li></ul></details><blockquote><p>创建线程多种方式</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 创建线程的方式</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateThread</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 不带参数的委托</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CreateThreadWithThreadStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(ThreadCallBack));</span><br><span class="line">        thread.Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 带参数的委托</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CreateThreadWithParamThreadStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ParameterizedThreadStart(ThreadCallBackWithParam));</span><br><span class="line">        Object param = null;</span><br><span class="line">        thread.Start(param);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 匿名函数</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CreateThreadWithAnonymousFunction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(delegate()</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;进入子线程1&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                Thread.Sleep(<span class="number">50</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;\t+++++++子线程1+++++++++&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;退出子线程1&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        thread.Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 直接赋值委托</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CreateThreadWithCallBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread _hThread = <span class="keyword">new</span> Thread(ThreadCallBack);</span><br><span class="line">        _hThread.Start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 无参数的方法调用</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ThreadCallBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Do Something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 带参数的方法</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="comment">/// &lt;param name=&quot;obj&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ThreadCallBackWithParam</span><span class="params">(object obj)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Do Something</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="暂停线程终止线程"><a href="#暂停线程终止线程" class="headerlink" title="暂停线程终止线程"></a>暂停线程终止线程</h4><details>    <summary>暂停线程、线程等待、终止线程</summary><blockquote><p>暂停线程</p></blockquote><pre><code>调用 Thread.Sleep 方法会导致当前线程立即阻止，阻止时间的长度等于传递给 Thread.Sleep 的毫秒数，这样，就会将其时间片中剩余的部分让与另一个线程。 一个线程不能针对另一个线程调用 Thread.Sleep。</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintNumbersWithDelay</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;PrintNumbersWithDelay 方法调用 **************&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;PrintNumbersWithDelay: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>线程等待</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改代码如下</span></span><br><span class="line">s.Start();</span><br><span class="line">s.Join();</span><br></pre></td></tr></table></figure><ul><li>s.Join() 方法，可以实现多个线程间同步执行</li></ul><blockquote><p>终止线程</p></blockquote><pre><code>永久地停止托管线程。一旦线程被中止，它将无法重新启动。</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改代码如下</span></span><br><span class="line"><span class="comment">//s.Join();</span></span><br><span class="line">Thread.Sleep(TimeSpan.FromSeconds(<span class="number">6</span>));</span><br><span class="line">s.Abort();</span><br><span class="line">Console.WriteLine(<span class="string">&quot;s 线程被关闭！&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>s.Abort() 方法，给线程注入了 ThreadAbortException 方法，导致线程被终结</li></ul><pre><code>不推荐使用 Abort 方法来关闭线程原因：该异常可以在任何时候发生，并可能彻底摧毁应用程序     该技术不一定总能终止线程，目标线程可以通过处理该异常并调用 Thread.ResetAbort 方法拒绝被终止</code></pre></details><h4 id="线程状态"><a href="#线程状态" class="headerlink" title="线程状态"></a>线程状态</h4><details>    <summary>线程状态</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintNumbersWithStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;PrintNumbersWithStatus 方法调用 **************&quot;</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\t&quot;</span> + </span><br><span class="line">        Thread.CurrentThread.ThreadState.ToString());</span><br><span class="line">        <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;PrintNumbersWithStatus: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(Print.PrintNumbers);</span><br><span class="line">        Thread d = <span class="keyword">new</span> Thread(Print.PrintNumbersWithDelay);</span><br><span class="line">        Thread s = <span class="keyword">new</span> Thread(Print.PrintNumbersWithStatus);</span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;d 线程 调用：PrintNumbersWithDelay&quot;</span>);</span><br><span class="line">        d.Start();</span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;s 线程 调用：PrintNumbersWithStatus&quot;</span>);</span><br><span class="line">        s.Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//线程等待</span></span><br><span class="line">        <span class="comment">//s.Join();</span></span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//线程终止</span></span><br><span class="line">        Thread.Sleep(TimeSpan.FromSeconds(<span class="number">6</span>));</span><br><span class="line">        s.Abort();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;s 线程被关闭！&quot;</span>);</span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;t 线程 调用：PrintNumbers&quot;</span>);</span><br><span class="line">        t.Start();</span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主 线程 调用：PrintNumbers&quot;</span>);</span><br><span class="line">        Print.PrintNumbers();</span><br><span class="line"></span><br><span class="line">        GetThreadStatus(t, d, s);</span><br><span class="line">        Console.ReadLine();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">GetThreadStatus</span><span class="params">(Thread t, Thread d, Thread s)</span> </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\n\tt.ThreadState: &quot;</span> + t.ThreadState.ToString());</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\td.ThreadState: &quot;</span> + d.ThreadState.ToString());</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\ts.ThreadState: &quot;</span> + </span><br><span class="line">        s.ThreadState.ToString() + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>注意：不要在程序中使用线程终止，以上代码只是演示线程状态</code></pre></details><h4 id="线程优先级"><a href="#线程优先级" class="headerlink" title="线程优先级"></a>线程优先级</h4><details>    <summary>线程优先级</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadSample</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> _isStopped = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        _isStopped = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CountNumbers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> counter = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!_isStopped) &#123;</span><br><span class="line">            counter++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; with &#123;1,11&#125; priority&quot;</span> + </span><br><span class="line">        <span class="string">&quot; has a count = &#123;2,13&#125;&quot;</span>, </span><br><span class="line">        Thread.CurrentThread.Name, </span><br><span class="line">        Thread.CurrentThread.Priority, </span><br><span class="line">        counter.ToString(<span class="string">&quot;N0&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sample</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">RunThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadSample s = <span class="keyword">new</span> ThreadSample();</span><br><span class="line"></span><br><span class="line">        Thread threadOne = <span class="keyword">new</span> Thread(s.CountNumbers);</span><br><span class="line">        threadOne.Name = <span class="string">&quot;ThreadOne&quot;</span>;</span><br><span class="line"></span><br><span class="line">        Thread threadTwo = <span class="keyword">new</span> Thread(s.CountNumbers);</span><br><span class="line">        threadTwo.Name = <span class="string">&quot;ThreadTwo&quot;</span>;</span><br><span class="line"></span><br><span class="line">        threadOne.Priority = ThreadPriority.Highest;</span><br><span class="line">        threadTwo.Priority = ThreadPriority.Lowest;</span><br><span class="line"></span><br><span class="line">        threadOne.Start();</span><br><span class="line">        threadTwo.Start();</span><br><span class="line"></span><br><span class="line">        Thread.Sleep(TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">        s.Stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;当前线程的优先级：&#123;0&#125;&quot;</span>, Thread.CurrentThread.Priority);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Running on all cores available&quot;</span>);</span><br><span class="line"></span><br><span class="line">    Sample.RunThread();</span><br><span class="line"></span><br><span class="line">    Thread.Sleep(TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Running on a single core&quot;</span>);</span><br><span class="line">    Process.GetCurrentProcess().ProcessorAffinity = <span class="keyword">new</span> IntPtr(<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    Sample.RunThread();</span><br><span class="line"></span><br><span class="line">    Console.ReadLine();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>//输出结果当前线程的优先级：NormalRunning on all cores availableThreadOne with     Highest priority has a count = 1,033,257,770ThreadTwo with      Lowest priority has a count =   778,827,478Running on a single coreThreadOne with     Highest priority has a count = 11,519,127,196ThreadTwo with      Lowest priority has a count =    48,656,315</code></pre></details><h4 id="前、后台线程"><a href="#前、后台线程" class="headerlink" title="前、后台线程"></a>前、后台线程</h4><details>    <summary>前、后台线程</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ThreadForeBackground();</span><br><span class="line">    Console.ReadLine();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadSample</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">bool</span> _isStopped = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _isStopped = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> readonly <span class="keyword">int</span> _iterations;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadSample</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadSample</span><span class="params">(<span class="keyword">int</span> iterations)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _iterations = iterations;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CountNumbers</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> counter = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!_isStopped)</span><br><span class="line">        &#123;</span><br><span class="line">            counter++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&#123;0&#125; with &#123;1,11&#125; priority&quot;</span> + </span><br><span class="line">        <span class="string">&quot; has a count = &#123;2,13&#125;&quot;</span>, </span><br><span class="line">        Thread.CurrentThread.Name, </span><br><span class="line">        Thread.CurrentThread.Priority, </span><br><span class="line">        counter.ToString(<span class="string">&quot;N0&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintInterations</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; _iterations; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;&#123;0&#125; prints &#123;1&#125;&quot;</span>,</span><br><span class="line">            Thread.CurrentThread.Name, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ThreadForeBackground</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ThreadSample sampleFore = <span class="keyword">new</span> ThreadSample(<span class="number">10</span>);</span><br><span class="line">        ThreadSample sampleBack = <span class="keyword">new</span> ThreadSample(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">        Thread one = <span class="keyword">new</span> Thread(sampleFore.PrintInterations);</span><br><span class="line">        one.Name = <span class="string">&quot;ForegroundThread&quot;</span>;</span><br><span class="line">        Thread two = <span class="keyword">new</span> Thread(sampleBack.PrintInterations);</span><br><span class="line">        two.Name = <span class="string">&quot;BackgroundThread&quot;</span>;</span><br><span class="line"></span><br><span class="line">        two.IsBackground = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        one.Start();</span><br><span class="line">        two.Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        LogHelper._multithreadingLog.Info(<span class="string">&quot;ThreadForeBackground: &#123;0&#125;&quot;</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li><p>要点：</p><p>  1、当在主线程中创建了一个线程，那么该线程的 IsBackground 默认是设置为 FALSE 的。</p><p>  2、当主线程退出的时候，IsBackground = FALSE 的线程还会继续执行下去，直到线程执行结束。</p><p>  3、只有 IsBackground = TRUE 的线程才会随着主线程的退出而退出。</p><p>  4、当初始化一个线程，把 Thread.IsBackground = true 的时候，指示该线程为后台线程。后台线程将会随着主线程的退出而退出。</p><p>  5、原理：只要所有前台线程都终止后，CLR 就会对每一个活在的后台线程调用 Abort（）来彻底终止应用程序。</p></li></ul><h4 id="线程传参"><a href="#线程传参" class="headerlink" title="线程传参"></a>线程传参</h4><details>    <summary>线程传参</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintNumbers</span><span class="params">(object number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;PrintNumbers 方法调用 ********************&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> numb = number != null? (<span class="keyword">int</span>)number: <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; numb; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;PrintNumbers: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintNumbers</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;带参数的 PrintNumbers 方法调用 ***************&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt; number; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;PrintNumbers: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Start 接受 类型为 Object 的单个参数</span></span><br><span class="line">Thread a = <span class="keyword">new</span> Thread(Print.PrintNumbers);</span><br><span class="line">a.Start(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//实例，构造器传参</span></span><br><span class="line">ThreadSample sampleFore = <span class="keyword">new</span> ThreadSample(<span class="number">10</span>);</span><br><span class="line">Thread b = <span class="keyword">new</span> Thread(sampleFore.PrintInterations);</span><br><span class="line">b.Name = <span class="string">&quot;sampleFore 线程传参：&quot;</span>;</span><br><span class="line">b.Start();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Lambda 传参</span></span><br><span class="line">Thread c = <span class="keyword">new</span> Thread(() =&gt; Print.PrintNumbers(<span class="number">15</span>));</span><br><span class="line">c.Start();</span><br></pre></td></tr></table></figure></details><h4 id="死锁、Monitor-类"><a href="#死锁、Monitor-类" class="headerlink" title="死锁、Monitor 类"></a>死锁、Monitor 类</h4><details>    <summary>锁定、死锁、Monitor 类</summary><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MonitorLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    object lock1 = <span class="keyword">new</span> object();</span><br><span class="line">    object lock2 = <span class="keyword">new</span> object();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Thread(() =&gt; LockTooMuch(lock1, lock2)).Start();</span><br><span class="line"></span><br><span class="line">    lock (lock2) &#123;</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(() =&gt; Print.PrintNumbers(<span class="number">6</span>)).Start();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (Monitor.TryEnter(lock1, TimeSpan.FromSeconds(<span class="number">5</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Monitor.TryEnter 获取成功！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Monitor.TryEnter 获取失败！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">    <span class="comment">//new Thread(() =&gt; LockTooMuch(lock1, lock2)).Start();</span></span><br><span class="line"></span><br><span class="line">    lock (lock2)</span><br><span class="line">    &#123;</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;这将会形成一个死锁！&quot;</span>);</span><br><span class="line">        lock (lock1) &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;lock 获取成功！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">LockTooMuch</span><span class="params">(Object lock1, Object lock2)</span> </span>&#123;</span><br><span class="line">    lock (lock1) &#123;</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">        lock (lock2) &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;线程运行...&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>lock 本质</p></blockquote><pre><code>private object o = new object();public void Work()&#123;　　object temp = o;　　System.Threading.Monitor.Enter(temp);　　try　　&#123;　　　　//做一些需要线程同步的工作　　&#125;　　finally　　&#123;　　　　System.Threading.Monitor.Exit(temp);　　&#125;&#125;    </code></pre></details><pre><code>提供给 lock 关键字的参数必须为基于引用类型的对象，该对象用来定义锁的范围。最好避免锁定 public 类型或锁定不受应用程序控制的对象实例常见的结构 lock (this)、lock (typeof (MyType)) 和 lock (&quot;myLock&quot;) 违反此准则：1）如果实例可以被公共访问，将出现 lock (this) 问题。2）如果 MyType 可以被公共访问，将出现 lock (typeof (MyType)) 问题。3）由于进程中使用同一字符串的任何其他代码将共享同一个锁，所以出现 lock(“myLock”) 问题。最佳做法是定义 private 对象来锁定, 或 private static 对象变量来保护所有实例所共有的数据。</code></pre>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 汇率换算器</title>
      <link href="2019/08/31/python/Python%20%E6%B1%87%E7%8E%87%E6%8D%A2%E7%AE%97%E5%99%A8/"/>
      <url>2019/08/31/python/Python%20%E6%B1%87%E7%8E%87%E6%8D%A2%E7%AE%97%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="数据工程"><a href="#数据工程" class="headerlink" title="数据工程"></a>数据工程</h4><p>采集、存储、清洗、分析、可视化</p><h4 id="Python-特点"><a href="#Python-特点" class="headerlink" title="Python 特点"></a>Python 特点</h4><p>解释型语、语言简洁、跨平台、可扩展、开放源码、多用途、类库丰富</p><h4 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h4><p>Python的科学计算发行版，内置常用库，自动基础最新版MKL，加速运算</p><ul><li><p>命令行 Python不可用</p><p>  需要配置环境变量，添加Python.exe所在目录路径，Scripts目录路径</p></li></ul><p><a href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学镜像站</a></p><h4 id="汇率换算器"><a href="#汇率换算器" class="headerlink" title="汇率换算器"></a>汇率换算器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  将输入的CNY金额，根据汇率，计算出可兑换到的USD金额</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#汇率</span></span><br><span class="line">USDRATE = <span class="number">6.77</span></span><br><span class="line"><span class="comment">#输入CNY</span></span><br><span class="line">strCNY = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入人民币（CNY）金额：&quot;</span>))</span><br><span class="line"><span class="comment">#汇率计算</span></span><br><span class="line">print(<span class="string">&quot;美元（USD）金额是：&quot;</span>, strCNY / USDRATE)</span><br><span class="line"></span><br><span class="line"><span class="comment">#**********************************************************</span></span><br><span class="line"><span class="comment">#将输入的带单位的货币金额，判断货币类型，根据汇率，计算出可兑换的金额</span></span><br><span class="line"></span><br><span class="line">strMoney = <span class="built_in">input</span>(<span class="string">&quot;请输入带单位的货币金额：&quot;</span>)</span><br><span class="line">unit = strMoney[-<span class="number">3</span>:]</span><br><span class="line"><span class="keyword">if</span> unit == <span class="string">&quot;CNY&quot;</span>:</span><br><span class="line">    print(<span class="string">&quot;美元（USD）金额是：&quot;</span>,<span class="built_in">eval</span>(strMoney[:-<span class="number">3</span>])/USDRATE)</span><br><span class="line"><span class="keyword">elif</span> unit == <span class="string">&quot;USD&quot;</span>:</span><br><span class="line">    print(<span class="string">&quot;人民币（CNY）金额是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(strMoney[:-<span class="number">3</span>])*USDRATE))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">&quot;目前版本尚不支持该种货币类型&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#**********************************************************</span></span><br><span class="line"><span class="comment">#将输入的带单位的货币金额，判断货币类型，根据汇率，计算出可兑换的金额，程序一直运行，直到用户输入 Q</span></span><br><span class="line"></span><br><span class="line">strMoney = <span class="built_in">input</span>(<span class="string">&quot;请输入带单位的货币金额（退出程序请输入Q）：&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> strMoney != <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">    unit = strMoney[-<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> unit == <span class="string">&quot;CNY&quot;</span>:</span><br><span class="line">        print(<span class="string">&quot;美元（USD）金额是：&quot;</span>,<span class="built_in">eval</span>(strMoney[:-<span class="number">3</span>])/USDRATE)</span><br><span class="line">    <span class="keyword">elif</span> unit == <span class="string">&quot;USD&quot;</span>:</span><br><span class="line">        print(<span class="string">&quot;人民币（CNY）金额是：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(strMoney[:-<span class="number">3</span>])*USDRATE))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;目前版本尚不支持该种货币类型&quot;</span>)</span><br><span class="line"></span><br><span class="line">    strMoney = <span class="built_in">input</span>(<span class="string">&quot;请输入带单位的货币金额（退出程序请输入Q）：&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;程序已退出！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#**********************************************************</span></span><br><span class="line"><span class="comment">#优化以上代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#汇率转换</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ExchangeRate</span>(<span class="params">unit</span>):</span></span><br><span class="line">    <span class="keyword">if</span> unit == <span class="string">&quot;CNY&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> USDRATE</span><br><span class="line">    <span class="keyword">elif</span> unit == <span class="string">&quot;USD&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>/USDRATE</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#汇率兑换</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ConvertCurrency</span>(<span class="params">im, er</span>):</span></span><br><span class="line">    <span class="keyword">return</span> im * er</span><br><span class="line"></span><br><span class="line"><span class="comment">#主函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    strMoney = <span class="built_in">input</span>(<span class="string">&quot;请输入带单位的货币金额（退出程序请输入Q）：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> strMoney != <span class="string">&quot;Q&quot;</span>:</span><br><span class="line">        unit = strMoney[-<span class="number">3</span>:]</span><br><span class="line">        er = ExchangeRate(unit)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> er != -<span class="number">1</span>:</span><br><span class="line">            <span class="comment">#lambda函数</span></span><br><span class="line">            ConvertCurrencyLamdba = <span class="keyword">lambda</span> x: x * er</span><br><span class="line">            <span class="comment">#调用lambda函数</span></span><br><span class="line">            outMoney = ConvertCurrencyLamdba(<span class="built_in">eval</span>(strMoney[:-<span class="number">3</span>]))</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#outMoney = ConvertCurrency(eval(strMoney[:-3]),er)</span></span><br><span class="line">            print(<span class="string">&quot;金额是：&quot;</span>,outMoney)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;目前版本尚不支持该种货币类型&quot;</span>)</span><br><span class="line"></span><br><span class="line">        strMoney = <span class="built_in">input</span>(<span class="string">&quot;请输入带单位的货币金额（退出程序请输入Q）：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;程序已退出！&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><blockquote><p>代码分析</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; 多行注释 &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 单行注释</span></span><br><span class="line">USDRATE <span class="comment">#常量</span></span><br><span class="line">strCNY  <span class="comment">#变量</span></span><br><span class="line"><span class="built_in">input</span>   <span class="comment">#输入</span></span><br><span class="line"><span class="built_in">eval</span>    <span class="comment">#字符串转数字</span></span><br><span class="line"><span class="built_in">print</span>   <span class="comment">#输出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#条件分支</span></span><br><span class="line"><span class="keyword">if</span> 表达式：</span><br><span class="line">  <span class="comment">#语句</span></span><br><span class="line"><span class="keyword">elif</span> 表达式：</span><br><span class="line">  <span class="comment">#语句</span></span><br><span class="line"><span class="keyword">else</span>：</span><br><span class="line">  <span class="comment">#语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#while 循环</span></span><br><span class="line"><span class="keyword">while</span> 表达式：</span><br><span class="line">  <span class="comment">#语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#def 函数申明</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数名 （参数列表）：</span></span><br><span class="line"><span class="function">  #函数体</span></span><br><span class="line"><span class="function">    <span class="title">return</span> 返回值</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">#<span class="title">lambda</span> 函数</span></span><br><span class="line"><span class="function"><span class="title">lambda</span> 参数列表：表达式</span></span><br></pre></td></tr></table></figure><h4 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;截取前3个字符：&quot;</span>，s[<span class="number">0</span>:<span class="number">3</span>]);</span><br><span class="line">print(<span class="string">&quot;截取前3个字符：&quot;</span>，s[:<span class="number">3</span>]);</span><br><span class="line">print(<span class="string">&quot;截取llo字符：&quot;</span>，s[<span class="number">2</span>:<span class="number">5</span>]);</span><br><span class="line">print(<span class="string">&quot;截取后3个字符：&quot;</span>，s[-<span class="number">3</span>:]);</span><br><span class="line"></span><br><span class="line"><span class="built_in">len</span>(s) <span class="comment">#输出 12</span></span><br><span class="line"><span class="string">&quot;llo&quot;</span> <span class="keyword">in</span> s <span class="comment">#输出 True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>代码分析</p></blockquote><pre><code>#字符串本质 h   e   l   l   0   _   W   o   r   l   d    ! 0   1   2   3   4   5   6   7   8   9   10   11 //正向取值    -12 -11 -10  -9  -8  -7  -6  -5  -4  -3  -2  -1  //反向取值切片（Slicing）[start：finish] 不包含 finish，start不填：从 0 开始；finish不填：到最后[start：finish：countBy] countBy 等差，默认为 1</code></pre><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><ul><li>便于阅读和复用</li><li>对一组表达特定功能表达式的封装</li><li>是程序模块化</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    判断某年某月第一天是星期几</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_leap_year</span>(<span class="params">year</span>):</span></span><br><span class="line">    <span class="keyword">if</span> year %<span class="number">4</span>==<span class="number">0</span> <span class="keyword">and</span> year %<span class="number">100</span> !=<span class="number">0</span> <span class="keyword">or</span> year %<span class="number">400</span> ==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_num_of_days_in_month</span>(<span class="params">year,month</span>):</span></span><br><span class="line">    <span class="keyword">if</span> month <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">31</span></span><br><span class="line">    <span class="keyword">elif</span> month <span class="keyword">in</span> (<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">30</span></span><br><span class="line">    <span class="keyword">elif</span> is_leap_year(year):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">29</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">28</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_total_num_of_day</span>(<span class="params">year,month</span>):</span></span><br><span class="line">    days =<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1800</span>,year):</span><br><span class="line">        <span class="keyword">if</span> is_leap_year(y):</span><br><span class="line">            days+=<span class="number">366</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            days+=<span class="number">365</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,month):</span><br><span class="line">        days += get_num_of_days_in_month(year, m)</span><br><span class="line">    <span class="keyword">return</span> days</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_start_day</span>(<span class="params">year,month</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">3</span>+get_total_num_of_day(year,month))%<span class="number">7</span></span><br><span class="line"></span><br><span class="line">print(get_start_day(<span class="number">2033</span>,<span class="number">12</span>))</span><br></pre></td></tr></table></figure><h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><pre><code>&gt;&gt;&gt; import math //引用模块&gt;&gt;&gt; dir(math)   //查看模块函数[&#39;__doc__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan&#39;, &#39;atan2&#39;, &#39;atanh&#39;, &#39;ceil&#39;, &#39;copysign&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;degrees&#39;, &#39;e&#39;, &#39;erf&#39;, &#39;erfc&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;fabs&#39;, &#39;factorial&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;frexp&#39;, &#39;fsum&#39;, &#39;gamma&#39;, &#39;gcd&#39;, &#39;hypot&#39;, &#39;inf&#39;, &#39;isclose&#39;, &#39;isfinite&#39;, &#39;isinf&#39;, &#39;isnan&#39;, &#39;ldexp&#39;, &#39;lgamma&#39;, &#39;log&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log2&#39;, &#39;modf&#39;, &#39;nan&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;radians&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;tan&#39;, &#39;tanh&#39;, &#39;tau&#39;, &#39;trunc&#39;]</code></pre><blockquote><p>(2 ** 2) ** 3<br>2 ** 2 ** 3<br>&#39;abc&#39; * 3</p></blockquote><pre><code>输出结果：64 256 abcabcabc</code></pre>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>面向对象程序设计</title>
      <link href="2019/08/29/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"/>
      <url>2019/08/29/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h4 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h4><ul><li>单一职责原则：一个类，只有一个引起它变化的原因</li><li>开闭原则：扩展开放，修改封闭</li><li>里氏代替原则：子类必须替换掉它们的父类</li><li>依赖倒置原则：面向接口编程，而不是面向实现编程</li><li>接口隔离原则</li><li>合成复用原则：Has-A 和 Is-A</li><li>迪米特法则：不要和陌生人说话，最少知识原则</li></ul><h4 id="软件系统设计核心"><a href="#软件系统设计核心" class="headerlink" title="软件系统设计核心"></a>软件系统设计核心</h4><p>一个项目有多少类：发现类<br>每个类有什么属性和方法：设计类<br>每个类之间的关系：设计类</p><h4 id="面向对象设计目标"><a href="#面向对象设计目标" class="headerlink" title="面向对象设计目标"></a>面向对象设计目标</h4><p>项目可扩展性，可维护性，更方便</p><h4 id="软件工作流程"><a href="#软件工作流程" class="headerlink" title="软件工作流程"></a>软件工作流程</h4><p>输入（用户界面） -&gt; 运算（业务逻辑） -&gt; 存储（数据库、文件） -&gt; 输出（界面，其他文件）</p><h4 id="软件文档"><a href="#软件文档" class="headerlink" title="软件文档"></a>软件文档</h4><p>需求说明 -&gt; 概要设计 -&gt; 详细设计</p><h4 id="编码过程"><a href="#编码过程" class="headerlink" title="编码过程"></a>编码过程</h4><p>变量 -&gt; 语句 -&gt; 属性+方法 -&gt; 类 -&gt; 模块 -&gt; 功能 -&gt; 子系统 -&gt; 软件整体</p><h4 id="类、对象"><a href="#类、对象" class="headerlink" title="类、对象"></a>类、对象</h4><p>类 -&gt; 对象数据的处理</p><pre><code>类 -&gt; 对象的抽象对象 -&gt; 类的实例化</code></pre><ul><li><p>对象数据</p><p>  静态特征：属性<br>  动态特征：行为，方法<br>  方法为抽象方法。</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span>&#123;</span></span><br><span class="line">  <span class="comment">//字段私有化，主要作用类内部数据交互</span></span><br><span class="line">  <span class="keyword">private</span> <span class="built_in">string</span> _name; </span><br><span class="line">  <span class="comment">//属性公有化，属性是外界访问私有字段的入口，属性本身不保存任何数据</span></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Name&#123;   </span><br><span class="line">    <span class="comment">//读取属性值，本质获取属性指向的私有字段的值</span></span><br><span class="line">    get&#123; <span class="keyword">return</span> _name&#125;</span><br><span class="line">    <span class="comment">//给属性赋值，本质是给属性指向的私有字段赋值</span></span><br><span class="line">    <span class="built_in">set</span>&#123; _name = value&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> _age; </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Age&#123;   </span><br><span class="line">    get&#123; <span class="keyword">return</span> _age&#125;</span><br><span class="line">    <span class="comment">//添加业务逻辑</span></span><br><span class="line">    <span class="built_in">set</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(_age&lt;<span class="number">18</span>)&#123;</span><br><span class="line">        _age = <span class="number">18</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        _age = value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> _address; </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Address&#123;  </span><br><span class="line">    <span class="comment">//只读 </span></span><br><span class="line">    get&#123; <span class="keyword">return</span> _address&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//自动属性,必须是标准属性 .NET 3.0 以后新增</span></span><br><span class="line">  <span class="keyword">public</span> DateTime Birthday&#123;get; <span class="built_in">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>为什么定义了字段，还要定义属性？属性可以添加业务逻辑，提高数据可靠性属性可以设置只读、只写，提高数据安全性</code></pre><ul><li><p>ref</p><p>  可以将值类型按照引用方式传递</p></li><li><p>out</p><p>  让方法有多个返回值</p></li><li><p>构造方法</p><p>  完成对象的初始化</p></li><li><p>对象初始化器</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">People people = <span class="keyword">new</span> People()&#123;</span><br><span class="line">  Name = <span class="string">&quot;张张&quot;</span>，</span><br><span class="line">  Age = <span class="number">12</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>装箱，拆箱</p><p>  Object -&gt; 值类型 -&gt; 拆箱<br>  值类型 -&gt; Object -&gt; 装箱</p></li><li><p>对象的动态排序</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span>IComparable&lt;Student&gt;&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Id&#123;get; <span class="built_in">set</span>;&#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Name&#123;get; <span class="built_in">set</span>;&#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> Age&#123;get; <span class="built_in">set</span>;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">CompareTo</span><span class="params">(Student other)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> other.Age - <span class="keyword">this</span>.Age <span class="comment">// 按照年龄降序</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用方法</span></span><br><span class="line">stuList.Sort();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ageAsc</span>:</span>IComparer&lt;Student&gt;&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Compare</span><span class="params">(Student x, Student y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.Age.CompareTo(y.Age);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用方法</span></span><br><span class="line">stuList.Sort(<span class="keyword">new</span> ageAsc());</span><br></pre></td></tr></table></figure><h4 id="继承多态"><a href="#继承多态" class="headerlink" title="继承多态"></a>继承多态</h4><pre><code>抽象类，抽象方法/虚方法里氏替换：父类类型作为方法的参数类型；父类类型作为方法的返回值；</code></pre><h4 id="接口多态"><a href="#接口多态" class="headerlink" title="接口多态"></a>接口多态</h4><pre><code>接口类，接口实现类实现方法：接口作为方法的参数类型；接口作为方法的返回值；</code></pre><h4 id="序列化、反序列化"><a href="#序列化、反序列化" class="headerlink" title="序列化、反序列化"></a>序列化、反序列化</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Serializer</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> <span class="meta">#region 文件序列化</span></span><br><span class="line"> <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"> <span class="comment">/// 将对象序列化为字符串</span></span><br><span class="line"> <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;param name=&quot;t&quot;&gt;实例&lt;/param&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;returns&gt;字符串&lt;/returns&gt;</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> ObjectToString&lt;T&gt;(T t)</span><br><span class="line"> &#123;</span><br><span class="line">     BinaryFormatter formatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">     <span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">     &#123;                </span><br><span class="line">         formatter.Serialize(stream, t);</span><br><span class="line">         <span class="built_in">string</span> result = System.Text.Encoding.UTF8.GetString(stream.ToArray());</span><br><span class="line">         <span class="keyword">return</span> result;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"> <span class="comment">/// 将对象序列化为文件</span></span><br><span class="line"> <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;param name=&quot;t&quot;&gt;实例&lt;/param&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;param name=&quot;path&quot;&gt;存放路径&lt;/param&gt;</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> ObjectToFile&lt;T&gt;(T t, <span class="built_in">string</span> path)</span><br><span class="line"> &#123;</span><br><span class="line">     BinaryFormatter formatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">     <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(path, FileMode.OpenOrCreate))</span><br><span class="line">     &#123;                </span><br><span class="line">         formatter.Serialize(stream, t);</span><br><span class="line">         stream.Flush();</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"> <span class="comment">/// 将字符串反序列为类型</span></span><br><span class="line"> <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;param name=&quot;s&quot;&gt;字符串&lt;/param&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;returns&gt;对象&lt;/returns&gt;</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> T StringToObject&lt;T&gt;(<span class="built_in">string</span> s) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">     byte[] buffer = System.Text.Encoding.UTF8.GetBytes(s);</span><br><span class="line">     BinaryFormatter formatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">     <span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream(buffer))</span><br><span class="line">     &#123;                </span><br><span class="line">         T result = formatter.Deserialize(stream) as T;</span><br><span class="line">         <span class="keyword">return</span> result;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"> <span class="comment">/// 将文件反序列化为对象</span></span><br><span class="line"> <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;param name=&quot;path&quot;&gt;路径&lt;/param&gt;</span></span><br><span class="line"> <span class="comment">/// &lt;returns&gt;对象&lt;/returns&gt;</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> T FileToObject&lt;T&gt;(<span class="built_in">string</span> path) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">     <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(path, FileMode.Open))</span><br><span class="line">     &#123;</span><br><span class="line">         BinaryFormatter formatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">         T result = formatter.Deserialize(stream) as T;</span><br><span class="line">         <span class="keyword">return</span> result;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="meta">#endregion</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 将对象序列化为xml文件</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;t&quot;&gt;对象&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;path&quot;&gt;xml存放路径&lt;/param&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> ObjectToXml&lt;T&gt;(T t,<span class="built_in">string</span> path) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> XmlSerializer formatter = <span class="keyword">new</span> XmlSerializer(typeof(T));</span><br><span class="line"> <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(path, FileMode.OpenOrCreate))</span><br><span class="line"> &#123;</span><br><span class="line">     formatter.Serialize(stream, t);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 将对象序列化为xml字符串</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;t&quot;&gt;对象&lt;/param&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> ObjectToXml&lt;T&gt;(T t) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> XmlSerializer formatter = <span class="keyword">new</span> XmlSerializer(typeof(T));</span><br><span class="line"> <span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream())</span><br><span class="line"> &#123;</span><br><span class="line">     formatter.Serialize(stream, t);</span><br><span class="line">     <span class="built_in">string</span> result = System.Text.Encoding.UTF8.GetString(stream.ToArray());</span><br><span class="line">     <span class="keyword">return</span> result;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 将xml文件反序列化为对象</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;t&quot;&gt;对象&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;path&quot;&gt;xml路径&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;returns&gt;对象&lt;/returns&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> T XmlToObject&lt;T&gt;(T t, <span class="built_in">string</span> path) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> XmlSerializer formatter = <span class="keyword">new</span> XmlSerializer(typeof(T));</span><br><span class="line"> <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(path, FileMode.OpenOrCreate))</span><br><span class="line"> &#123;</span><br><span class="line">     XmlReader xmlReader = <span class="keyword">new</span> XmlTextReader(stream);</span><br><span class="line">     T result = formatter.Deserialize(xmlReader) as T;</span><br><span class="line">     <span class="keyword">return</span> result;</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/// 将对象序列化为json文件</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;t&quot;&gt;实例&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;path&quot;&gt;存放路径&lt;/param&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> ObjectToJson&lt;T&gt;(T t, <span class="built_in">string</span> path) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> DataContractJsonSerializer formatter = <span class="keyword">new</span> DataContractJsonSerializer(typeof(T));</span><br><span class="line"> <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(path, FileMode.OpenOrCreate))</span><br><span class="line"> &#123;</span><br><span class="line">     formatter.WriteObject(stream, t);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 将对象序列化为json字符串</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;t&quot;&gt;实例&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;returns&gt;json字符串&lt;/returns&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> ObjectToJson&lt;T&gt;(T t) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> DataContractJsonSerializer formatter = <span class="keyword">new</span> DataContractJsonSerializer(typeof(T));</span><br><span class="line"> <span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream())</span><br><span class="line"> &#123;</span><br><span class="line">     formatter.WriteObject(stream, t);</span><br><span class="line">     <span class="built_in">string</span> result = System.Text.Encoding.UTF8.GetString(stream.ToArray());</span><br><span class="line">     <span class="keyword">return</span> result;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// json字符串转成对象</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">/// &lt;typeparam name=&quot;T&quot;&gt;类型&lt;/typeparam&gt;</span></span><br><span class="line"><span class="comment">/// &lt;param name=&quot;json&quot;&gt;json格式字符串&lt;/param&gt;</span></span><br><span class="line"><span class="comment">/// &lt;returns&gt;对象&lt;/returns&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> T JsonToObject&lt;T&gt;(<span class="built_in">string</span> json) where T : <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> DataContractJsonSerializer formatter = <span class="keyword">new</span> DataContractJsonSerializer(typeof(Book));</span><br><span class="line"> <span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream(System.Text.Encoding.UTF8.GetBytes(json)))</span><br><span class="line"> &#123;</span><br><span class="line">     T result = formatter.ReadObject(stream) as T;</span><br><span class="line">     <span class="keyword">return</span> result;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 面向对象 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 -文件，底层操作</title>
      <link href="2019/08/25/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%96%87%E4%BB%B6%EF%BC%8C%E5%BA%95%E5%B1%82%E6%93%8D%E4%BD%9C/"/>
      <url>2019/08/25/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%96%87%E4%BB%B6%EF%BC%8C%E5%BA%95%E5%B1%82%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h4 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h4><pre><code>printf：%[flags][width][.prec][hlL]typescanf： %[flags]type</code></pre><ul><li><p>flags</p><p>  &nbsp;-：左对齐<br>  +：强制+<br>  0：0填充；</p></li><li><p>width</p><p>  number<br>  .number<br>  *<br>  .*</p></li><li><p>HlL</p><p>  hh char<br>  h short<br>  l long<br>  ll long long<br>  L long double</p></li><li><p>type</p><p>  i\d -&gt; int<br>  g\G -&gt; float<br>  u -&gt; unsigned int<br>  o -&gt; 八进制<br>  a\A -&gt; 十六进制浮点<br>  x\X -&gt; 十六进制\字母大写的十六进制<br>  c -&gt; char<br>  s -&gt; 字符串<br>  P -&gt; 指针<br>  f\F -&gt; float<br>  e\E -&gt; 指数<br>  n -&gt; 读入\写出的个数</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%9d\n&quot;</span>,  <span class="number">1234567890</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%-9d\n&quot;</span>, <span class="number">1234567890</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> num;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%-6d%n\n&quot;</span>, <span class="number">1234567890</span>, &amp;num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h4><pre><code>printf：读入的项目数scanf：输出的字符数</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> num;</span><br><span class="line">  <span class="keyword">int</span> a = <span class="built_in">scanf</span>(<span class="string">&quot;%i&quot;</span>, &amp;num);</span><br><span class="line">  <span class="keyword">int</span> b = <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, num);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d:%d\n&quot;</span>, a, b);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="FILE"><a href="#FILE" class="headerlink" title="FILE"></a>FILE</h4><pre><code>fopen | fclose | fscanf | fprintf</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FILE * fp = fopen(<span class="string">&quot;filePath&quot;</span>，<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="comment">// 判断 fp 是否为 NULL</span></span><br><span class="line"><span class="keyword">if</span>(fp)&#123;</span><br><span class="line">  <span class="keyword">int</span> num;</span><br><span class="line">  <span class="built_in">fscanf</span>(fp, <span class="string">&quot;%d&quot;</span>, &amp;num);</span><br><span class="line">  fclose(fp);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;无法打开文件。\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>fopen</p></blockquote><pre><code>r | r+ | w | w+ | a | ..x：只新建，如果文件存在，则不能打开</code></pre><h4 id="二进制文件"><a href="#二进制文件" class="headerlink" title="二进制文件"></a>二进制文件</h4><pre><code>所有的文件最终都是二进制    </code></pre><h4 id="二进制读写"><a href="#二进制读写" class="headerlink" title="二进制读写"></a>二进制读写</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//内存指针，内存大小，内存个数，文件指针</span></span><br><span class="line"><span class="function"><span class="keyword">size_t</span> <span class="title">fread</span><span class="params">(<span class="keyword">void</span> *<span class="keyword">restrict</span> ptr, <span class="keyword">size_t</span> size, <span class="keyword">size_t</span> nitems, FILE *<span class="keyword">restrict</span> stream)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">size_t</span> <span class="title">fwrite</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *<span class="keyword">restrict</span> ptr, <span class="keyword">size_t</span> size, <span class="keyword">size_t</span> nitems, FILE *<span class="keyword">restrict</span> stream)</span></span>;</span><br><span class="line"><span class="comment">//返回值：成功读取的字节数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//size 结构大小</span></span><br><span class="line"><span class="comment">//nitems 结构个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//文件中定位</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">ftell</span><span class="params">(FILE *stream)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fseek</span><span class="params">(FILE *stream, <span class="keyword">long</span> offset, <span class="keyword">int</span> whence)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// whence</span></span><br><span class="line"><span class="comment">// SEEK_SET：从头开始</span></span><br><span class="line"><span class="comment">// SEEK_CUR：当前位置</span></span><br><span class="line"><span class="comment">// SEEK_END：从尾开始</span></span><br></pre></td></tr></table></figure><h4 id="二进制缺点"><a href="#二进制缺点" class="headerlink" title="二进制缺点"></a>二进制缺点</h4><pre><code>可移植性差</code></pre><h4 id="按位运算"><a href="#按位运算" class="headerlink" title="按位运算"></a>按位运算</h4><pre><code>&amp;|~ ：反^ ：异或（两个位不相等为1，相等为0）&lt;&lt;：左移（乘以 2^n）&gt;&gt;：右移（除以 2^n）*移位不可以用负数*</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0101</span> <span class="number">1010</span> &amp; <span class="number">5</span>A</span><br><span class="line"><span class="number">1000</span> <span class="number">1100</span>   <span class="number">8</span>c</span><br><span class="line"><span class="comment">//0000 1000 08</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//常用场景</span></span><br><span class="line">x &amp; <span class="number">0xFE</span></span><br><span class="line">x &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="number">1010</span> <span class="number">1010</span> | AA</span><br><span class="line"><span class="number">0101</span> <span class="number">0100</span>   <span class="number">54</span></span><br><span class="line"><span class="comment">//1111 1110 FE</span></span><br><span class="line"></span><br><span class="line"><span class="number">1010</span> <span class="number">1010</span> ~ AA</span><br><span class="line"><span class="comment">//0101 0101 55</span></span><br><span class="line"></span><br><span class="line"><span class="number">1011</span> <span class="number">0100</span> ^</span><br><span class="line"><span class="number">0100</span> <span class="number">1011</span></span><br><span class="line"><span class="comment">//1111 1111</span></span><br><span class="line"></span><br><span class="line"><span class="number">1010</span> <span class="number">0101</span> &lt;&lt;<span class="number">2</span> A5</span><br><span class="line"><span class="comment">//1001 0100   94</span></span><br></pre></td></tr></table></figure><h4 id="位段"><a href="#位段" class="headerlink" title="位段"></a>位段</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">U0</span>&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> leading :<span class="number">3</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Flag1 : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> Flag2 : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> trailing : <span class="number">11</span>；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 -程序结构</title>
      <link href="2019/08/25/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84/"/>
      <url>2019/08/25/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>全局的生命周期，作用域<br>与任何函数无关，任何函数都可以使用全局变量</p><p>未初始化的全局变量，默认值0，指针指向NULL<br>只能编译时刻已知的值来初始化全局变量<br>初始化发生在main函数之前</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//错误示例</span></span><br><span class="line"><span class="keyword">int</span> all = <span class="number">12</span>;</span><br><span class="line"><span class="keyword">int</span> g = all;</span><br><span class="line"><span class="keyword">int</span> fun = f(x);</span><br></pre></td></tr></table></figure><h4 id="编译预处理"><a href="#编译预处理" class="headerlink" title="编译预处理"></a>编译预处理</h4><blockquote><p>#开头的是编译预处理指令</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;xxx.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;xxx.c&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="define-宏"><a href="#define-宏" class="headerlink" title="define 宏"></a>define 宏</h4><blockquote><p>纯文本替换</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI 3.14159</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI2 2*PI <span class="comment">// pi *2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FORMAT <span class="meta-string">&quot;%f\n&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(FORMAT, PI2*<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><em>gcc 查看编译过程文件</em><br>gcc 文件名 –save-temps<br>.c -&gt; .i -&gt; .s -&gt; .o -&gt; .out</p><blockquote><p>预定义宏</p></blockquote><pre><code>__LINE____FILE____DATE____TIME____STDC__</code></pre><blockquote><p>带参数的宏</p></blockquote><pre><code>一切都要括号整个值要括号参数出现的每个地方都需要括号</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cube(x) ((x)*((x)+1)+(x))</span></span><br></pre></td></tr></table></figure><h4 id="大程序结构"><a href="#大程序结构" class="headerlink" title="大程序结构"></a>大程序结构</h4><p>创建项目<br>一个.c文件是一个编译单元<br>编译器每次编译只处理一个编译单元</p><blockquote><p>头文件</p></blockquote><p>函数原型</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;max.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//报错</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">max</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">int</span> a)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, max(a,b));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>indlude “”和&lt;&gt;的区别</p></blockquote><p>“” 当前目录查找，未找到查找系统指定目录<br>&nbsp;&lt;&gt; &nbsp;只在系统指定目录查找</p><blockquote><p>static</p></blockquote><p>不对外公开的函数，变量<br>只能在所在的编译单元中被使用的函数，全局变量</p><blockquote><p>全局变量申明</p></blockquote><pre><code>只有申明可以放在头文件中</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//max.h</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> gAll;</span><br><span class="line"></span><br><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, max(gAll,<span class="number">12</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>重复定义，引用</p></blockquote><pre><code>标准头文件结构</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __MAX_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __MAX_H__</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 - 结构类型</title>
      <link href="2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E7%BB%93%E6%9E%84%E7%B1%BB%E5%9E%8B/"/>
      <url>2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E7%BB%93%E6%9E%84%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h4><p>枚举只能是 int<br>枚举量可以指定量</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enmu color&#123;</span><br><span class="line">  red,</span><br><span class="line">  yellow,</span><br><span class="line">  blue,</span><br><span class="line">  green,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> year;</span><br><span class="line">  <span class="keyword">int</span> month;</span><br><span class="line">  <span class="keyword">int</span> day;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span> <span class="title">today</span>;</span></span><br><span class="line">today.year = <span class="number">2019</span>;</span><br><span class="line">today.month = <span class="number">8</span>;</span><br><span class="line">today.day = <span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span> <span class="title">today</span> =</span> &#123;<span class="number">2019</span>, <span class="number">8</span>, <span class="number">23</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span> <span class="title">t_day</span> =</span> &#123;.month = <span class="number">8</span>, .year = <span class="number">2019</span>&#125;;</span><br></pre></td></tr></table></figure><ul><li>无名结构</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//(date) 可选</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> (<span class="title">date</span>)&#123;</span></span><br><span class="line">  <span class="keyword">int</span> year;</span><br><span class="line">  <span class="keyword">int</span> month;</span><br><span class="line">  <span class="keyword">int</span> day;</span><br><span class="line">&#125;today,yesterday;</span><br></pre></td></tr></table></figure><pre><code>*结构参数是值的传递*</code></pre><h4 id="结构指针"><a href="#结构指针" class="headerlink" title="结构指针"></a>结构指针</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(*p).month = <span class="number">12</span>;</span><br><span class="line">p-&gt;month = <span class="number">12</span>;</span><br></pre></td></tr></table></figure><h4 id="结构数组"><a href="#结构数组" class="headerlink" title="结构数组"></a>结构数组</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">time</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> hour;</span><br><span class="line">  <span class="keyword">int</span> minutes;</span><br><span class="line">  <span class="keyword">int</span> seconds;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">time</span> <span class="title">times</span>[] =</span> &#123;</span><br><span class="line">  &#123;<span class="number">12</span>,<span class="number">20</span>,<span class="number">25</span>&#125;,&#123;<span class="number">16</span>,<span class="number">24</span>,<span class="number">45</span>&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="结构的嵌套"><a href="#结构的嵌套" class="headerlink" title="结构的嵌套"></a>结构的嵌套</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> year;</span><br><span class="line">  <span class="keyword">int</span> month;</span><br><span class="line">  <span class="keyword">int</span> day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">time</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> hour;</span><br><span class="line">  <span class="keyword">int</span> minutes;</span><br><span class="line">  <span class="keyword">int</span> seconds;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DayAndTime</span>&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">date</span> <span class="title">today</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">time</span> <span class="title">currtime</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DayAndTime</span> <span class="title">dayAndtimes</span>[] =</span> &#123;</span><br><span class="line">  &#123;&#123;<span class="number">2019</span>,<span class="number">8</span>,<span class="number">25</span>&#125;,&#123;<span class="number">16</span>,<span class="number">24</span>,<span class="number">45</span>&#125;&#125;,</span><br><span class="line">  &#123;&#123;<span class="number">2019</span>,<span class="number">8</span>,<span class="number">23</span>&#125;,&#123;<span class="number">13</span>,<span class="number">14</span>,<span class="number">35</span>&#125;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="typedef"><a href="#typedef" class="headerlink" title="typedef"></a>typedef</h4><p>声明一个已经有的数据类型的新名字</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">int64_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">time</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> hour;</span><br><span class="line">  <span class="keyword">int</span> minutes;</span><br><span class="line">  <span class="keyword">int</span> seconds;</span><br><span class="line">&#125; CurrTime;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int64_t</span> i = <span class="number">1000000000000</span>;</span><br><span class="line">CurrTime t = &#123;<span class="number">12</span>,<span class="number">35</span>,<span class="number">24</span>&#125;;</span><br></pre></td></tr></table></figure><h4 id="联合"><a href="#联合" class="headerlink" title="联合"></a>联合</h4><p>成员使用同一个内存空间</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">char</span> ch[<span class="keyword">sizeof</span>(<span class="keyword">int</span>)];</span><br><span class="line">&#125; CHI;</span><br></pre></td></tr></table></figure><h4 id="ACLLib-图形库"><a href="#ACLLib-图形库" class="headerlink" title="ACLLib 图形库"></a>ACLLib 图形库</h4><p>Win32API的函数库，开发Windows程序</p><p><a href="https://github.com/wengkai/ACLLib">ACLLib</a></p>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 - 链表</title>
      <link href="2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E9%93%BE%E8%A1%A8/"/>
      <url>2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h4 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h4>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 - 指针和字符串</title>
      <link href="2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%8C%87%E9%92%88%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%8C%87%E9%92%88%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h4 id="指针的使用"><a href="#指针的使用" class="headerlink" title="指针的使用"></a>指针的使用</h4><ul><li>交换变量</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">viod <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *p, <span class="keyword">int</span> *q)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> t = *p;</span><br><span class="line">  *p = *q;</span><br><span class="line">  *q = t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>函数返回多个返回值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">viod <span class="title">minmax</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> len, <span class="keyword">int</span> *min, <span class="keyword">int</span> *max)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  *min = *max = a[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;len; i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(a[i]&lt;*min)&#123;</span><br><span class="line">      *min = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a[i]&gt;*max)&#123;</span><br><span class="line">      *max = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">123</span>,<span class="number">456</span>,<span class="number">234</span>,<span class="number">54</span>,<span class="number">1234</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span> min,max;</span><br><span class="line">  minmax(a, <span class="keyword">sizeof</span>(a)/<span class="keyword">sizeof</span>(a[<span class="number">0</span>]), &amp;min, &amp;max);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li>返回运算状态，结果通过指针返回<br>通常是让函数返回特殊的不属于有效范围内的值来表示出错。（-1 0）</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数指针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;f 函数调用。\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> (*fun)() = f;</span><br><span class="line">f();</span><br><span class="line">(*fun)();</span><br><span class="line"></span><br><span class="line"><span class="comment">//示例</span></span><br><span class="line"><span class="keyword">void</span> (*fs[])(<span class="keyword">int</span>) = &#123;f,g,h,k&#125;;</span><br><span class="line"><span class="keyword">if</span>(i&gt;=<span class="number">0</span>; i&lt; <span class="keyword">sizeof</span>(fa)/<span class="keyword">sizeof</span>(fa[<span class="number">0</span>]))&#123;</span><br><span class="line">  (*fa[i])(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//示例</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">plus</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minus</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> (*f)(<span class="keyword">int</span> a, <span class="keyword">int</span> b))</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (*f)(<span class="number">2</span>,<span class="number">5</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  cal(plus);</span><br><span class="line">  cal(minus);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>指针变量必须有初始值，否则会报错。</p></blockquote><h4 id="指针和const"><a href="#指针和const" class="headerlink" title="指针和const"></a>指针和const</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> *p1 = &amp;i;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> *p2 = &amp;i;</span><br><span class="line"><span class="keyword">int</span> *<span class="keyword">const</span> p3 = &amp;i;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 表达的意思</span></span><br><span class="line"><span class="keyword">const</span>在*前面：p1,p2不能被修改</span><br><span class="line"><span class="keyword">const</span>在*后面：指针不能被修改</span><br></pre></td></tr></table></figure><h4 id="指针的计算"><a href="#指针的计算" class="headerlink" title="指针的计算"></a>指针的计算</h4><p>通常加的是 sizeof(类型)<br>指针+1：指向下一个地址<br>指针- 1：指向上一个地址<br>指针-指针：返回两个地址之间有多少个同一个类型的个数<br>*p++：取出p所指的数据来，同时指向下一个地址</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> ac[] = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> *p = ac;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p  =%p\n&quot;</span>, p);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;p+1=%p\n&quot;</span>, p+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="comment">// p   = 0xbffbad5a;</span></span><br><span class="line"><span class="comment">// p+1 = 0xbffbad5b;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ai[] = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> *q = ai;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;q  =%p\n&quot;</span>, q);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;q+1=%p\n&quot;</span>, q+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="comment">// q   = 0xbffbad2c;</span></span><br><span class="line"><span class="comment">// q+1 = 0xbffbad30;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(*p != <span class="number">-1</span>)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, *p++);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="0地址"><a href="#0地址" class="headerlink" title="0地址"></a>0地址</h4><pre><code>0地址通常不能碰的地址指针不应该有0值特殊意义：返回的指针无效；指针没有真正初始化；NULL：预定义符号，表示0地址有些编译器不愿意你用0表示0地址</code></pre><p><em>指向不同类型的指针不能互相赋值</em></p><h4 id="void"><a href="#void" class="headerlink" title="void*"></a>void*</h4><p>直接访问内存地址，不确定什么类型</p><h4 id="动态内存分配"><a href="#动态内存分配" class="headerlink" title="动态内存分配"></a>动态内存分配</h4><p>int <em>a = (int</em>) malloc (n<em>sizeof(int));<br>申请的空间大小以字节为单位，返回结果是void</em>,需要类型转换</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> number;</span><br><span class="line">  <span class="keyword">int</span> *a;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;输入数量：&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;number);</span><br><span class="line">  </span><br><span class="line">  a = (<span class="keyword">int</span>*) <span class="built_in">malloc</span> (number*<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;number; i++)&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(i=number<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, a[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//空间归还系统，归还的必须是申请的那个空间</span></span><br><span class="line">  <span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//能申请的最大空间</span></span><br><span class="line">  <span class="keyword">void</span> *p;</span><br><span class="line">  <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(p = <span class="built_in">malloc</span>(<span class="number">100</span>*<span class="number">1024</span>*<span class="number">1024</span>))&#123;</span><br><span class="line">    cnt ++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;分配了%d00MB的空间\n&quot;</span>, cnt);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h4><pre><code>putchar()getchar()EOF 返回 -1</code></pre><h4 id="字符串数组"><a href="#字符串数组" class="headerlink" title="字符串数组"></a>字符串数组</h4><pre><code>char *a[];char a[][10];</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;argc; i++)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d:%s\n&quot;</span>, i, argv[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>busybox</em></p>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言进阶 - 数据类型</title>
      <link href="2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>2019/08/23/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6%20-%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h4 id="类型语言"><a href="#类型语言" class="headerlink" title="类型语言"></a>类型语言</h4><ul><li><p>变量提前定义</p></li><li><p>必须确定类型</p><p><em>语言两个发展方向：强类型（c++，java），弱类型（javascript，php，python）</em></p></li></ul><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><ul><li>整数<br>char -&gt; 1Byte，short -&gt; 2Byte，int，long，long long -&gt; 8Byte<br>int 表示寄存器的大小</li><li>浮点数<br>float，double，long double</li><li>逻辑<br>bool<br>#include “stdbool.h”</li><li>指针<br>*</li><li>自定义类型</li></ul><h4 id="类型的区别"><a href="#类型的区别" class="headerlink" title="类型的区别"></a>类型的区别</h4><pre><code>表达的数的范围：char &lt; short &lt; int &lt; float &lt; double输入输出格式化：%s %d %ld %lf内存所占字节：1-16内存中表达形式：二进制、编码</code></pre><h4 id="计算机内部表达"><a href="#计算机内部表达" class="headerlink" title="计算机内部表达"></a>计算机内部表达</h4><pre><code>计算机内部一切都是二进制</code></pre><h4 id="补码，负数"><a href="#补码，负数" class="headerlink" title="补码，负数"></a>补码，负数</h4><pre><code>-a = 2^n - a</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> c = <span class="number">255</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">255</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=%d, i=%d\n&quot;</span>, c, i);</span><br><span class="line"><span class="comment">// c -&gt; 11111111</span></span><br><span class="line"><span class="comment">// i -&gt; 00000000 00000000 00000000 11111111</span></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="comment">// c = -1</span></span><br><span class="line"><span class="comment">// i = 255</span></span><br></pre></td></tr></table></figure><h4 id="unsigned"><a href="#unsigned" class="headerlink" title="unsigned"></a>unsigned</h4><pre><code>unsigned char c = 255;char c = 255u;纯二进制数，不看成补码</code></pre><h4 id="整数边界"><a href="#整数边界" class="headerlink" title="整数边界"></a>整数边界</h4><pre><code>↓- -128 | 127 -↓...          ...↑- -1   | 0   -↑</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> c = <span class="number">127</span>;</span><br><span class="line">c = c + <span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=%d\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="comment">// c = -128</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> c = <span class="number">-128</span>;</span><br><span class="line">c = c - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=%d\n&quot;</span>, c);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="comment">// c = 127</span></span><br></pre></td></tr></table></figure><h4 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h4><pre><code>0   8进制0x 16进制</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0 = %o, 0x = %x\n&quot;</span>, <span class="number">8</span>进制，<span class="number">16</span>进制);</span><br></pre></td></tr></table></figure><h4 id="科学计数法"><a href="#科学计数法" class="headerlink" title="科学计数法"></a>科学计数法</h4><pre><code>-5.12E+16</code></pre><h4 id="浮点运算"><a href="#浮点运算" class="headerlink" title="浮点运算"></a>浮点运算</h4><pre><code>±∞ Nanfloat  精度 7位double 精度 15位</code></pre><h4 id="类型自动转换"><a href="#类型自动转换" class="headerlink" title="类型自动转换"></a>类型自动转换</h4><pre><code>当运算符两边出现不一致的类型，会自动转换成较大的类型printf：任何小于 int 的类型会转换成 int，float 会转换成 doublescanf：要输入 short，需要 %hd//强制转化，不会更改原始值，优先级高于四则运算(int) 10.21</code></pre>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C 语言基础</title>
      <link href="2019/08/22/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"/>
      <url>2019/08/22/C%E8%AF%AD%E8%A8%80/C%20%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="编程软件"><a href="#编程软件" class="headerlink" title="编程软件"></a>编程软件</h4><p><a href="http://sourceforge.net/projects/orwelldevcpp/?source=directory">DEV C++</a></p><p>Mac 安装 XCode 或者 gcc </p><h4 id="程序框架"><a href="#程序框架" class="headerlink" title="程序框架"></a>程序框架</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//...语句</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="编译执行"><a href="#编译执行" class="headerlink" title="编译执行"></a>编译执行</h4><p>cmd 命令<br>cd path<br>ls -l<br>gcc fileName.c<br>ls -l<br>./a.out</p><h4 id="输入，输出"><a href="#输入，输出" class="headerlink" title="输入，输出"></a>输入，输出</h4><p>scanf，printf</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//打印字符串</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World!\n&quot;</span>);</span><br><span class="line">    <span class="comment">//计算</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;12+34=%d&quot;</span>,<span class="number">12</span>+<span class="number">34</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> price= <span class="number">0</span>；</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入金额（元）：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;price);</span><br><span class="line">    <span class="keyword">int</span> change = <span class="number">100</span>-price;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;找您%d元。\n&quot;</span>,change);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入身高的英尺和英寸，例如：5 7 表示5尺7寸。&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> x,y；</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;x, &amp;y);</span><br><span class="line">    <span class="comment">//改进方式②</span></span><br><span class="line">    <span class="keyword">double</span> x,y；</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>,&amp;x, &amp;y);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;身高是%f米\n&quot;</span>, (x+y/<span class="number">12</span>)*<span class="number">0.3048</span>);</span><br><span class="line">    <span class="comment">//整数计算结果只能是整数</span></span><br><span class="line">    <span class="comment">//改进方式①</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;身高是%f米\n&quot;</span>, (x+y/<span class="number">12.0</span>)*<span class="number">0.3048</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><p>a = b + 5;</p><ul><li>=，+ 运算符</li><li>a,b,5 算子</li></ul><h4 id="sizeof"><a href="#sizeof" class="headerlink" title="sizeof"></a>sizeof</h4><p>返回内存中所占字节</p><h4 id="amp"><a href="#amp" class="headerlink" title="&amp;"></a>&amp;</h4><p>获得变量的地址</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>；</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, &amp;i);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lu\n&quot;</span>, <span class="keyword">sizeof</span>(&amp;i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lu\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>内存变量分配，自定向下。先定义的在高位，后定义的在低位。</p><h4 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h4><p>保存地址的变量</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span>* p = &amp;i;</span><br><span class="line"><span class="keyword">int</span> *p,*q  != <span class="keyword">int</span> *p,q</span><br></pre></td></tr></table></figure><p>访问指针地址上的值</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> *p = &amp;i;</span><br><span class="line"><span class="keyword">int</span> x = *p</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;x=%d\n&quot;</span>, x);</span><br><span class="line"><span class="comment">//输出结果为100</span></span><br><span class="line">*p = <span class="number">26</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;i=%d\n&quot;</span>, i);</span><br><span class="line"><span class="comment">//输出结果为26</span></span><br></pre></td></tr></table></figure><p>函数参数列表中的数组参数实际上是指针，但是可以用【】操作数据。</p><p>数组变量是常量指针，不能被赋值</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> b[] --&gt; <span class="keyword">int</span> *<span class="keyword">const</span> b</span><br></pre></td></tr></table></figure><h4 id="字符类型-char"><a href="#字符类型-char" class="headerlink" title="字符类型 char"></a>字符类型 char</h4><p>char是一种整数，也是字符。</p><pre><code>%c &#39;a&#39;    </code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> c,d;</span><br><span class="line">c=<span class="number">1</span>;</span><br><span class="line">d=<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(c==d)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;相等\n&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;不相等\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=%d\n&quot;</span>,c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;d=%d\n&quot;</span>,d);</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出结果</span></span><br><span class="line"><span class="comment">//不相等</span></span><br><span class="line"><span class="comment">//c=1;</span></span><br><span class="line"><span class="comment">//d=49;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%c&quot;</span>,&amp;c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=%d\n&quot;</span>,c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c=&#x27;%c&#x27;\n&quot;</span>,c);</span><br><span class="line"><span class="comment">//输出结果</span></span><br><span class="line"><span class="comment">//c=1;</span></span><br><span class="line"><span class="comment">//c=&#x27;1&#x27;;</span></span><br></pre></td></tr></table></figure><h4 id="逃逸字符"><a href="#逃逸字符" class="headerlink" title="逃逸字符"></a>逃逸字符</h4><pre><code>\“ | \b | \t | \&#39; | \n | \r | \\</code></pre><h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><p>以0结尾的一串字符</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> word[] = &#123;<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> *str = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> word[] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> line[<span class="number">10</span>] = <span class="string">&quot;Hello&quot;</span>;</span><br></pre></td></tr></table></figure><ul><li>0 == ‘\0’ != ‘0’</li><li>‘\0’标识字符串结束，不属于字符串的一部分，计算长度不包括’\0’</li><li>字符串以数组的形式存在，以数组和指针的形式访问</li></ul><p>“Hello” 字符串常量<br>不能用运算符对字符串做运算</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chart <span class="built_in">string</span>[<span class="number">8</span>]</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, <span class="built_in">string</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s##%s##\n&quot;</span>, <span class="built_in">string</span>, <span class="built_in">string</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%7s&quot;</span>, <span class="built_in">string</span>); <span class="comment">//输入内容最多读取7位</span></span><br></pre></td></tr></table></figure><h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h4><p>string.h</p><pre><code>strlen | strcmp | strcpy | strcat | strchr | strstrstrcpy，strcat 不安全，安全版本：strncpy，strncatstrncmp：比较前几位</code></pre>]]></content>
      
      
      <categories>
          
          <category> C 语言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# 数据库访问</title>
      <link href="2019/08/22/Csharp/C%20sharp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE/"/>
      <url>2019/08/22/Csharp/C%20sharp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><p>数据库 Database<br>数据库管理系统 DBMS</p><ul><li>Oracle，MySql，SQL Server，Access</li></ul><p>优点：共享性，独立性，完整性，冗余数据少<br>功能：数据定义，操作，完整，安全，并发</p><h4 id="RDBMS"><a href="#RDBMS" class="headerlink" title="RDBMS"></a>RDBMS</h4><p>关系型数据库：二维表形式组织数据</p><p>DataTable -&gt; DataRow -&gt; DataColumn -&gt; primary key</p><h4 id="ADO-NET"><a href="#ADO-NET" class="headerlink" title="ADO.NET"></a>ADO.NET</h4><p>具有标准CRUD接口<br>不同数据库统一的访问接口</p><p>技术发展：<br>ODBC -&gt; DAO -&gt; ADO -&gt; ADO.NET</p><p>数据访问层：</p><ol><li>源代码</li><li>ADO.NET(Adapter，Command)</li><li>Connection</li><li>供应程序 Provider</li><li>数据库</li></ol><p>主要对象：</p><blockquote><p>Connection<br>Command<br>DataReader<br>DataAdapter</p></blockquote><p>Provider:</p><blockquote><p>System.Data.SqlClient<br>System.Data.OleDb<br>System.Data.Odbc<br>System.Data.OracleClient</p></blockquote><h4 id="访问数据方式"><a href="#访问数据方式" class="headerlink" title="访问数据方式"></a>访问数据方式</h4><ul><li><p>DataAdapter + DataSet<br>自动建立 Command 对象</p></li><li><p>DataReader<br>适用只读数据，高效</p></li></ul><p>Connection 重要方法，属性：</p><ul><li>Open();</li><li>ConnectionSting <a href="/2013/07/01/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E4%B8%B2/">常用连接串</a></li></ul><p>Command 重要方法：</p><ul><li>ExecuteReader(); //只读，单纯查询数据</li><li>ExecuteScalar(); //返回聚合函数的结果</li><li>ExecuteNonQuery(); //Update/Delete/Insert 返回受影响的行数</li></ul><pre><code>Command.CommandText = &quot;Insert Into xxx(a,b,c) VALUES (@ID,@NAME,@PRICE)&quot;;Command.Connection = connectionSting;Command.Parameters.Add(&quot;@Name&quot;, SqlDbType.VarChar, 60).Value = &quot;aaaaa&quot;;/*使用参数比拼接字符串更安全，Sql注入*/</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        TestAdapter();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestAdapter</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> strSql = <span class="string">&quot;SELECT * FROM [Publishers]&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> strConn =</span><br><span class="line">            @<span class="string">&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;</span> +</span><br><span class="line">            @<span class="string">&quot;Data Source=D:\CsExample\ch10\BIBLIO.MDB&quot;</span>;</span><br><span class="line">        OleDbConnection MyConn = <span class="keyword">new</span> OleDbConnection(strConn);</span><br><span class="line">        OleDbCommand MyCommand = <span class="keyword">new</span> OleDbCommand(strSql, MyConn);</span><br><span class="line">        MyConn.Open();</span><br><span class="line">        <span class="comment">//使用DataReader</span></span><br><span class="line">        OleDbDataReader MyReader = MyCommand.ExecuteReader();</span><br><span class="line">        <span class="keyword">while</span>( MyReader.Read() )</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine( </span><br><span class="line">                MyReader.GetString(<span class="number">1</span>)+</span><br><span class="line">                MyReader[<span class="string">&quot;Name&quot;</span>].ToString() + </span><br><span class="line">                MyReader[<span class="number">2</span>].ToString() </span><br><span class="line">                );</span><br><span class="line">        &#125;</span><br><span class="line">        MyReader.Close();</span><br><span class="line">        <span class="comment">//使用Command的ExecuteScalar</span></span><br><span class="line">        MyCommand.CommandText = <span class="string">&quot;Select Count(*) From [Publishers]&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt = (<span class="keyword">int</span>) MyCommand.ExecuteScalar();</span><br><span class="line">        Console.WriteLine( cnt );</span><br><span class="line">        <span class="comment">//使用Command的ExecuteNonQuery</span></span><br><span class="line">        MyCommand.CommandText = <span class="string">&quot;Delete From [Publishers] Where [Name]=&#x27;T&#x27;&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> cntDeleted = MyCommand.ExecuteNonQuery();</span><br><span class="line">        Console.WriteLine( cntDeleted );</span><br><span class="line">        MyConn.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br><span class="line"><span class="keyword">using</span> System.Xml;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        TestAdapter();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestAdapter</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> strSql = <span class="string">&quot;SELECT * FROM [Publishers]&quot;</span>;</span><br><span class="line">        <span class="comment">// 连接串</span></span><br><span class="line">        <span class="built_in">string</span> strConn =</span><br><span class="line">            @<span class="string">&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;</span> +</span><br><span class="line">            @<span class="string">&quot;Data Source=D:\CsExample\ch10\BIBLIO.MDB&quot;</span>;</span><br><span class="line">        <span class="comment">//注：如果是accdb文件,则用下面的方式</span></span><br><span class="line">        <span class="comment">//  @&quot;Provider=Microsoft.ACE.OLEDB.12.0;&quot; +</span></span><br><span class="line">        <span class="comment">//  @&quot;Data Source=&quot;+Environment.CurrentDirectory+@&quot;\english.accdb&quot;;</span></span><br><span class="line">        <span class="comment">// 连接</span></span><br><span class="line">        OleDbConnection conn = <span class="keyword">new</span> OleDbConnection( strConn );</span><br><span class="line">        <span class="comment">// 适配器</span></span><br><span class="line">        OleDbDataAdapter daAdapter = <span class="keyword">new</span> OleDbDataAdapter(strSql, conn);</span><br><span class="line">        <span class="comment">// 命令建立器</span></span><br><span class="line">        OleDbCommandBuilder cmdbld = <span class="keyword">new</span> OleDbCommandBuilder( daAdapter );       </span><br><span class="line">        <span class="comment">// 数据集</span></span><br><span class="line">        DataSet dsMyData = <span class="keyword">new</span> DataSet();</span><br><span class="line">        <span class="comment">// 填充数据</span></span><br><span class="line">        daAdapter.Fill(dsMyData);</span><br><span class="line">        <span class="comment">// 访问数据</span></span><br><span class="line">        foreach( DataTable table in dsMyData.Tables )</span><br><span class="line">        &#123;</span><br><span class="line">            foreach( DataRow row in table.Rows )</span><br><span class="line">            &#123;</span><br><span class="line">                foreach( object field in row.ItemArray )</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.Write(field);</span><br><span class="line">                &#125;</span><br><span class="line">                Console.WriteLine();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine( dsMyData.Tables[<span class="number">0</span>].Rows[<span class="number">0</span>][<span class="number">1</span>] );</span><br><span class="line">        <span class="comment">// 在内存中选择、计算数据</span></span><br><span class="line">        DataTable myTable = dsMyData.Tables[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">string</span> strExpr = <span class="string">&quot;Name Like &#x27;T*&#x27;&quot;</span>;</span><br><span class="line">        DataRow [] foundRows = myTable.Select(strExpr);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; foundRows.Length; i ++)&#123;</span><br><span class="line">          Console.WriteLine(foundRows[i][<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 在内存中修改数据</span></span><br><span class="line">        DataRow row1 = dsMyData.Tables[<span class="number">0</span>].Rows[<span class="number">0</span>];</span><br><span class="line">        row1.BeginEdit();</span><br><span class="line">        row1[<span class="number">1</span>] = <span class="string">&quot;Tang&quot;</span>;</span><br><span class="line">        row1[<span class="number">2</span>] = <span class="string">&quot;Peking Univ.&quot;</span>;</span><br><span class="line">        row1[<span class="number">3</span>] = <span class="string">&quot;Beijing&quot;</span>;</span><br><span class="line">        row1.EndEdit();</span><br><span class="line">        row1.AcceptChanges();</span><br><span class="line">        <span class="comment">// 提交数据的改变</span></span><br><span class="line">        daAdapter.Update(dsMyData);</span><br><span class="line">        <span class="comment">// 将数据标为已改变</span></span><br><span class="line">        dsMyData.AcceptChanges();</span><br><span class="line">        myTable.AcceptChanges();</span><br><span class="line">        <span class="comment">// DataSet与XML操作</span></span><br><span class="line">        dsMyData.WriteXml(<span class="string">&quot;test.xml&quot;</span>);</span><br><span class="line">        dsMyData.ReadXml(<span class="string">&quot;test.xml&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AccessDB-简单实现"><a href="#AccessDB-简单实现" class="headerlink" title="AccessDB 简单实现"></a>AccessDB 简单实现</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br><span class="line"><span class="keyword">namespace</span> KYL.DAL</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccessDB</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="comment">//数据库,</span></span><br><span class="line">        <span class="comment">//项目中添加引用 System.Configuration</span></span><br><span class="line">        <span class="comment">//在配置文件中的 &lt;configuration&gt;下面的 &lt;appSettings&gt;中加上以下的配置</span></span><br><span class="line">        <span class="comment">//   &lt;add key=&quot;AccessDB&quot; value=&quot;Demo.accdb&quot;/&gt;</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> _AccessDB = System.Configuration.ConfigurationManager.AppSettings[<span class="string">&quot;AccessDB&quot;</span>];</span><br><span class="line">        <span class="comment">//private static string _DBConnString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; + Environment.CurrentDirectory + &quot;\\&quot; + _AccessDB; //这是早期的Access数据库</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> _DBConnString = <span class="string">&quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=&quot;</span> + Environment.CurrentDirectory + <span class="string">&quot;\\&quot;</span> + _AccessDB; <span class="comment">//这是2007以后的Access数据库</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> DBConnString</span><br><span class="line">        &#123;</span><br><span class="line">            get</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _DBConnString;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">GetDataSet</span><span class="params">(<span class="built_in">string</span> sql)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (DBConnString == null || DBConnString == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> null;</span><br><span class="line">            OleDbDataAdapter daAdapter = <span class="keyword">new</span> OleDbDataAdapter(sql, DBConnString);</span><br><span class="line">            <span class="comment">//OleDbCommandBuilder cmdbld = new OleDbCommandBuilder( daAdapter );</span></span><br><span class="line">            DataSet dsMyData = <span class="keyword">new</span> DataSet();</span><br><span class="line">            daAdapter.Fill(dsMyData);</span><br><span class="line">            <span class="keyword">return</span> dsMyData;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">ExecuteNonQuery</span><span class="params">(<span class="built_in">string</span> sql)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (DBConnString == null || DBConnString == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            OleDbConnection con = <span class="keyword">new</span> OleDbConnection(DBConnString);</span><br><span class="line">            OleDbCommand cmd = <span class="keyword">new</span> OleDbCommand(sql, con);</span><br><span class="line">            con.Open();</span><br><span class="line">            <span class="keyword">int</span> n = cmd.ExecuteNonQuery();</span><br><span class="line">            con.Close();</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ExecuteScalar</span><span class="params">(<span class="built_in">string</span> sql)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (DBConnString == null || DBConnString == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> null;</span><br><span class="line">            OleDbConnection myConn = <span class="keyword">new</span> OleDbConnection(DBConnString);</span><br><span class="line">            OleDbCommand myCommand = <span class="keyword">new</span> OleDbCommand(sql, myConn);</span><br><span class="line">            myConn.Open();</span><br><span class="line">            object ret = myCommand.ExecuteScalar();</span><br><span class="line">            myConn.Close();</span><br><span class="line">            <span class="keyword">if</span> (ret == null) <span class="keyword">return</span> null;</span><br><span class="line">            <span class="keyword">return</span> ret.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="SqlServerDB-实现"><a href="#SqlServerDB-实现" class="headerlink" title="SqlServerDB 实现"></a>SqlServerDB 实现</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如下类型替换掉即可</span></span><br><span class="line">SqlDataAdapter daAdapter = <span class="keyword">new</span> SqlDataAdapter(sql, DBConnString);</span><br><span class="line">SqlCommandBuilder cmdbld = <span class="keyword">new</span> SqlCommandBuilder( daAdapter );</span><br><span class="line">SqlConnection con = <span class="keyword">new</span> SqlConnection(DBConnString);</span><br><span class="line">SqlCommand cmd = <span class="keyword">new</span> SqlCommand(sql, con);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 多线程与异步</title>
      <link href="2019/08/20/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%BC%82%E6%AD%A5/"/>
      <url>2019/08/20/Csharp/C%20sharp%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%BC%82%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<h4 id="进程-Process"><a href="#进程-Process" class="headerlink" title="进程 Process"></a>进程 Process</h4><p>包含多个线程 Thread</p><p>指令：方法（委托）<br>数据：相关对象</p><h4 id="Thread-属性"><a href="#Thread-属性" class="headerlink" title="Thread 属性"></a>Thread 属性</h4><ul><li>CurrentPrincipal 当前线程安全性</li><li>CurrentThread</li><li>IsAlive</li><li>IsBackground</li><li>Name</li><li>Priority 线程优先级</li><li>ThreadState 当前状态</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Test obj1 = <span class="keyword">new</span> Test();</span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread( <span class="keyword">new</span> ThreadStart( obj1.Count ));</span><br><span class="line">        thread1.Name = <span class="string">&quot;线程1&quot;</span>;</span><br><span class="line">        Test obj2 = <span class="keyword">new</span> Test();</span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread( <span class="keyword">new</span> ThreadStart( obj2.Count ));</span><br><span class="line">        thread2.Name = <span class="string">&quot;线程2&quot;</span>;</span><br><span class="line">        Thread thread3 = <span class="keyword">new</span> Thread( <span class="keyword">new</span> ThreadStart( obj2.Count ));</span><br><span class="line">        thread3.Name = <span class="string">&quot;线程3&quot;</span>;</span><br><span class="line">        thread1.Start();</span><br><span class="line">        thread2.Start();</span><br><span class="line">        thread3.Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Count</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>( cnt &lt; <span class="number">10</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            cnt ++;</span><br><span class="line">            Console.WriteLine( Thread.CurrentThread.Name + <span class="string">&quot;数到&quot;</span> + cnt  );</span><br><span class="line">            Thread.Sleep( <span class="number">100</span> );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Thread-方法"><a href="#Thread-方法" class="headerlink" title="Thread 方法"></a>Thread 方法</h4><ul><li>Abort 撤销</li><li>Interrupt 中断</li><li>Join 等待</li><li>Resume 恢复</li><li>Sleep</li><li>Start</li><li>Suspend 挂起</li></ul><h4 id="ThreadState-Enume"><a href="#ThreadState-Enume" class="headerlink" title="ThreadState Enume"></a>ThreadState Enume</h4><ul><li>Aborted</li><li>AbortedRequested</li><li>Background</li><li>Running</li><li>Stopped</li><li>StopRequested</li><li>Suspended</li><li>SuspendRequested</li><li>Unstarted</li><li>WaitSleepJoin</li></ul><h4 id="ThreadPriority"><a href="#ThreadPriority" class="headerlink" title="ThreadPriority"></a>ThreadPriority</h4><ul><li>Highest</li><li>AboveNormal</li><li>Normal</li><li>BelowNormal</li><li>Lowest</li></ul><h4 id="线程同步"><a href="#线程同步" class="headerlink" title="线程同步"></a>线程同步</h4><p>Join()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadJoin</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span> [] args)</span> </span>&#123;</span><br><span class="line">        Runner r = <span class="keyword">new</span> Runner();</span><br><span class="line">        Thread thread = <span class="keyword">new</span> Thread(  r.run );</span><br><span class="line">        thread.Start();</span><br><span class="line">        thread.Join();</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++ )&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\t&quot;</span> + i );</span><br><span class="line">            Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Runner</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++ )&#123;</span><br><span class="line">            Console.WriteLine( i );</span><br><span class="line">            Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="多线程访问同变量"><a href="#多线程访问同变量" class="headerlink" title="多线程访问同变量"></a>多线程访问同变量</h4><p>Lock(对象，表达式){<br>    …<br>}</p><p>System.Threading.Monitor.Enter(对象，表达式);<br>System.Threading.Monitor.Exit(对象，表达式);</p><h4 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h4><p>Threadpool.QueueUserWorkItem(WaitCallback, object)</p><p>Timer(TimerCallback callback, //执行的任务<br>object state,  //数据<br>int dueTime,   //启动前的延时<br>int period     //任务间隔<br>)</p><h4 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h4><p>IsSynchoronized() 判断是否为同步<br>SyncRoot()<br>Synchronized()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SamplesArrayList</span>  &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span>  </span>&#123;</span><br><span class="line">        ArrayList myAL = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        myAL.Add( <span class="string">&quot;The&quot;</span> );</span><br><span class="line">        myAL.Add( <span class="string">&quot;quick&quot;</span> );</span><br><span class="line">        myAL.Add( <span class="string">&quot;brown&quot;</span> );</span><br><span class="line">        myAL.Add( <span class="string">&quot;fox&quot;</span> );</span><br><span class="line">        ArrayList mySyncdAL = ArrayList.Synchronized( myAL );</span><br><span class="line">        Console.WriteLine( myAL.IsSynchronized  ); <span class="comment">//False</span></span><br><span class="line">        Console.WriteLine( mySyncdAL.IsSynchronized ); <span class="comment">//True</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="并行编程"><a href="#并行编程" class="headerlink" title="并行编程"></a>并行编程</h4><p>TPL 并行任务库</p><p>Task 类，利用线程池进行任务执行<br>Parallel 类，并行执行任务类的实用类，隐式的使用Task</p><p>使用方法：<br>    Task<double> task = Task.Run(()=&gt; someFun());<br>    double res = task.Result;<br>    Task.WaitAll<br>    task.ContinueWith </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Task&lt;<span class="keyword">double</span>&gt;[] tasks = &#123;</span><br><span class="line">            Task.Run( ()=&gt;SomeFun() ),</span><br><span class="line">            Task.Run( ()=&gt;SomeFun() ),</span><br><span class="line">        &#125;;</span><br><span class="line">        Thread.Sleep(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;tasks.Length; i++ )</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(tasks[i].Status);  <span class="comment">//可以查看状态</span></span><br><span class="line">            Console.WriteLine(tasks[i].Result);  <span class="comment">//取Result时，会等到计算结束</span></span><br><span class="line">        &#125;</span><br><span class="line">        Task.WaitAll( tasks ); <span class="comment">//也可以用这句，来等结束</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoSometing</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">SomeFun</span><span class="params">()</span></span>&#123; Thread.Sleep(<span class="number">50</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异常处理：AggregateExecption(合并的异常)</p><p>使用方法：<br>Parallel.Invoke(Action[] actions)<br>Parallel.For(0, 100, i=&gt;{})<br>Parallel.FOrEach(list, item=&gt;{})</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestParallelInvoke</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Action[] actions = &#123; <span class="keyword">new</span> Action(DoSometing), DoSometing &#125;;</span><br><span class="line">        Parallel.Invoke( actions ); </span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主函数所在线程&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Console.ReadKey();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoSometing</span><span class="params">()</span></span>&#123; </span><br><span class="line">        Console.WriteLine(<span class="string">&quot;函数所在线程&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Parallel.For(<span class="number">0</span>, <span class="number">10</span>, i =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;i=&#123;0&#125;, fac=&#123;1&#125;, 线程id=&#123;2&#125;&quot;</span>, i, Calc(i),</span><br><span class="line">                Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">            Thread.Sleep(<span class="number">10</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        Console.ReadLine();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">Calc</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> f = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++ ) f*=i;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        List&lt;<span class="keyword">double</span>&gt; <span class="built_in">list</span> = <span class="keyword">new</span> List&lt;<span class="keyword">double</span>&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) <span class="built_in">list</span>.Add(i*i);</span><br><span class="line">        ParallelLoopResult loopResult = Parallel.ForEach(</span><br><span class="line">            <span class="built_in">list</span>, (<span class="keyword">double</span> x, ParallelLoopState state) =&gt;</span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">if</span> (x == <span class="number">400</span>)state.Break();</span><br><span class="line">             Console.WriteLine(<span class="string">&quot;x=&#123;0&#125;,thread id=&#123;1&#125;&quot;</span>, x, Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">         &#125;);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;IsCompleted: &#123;0&#125;&quot;</span>, </span><br><span class="line">            loopResult.IsCompleted);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;BreakValue: &#123;0&#125;&quot;</span>, </span><br><span class="line">            loopResult.LowestBreakIteration.HasValue);</span><br><span class="line">        Console.ReadLine();     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Linq，PLinq</p><p>使用方法：<br>使用Linq语法，集合.AsParallel()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Concurrent;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> count = <span class="number">1000000</span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span>      </span>&#123;</span><br><span class="line">        var dic = LoadData();</span><br><span class="line">        Stopwatch watch = <span class="keyword">new</span> Stopwatch();</span><br><span class="line">        watch.Start();</span><br><span class="line">        <span class="comment">//串行运算</span></span><br><span class="line">        var query1 = (from n in dic.Values</span><br><span class="line">                      where n.Age &gt; <span class="number">20</span> &amp;&amp; n.Age &lt; <span class="number">25</span></span><br><span class="line">                      select n).ToList();</span><br><span class="line">        watch.Stop();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;串行计算耗费时间：&#123;0&#125;&quot;</span>, watch.ElapsedMilliseconds);</span><br><span class="line">        watch.Restart();</span><br><span class="line">        <span class="comment">//并行运算</span></span><br><span class="line">        var query2 = (from n in dic.Values.AsParallel()</span><br><span class="line">                      where n.Age &gt; <span class="number">20</span> &amp;&amp; n.Age &lt; <span class="number">25</span></span><br><span class="line">                      select n).ToList();</span><br><span class="line">        watch.Stop();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;并行计算耗费时间：&#123;0&#125;&quot;</span>, watch.ElapsedMilliseconds);</span><br><span class="line">        Console.Read();</span><br><span class="line">    &#125;</span><br><span class="line">    public static ConcurrentDictionary&lt;int, Student&gt; LoadData()      &#123;</span><br><span class="line">        ConcurrentDictionary&lt;<span class="keyword">int</span>, Student&gt; dic = </span><br><span class="line">            <span class="keyword">new</span> ConcurrentDictionary&lt;<span class="keyword">int</span>, Student&gt;();</span><br><span class="line">        Parallel.For(<span class="number">0</span>, count, (i) =&gt;  &#123;</span><br><span class="line">            var single = <span class="keyword">new</span> Student() &#123;</span><br><span class="line">                ID = i,</span><br><span class="line">                Name = <span class="string">&quot;n&quot;</span> + i,   </span><br><span class="line">                Age = i % <span class="number">151</span>,</span><br><span class="line">                <span class="comment">//CreateTime = DateTime.Now.AddSeconds(i)</span></span><br><span class="line">            &#125;;</span><br><span class="line">            dic.TryAdd(i, single);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> dic;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> ID &#123;get;<span class="built_in">set</span>;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;get;<span class="built_in">set</span>;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> Age &#123;get;<span class="built_in">set</span>;&#125;</span><br><span class="line">        <span class="keyword">public</span> DateTime CreateTime &#123;get;<span class="built_in">set</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="异步编程"><a href="#异步编程" class="headerlink" title="异步编程"></a>异步编程</h4><p>asynchronize</p><p>主要解决的事情：<br>等待一些耗时的任务，不阻塞当前任务<br>异步提高UI响应能力</p><ul><li>方法一 委托</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 异步调用方法总结：</span></span><br><span class="line"><span class="comment">/// 1.BeginEnvoke EndEnvoke</span></span><br><span class="line"><span class="comment">/// 当使用BeginInvoke异步调用方法时，如果方法未执行完，EndInvoke方法就会一直阻塞，直到被调用的方法执行完毕</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Async1</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> delegate <span class="keyword">int</span> <span class="title">FooDelegate</span><span class="params">(<span class="built_in">string</span> s)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主线程&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        FooDelegate fooDelegate = Foo;</span><br><span class="line">        IAsyncResult result= fooDelegate.BeginInvoke(<span class="string">&quot;Hello World.&quot;</span>, null, null);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主线程继续执行...&quot;</span>);</span><br><span class="line">        <span class="comment">//当使用BeginInvoke异步调用方法时，如果方法未执行完，EndInvoke方法就会一直阻塞，直到被调用的方法执行完毕</span></span><br><span class="line">        <span class="keyword">int</span> n = fooDelegate.EndInvoke(result);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;回到主线程&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;结果是&quot;</span>+n);</span><br><span class="line">        Console.ReadKey(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Foo</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;函数所在线程&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;异步线程开始执行：&quot;</span>+s);</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">return</span> s.Length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>方法二 回调</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 异步调用方法总结：</span></span><br><span class="line"><span class="comment">/// 回调</span></span><br><span class="line"><span class="comment">/// 异步线程在工作结束后会主动调用我们提供的回调方法，并在回调方法中做相应的处理，例如显示异步调用的结果。</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">FooDelegate</span><span class="params">(<span class="built_in">string</span> s)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主线程.&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        FooDelegate fooDelegate = Foo;</span><br><span class="line">        fooDelegate.BeginInvoke(<span class="string">&quot;Hello world.&quot;</span>, </span><br><span class="line">            FooComepleteCallback, fooDelegate);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;主线程继续执行...&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Press any key to continue...&quot;</span>);</span><br><span class="line">        Console.ReadKey(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Foo</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        Console.WriteLine(<span class="string">&quot;函数当前线程：&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        Console.WriteLine(s);</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//回调方法要求</span></span><br><span class="line">    <span class="comment">//1.返回类型为void</span></span><br><span class="line">    <span class="comment">//2.只有一个参数IAsyncResult</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">FooComepleteCallback</span><span class="params">(IAsyncResult result)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;回调函数所在线程：&quot;</span>+Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        (result.AsyncState as FooDelegate).EndInvoke(result);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;回调函数线程结束.&quot;</span> + result.AsyncState.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>方法三 await async</li></ul><p>await 等待任务执行<br>async 修饰符，内部存在异步任务</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AsyncSimple1</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function">Task&lt;<span class="keyword">double</span>&gt; <span class="title">FacAsync</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Task&lt;<span class="keyword">double</span>&gt;.Run( ()=&gt;&#123;</span><br><span class="line">            <span class="keyword">double</span> s = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++) s = s*i;</span><br><span class="line">            <span class="keyword">return</span> s;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">async <span class="keyword">void</span> <span class="title">Test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 调用异步方法</span></span><br><span class="line">        <span class="keyword">double</span> result = await FacAsync(<span class="number">10</span>);</span><br><span class="line">        Console.WriteLine( result); <span class="comment">//想想这句在哪个线程</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> AsyncSimple1().Test();</span><br><span class="line">        Console.ReadKey();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.ComponentModel;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncStream</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function">async Task&lt;<span class="keyword">int</span>&gt; <span class="title">WriteFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">using</span> (StreamWriter sw = <span class="keyword">new</span> StreamWriter(</span><br><span class="line">            <span class="keyword">new</span> FileStream(<span class="string">&quot;aaa.txt&quot;</span>, FileMode.Create) ))</span><br><span class="line">        &#123;</span><br><span class="line">            await sw.WriteAsync(<span class="string">&quot;my text&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">async <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        AsyncStream a = <span class="keyword">new</span> AsyncStream();</span><br><span class="line">        await a.WriteFile();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Write OK&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 多线程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>正则表达式</title>
      <link href="2019/08/19/Csharp/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>2019/08/19/Csharp/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h4 id="主要要素"><a href="#主要要素" class="headerlink" title="主要要素"></a>主要要素</h4><blockquote><p>字符</p></blockquote><p>[a-zA-Z] 即 \w<br>[0-9] 即 \d<br>[^0-9] 即 \D<br>\s 即 空白<br>\S 即 非空白<br>. 通配符</p><blockquote><p>次数</p></blockquote><p>* 即 {0,}<br>+ 即 {1,}<br>? 即 {0,1}</p><p>*? +? ?? 懒惰匹配，尽量匹配少</p><blockquote><p>| 或<br>() 组合</p></blockquote><blockquote><p>位置限定</p></blockquote><p>^ 首<br>$ 尾<br>\b 单词边界<br>\B 非单词边界</p><blockquote><p>(?&lt;a&gt;xxxx)(yyyy)</p></blockquote><p>替换时：<br>${a} =&gt; $1 =&gt; xxxx<br>$2 =&gt; yyyy</p><blockquote><p>(?i:xxxxx) </p></blockquote><p>忽略大小写</p><h4 id="Regex"><a href="#Regex" class="headerlink" title="Regex"></a>Regex</h4><p>命名空间：using System.Text.RegularExpressions;</p><p>Regex.IsMatch | Match | Matches | Replace(s,r)<br>Match.Groups | Value | Result</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Text.RegularExpressions;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span>  <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">/*示例*/</span></span><br><span class="line">        <span class="built_in">string</span> pattern = @<span class="string">&quot;^[\. a-zA-z]+ (?&lt;name&gt;\w+), [a-zA-z]+, x(?&lt;ext&gt;\d+)$&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> [] sa =</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;Dr. David Jones, Ophthalmology, x2441&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Ms. Cindy Harriman, Registry, x6231&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Mr. Chester Addams, Mortuary, x1667&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Dr. Hawkeye Pierce, Surgery, x0986&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">  </span><br><span class="line">        Regex rx = <span class="keyword">new</span> Regex( pattern );</span><br><span class="line">  </span><br><span class="line">        foreach ( <span class="built_in">string</span> s in sa )</span><br><span class="line">        &#123;</span><br><span class="line">            Match m= rx.Match(s);</span><br><span class="line">            <span class="keyword">if</span>( m.Success )</span><br><span class="line">                Console.Write(m.Result(<span class="string">&quot;$&#123;ext&#125;,  $&#123;name&#125;, $1&quot;</span>));</span><br><span class="line">            Console.WriteLine( <span class="string">&quot;\t&quot;</span> +</span><br><span class="line">                rx.Replace( s, <span class="string">&quot;姓：$&#123;name&#125;, 分机号：$&#123;ext&#125;&quot;</span> ));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*示例*/</span></span><br><span class="line">        <span class="built_in">string</span> pattern = <span class="string">&quot;[Bbw]ill&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> s = <span class="string">&quot;My friend Bill will pay the bill&quot;</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span>( Regex.IsMatch( s, pattern ) )</span><br><span class="line">            Console.WriteLine( s+ <span class="string">&quot;与&quot;</span> + pattern +<span class="string">&quot;相匹配&quot;</span> );</span><br><span class="line">          </span><br><span class="line">        Regex  rx = <span class="keyword">new</span> Regex( pattern );</span><br><span class="line">          </span><br><span class="line">        MatchCollection mc = rx.Matches(s);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;有&#123;0&#125;次匹配&quot;</span>, mc.Count);</span><br><span class="line">        foreach ( Match mt in mc )</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine( mt );</span><br><span class="line">        &#125;   </span><br><span class="line">  </span><br><span class="line">        Match m = rx.Match(s);</span><br><span class="line">        <span class="keyword">while</span> ( m.Success )</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;在位置 &#123;0&#125; 有匹配&#x27;&#123;1&#125;&#x27;&quot;</span>, </span><br><span class="line">                m.Index, m.Value);</span><br><span class="line">            m = rx.Match(s, m.Index+ m.Length);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span> (m = rx.Match(s); m.Success; m = m.NextMatch()) </span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;在位置 &#123;0&#125; 有匹配&#x27;&#123;1&#125;&#x27;&quot;</span>, </span><br><span class="line">                m.Index, m.Value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 正则表达式 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# GDI+</title>
      <link href="2019/08/18/Csharp/C%20sharp%20GDI+/"/>
      <url>2019/08/18/Csharp/C%20sharp%20GDI+/</url>
      
        <content type="html"><![CDATA[<h4 id="NET-GDI"><a href="#NET-GDI" class="headerlink" title=".NET GDI"></a>.NET GDI</h4><p>System.Drawing<br>System.Drawing.2D<br>System.Drawing.Imaging<br>System.Drawing.Text</p><h4 id="Drawing"><a href="#Drawing" class="headerlink" title="Drawing"></a>Drawing</h4><p>Color.FromArgb<br>Color.FromName</p><p>Size(w,h)<br>Point(x,y)<br>Rectangle()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Graphics g = <span class="keyword">this</span>.CreateGraphics();</span><br><span class="line">Pen pen = <span class="keyword">new</span> Pen(Color.Red, <span class="number">2</span>);</span><br><span class="line">Brush brush = <span class="keyword">new</span> SolidBrush(Color.Blue);</span><br><span class="line">Font font = <span class="keyword">new</span> Font(<span class="string">&quot;宋体&quot;</span>, <span class="number">25</span>);</span><br><span class="line">Rectangle rect = <span class="keyword">new</span> Rectangle(<span class="number">20</span>, <span class="number">120</span>, <span class="number">100</span>, <span class="number">160</span>);</span><br><span class="line">g.DrawLine(pen, <span class="number">20</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">g.DrawRectangle(pen, rect);</span><br><span class="line">g.DrawString(<span class="string">&quot;GDI+图形编程&quot;</span>, font, brush, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">brush.Dispose(); font.Dispose(); pen.Dispose();</span><br><span class="line">g.Dispose();</span><br></pre></td></tr></table></figure><h4 id="Graphics"><a href="#Graphics" class="headerlink" title="Graphics"></a>Graphics</h4><p>DrawARC：绘制圆弧<br>DrawBezier：绘制贝塞尔曲线<br>DrawClosedCurve：绘制封闭曲线<br>DrawCurve：绘制曲线<br>DrawEllipse：绘制椭圆 **<br>DrawIcon：绘制图标<br>DrawImage：绘制图像 **<br>DrawLine：绘制直线<br>DrawString：绘制文本<br>DrawRectangle：绘制矩形</p><p>FillXXX：绘制实心</p><h4 id="Pen"><a href="#Pen" class="headerlink" title="Pen"></a>Pen</h4><pre><code>Pen pen = new Pen(Color.Blue,5);</code></pre><p>PenAlignment<br>DashStyle</p><h4 id="Brush"><a href="#Brush" class="headerlink" title="Brush"></a>Brush</h4><p>抽象类，不能被实例化</p><h4 id="双缓冲技术"><a href="#双缓冲技术" class="headerlink" title="双缓冲技术"></a>双缓冲技术</h4><p>DoubleBuffered</p><p>原理：</p><p>Bitmap bmp = new Bitmap(600,600);<br>Graphics g = Graphics.FromImage(bmp);<br>g.FillEllipse(brush, i<em>10, j</em>10, 10, 10);<br>g.DrawLine();<br>g.DrawString();<br>this.CreateGraphics().DrawImage(bmp, 0, 0);</p><h4 id="图像处理"><a href="#图像处理" class="headerlink" title="图像处理"></a>图像处理</h4><p>Image 抽象类，主要使用 Bitmap，处理BMP、Jpg、Gif、Png</p><ul><li>bitmap.GetPixel(x,y); 获得像素点</li><li>使用指针</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Drawing.Imaging;</span><br><span class="line"><span class="keyword">public</span> unsafe <span class="class"><span class="keyword">class</span> <span class="title">UnsafeBitmap</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  </span><br><span class="line">    Bitmap bitmap;</span><br><span class="line">    <span class="keyword">int</span> stride;</span><br><span class="line">    BitmapData bitmapData = null;</span><br><span class="line">    Byte* pBase = null;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UnsafeBitmap</span><span class="params">(Bitmap bitmap)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bitmap = <span class="keyword">new</span> Bitmap(bitmap);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UnsafeBitmap</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bitmap = <span class="keyword">new</span> Bitmap(width, height, PixelFormat.Format24bppRgb);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        bitmap.Dispose();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> Bitmap Bitmap</span><br><span class="line">    &#123;</span><br><span class="line">        get</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (bitmap);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">PixelData</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">public</span> byte blue;</span><br><span class="line">        <span class="keyword">public</span> byte green;</span><br><span class="line">        <span class="keyword">public</span> byte red;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> Point PixelSize</span><br><span class="line">    &#123;</span><br><span class="line">        get</span><br><span class="line">        &#123;</span><br><span class="line">            GraphicsUnit unit = GraphicsUnit.Pixel;</span><br><span class="line">            RectangleF bounds = bitmap.GetBounds(ref unit); <span class="keyword">return</span> <span class="keyword">new</span> Point((<span class="keyword">int</span>)bounds.Width, (<span class="keyword">int</span>)bounds.Height);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LockBitmap</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">  </span><br><span class="line">        GraphicsUnit unit = GraphicsUnit.Pixel;</span><br><span class="line">  </span><br><span class="line">        RectangleF boundsF = bitmap.GetBounds(ref unit);</span><br><span class="line">        Rectangle bounds = <span class="keyword">new</span> Rectangle((<span class="keyword">int</span>)boundsF.X,</span><br><span class="line">             (<span class="keyword">int</span>)boundsF.Y,</span><br><span class="line">             (<span class="keyword">int</span>)boundsF.Width,</span><br><span class="line">              (<span class="keyword">int</span>)boundsF.Height);</span><br><span class="line">  </span><br><span class="line">          </span><br><span class="line">  </span><br><span class="line">        bitmapData = bitmap.LockBits(bounds, ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);</span><br><span class="line">        pBase = (Byte*)bitmapData.Scan0.ToPointer();</span><br><span class="line">  </span><br><span class="line">        stride = bitmapData.Stride;</span><br><span class="line">        <span class="comment">//stride = (int)boundsF.Width * sizeof(PixelData);</span></span><br><span class="line">        <span class="comment">//if (stride % 4 != 0)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    stride = 4 * (stride / 4 + 1);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> PixelData <span class="title">GetPixel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        PixelData returnValue = *PixelAt(x, y);</span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetPixel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, PixelData colour)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        PixelData* pixel = PixelAt(x, y);</span><br><span class="line">        *pixel = colour;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UnlockBitmap</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        bitmap.UnlockBits(bitmapData);</span><br><span class="line">        bitmapData = null;</span><br><span class="line">        pBase = null;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> PixelData* <span class="title">PixelAt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (PixelData*)(pBase + y * stride + x * <span class="keyword">sizeof</span>(PixelData));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      </span><br><span class="line">        Bitmap bitmap = <span class="keyword">new</span> Bitmap(@<span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">        UnsafeBitmap bitmap2 = <span class="keyword">new</span> UnsafeBitmap( bitmap );</span><br><span class="line">  </span><br><span class="line">        System.Diagnostics.Stopwatch sw = <span class="keyword">new</span> System.Diagnostics.Stopwatch();</span><br><span class="line">        sw.Start();</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;bitmap.Width; i++) <span class="keyword">for</span>( <span class="keyword">int</span> j=<span class="number">0</span>; j&lt;bitmap.Height; j++ )</span><br><span class="line">        &#123;</span><br><span class="line">            Color c = bitmap.GetPixel( i,j );</span><br><span class="line">        &#125;</span><br><span class="line">        sw.Stop();</span><br><span class="line">        Console.WriteLine( sw.ElapsedTicks );</span><br><span class="line">  </span><br><span class="line">        sw.Reset();</span><br><span class="line">        sw.Start();</span><br><span class="line">        bitmap2.LockBitmap(); </span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;bitmap.Width; i++) <span class="keyword">for</span>( <span class="keyword">int</span> j=<span class="number">0</span>; j&lt;bitmap.Height; j++ )</span><br><span class="line">        &#123;</span><br><span class="line">            UnsafeBitmap.PixelData c = bitmap2.GetPixel( i,j );</span><br><span class="line">        &#125;</span><br><span class="line">        bitmap2.UnlockBitmap();</span><br><span class="line">        sw.Stop();</span><br><span class="line">        Console.WriteLine( sw.ElapsedTicks );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# IO</title>
      <link href="2019/08/18/Csharp/C%20sharp%20IO/"/>
      <url>2019/08/18/Csharp/C%20sharp%20IO/</url>
      
        <content type="html"><![CDATA[<h4 id="流的分类"><a href="#流的分类" class="headerlink" title="流的分类"></a>流的分类</h4><p>存取位置分类：<br>FileStream<br>MemoryStream<br>BufferedStream</p><p>读写类：<br>BinaryReader/BinaryWriter<br>TextReader/TextWriter</p><p>StreamReader/StreamWriter<br>StringReader/StringWriter</p><p>相互关系：</p><pre><code>FileStream fin = new FileStream(@&quot;Path&quot;, FileMode.Open, FileAccess.Read );StreamReader brin = new StreamReader(fin, System.Text.Encoding.Default );</code></pre><h4 id="FileStream"><a href="#FileStream" class="headerlink" title="FileStream"></a>FileStream</h4><ul><li>Seek</li><li>Read</li></ul><h4 id="StreamReader"><a href="#StreamReader" class="headerlink" title="StreamReader"></a>StreamReader</h4><p>实例：new StreamReader(path, FileMode)</p><ul><li>ReadLine</li><li>ReadToEnd</li><li>Read</li><li>Peek</li><li>Close</li></ul><h4 id="StreamWriter"><a href="#StreamWriter" class="headerlink" title="StreamWriter"></a>StreamWriter</h4><p>实例：new StreamWriter(path, FileMode, FileEncode)</p><ul><li>WriteLine</li><li>Write</li><li>Flush</li><li>Close</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LogToFile( <span class="string">&quot;msg&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span> );</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> LogFile = @<span class="string">&quot;c:\aaa.log&quot;</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">LogToFile</span><span class="params">( <span class="built_in">string</span> str, <span class="keyword">bool</span> bWithTime, <span class="keyword">bool</span> bAppendLineFeed)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( str == null ) <span class="keyword">return</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> fname = LogFile;</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span>( fname == <span class="string">&quot;&quot;</span> || fname == null ) <span class="keyword">return</span>;</span><br><span class="line">          </span><br><span class="line">            StreamWriter writer = <span class="keyword">new</span> StreamWriter( fname, <span class="literal">true</span>, System.Text.Encoding.Default );</span><br><span class="line">            <span class="keyword">if</span>( bWithTime )writer.WriteLine( <span class="string">&quot;\r\n\r\n--------- &quot;</span> + DateTime.Now.ToString() );</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span>( bAppendLineFeed ) writer.WriteLine( str );</span><br><span class="line">            <span class="keyword">else</span> writer.Write( str );</span><br><span class="line">  </span><br><span class="line">            writer.Close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e )</span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write( e );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFileAddLineNumber</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> infname = <span class="string">&quot;CopyFileAddLineNumber.cs&quot;</span>;</span><br><span class="line">        <span class="built_in">string</span> outfname = <span class="string">&quot;CopyFileAddLineNumber.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>( args.Length &gt;= <span class="number">1</span> ) infname = args[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>( args.Length &gt;= <span class="number">2</span> ) outfname = args[<span class="number">1</span>];</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span> </span><br><span class="line">        &#123;</span><br><span class="line">            FileStream fin = <span class="keyword">new</span> FileStream( </span><br><span class="line">                infname, FileMode.Open, FileAccess.Read );</span><br><span class="line">            FileStream fout = <span class="keyword">new</span> FileStream(</span><br><span class="line">                outfname, FileMode.Create, FileAccess.Write );</span><br><span class="line">  </span><br><span class="line">            StreamReader brin = <span class="keyword">new</span> StreamReader( </span><br><span class="line">                fin, System.Text.Encoding.Default );</span><br><span class="line">            StreamWriter brout  = <span class="keyword">new</span> StreamWriter(</span><br><span class="line">                fout, System.Text.Encoding.Default );</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>; <span class="comment">// 行号</span></span><br><span class="line">            <span class="built_in">string</span> s = brin.ReadLine();</span><br><span class="line">            <span class="keyword">while</span> ( s != null ) </span><br><span class="line">            &#123;</span><br><span class="line">                cnt ++; </span><br><span class="line">                s = deleteComments(s);                        <span class="comment">//去掉以//开始的注释</span></span><br><span class="line">                brout.WriteLine(cnt + <span class="string">&quot;: \t&quot;</span> + s );           <span class="comment">//写出</span></span><br><span class="line">                Console.WriteLine(cnt + <span class="string">&quot;: \t&quot;</span> + s );     <span class="comment">//在控制上显示</span></span><br><span class="line">                s = brin.ReadLine();                      <span class="comment">//读入</span></span><br><span class="line">            &#125;           </span><br><span class="line">            brin.Close();               <span class="comment">// 关闭缓冲读入流及文件读入流的连接.</span></span><br><span class="line">            brout.Close();</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">catch</span> (FileNotFoundException) </span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;File not found!&quot;</span> );</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">catch</span> (IOException e2) </span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine( e2 );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">deleteComments</span><span class="params">( <span class="built_in">string</span> s )</span> <span class="comment">//去掉以//开始的注释</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( s==null ) <span class="keyword">return</span> s;</span><br><span class="line">        <span class="keyword">int</span> pos = s.IndexOf( <span class="string">&quot;//&quot;</span> );</span><br><span class="line">        <span class="keyword">if</span>( pos&lt;<span class="number">0</span> ) <span class="keyword">return</span> s;</span><br><span class="line">        <span class="keyword">return</span> s.Substring( <span class="number">0</span>, pos );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Serializble"><a href="#Serializble" class="headerlink" title="Serializble"></a>Serializble</h4><ul><li>BinaryFormatter</li><li>XmlFormatter</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.Serialization;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.Serialization.Formatters.Binary;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">namespace</span> SerializationTest</span><br><span class="line">&#123;</span><br><span class="line">  [Serializable]</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Book</span> &#123;</span></span><br><span class="line">      <span class="keyword">public</span> <span class="built_in">string</span> name;</span><br><span class="line">      <span class="comment">//public double price;</span></span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">int</span> num=<span class="number">13</span>; <span class="comment">//如果book的版本变了，反序列化时，这个默认值不会被执行</span></span><br><span class="line">      <span class="keyword">public</span> <span class="built_in">string</span> [] reader;</span><br><span class="line">  </span><br><span class="line">      <span class="function"><span class="keyword">override</span> <span class="keyword">public</span> <span class="built_in">string</span> <span class="title">ToString</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">return</span> name + <span class="string">&quot;:&quot;</span> <span class="comment">//+ price </span></span><br><span class="line">              + <span class="string">&quot;:&quot;</span> + <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,reader)</span><br><span class="line">              + <span class="string">&quot;:&quot;</span> + num;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">      <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">  </span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestBinary</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          BinaryFormatter formatter = <span class="keyword">new</span> BinaryFormatter();</span><br><span class="line">  </span><br><span class="line">          <span class="comment">//Serialization of String Object</span></span><br><span class="line">          Book book = <span class="keyword">new</span> Book();</span><br><span class="line">          book.name = <span class="string">&quot;学习C#&quot;</span>;</span><br><span class="line">          book.price = <span class="number">123.45</span>;</span><br><span class="line">          book.reader = <span class="keyword">new</span> <span class="built_in">string</span>[]&#123; <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;王五&quot;</span>&#125;;</span><br><span class="line">  </span><br><span class="line">          FileStream stream = <span class="keyword">new</span> FileStream(<span class="string">&quot;C:\\StrObj.t&quot;</span>, FileMode.Create, FileAccess.Write ,</span><br><span class="line">            FileShare.None);</span><br><span class="line">          formatter.Serialize(stream, book);</span><br><span class="line">          stream.Close();</span><br><span class="line">  </span><br><span class="line">          <span class="comment">//Deserialization of String Object</span></span><br><span class="line">          FileStream readstream = <span class="keyword">new</span> FileStream(<span class="string">&quot;C:\\StrObj.t&quot;</span>, FileMode.Open , FileAccess.Read ,</span><br><span class="line">            FileShare.Read );</span><br><span class="line">          Book book2 = (Book)formatter.Deserialize(readstream);</span><br><span class="line">          readstream.Close();</span><br><span class="line">          Console.WriteLine(book2);</span><br><span class="line">          Console.ReadLine();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Directory，File"><a href="#Directory，File" class="headerlink" title="Directory，File"></a>Directory，File</h4><p>Directory，DirectoryInfo<br>File，FileInfo</p><p><em>FileSystemInfo 是 DirectoryInfo，FileInfo 的父类</em></p><p>FileInfo 实例信息包含：</p><ul><li>Name</li><li>Extension</li><li>FullName</li><li>Length</li><li>CreationTime</li><li>LastAccessTime </li><li>LastWriteTime</li><li>DirectoryName</li><li>Attributes</li></ul><p>DirectoryInfo 实例信息包含：</p><ul><li>Name</li><li>FullName</li><li>CreationTime</li><li>LastAccessTime </li><li>LastWriteTime</li><li>Parent</li><li>Root</li></ul><p>File 新建，复制，移动，删除文件：</p><ul><li>Create(filePath)</li><li>Copy(filePath1,filePath2)</li><li>Move(filePath1,filePath2)</li><li>Delete(filePath1)</li><li>Exists(filePath)</li><li>CreateText(filePath);</li></ul><p>Directory 新建，复制，移动，删除文件夹：</p><ul><li>CreateDirectory(dirPath)</li><li>Move|Delete|Exists</li><li>GetDirectories(dirPath)</li><li>GetFiles(dirPath)</li></ul><h4 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h4><p>Combine<br>GetDirectoryName<br>GetExtension<br>GetFileName<br>GetFileNameWithoutExtension<br>GetFullPath<br>GetPathRoot<br>GetTempFileName<br>GetTempPath</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">ListAllFiles</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(<span class="built_in">string</span>[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        ListFiles( <span class="keyword">new</span> DirectoryInfo( @<span class="string">&quot;c:\workspace&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ListFiles</span><span class="params">( FileSystemInfo info )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( ! info.Exists ) <span class="keyword">return</span>;</span><br><span class="line">  </span><br><span class="line">        DirectoryInfo dir = info as DirectoryInfo;</span><br><span class="line">        <span class="keyword">if</span>( dir == null ) <span class="keyword">return</span>; <span class="comment">//不是目录</span></span><br><span class="line">          </span><br><span class="line">        FileSystemInfo [] files = dir.GetFileSystemInfos();</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;files.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            FileInfo file = files[i] as FileInfo;</span><br><span class="line">            <span class="keyword">if</span>( file != null ) <span class="comment">// 是文件</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine( </span><br><span class="line">                    file.FullName + <span class="string">&quot;\t&quot;</span> + file.Length );</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>    <span class="comment">//是目录</span></span><br><span class="line">            &#123;</span><br><span class="line">                ListFiles( files[i] );  <span class="comment">//对于子目录,进行递归调用</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 程序设计（二）</title>
      <link href="2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_2/"/>
      <url>2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_2/</url>
      
        <content type="html"><![CDATA[<h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><p>字段，方法，属性，索引器等<br>子类可以添加，隐藏，删除父类成员。</p><h4 id="同名方法"><a href="#同名方法" class="headerlink" title="同名方法"></a>同名方法</h4><p>Overloading<br>new<br>Override：虚方法覆盖重写</p><h4 id="调用父类"><a href="#调用父类" class="headerlink" title="调用父类"></a>调用父类</h4><p>base.sayHello<br>:base(a,b)</p><h4 id="父子转换"><a href="#父子转换" class="headerlink" title="父子转换"></a>父子转换</h4><p>as 只能针对引用类型，不能转换 Null<br>is 判断对象是不是某个类及子类的实例</p><h4 id="访问控制符"><a href="#访问控制符" class="headerlink" title="访问控制符"></a>访问控制符</h4><p>public | private | internal | protected</p><h4 id="static"><a href="#static" class="headerlink" title="static"></a>static</h4><p>字段，属性，方法属于整个类，直接用类名访问<br>变量可以表示全局变量</p><h4 id="const"><a href="#const" class="headerlink" title="const"></a>const</h4><p>常量，只能基本类型和string，例如：Math.PI</p><h4 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h4><p>不可改量，只能赋值一次，例如：String.Empty<br>只能修饰字段</p><h4 id="sealed"><a href="#sealed" class="headerlink" title="sealed"></a>sealed</h4><p>不可继承</p><h4 id="abstract"><a href="#abstract" class="headerlink" title="abstract"></a>abstract</h4><p>不可实例化</p><h4 id="接口-interface"><a href="#接口-interface" class="headerlink" title="接口 interface"></a>接口 interface</h4><p>抽象成员的集合，是一种约定，一个引用类型，比抽象类更抽象，可以实现多继承<br>不相关类的相同行为，了解对象的交互界面</p><h4 id="结构-struct"><a href="#结构-struct" class="headerlink" title="结构 struct"></a>结构 struct</h4><p>值类型<br>不能包含无参数构造方法<br>字段不能有初始值<br>构造方法中，必须给字段赋值<br>sealed修饰，不能被集成</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">R</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Sqrt(x*x+y*y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Point[] points = <span class="keyword">new</span> Point[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">            points[i] = <span class="keyword">new</span> Point(i, i*i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="枚举-enum"><a href="#枚举-enum" class="headerlink" title="枚举 enum"></a>枚举 enum</h4><p>符号化的常量，常定义类别等</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">LightColor</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Red,</span><br><span class="line">    Yellow,</span><br><span class="line">    Green</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrafficLight</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">WhatInfo</span><span class="params">(LightColor color)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(color) &#123;</span><br><span class="line">            <span class="keyword">case</span> LightColor.Red:</span><br><span class="line">                Console.WriteLine(  <span class="string">&quot;Stop!&quot;</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> LightColor.Yellow:</span><br><span class="line">                Console.WriteLine(  <span class="string">&quot;Warning!&quot;</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> LightColor.Green:</span><br><span class="line">                Console.WriteLine(  <span class="string">&quot;Go!&quot;</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 程序设计（三）</title>
      <link href="2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_3/"/>
      <url>2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_3/</url>
      
        <content type="html"><![CDATA[<h4 id="委托"><a href="#委托" class="headerlink" title="委托"></a>委托</h4><p>对函数类型的封装，相当于函数指针</p><p>Action,Func</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="function">delegate <span class="keyword">double</span> <span class="title">Fun</span><span class="params">( <span class="keyword">double</span> x )</span></span>;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegateIntegral</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Fun fun = <span class="keyword">new</span> Fun(Math.Sin);</span><br><span class="line">        <span class="keyword">double</span> d = Integral( fun, <span class="number">0</span>, Math.PI/<span class="number">2</span>, <span class="number">1e-4</span> ); </span><br><span class="line">        Console.WriteLine( d );</span><br><span class="line"> </span><br><span class="line">        Fun fun2 = <span class="keyword">new</span> Fun( Linear );</span><br><span class="line">        <span class="keyword">double</span> d2 = Integral( fun2, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1e-3</span> );</span><br><span class="line">        Console.WriteLine( d2 );</span><br><span class="line"> </span><br><span class="line">        Rnd rnd = <span class="keyword">new</span> Rnd();</span><br><span class="line">        <span class="keyword">double</span> d3 = Integral( <span class="keyword">new</span> Fun(rnd.Num), <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.01</span> ); </span><br><span class="line">        Console.WriteLine( d3 );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">Linear</span><span class="params">( <span class="keyword">double</span> a )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a*<span class="number">2</span>+<span class="number">1</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Rnd</span> </span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Random r = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">Num</span><span class="params">( <span class="keyword">double</span>  x )</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> r.NextDouble();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">Integral</span><span class="params">(Fun f, <span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> eps)</span><span class="comment">// 积分计算</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n,k;</span><br><span class="line">        <span class="keyword">double</span> fa,fb,h,t1,p,s,x,t=<span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        fa=f(a); </span><br><span class="line">        fb=f(b);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 迭代初值</span></span><br><span class="line">        n=<span class="number">1</span>; </span><br><span class="line">        h=b-a;</span><br><span class="line">        t1=h*(fa+fb)/<span class="number">2.0</span>;</span><br><span class="line">        p=<span class="keyword">double</span>.MaxValue;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 迭代计算</span></span><br><span class="line">        <span class="keyword">while</span> (p&gt;=eps)</span><br><span class="line">        &#123; </span><br><span class="line">            s=<span class="number">0.0</span>;</span><br><span class="line">            <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;=n<span class="number">-1</span>;k++)</span><br><span class="line">            &#123; </span><br><span class="line">                x=a+(k+<span class="number">0.5</span>)*h;</span><br><span class="line">                s=s+f(x);</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            t=(t1+h*s)/<span class="number">2.0</span>;</span><br><span class="line">            p=Math.Abs(t1-t);</span><br><span class="line">            t1=t; </span><br><span class="line">            n=n+n; </span><br><span class="line">            h=h/<span class="number">2.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DownloadStartHandler</span><span class="params">(object sender, DownloadStartEventArgs e)</span></span>;  <span class="comment">//声明委托</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DownloadEndHandler</span><span class="params">(object sender, DownloadEndEventArgs e)</span></span>;  </span><br><span class="line"><span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">DownloadingHandler</span><span class="params">(object sender, DownloadingEventArgs e)</span></span>;  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadStartEventArgs</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Url&#123; get&#123; <span class="keyword">return</span> _url;&#125; <span class="built_in">set</span>&#123; _url=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _url;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DownloadStartEventArgs</span><span class="params">( <span class="built_in">string</span> url )</span></span>&#123; <span class="keyword">this</span>._url = url; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadEndEventArgs</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Url&#123; get&#123; <span class="keyword">return</span> _url;&#125; <span class="built_in">set</span>&#123; _url=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _url;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">long</span> ByteCount &#123; get &#123; <span class="keyword">return</span> _byteCount; &#125; <span class="built_in">set</span>&#123; _byteCount=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> _byteCount;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DownloadEndEventArgs</span><span class="params">( <span class="built_in">string</span> url, <span class="keyword">long</span> size  )</span></span>&#123; <span class="keyword">this</span>._url = url; <span class="keyword">this</span>._byteCount=size; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadingEventArgs</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Url&#123; get&#123; <span class="keyword">return</span> _url;&#125; <span class="built_in">set</span>&#123; _url=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _url;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> Percent &#123; get &#123; <span class="keyword">return</span> _percent; &#125; <span class="built_in">set</span>&#123; _percent=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> _percent;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DownloadingEventArgs</span><span class="params">( <span class="built_in">string</span> url, <span class="keyword">double</span> percent  )</span></span>&#123; <span class="keyword">this</span>._url = url; <span class="keyword">this</span>._percent=percent; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Crawler</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> event DownloadStartHandler DownloadStart;  <span class="comment">// 声明事件</span></span><br><span class="line">    <span class="keyword">public</span> event DownloadEndHandler DownloadEnd;  <span class="comment">// 声明事件</span></span><br><span class="line">    <span class="keyword">public</span> event DownloadingHandler Downloading;  <span class="comment">// 声明事件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; get&#123;<span class="keyword">return</span> name;&#125; <span class="built_in">set</span>&#123; name=value;&#125; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> site;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Crawler</span><span class="params">( <span class="built_in">string</span> name, <span class="built_in">string</span> site )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.site = site;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Craw</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">while</span>( <span class="literal">true</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> url = GetNextUrl();</span><br><span class="line">            <span class="keyword">if</span>( url == null ) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">long</span> size = GetSizeOfUrl( url );</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span>( DownloadStart != null ) <span class="comment">//下载开始的事件发生</span></span><br><span class="line">            &#123;</span><br><span class="line">                DownloadStart( <span class="keyword">this</span>, <span class="keyword">new</span> DownloadStartEventArgs(url));</span><br><span class="line">            &#125;</span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>( <span class="keyword">long</span> i=<span class="number">0</span>; i&lt;size+<span class="number">1024</span>; i+=<span class="number">1024</span> )</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//下载数据。。。</span></span><br><span class="line">                System.Threading.Thread.Sleep( <span class="number">100</span> );</span><br><span class="line">                <span class="keyword">double</span> percent = (<span class="keyword">int</span>)(i*<span class="number">100.0</span>/size);</span><br><span class="line">                <span class="keyword">if</span>( percent&gt;<span class="number">100</span>) percent=<span class="number">100</span>;</span><br><span class="line">                  </span><br><span class="line">                <span class="keyword">if</span>( Downloading != null ) <span class="comment">//下载数据的事件发生</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Downloading( <span class="keyword">this</span>, <span class="keyword">new</span> DownloadingEventArgs(url, percent));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span>( DownloadEnd != null ) <span class="comment">//下载结束的事件发生</span></span><br><span class="line">            &#123;</span><br><span class="line">                DownloadEnd( <span class="keyword">this</span>, <span class="keyword">new</span> DownloadEndEventArgs(url, size));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">GetNextUrl</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = rnd.Next(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span>( a == <span class="number">0</span> ) <span class="keyword">return</span> null;</span><br><span class="line">        <span class="keyword">return</span> site + <span class="string">&quot;/Page&quot;</span> + a + <span class="string">&quot;.htm&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">GetSizeOfUrl</span><span class="params">( <span class="built_in">string</span> url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rnd.Next(<span class="number">3000</span> * url.Length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Crawler crawler = <span class="keyword">new</span> Crawler(<span class="string">&quot;Crawer101&quot;</span>, <span class="string">&quot;http://www.pku.edu.cn&quot;</span>);</span><br><span class="line">  </span><br><span class="line">        crawler.DownloadStart += <span class="keyword">new</span> DownloadStartHandler( ShowStart ); <span class="comment">//注册事件</span></span><br><span class="line">        crawler.DownloadEnd += <span class="keyword">new</span> DownloadEndHandler( ShowEnd );</span><br><span class="line">        crawler.Downloading += <span class="keyword">new</span> DownloadingHandler( ShowPercent );</span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">        crawler.Craw();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowStart</span><span class="params">(object sender, DownloadStartEventArgs e)</span></span>&#123;</span><br><span class="line">        Console.WriteLine( (sender as Crawler).Name + <span class="string">&quot;开始下载&quot;</span> + e.Url );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowEnd</span><span class="params">(object sender, DownloadEndEventArgs e)</span></span>&#123;</span><br><span class="line">        Console.WriteLine( <span class="string">&quot;\n\r下载&quot;</span> + e.Url + <span class="string">&quot;结束,其下载&quot;</span> + e.ByteCount + <span class="string">&quot;字节&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowPercent</span><span class="params">(object sender, DownloadingEventArgs e)</span></span>&#123;</span><br><span class="line">        Console.Write( <span class="string">&quot;\r下载&quot;</span> + e.Url + <span class="string">&quot;.......&quot;</span> + e.Percent + <span class="string">&quot;%&quot;</span> );</span><br><span class="line">          </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h4><h4 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h4><h4 id="Linq"><a href="#Linq" class="headerlink" title="Linq"></a>Linq</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.ComponentModel;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">namespace</span> MethodDelegateLamda</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> partial <span class="class"><span class="keyword">class</span> <span class="title">Form1</span> :</span> Form</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Form1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="comment">//示例1,使用线程</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//csharp 1.0</span></span><br><span class="line">            <span class="comment">//使用委托，使用已定义好的函数</span></span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(MyFun)).Start();</span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 2.0</span></span><br><span class="line">            <span class="comment">//省略委托：MyFun自动实例化为ThreadStart委托（</span></span><br><span class="line">            <span class="keyword">new</span> Thread(MyFun).Start();</span><br><span class="line">            <span class="comment">//匿名方法</span></span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart( delegate()&#123; Console.Write(<span class="string">&quot;my function&quot;</span>); &#125;)).Start();</span><br><span class="line">            <span class="comment">//匿名方法，省略参数列表</span></span><br><span class="line">            <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart( delegate&#123; Console.Write(<span class="string">&quot;my function&quot;</span>); &#125;)).Start();</span><br><span class="line">            <span class="comment">//匿名方法，自动转委托</span></span><br><span class="line">            <span class="keyword">new</span> Thread( delegate()&#123; Console.Write(<span class="string">&quot;my function&quot;</span>); &#125;).Start(); </span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 3.0</span></span><br><span class="line">            <span class="comment">//Lambda表达式</span></span><br><span class="line">            <span class="keyword">new</span> Thread(() =&gt; &#123; Console.Write(<span class="string">&quot;my function&quot;</span>); &#125;).Start();</span><br><span class="line">  </span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">MyFun</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.Write(<span class="string">&quot;my function&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="comment">//示例2,使用事件</span></span><br><span class="line">  </span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button3_Click</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Example3();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Example3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//csharp 1.0</span></span><br><span class="line">            <span class="comment">//使用委托，使用自定义函数</span></span><br><span class="line">            <span class="keyword">this</span>.MouseMove += <span class="keyword">new</span> MouseEventHandler(Form1_MouseMove);</span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 2.0</span></span><br><span class="line">            <span class="comment">//自动转委托</span></span><br><span class="line">            <span class="keyword">this</span>.MouseMove += Form1_MouseMove; </span><br><span class="line">  </span><br><span class="line">            Label lbl = <span class="keyword">this</span>.label1; <span class="comment">//这个变量下面使用了闭包（简单地说，使用外部的局部变量）</span></span><br><span class="line">            <span class="keyword">this</span>.MouseMove += <span class="keyword">new</span> MouseEventHandler(delegate(object sender, MouseEventArgs e) &#123; lbl.Text = e.X + <span class="string">&quot;,&quot;</span> + e.Y; &#125;);</span><br><span class="line">            <span class="keyword">this</span>.MouseMove += delegate(object sender, MouseEventArgs e) &#123; lbl.Text = e.X + <span class="string">&quot;,&quot;</span> + e.Y; &#125;;</span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 3.0 </span></span><br><span class="line">            <span class="comment">//使用Lambda表达式</span></span><br><span class="line">            <span class="keyword">this</span>.MouseMove += (object sender, MouseEventArgs e) =&gt; &#123; lbl.Text = e.X + <span class="string">&quot;,&quot;</span> + e.Y; &#125;;　<span class="comment">//Lamda</span></span><br><span class="line">            <span class="keyword">this</span>.MouseMove += (sender, e) =&gt; &#123; lbl.Text = e.X + <span class="string">&quot;,&quot;</span> + e.Y; &#125;; <span class="comment">//可以省略类型</span></span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Form1_MouseMove</span><span class="params">(object sender, MouseEventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.label1.Text = e.X + <span class="string">&quot;,&quot;</span> + e.Y;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="comment">//示例3, 数组排序</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Book</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> title;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">double</span> price;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(<span class="built_in">string</span> title, <span class="keyword">double</span> price)</span> </span>&#123; <span class="keyword">this</span>.title=title; <span class="keyword">this</span>.price=price; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button2_Click</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">            Book [] books  = <span class="keyword">new</span> Book[ <span class="number">10</span>];</span><br><span class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;books.Length; i++ ) books[i] = <span class="keyword">new</span> Book( <span class="string">&quot;Book&quot;</span>+i, rnd.Next(<span class="number">100</span>) );</span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 1.0</span></span><br><span class="line">            Array.Sort(books, <span class="keyword">new</span> MyComparer()); <span class="comment">//用一个IComparer</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 2.0</span></span><br><span class="line">            Array.Sort&lt;Book&gt;(books, <span class="keyword">new</span> Comparison&lt;Book&gt;(delegate(Book book1, Book book2) &#123; <span class="keyword">return</span> (<span class="keyword">int</span>)(book1.price - book2.price); &#125;)); <span class="comment">//使用Comparison委托</span></span><br><span class="line">            Array.Sort&lt;Book&gt;(books, delegate(Book book1, Book book2) &#123; <span class="keyword">return</span> (<span class="keyword">int</span>)(book1.price - book2.price); &#125;);</span><br><span class="line">  </span><br><span class="line">            <span class="comment">//csharp 3.0</span></span><br><span class="line">            Array.Sort&lt;Book&gt;(books, (Book book1, Book book2) =&gt; (<span class="keyword">int</span>)(book1.price - book2.price));</span><br><span class="line">            Array.Sort&lt;Book&gt;(books, (book1, book2) =&gt; (<span class="keyword">int</span>)(book1.price - book2.price)); <span class="comment">//省略参数类型</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">//使用Linq</span></span><br><span class="line">            IOrderedEnumerable&lt;Book&gt; result = from book in books orderby book.price select book;</span><br><span class="line">  </span><br><span class="line">            var result2 = from book in books  where book.price&gt;=<span class="number">0</span> orderby book.price select book.title;</span><br><span class="line">            foreach (<span class="built_in">string</span> s in result2) Console.Write(s);</span><br><span class="line">  </span><br><span class="line">            var result3 = books</span><br><span class="line">                .Where&lt;Book&gt;(b =&gt; b.price&gt;=<span class="number">0</span>)</span><br><span class="line">                .OrderBy&lt;Book, <span class="keyword">double</span>&gt;(b =&gt; b.price, Comparer&lt;<span class="keyword">double</span>&gt;.Default)</span><br><span class="line">                .Select&lt;Book,Book&gt;(book =&gt; book);</span><br><span class="line">            foreach (Book b in result3) Console.Write(b.price+<span class="string">&quot; &quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">MyComparer</span> :</span> System.Collections.IComparer</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Compare</span><span class="params">(object x1, object x2)</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (<span class="keyword">int</span>)(((Book)x1).price - ((Book)x2).price);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>备忘录模式</title>
      <link href="2019/08/18/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
      <url>2019/08/18/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>（Memento Pattern）不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。行为型模式的一种。</p><p>备忘录模式的核心是设计备忘录类以及用于管理备忘录的管理者类，主要有三类角色：</p><p>发起人角色：记录当前时刻的内部状态，负责创建和恢复备忘录数据。<br>备忘录角色：负责存储发起人对象的内部状态，在进行恢复时提供给发起人需要的状态。<br>管理者角色：对备忘录进行管理，提供保存与获取备忘录的功能，但其不能对备忘录的内容进行访问与修改。</p><h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><p>很多应用软件都提供了这项功能，如 Word、记事本、Photoshop、Eclipse 等软件在编辑时按 Ctrl+Z 组合键时能撤销当前操作，使文档恢复到之前的状态；还有在 IE 中的后退键、数据库事务管理中的回滚操作、玩游戏时的中间结果存档功能、数据库与操作系统的备份操作、棋类游戏中的悔棋功能等都属于这类。</p><p>备忘录模式是一种对象行为型模式，其主要优点如下。<br>提供了一种可以恢复状态的机制。当用户需要时能够比较方便地将数据恢复到某个历史的状态。<br>实现了内部状态的封装。除了创建它的发起人之外，其他对象都不能够访问这些状态信息。<br>简化了发起人类。发起人不需要管理和保存其内部状态的各个备份，所有状态信息都保存在备忘录中，并由管理者进行管理，这符合单一职责原则。</p><p>其主要缺点是：资源消耗大。如果要保存的内部状态信息过多或者特别频繁，将会占用比较大的内存资源。</p>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# 程序设计（一）</title>
      <link href="2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_1/"/>
      <url>2019/08/18/Csharp/C%20sharp%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1_1/</url>
      
        <content type="html"><![CDATA[<h4 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h4><p>.Net + VStudio</p><h4 id="公共语言运行时-CLR"><a href="#公共语言运行时-CLR" class="headerlink" title="公共语言运行时 CLR"></a>公共语言运行时 CLR</h4><p>简化开发，安全性，内存管理<br>简化应用程序部署<br>基类库<br>支持多种语言</p><h4 id="编译和执行"><a href="#编译和执行" class="headerlink" title="编译和执行"></a>编译和执行</h4><p>c# 源文件 .cs 文件<br>-&gt; 编译过程<br>元数据，中间代码  .exe 文件<br>-&gt; 执行过程<br>即时编译（JIT） 本地代码，并执行</p><ul><li>exe IL指令,元信息</li><li>反编译工具 ildasm.exe -&gt; NETFX.Tools</li></ul><h4 id="对象三要素"><a href="#对象三要素" class="headerlink" title="对象三要素"></a>对象三要素</h4><p>属性，方法，事件</p><h4 id="常用应用程序类型"><a href="#常用应用程序类型" class="headerlink" title="常用应用程序类型"></a>常用应用程序类型</h4><p>控制台程序<br>Windows应用程序（WPF，WinForm）<br>Web应用程序（ASP.NET）</p><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><ul><li>数据类型本质是数据的“存储方式”及其能“参与的运算”的抽象</li><li>值类型，引用类型</li></ul><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">Array.Copy(source, <span class="number">0</span>, dest, <span class="number">0</span>, source.Length);</span><br><span class="line"><span class="keyword">int</span> [,] a = &#123;&#123;&#125;,&#123;&#125;,&#123;&#125;&#125;</span><br><span class="line">a.GetLength(<span class="number">0</span>), a.GetLength(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">int</span>[][] t = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>][];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 示例 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4</span>; <span class="comment">//按钮的行、列数</span></span><br><span class="line">        Button[,] buttons = <span class="keyword">new</span> Button[N, N]; <span class="comment">//按钮的数组</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Form1_Load</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//产生所有按钮</span></span><br><span class="line">            GenerateAllButtons();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">button1_Click</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//打乱顺序</span></span><br><span class="line">            Shuffle();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//打乱顺序</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Shuffle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//多次随机交换两个按钮</span></span><br><span class="line">            Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> a = rnd.Next(N);</span><br><span class="line">                <span class="keyword">int</span> b = rnd.Next(N);</span><br><span class="line">                <span class="keyword">int</span> c = rnd.Next(N);</span><br><span class="line">                <span class="keyword">int</span> d = rnd.Next(N);</span><br><span class="line">                Swap(buttons[a, b], buttons[c, d]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//生成所有的按钮</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">GenerateAllButtons</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> x0 = <span class="number">100</span>, y0 = <span class="number">10</span>, w = <span class="number">45</span>, d = <span class="number">50</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; N; r++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; N; c++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">int</span> num = r * N + c;</span><br><span class="line">                    Button btn = <span class="keyword">new</span> Button();</span><br><span class="line">                    btn.Text = (num + <span class="number">1</span>).ToString();</span><br><span class="line">                    btn.Top = y0 + r * d;</span><br><span class="line">                    btn.Left = x0 + c * d;</span><br><span class="line">                    btn.Width = w;</span><br><span class="line">                    btn.Height = w;</span><br><span class="line">                    btn.Visible = <span class="literal">true</span>;</span><br><span class="line">                    btn.Tag = r * N + c; <span class="comment">//这个数据用来表示它所在行列位置</span></span><br><span class="line">                     </span><br><span class="line">                    <span class="comment">//注册事件</span></span><br><span class="line">                    btn.Click += <span class="keyword">new</span> EventHandler(btn_Click);</span><br><span class="line"> </span><br><span class="line">                    buttons[r, c] = btn; <span class="comment">//放到数组中</span></span><br><span class="line">                    <span class="keyword">this</span>.Controls.Add(btn); <span class="comment">//加到界面上</span></span><br><span class="line">                &#125;</span><br><span class="line">            buttons[N - <span class="number">1</span>, N - <span class="number">1</span>].Visible = <span class="literal">false</span>; <span class="comment">//最后一个不可见</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//交换两个按钮</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(Button btna, Button btnb)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">string</span> t = btna.Text;</span><br><span class="line">            btna.Text = btnb.Text;</span><br><span class="line">            btnb.Text = t;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">bool</span> v = btna.Visible;</span><br><span class="line">            btna.Visible = btnb.Visible;</span><br><span class="line">            btnb.Visible = v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//按钮点击事件处理</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">btn_Click</span><span class="params">(object sender, EventArgs e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Button btn = sender as Button; <span class="comment">//当前点中的按钮</span></span><br><span class="line">            Button blank = FindHiddenButton(); <span class="comment">//空白按钮</span></span><br><span class="line">            <span class="comment">//判断是否与空白块相邻，如果是，则交换</span></span><br><span class="line">            <span class="keyword">if</span> (IsNeighbor(btn, blank))</span><br><span class="line">            &#123;</span><br><span class="line">                Swap(btn, blank);</span><br><span class="line">                blank.Focus();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//判断是否完成了</span></span><br><span class="line">            <span class="keyword">if</span> (ResultIsOk())</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//查找要隐藏的按钮</span></span><br><span class="line">        <span class="function">Button <span class="title">FindHiddenButton</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; N; r++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; N; c++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!buttons[r, c].Visible)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> buttons[r, c];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">return</span> null;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//判断是否相邻</span></span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">IsNeighbor</span><span class="params">(Button btnA, Button btnB)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> a = (<span class="keyword">int</span>)btnA.Tag; <span class="comment">//Tag中记录是行列位置</span></span><br><span class="line">            <span class="keyword">int</span> b = (<span class="keyword">int</span>)btnB.Tag;</span><br><span class="line">            <span class="keyword">int</span> r1 = a / N, c1 = a % N;</span><br><span class="line">            <span class="keyword">int</span> r2 = b / N, c2 = b % N;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (r1 == r2 &amp;&amp; (c1 == c2 - <span class="number">1</span> || c1 == c2 + <span class="number">1</span>) <span class="comment">//左右相邻</span></span><br><span class="line">                || c1 == c2 &amp;&amp; (r1 == r2 - <span class="number">1</span> || r1 == r2 + <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//检查是否完成</span></span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">ResultIsOk</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; N; r++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; N; c++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (buttons[r, c].Text != (r * N + c + <span class="number">1</span>).ToString())</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h4 id="类-Class"><a href="#类-Class" class="headerlink" title="类 Class"></a>类 Class</h4><p>基本要素：变量，函数</p><h4 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h4><p>作用：初始化值<br>方法名和类名相同<br>没有返回值，也不能写<br>构造方法不能显示直接调用，可以 new 调用</p><p><em>同名方法的重载</em></p><h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><p>对象本身，访问对象字段和方法<br>区分字段和局部变量<br>构造方法调用另一个构造方法</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> :<span class="title">this</span><span class="params">(<span class="number">0</span>,<span class="string">&quot;&quot;</span>)</span></span>&#123; ... &#125;</span><br></pre></td></tr></table></figure><h4 id="属性-方法"><a href="#属性-方法" class="headerlink" title="属性==方法"></a>属性==方法</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">string</span> _name;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Name &#123;</span><br><span class="line">  get&#123; <span class="keyword">return</span> _name;&#125;</span><br><span class="line">  <span class="built_in">set</span>&#123; _name = value;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Name &#123;<span class="built_in">set</span>; get;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///索引器</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[参数列表] &#123;<span class="built_in">set</span>; get;&#125;</span><br><span class="line"><span class="comment">/*示例*/</span></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexerRecord</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> [] data = <span class="keyword">new</span> <span class="built_in">string</span> [<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> [] keys  = &#123;</span><br><span class="line">        <span class="string">&quot;Author&quot;</span>, <span class="string">&quot;Publisher&quot;</span>, <span class="string">&quot;Title&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Subject&quot;</span>, <span class="string">&quot;ISBN&quot;</span>, <span class="string">&quot;Comments&quot;</span> </span><br><span class="line">        &#125;; </span><br><span class="line">     </span><br><span class="line">    <span class="comment">//注：程序中用了两种方法来索引：</span></span><br><span class="line">    <span class="comment">//一是整数作下标，二是字符串（关键词名）作下标</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[ <span class="keyword">int</span> idx ]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>( idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; data.Length )</span><br><span class="line">                data[ idx ] = value;</span><br><span class="line">        &#125;</span><br><span class="line">        get</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>( idx &gt;= <span class="number">0</span> &amp;&amp; idx &lt; data.Length )</span><br><span class="line">                <span class="keyword">return</span> data[ idx ];</span><br><span class="line">            <span class="keyword">return</span> null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[ <span class="built_in">string</span> key ]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> idx = FindKey( key );</span><br><span class="line">            <span class="keyword">this</span>[ idx ] = value;</span><br><span class="line">        &#125;</span><br><span class="line">        get</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>[ FindKey(key) ];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">FindKey</span><span class="params">( <span class="built_in">string</span> key )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">int</span> i=<span class="number">0</span>; i&lt;keys.Length; i++)</span><br><span class="line">            <span class="keyword">if</span>( keys[i] == key ) <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        IndexerRecord record = <span class="keyword">new</span> IndexerRecord();</span><br><span class="line">        record[ <span class="number">0</span> ] = <span class="string">&quot;马克-吐温&quot;</span>;</span><br><span class="line">        record[ <span class="number">1</span> ] = <span class="string">&quot;Crox出版公司&quot;</span>;</span><br><span class="line">        record[ <span class="number">2</span> ] = <span class="string">&quot;汤姆-索亚历险记&quot;</span>;</span><br><span class="line">        Console.WriteLine( record[ <span class="string">&quot;Title&quot;</span> ] );</span><br><span class="line">        Console.WriteLine( record[ <span class="string">&quot;Author&quot;</span> ] );</span><br><span class="line">        Console.WriteLine( record[ <span class="string">&quot;Publisher&quot;</span> ] );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>设置只读，只写；<br>进行有效性检查；<br>计算数据返回；<br>定义抽象属性；</p>]]></content>
      
      
      <categories>
          
          <category> 程序设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xml 入门基础</title>
      <link href="2019/08/18/Csharp/XML%20%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>2019/08/18/Csharp/XML%20%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="实体引用"><a href="#实体引用" class="headerlink" title="实体引用"></a>实体引用</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &amp;lt;               &lt;</span></span><br><span class="line"><span class="comment"># &amp;gt;               &gt;</span></span><br><span class="line"><span class="comment"># &amp;amp;              &amp;</span></span><br><span class="line"><span class="comment"># &amp;apos;             &#x27;</span></span><br><span class="line"><span class="comment"># &amp;quot;             &quot;</span></span><br></pre></td></tr></table></figure><h4 id="CDATA-区"><a href="#CDATA-区" class="headerlink" title="CDATA 区"></a>CDATA 区</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;![CDATA[ 内容 ]]&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- CDATA 区内，不必使用实体--引用，XML解析器不会解析 CDATA 区内的内容 ---&gt;</span></span><br></pre></td></tr></table></figure><h4 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h4><pre><code>xmlns:&lt;name&gt;=&lt;&quot;uri&quot;&gt;&lt;name&gt;：命名空间前缀&lt;&quot;uri&quot;&gt;：命名空间 URI 的字符串</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;f:table xmlns:f=&quot;http://www.w3.org/furniture&quot;&gt;</span><br><span class="line">    &lt;f:name&gt;African Coffee&lt;/f:name&gt;</span><br><span class="line">    &lt;f:width&gt;80&lt;/f:width&gt;</span><br><span class="line">&lt;/f:table&gt;</span><br></pre></td></tr></table></figure><h4 id="XML-解析模式"><a href="#XML-解析模式" class="headerlink" title="XML 解析模式"></a>XML 解析模式</h4><p>1.流模型 分为：“推”，“拉”两种变体</p><pre><code>“推”模型，SAX是事件驱动模型    </code></pre><p>2.DOM（文档对象模型）</p><pre><code>建立树状结构的方式访问XML文档</code></pre><p>区别：<br>    DOM需要加载整个文档和构造层次结构才能工作<br>    DOM内存持久，SAX一次性处理</p><pre><code>DOM处理文档编码方便，SAX很难同时访问同一个文档的多处不同数据.NET 支持 “拉”模式，通过 XMLTextReader 类实现，不支持 SAXDOM 允许编辑更新XML，可以随机访问文档数据，可以用Xpath查询</code></pre><blockquote><p>XSLT 转换只能输出纯文本文档</p></blockquote><h4 id="位置、步"><a href="#位置、步" class="headerlink" title="位置、步"></a>位置、步</h4><p>绝对位置路径：/step/step/…<br>相对位置路径：step/step/…</p><p>步的语法：轴名称::节点测试[谓词]</p><p>轴名称：ancestor、ancestor-or-self、attribute、child、descendant、descendant-or-self、following、namespace、parent、preceding、preceding-sibling、self</p><p>节点测试：识别某个轴内部的节点</p><h4 id="Xml-结构"><a href="#Xml-结构" class="headerlink" title="Xml 结构"></a>Xml 结构</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">father</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span> Tom Smith</span><br><span class="line">    <span class="tag">&lt;<span class="name">son</span>&gt;</span> John Smith</span><br><span class="line">        <span class="tag">&lt;<span class="name">grandson</span>&gt;</span> Hans Smith<span class="tag">&lt;/<span class="name">grandson</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">son</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">daughter</span>&gt;</span> Jane Smith<span class="tag">&lt;/<span class="name">daughter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">son</span>&gt;</span> Jake Smith</span><br><span class="line">        <span class="tag">&lt;<span class="name">grandson</span>&gt;</span> White Smith<span class="tag">&lt;/<span class="name">grandson</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">son</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">daughter</span>&gt;</span> Lucky Smith<span class="tag">&lt;/<span class="name">daughter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">father</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Xpath-操作"><a href="#Xpath-操作" class="headerlink" title="Xpath 操作"></a>Xpath 操作</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//son/child::node()</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#John Smith</span></span><br><span class="line"><span class="comment">#&lt;grandson&gt; Hans Smith&lt;/grandson&gt;</span></span><br><span class="line"><span class="comment">#Jake Smith</span></span><br><span class="line"><span class="comment">#&lt;grandson&gt; White Smith&lt;/grandson&gt;</span></span><br><span class="line"></span><br><span class="line">/father/son/text()</span><br><span class="line">//son/text()</span><br><span class="line">//son/child::node()[1]</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#John Smith</span></span><br><span class="line"><span class="comment">#Jake Smith</span></span><br><span class="line"></span><br><span class="line">/father/son/grandson/text()</span><br><span class="line">//son/grandson/text()</span><br><span class="line">//son/child::node()[2]/text()</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#Hans Smith</span></span><br><span class="line"><span class="comment">#White Smith</span></span><br><span class="line"></span><br><span class="line">string(/father/son/grandson)</span><br><span class="line">string(//son/grandson)</span><br><span class="line">string(//son/child::node()[2])</span><br><span class="line">string(//son/child::node()[2]/text())</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#Hans Smith</span></span><br><span class="line"></span><br><span class="line">//son[2]/grandson/text()</span><br><span class="line">(//son/grandson/text())[2]</span><br><span class="line">(son/grandson/text())[2]</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment">#White Smith</span></span><br><span class="line"></span><br><span class="line">//son/grandson[2]/text()</span><br><span class="line"><span class="comment">#无返回</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>总结：</code></pre><p>Xpath 是一种表达式，返回值可以是节点、节点集合、原子值，以及节点和原子值的混合等<br>节点类型：元素、属性、文本、命名空间、处理指令、注释、根节点<br>节点关系：父 Parent、子 Children、兄弟 Sibling、先辈 Ancestor、后代 Descendant</p><p>Xpath 采用内嵌条件判断语句，解决Xpath路径无法唯一的确认XML节点<br>Xpath 路径字符串中使用 [] 包含逻辑表达式，谓词被嵌套在方括号中</p><p>通配符：* node() @*</p><h4 id="Xpath-函数"><a href="#Xpath-函数" class="headerlink" title="Xpath 函数"></a>Xpath 函数</h4><p>数值：number、ceiling、floor、round<br>字符串：string、concat、substring、string-length、normalize-space、translate、contains、starts-with、ends-with、<br>substring-before、substring-after<br>上下文：position、last<br>节点函数：name、local-name<br>布尔值函数：boolean、not、true、false</p><p>其它：测试序列容量的函数、QNames相关的函数、合计函数、生成序列的函数等</p><h4 id="XSLT-应用"><a href="#XSLT-应用" class="headerlink" title="XSLT 应用"></a>XSLT 应用</h4><p><strong>XSLT 转换过程：</strong></p><p>1.创建 XML 文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span> xml 文件 <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.创建 XSLT 文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/XSL/Transform&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:for-each</span> <span class="attr">select</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsl:if</span> <span class="attr">test</span>=<span class="string">&quot;布尔表达式&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 执行内容 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">xsl:if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsl:for-each</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet</span><br></pre></td></tr></table></figure><p>3.XML 引用 XSL 文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引用 XSL 文件 --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=“xxx.xsl”?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span> xml 文件 <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>XSLT 语法：</strong></p><p>&lt;xsl:template&gt;和&lt;xsl:apply-templates&gt;<br>模板由两部组成：匹配模式和执行</p><p>&lt;xsl:template&gt; 定义模板，<br>&lt;xsl:apply-templates&gt; 用来执行哪一个节点被模板具体处理，可以理解为程序中调用子函数。&lt;xsl:apply-templates&gt; 总是嵌套在 &lt;xsl:template&gt; 元素内</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">Xpath</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 执行内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:apply-templates</span> <span class="attr">select</span>=<span class="string">Xpath</span> <span class="attr">set-expression</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 执行内容 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:apply-templates</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;xsl:value-of&gt;和&lt;xsl:copy-of&gt; 选取XML元素以及把它添加到已被转换的输出流</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:value-of</span> <span class="attr">select</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;xsl:for-each&gt; 允许在XSLT里使用循环语句</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:for-each</span> <span class="attr">select</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:for-each</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;xsl:sort&gt; 节点集合分类，排序</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:sort</span> <span class="attr">select</span>=<span class="string">&quot;XPath获取属性&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;xsl:if&gt; 条件判断语句</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:for-each</span> <span class="attr">select</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:if</span> <span class="attr">test</span>=<span class="string">&quot;布尔表达式&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 执行内容 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsl:if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:for-each</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;xsl:choose&gt; &lt;xsl:when&gt; &lt;xsl:otherwise&gt; 多条件判断语句</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:choose</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:when</span> <span class="attr">test</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span><span class="comment">&lt;!-- 执行内容 --&gt;</span><span class="tag">&lt;/<span class="name">xsl:when</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:when</span> <span class="attr">test</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span><span class="comment">&lt;!-- 执行内容 --&gt;</span><span class="tag">&lt;/<span class="name">xsl:when</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:otherwise</span>&gt;</span><span class="comment">&lt;!-- 执行内容 --&gt;</span><span class="tag">&lt;/<span class="name">xsl:otherwise</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>.NET XslCompiledTransform 类，命名空间 System.Xml.Xsl，接受 XML 数据并将其转换成多种形式</p><p><strong>XSLT 传递参数：</strong></p><p>XSLT 文件中定义参数变量，能够接受外部传入的具体值。.NET XsltArgumentList 类可以获得这些值集合</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义参数变量 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:param</span> <span class="attr">name</span>=<span class="string">&quot;paramname&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">pattern</span> <span class="attr">name</span>=<span class="string">qname</span> <span class="attr">priority</span>=<span class="string">number</span> <span class="attr">mode</span>=<span class="string">qname</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:for-each</span> <span class="attr">select</span>=<span class="string">&quot;XPath&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsl:if</span> <span class="attr">test</span>=<span class="string">&quot;Xpath[text()=$paramname]&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 执行内容 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsl:if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsl:for-each</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>应用扩展对象：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义 命名空间 mObj--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/XSL/Transform&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">xmlns:mObj</span>=<span class="string">&quot;urn:price-conv&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 定义 变量 conv--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:param</span> <span class="attr">name</span>=<span class="string">&quot;conv&quot;</span> <span class="attr">select</span>=<span class="string">&quot;1.529&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 添加新项目 NewPrice--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">conv-price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsl:value-of</span> <span class="attr">select</span>=<span class="string">&quot;mObj:NewPriceFunc(./price, $conv)&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">conv-price</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- c# 代码 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">XslCompiledTransform 实例对象 _xslt</span></span><br><span class="line"><span class="comment">调用 Load() 加载 XSLT 样式表文件</span></span><br><span class="line"><span class="comment">定义 BookPrice 类</span></span><br><span class="line"><span class="comment">BookPrice 实例对象 _obj</span></span><br><span class="line"><span class="comment">XsltArgumentList 实例对象 _argum</span></span><br><span class="line"><span class="comment">调用 AddExtensionObject(URL，Obj) 方法</span></span><br><span class="line"><span class="comment">    命名空间 URL：“urn:price-conv”</span></span><br><span class="line"><span class="comment">    Obj 对象：“BookPrice 实例对象 _obj”</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mObj:NewPriceFunc -&gt; BookPrice 类中定义的 NewPriceFunc 函数，通过 _obj 对象在 XSLT 中被调用</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h4 id="XML-验证"><a href="#XML-验证" class="headerlink" title="XML 验证"></a>XML 验证</h4><p>XML 目的：存储和交换数据<br>XML 验证目的：保证所有的 XML 文档结构一致<br>两种方法：DTD模式、XML Schema</p><pre><code>区别：</code></pre><p>DTD基于正则，描述能力不够；没有数据类型的支持；约束定义能力不足，无法对 XML 文档作出更细致的语义限制；结构不够结构化；没有标准的编程接口<br>XML Schema基于XML，支持数据类型，可扩展的数据模型，支持综合命名空间，属性组</p><pre><code>XML 应用 DTD:    内部 DTD、外部 DTD：&lt;!DOCTYPE customers SYSTEM &quot;Customers.dtd&quot;&gt;XML 应用 XSD Schema:    XML 根元素 包含 xmlns:xsi，xsi:(schemaLocation|nonamespaceschemaLocation    )    XSD 声明中添加 targetNamespace 指定目标名字空间XML Schema 创建：    编辑文本方式、VStudio 设计器、模式对象模型（SOM），编程方式</code></pre><p><strong>XML Schema 文档：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- XML Schema 文档 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns:xs</span>=<span class="string">&quot;http://www.w3.org/XMLSchema&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;quantity&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:nonNegativeInteger&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">quantity：元素</span></span><br><span class="line"><span class="comment">nonNegativeInteger：类型</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>XSD 文档至少包含：schema 根元素（唯一）和XML模式命名空间的定义、元素定义</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- schema 根元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:schema</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/XMLSchema&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 元素 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xsd:string&quot;</span> <span class="attr">minOccurs</span>=<span class="string">&quot;元素在父元素中出现的最少次数，默认1，值范围&gt;=0&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">maxOccurs</span>=<span class="string">&quot;出现的最多次数，unbounded：次数不限制&quot;</span> <span class="attr">default</span>=<span class="string">&quot;默认值&quot;</span> <span class="attr">fixed</span>=<span class="string">&quot;固定值&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:schema</span>&gt;</span></span><br></pre></td></tr></table></figure><p>应用元素、替代、组合器：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- schema 根元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:schema</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/XMLSchema&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 元素别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">&quot;yonghu&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xsd:string&quot;</span> <span class="attr">substitutionGroup</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xsd:string&quot;</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- sequence组合器：定义一列元素必须按照模式中制定的顺序显示 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">xsd:sequence</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- all组合器：允许一列元素任意顺序显示，all 元素的子元素默认情况必须，且最多显示一次 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:all</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">xsd:all</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- choice组合器：允许一列元素中的一个，用于互斥 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">xsd:element</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">xsd:choice</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">xsd:complexType</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:element</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:schema</span>&gt;</span></span><br></pre></td></tr></table></figure><p>属性：default、fixed、name、ref、type、use、form、id</p><pre><code>&lt;xsd:attribute name=&quot;age&quot; type=&quot;xsd:integer&quot;/&gt;</code></pre><p><a href="xsd:attribute">xsd:attribute</a> 必须是 schema、complexType、attributeGroup 元素的子元素，要把属性添加到元素上，属性应该在 complexType 定义的组合器后定义或应用</p><p><strong>Schema 数据类型：</strong></p><pre><code>约束：    enumeration、fractionDigit、length、(min|max)(Exclusive|Length|Inclusive)、pattern、totalDigits、whiteSpace简单类型：    simpleType 不能包含元素、属性，只能是值、值得集合列表类型：    list联合类型：    union    复杂类型：    complexType    内容模型：    any empty mixed</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义 simpleType 简单类型 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">id</span>=<span class="string">&quot;唯一标识&quot;</span> <span class="attr">name</span>=<span class="string">&quot;USState&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- resteriction 应用约束 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:resteriction</span> <span class="attr">id</span>=<span class="string">&quot;唯一标识&quot;</span> <span class="attr">base</span>=<span class="string">&quot;xsd:string&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">&quot;AK&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">xsd:enumeration</span> <span class="attr">value</span>=<span class="string">&quot;AL&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xsd:resteriction</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">id</span>=<span class="string">&quot;唯一标识&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ListOfIntType&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:list</span> <span class="attr">itemType</span>=<span class="string">&quot;Integer&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xsd:simpleType</span> <span class="attr">id</span>=<span class="string">&quot;唯一标识&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ZipUnion&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义联合类型 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xsd:union</span> <span class="attr">memberTypes</span>=<span class="string">&quot;USState ListOfIntType&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xsd:simpleType</span>&gt;</span></span><br></pre></td></tr></table></figure><p>XMLReader 类验证 XML<br>XMLDocument 类验证 XML<br>XPath 导航器验证 XML<br>验证未声明 XSD Schema 模式文件位置的 XML<br>    ValidationEventHandler 事件实例 -关联-&gt; 处理函数 ValidationEventHandler() -&gt; XmlDocument类 -&gt; Validate()</p>]]></content>
      
      
      <categories>
          
          <category> Xml </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xpath 示例</title>
      <link href="2019/08/18/Csharp/Xpath%20%E7%A4%BA%E4%BE%8B/"/>
      <url>2019/08/18/Csharp/Xpath%20%E7%A4%BA%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pets</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cat</span> <span class="attr">color</span>=<span class="string">&quot;black&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>100<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a black cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cat</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cat</span> <span class="attr">color</span>=<span class="string">&quot;white&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;9&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>80<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a white cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cat</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">cat</span> <span class="attr">color</span>=<span class="string">&quot;yellow&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;15&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>80<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a yellow cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">cat</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">dog</span> <span class="attr">color</span>=<span class="string">&quot;black&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>100<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a black dog<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dog</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dog</span> <span class="attr">color</span>=<span class="string">&quot;white&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;9&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>80<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a white dog<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dog</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dog</span> <span class="attr">color</span>=<span class="string">&quot;yellow&quot;</span> <span class="attr">weight</span>=<span class="string">&quot;15&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">price</span>&gt;</span>80<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">desc</span>&gt;</span>this is a yellow dog<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pets</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="XPath-符号"><a href="#XPath-符号" class="headerlink" title="XPath 符号"></a>XPath 符号</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&quot;/&quot; 从根节点开始选择，节点之间的分隔符</span><br><span class="line"><span class="comment">&lt;!-- 选择根节点 pets --&gt;</span></span><br><span class="line">/pets  </span><br><span class="line"><span class="comment">&lt;!-- 选择根节点 pets 下的所有 dog 节点 --&gt;</span></span><br><span class="line">/pets/dog</span><br><span class="line"></span><br><span class="line">&quot;//&quot; 从整个xml文档中查找，而不考虑当前节点位置</span><br><span class="line"><span class="comment">&lt;!-- 选择文档中所有的 price 节点 --&gt;</span></span><br><span class="line">//price</span><br><span class="line"></span><br><span class="line">&quot;.&quot; 单个英文半角句点表示选择当前节点</span><br><span class="line"><span class="comment">&lt;!-- 选择pets节点 --&gt;</span></span><br><span class="line">/pets/.</span><br><span class="line"></span><br><span class="line">&quot;..&quot; 双点，表示选择父节点</span><br><span class="line"><span class="comment">&lt;!-- 选择 pets 节点下的第一个 dog 节点的父节点，也就是选择 pets 节点, --&gt;</span></span><br><span class="line">/pets/dog[0]/..</span><br><span class="line"></span><br><span class="line">&quot;@xx&quot; 选择属性</span><br><span class="line"><span class="comment">&lt;!-- 选择所有dog节点的color属性集合 --&gt;</span></span><br><span class="line">//dog/@color</span><br><span class="line"></span><br><span class="line">&quot;[…]&quot; 表示选择条件，括号内为条件</span><br><span class="line"><span class="comment">&lt;!-- 所有 color 为 white 的 dog 节点 --&gt;</span></span><br><span class="line">//dog[@color=’white’]</span><br><span class="line"><span class="comment">&lt;!-- 所有 price 字节点值小于100的 dog 节点 --&gt;</span></span><br><span class="line">//dog[/price&lt;100]</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 第1个 dog 节点 --&gt;</span></span><br><span class="line">//dog[1]</span><br><span class="line"><span class="comment">&lt;!-- 最后一个 dog 节点 --&gt;</span></span><br><span class="line">//dog[last()]</span><br><span class="line"></span><br><span class="line">&quot;|&quot; 单竖杠表示合并节点结合</span><br><span class="line"><span class="comment">&lt;!-- color 属性为 white 的 dog 节点和 color 属性为 white 的 cat 节点 --&gt;</span></span><br><span class="line">//dog[@color=’white’] | //cat[@color=’white’]</span><br><span class="line"></span><br><span class="line">&quot;*&quot; 表示任何名字的节点或者属性</span><br><span class="line">//dog/*</span><br><span class="line">//dog/@*</span><br></pre></td></tr></table></figure><h4 id="数学运算符"><a href="#数学运算符" class="headerlink" title="数学运算符"></a>数学运算符</h4><p>+  -  *  div  mod</p><h4 id="常用-Axes"><a href="#常用-Axes" class="headerlink" title="常用 Axes"></a>常用 Axes</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--当前节点的所有字节点--&gt;</span></span><br><span class="line">child::*[name()!=’price’]</span><br><span class="line"><span class="comment">&lt;!--有属性的子孙节点--&gt;</span></span><br><span class="line">descendant::*[@*]</span><br><span class="line"><span class="comment">&lt;!--当前节点之后的所有节点--&gt;</span></span><br><span class="line">following::*</span><br><span class="line"><span class="comment">&lt;!--当前节点之后的同父兄弟节点--&gt;</span></span><br><span class="line">following-sibling::</span><br><span class="line"><span class="comment">&lt;!--同 following ，当前节点之前--&gt;</span></span><br><span class="line">preceding::* || preceding-sibling::*</span><br><span class="line"></span><br><span class="line">string xPath = &quot;//cat[@color=&#x27;color&#x27; and @weight=&#x27;15&#x27;]/following-sibling::dog[contains(@color,&#x27;w&#x27;) and @weight!=&#x27;9&#x27;]&quot;;</span><br></pre></td></tr></table></figure><h4 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h4><ul><li>position()</li><li>last()</li><li>name()</li></ul><h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">XmlDocument doc = <span class="keyword">new</span> XmlDocument();</span><br><span class="line">doc.Load(@<span class="string">&quot;.\BookList.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">XPathNavigator nav =doc.CreateNavigator();</span><br><span class="line">nav.MoveToRoot();</span><br><span class="line"></span><br><span class="line">XslTransform xt = <span class="keyword">new</span> XslTransform();</span><br><span class="line">xt.Load(@<span class="string">&quot;.\BookList.xslt&quot;</span>);</span><br><span class="line"></span><br><span class="line">XmlTextWriter writer = <span class="keyword">new</span> XmlTextWriter(Console.Out);</span><br><span class="line"></span><br><span class="line">xt.Transform(nav,  null, writer);</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/1575db75670f">Xpath 用法</a></p>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>位运算技巧</title>
      <link href="2019/08/18/Csharp/%E4%BD%8D%E8%BF%90%E7%AE%97%E6%8A%80%E5%B7%A7/"/>
      <url>2019/08/18/Csharp/%E4%BD%8D%E8%BF%90%E7%AE%97%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<ul><li>获得int型最大值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMaxInt</span><span class="params">()</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; <span class="number">31</span>) - <span class="number">1</span>;<span class="comment">//2147483647， 由于优先级关系，括号不可省略 </span></span><br><span class="line">  <span class="keyword">return</span> ~(<span class="number">1</span> &lt;&lt; <span class="number">31</span>);</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; <span class="number">-1</span>) - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> ((<span class="keyword">unsigned</span> <span class="keyword">int</span>) - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>获得int型最小值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMinInt</span><span class="params">()</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; <span class="number">31</span>;<span class="comment">//-2147483648  </span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>获得long类型的最大值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">getMaxLong</span><span class="params">()</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;<span class="comment">//2147483647  </span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li>乘以2运算，2的m次方，除以2运算，2的m次方</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mulanddiv</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span>&#123;  </span><br><span class="line">   <span class="keyword">return</span> n &lt;&lt; <span class="number">1</span>;  <span class="comment">// n*2  </span></span><br><span class="line">  <span class="keyword">return</span> n &lt;&lt; m;  <span class="comment">// n*(2^m)  </span></span><br><span class="line">  <span class="keyword">return</span> n &gt;&gt; <span class="number">1</span>;  <span class="comment">// n/2 </span></span><br><span class="line">  <span class="keyword">return</span> n &gt;&gt; m;  <span class="comment">// n/(2^m) </span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>判断一个数的奇偶性</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">boolean <span class="title">isOddNumber</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> (n &amp; <span class="number">1</span>) == <span class="number">1</span>;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>不用临时变量交换两个数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> *b)</span></span>&#123;     </span><br><span class="line">  (*a) ^= (*b) ^= (*a) ^= (*b);     </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>取绝对值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">abs</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> (n ^ (n &gt;&gt; <span class="number">31</span>)) - (n &gt;&gt; <span class="number">31</span>);  </span><br><span class="line">  <span class="comment">/* n&gt;&gt;31 取得n的符号，若n为正数，n&gt;&gt;31等于0，若n为负数，n&gt;&gt;31等于-1 </span></span><br><span class="line"><span class="comment">  若n为正数 n^0=0,数不变，若n为负数有n^-1 需要计算n和-1的补码，然后进行异或运算， </span></span><br><span class="line"><span class="comment">  结果n变号并且为n的绝对值减1，再减去-1就是绝对值 */</span>  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>取两个数的最大值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> b &amp; ((a-b) &gt;&gt; <span class="number">31</span>) | a &amp; (~(a-b) &gt;&gt; <span class="number">31</span>);  </span><br><span class="line">  <span class="comment">/*如果a&gt;=b,(a-b)&gt;&gt;31为0，否则为-1*/</span>  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> a ^ ((a ^ b) &amp; -(a &lt; b));  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>取两个数的最小值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> a &amp; ((a-b) &gt;&gt; <span class="number">31</span>) | b &amp; (~(a-b) &gt;&gt; <span class="number">31</span>);  </span><br><span class="line">  <span class="comment">/*如果a&gt;=b,(a-b)&gt;&gt;31为0，否则为-1*/</span>  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> b ^ ((a ^ b) &amp; -(a &lt; b));  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>判断符号是否相同</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">boolean <span class="title">isSameSign</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; <span class="comment">//有0的情况例外  </span></span><br><span class="line">  <span class="keyword">return</span> (x ^ y) &gt;= <span class="number">0</span>; <span class="comment">// true 表示 x和y有相同的符号， false表示x，y有相反的符号。  </span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>2的n次方</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getFactorialofTwo</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">  <span class="comment">//n &gt; 0  </span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span> &lt;&lt; (n<span class="number">-1</span>);<span class="comment">//2的n次方  </span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>判断一个数是不是2的幂</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">boolean <span class="title">isFactorialofTwo</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> n &gt; <span class="number">0</span> ? (n &amp; (n - <span class="number">1</span>)) == <span class="number">0</span> : <span class="literal">false</span>;  </span><br><span class="line">  <span class="comment">/*如果是2的幂，n一定是100... n-1就是1111.... </span></span><br><span class="line"><span class="comment">  所以做与运算结果为0*/</span>  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>对2的n次方取余</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">quyu</span><span class="params">(<span class="keyword">int</span> m,<span class="keyword">int</span> n)</span></span>&#123;<span class="comment">//n为2的次方  </span></span><br><span class="line">  <span class="keyword">return</span> m &amp; (n - <span class="number">1</span>);  </span><br><span class="line">  <span class="comment">/*如果是2的幂，n一定是100... n-1就是1111.... </span></span><br><span class="line"><span class="comment">  所以做与运算结果保留m在n范围的非0的位*/</span>  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><ul><li>求两个整数的平均值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAverage</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> (x + y) &gt;&gt; <span class="number">1</span>;   </span><br><span class="line">  <span class="keyword">return</span> ((x ^ y) &gt;&gt; <span class="number">1</span>) + (x &amp; y);   </span><br><span class="line">  <span class="comment">/*(x^y) &gt;&gt; 1得到x，y其中一个为1的位并除以2， x&amp;y得到x，y都为1的部分，加一起就是平均数了*/</span></span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> .Net </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# 设计模式</title>
      <link href="2019/08/18/Csharp/C%20sharp%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>2019/08/18/Csharp/C%20sharp%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>设计模式不是知识点，是一种经验的总结，用来解决某些场景下的某一类问题的通用解决方案。<br>设计模式让代码更容易被理解，确保了复用性、可靠性、可扩展性</p><h4 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h4><ul><li>单一职责原则：一个类，只有一个引起它变化的原因</li><li>开闭原则：扩展开放，修改封闭</li><li>里氏代替原则：子类必须替换掉它们的父类</li><li>依赖倒置原则：面向接口编程，而不是面向实现编程</li><li>接口隔离原则</li><li>合成复用原则：Has-A 和 Is-A</li><li>迪米特法则：不要和陌生人说话，最少知识原则</li></ul><h4 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h4><blockquote><p>单例模式，工厂方法模式，抽象工厂模式，建造者模式，原型模式</p></blockquote><p>单例模式：</p><pre><code>通过私有构造函数来保证类外部不能对类进行实例化，实现类只要一个实例。创建一个返回类对象的静态方法，提供一个全局访问点。*双重锁校验*饿汉式（立即加载）、懒汉式（延迟加载）、生命周期托管</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">    &#123;</span><br><span class="line">        get &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">set</span> &#123;</span><br><span class="line">            name = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Singleton</span><span class="params">(<span class="built_in">string</span> name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">(<span class="built_in">string</span> name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == null)</span><br><span class="line">        &#123;</span><br><span class="line">            lock (typeof(Singleton))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == null)</span><br><span class="line">                &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Singleton(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>工厂方法模式：</p><pre><code>声明一个工厂抽象类，定义一个工厂接口。创建派生于工厂抽象类的产品抽象类和具体产品类，由其具体子类创建对象。</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> abstract <span class="class"><span class="keyword">class</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> NumberA &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> NumberB &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">GetResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 加法运算</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Plus</span> :</span> Operation</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA + NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 减法运算</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Minus</span> :</span> Operation</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA - NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 乘法运算</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Multiply</span> :</span> Operation</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> NumberA * NumberB;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 除法运算</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Divide</span> :</span>Operation</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> NumberA / NumberB;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 简单工厂</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OperationFactory</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Operation <span class="title">CreateOperate</span><span class="params">(<span class="built_in">string</span> operate)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Operation operation = null;</span><br><span class="line">        <span class="keyword">switch</span> (operate)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;+&quot;</span>:</span><br><span class="line">                operation = <span class="keyword">new</span> Plus();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;-&quot;</span>:</span><br><span class="line">                operation = <span class="keyword">new</span> Minus();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                operation = <span class="keyword">new</span> Multiply();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;/&quot;</span>:</span><br><span class="line">                operation = <span class="keyword">new</span> Divide();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> operation;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用方法</span></span><br><span class="line">Operation operateion = OperationFactory.CreateOperate(<span class="string">&quot;+&quot;</span>);</span><br><span class="line">operateion.NumberA = <span class="number">10</span>;</span><br><span class="line">operateion.NumberB = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(operateion.GetResult());</span><br></pre></td></tr></table></figure><p>抽象工厂模式：</p><pre><code>提供多个产品的抽象接口。每一个具体工厂创建一个产品族中的多个产品对象，多个具体工厂就可以创建多个产品族中的多个对象。</code></pre><p>建造者模式：</p><pre><code>不要把产品的构造过程放在产品类中，而是由建造者类来负责构造过程，产品的内部表示放在产品类中。</code></pre><p>原型工厂模式：</p><pre><code>创建一个原型类，通过 MemberwiseClone() 实现浅拷贝</code></pre><h4 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h4><blockquote><p>适配器模式：注重转换接口</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> interface IBuddhistMonk</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">void</span> 吃斋();</span><br><span class="line">    <span class="keyword">void</span> 念佛();</span><br><span class="line">    <span class="keyword">void</span> 打坐();</span><br><span class="line">    <span class="keyword">void</span> 习武();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//适配器</span></span><br><span class="line"><span class="keyword">public</span> abstract <span class="class"><span class="keyword">class</span> <span class="title">SpecialMonk</span> :</span> IBuddhistMonk</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">    &#123;</span><br><span class="line">        get &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="built_in">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            name = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SpecialMonk</span><span class="params">(<span class="built_in">string</span> name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 吃斋() &#123; Console.WriteLine(name + <span class="string">&quot;不吃斋&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 念佛() &#123; Console.WriteLine(name + <span class="string">&quot;不念佛&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 打坐() &#123; Console.WriteLine(name + <span class="string">&quot;不打坐&quot;</span>); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> abstract <span class="keyword">void</span> 习武();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 喝酒()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(name + <span class="string">&quot;大口吃肉&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 吃肉()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(name + <span class="string">&quot;大口喝酒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrdinaryMonk</span> :</span> IBuddhistMonk</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">    &#123;</span><br><span class="line">        get &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">        <span class="built_in">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            name = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrdinaryMonk</span><span class="params">(<span class="built_in">string</span> name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        吃斋();</span><br><span class="line">        念佛();</span><br><span class="line">        打坐();</span><br><span class="line">        习武();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 吃斋()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(Name + <span class="string">&quot; 吃斋&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 念佛()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(Name + <span class="string">&quot; 念佛&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 打坐()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(Name + <span class="string">&quot; 打坐&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 习武()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(Name + <span class="string">&quot; 习 “长拳”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LuZhiShen</span> :</span> SpecialMonk</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LuZhiShen</span><span class="params">(<span class="built_in">string</span> name)</span> : <span class="title">base</span><span class="params">(name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        吃斋();</span><br><span class="line">        念佛();</span><br><span class="line">        打坐();</span><br><span class="line">        习武();</span><br><span class="line">        喝酒();</span><br><span class="line">        吃肉();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> 习武()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine( Name + <span class="string">&quot;习“横练功夫”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WuSong</span> :</span> SpecialMonk</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WuSong</span><span class="params">(<span class="built_in">string</span> name)</span> : <span class="title">base</span><span class="params">(name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        习武();</span><br><span class="line">        喝酒();</span><br><span class="line">        吃肉();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> 习武()</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(Name + <span class="string">&quot;习“北派戳脚”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>装饰者模式：注重稳定接口<br>代理模式：注重假借接口<br>外观模式：注重简化接口</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubSystemOne</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MethodOne</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot; SubSystemOne Method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubSystemTwo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MethodTwo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot; SubSystemTwo Method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...其他子类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Facade</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span> SubSystemOne _one;</span><br><span class="line">    <span class="keyword">private</span> SubSystemTwo _two;</span><br><span class="line">    <span class="comment">//... 其他需要使用的类</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Facade</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//实例化</span></span><br><span class="line">        _one = <span class="keyword">new</span> SubSystemOne();</span><br><span class="line">        _two = <span class="keyword">new</span> SubSystemTwo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MethodA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\nMethodA() ---- &quot;</span>);</span><br><span class="line">        _one.MethodOne();</span><br><span class="line">        _two.MethodTwo();</span><br><span class="line">        <span class="comment">//...其他方法调用</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MethodB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;\nMethodB() ---- &quot;</span>);</span><br><span class="line">        _two.MethodTwo();</span><br><span class="line">        <span class="comment">//...其他方法调用</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如何调用</span></span><br><span class="line">Facade facade = <span class="keyword">new</span> Facade();</span><br><span class="line"></span><br><span class="line">facade.MethodA();</span><br><span class="line">facade.MethodB();</span><br></pre></td></tr></table></figure><blockquote><p>桥接模式：注重分离接口和其实现<br>组合模式：注重统一接口<br>享元模式：注重保留接口</p></blockquote><h4 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h4><p>模板方法模式：</p><pre><code>封装算法结构，定义算法骨架，支持算法子步骤变化</code></pre><p>命令模式：</p><pre><code>注重将请求封装为对象，支持请求的变化，通过将一组行为抽象为对象，实现行为请求者和行为实现者之间的解耦。</code></pre><p>迭代器模式：</p><pre><code>注重封装特定领域变化，支持集合的变化，屏蔽集合对象内部复杂结构，提供客户程序对它的透明遍历。</code></pre><p>观察者模式：</p><pre><code>注重封装对象通知，支持通信对象的变化，实现对象状态改变，通知依赖它的对象并更新。</code></pre><ul><li>简单需求，水是否烧开</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoilWater</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> waterTemperature = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Boil</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            waterTemperature = i;</span><br><span class="line">            Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span> (waterTemperature == <span class="number">100</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Call();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Call</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Console.Write(<span class="string">&quot;The Water is Boiled!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接口实现观察者模式</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoilWater</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> waterTemperature = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 主方法</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Boil</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                waterTemperature = i;</span><br><span class="line">                Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;水当前温度:&quot;</span> + waterTemperature);</span><br><span class="line">                <span class="keyword">if</span> (waterTemperature == <span class="number">100</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (Observers.Count != <span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        CallAllObserve();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        DefaultCall();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 默认处理方法</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DefaultCall</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;The Water is Boiled!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 存储接口列表方法循环调用</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CallAllObserve</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            foreach (var item in Observers)</span><br><span class="line">            &#123;</span><br><span class="line">                item.Run();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 存储接口的列表</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="keyword">public</span> IList&lt;RunInter&gt; Observers = <span class="keyword">new</span> List&lt;RunInter&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 接口列表添加</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddObserve</span><span class="params">(RunInter runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Observers.Add(runner);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 接口列表删除</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RemoveObserve</span><span class="params">(RunInter runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Observers.Remove(runner);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 定义接口</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> interface RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 实现接口</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoSomeThing</span> :</span> RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Do Other Things!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoOtherThing</span> :</span> RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;The Water is Boiled!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如何调用</span></span><br><span class="line">BoilWater boilWater = <span class="keyword">new</span> BoilWater();</span><br><span class="line"></span><br><span class="line">boilWater.AddObserve(<span class="keyword">new</span> DoSomeThing());</span><br><span class="line">boilWater.AddObserve(<span class="keyword">new</span> DoOtherThing());</span><br><span class="line"></span><br><span class="line">boilWater.Boil();</span><br></pre></td></tr></table></figure><ul><li>委托和事件实现观察者模式</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoilWater</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> waterTemperature = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 主方法</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Boil</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                waterTemperature = i;</span><br><span class="line">                Thread.Sleep(<span class="number">100</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;水当前温度:&quot;</span> + waterTemperature);</span><br><span class="line">                <span class="keyword">if</span> (waterTemperature == <span class="number">100</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (Observers.Count != <span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        CallAllObserve();</span><br><span class="line">                        CallAllObserve(<span class="keyword">new</span> DoSomeThing(<span class="string">&quot;这是传参，接口方法调用！&quot;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (actions != null)</span><br><span class="line">                    &#123;</span><br><span class="line">                        actions();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        DefaultCall();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 默认处理方法</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DefaultCall</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;The Water is Boiled!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 存储接口列表方法循环调用</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CallAllObserve</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            foreach (var item in Observers)</span><br><span class="line">            &#123;</span><br><span class="line">                item.Run();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CallAllObserve</span><span class="params">(RunInter runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            runner.Run();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 存储接口的列表</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="keyword">public</span> IList&lt;RunInter&gt; Observers = <span class="keyword">new</span> List&lt;RunInter&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 接口列表添加</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddObserve</span><span class="params">(RunInter runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Observers.Add(runner);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 接口列表删除</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RemoveObserve</span><span class="params">(RunInter runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Observers.Remove(runner);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 委托和事件实现观察者模式</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="keyword">private</span> event Action actions;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 注册事件</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddObserve</span><span class="params">(Action runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            actions += runner;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">        <span class="comment">/// 取消事件</span></span><br><span class="line">        <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">        <span class="comment">/// &lt;param name=&quot;runner&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RemoveObserve</span><span class="params">(Action runner)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            actions -= runner;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 定义接口</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> interface RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">    <span class="comment">/// 实现接口</span></span><br><span class="line">    <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoSomeThing</span> :</span> RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> _strInfo;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(_strInfo))</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;自定义字符串返回结果：&quot;</span> + _strInfo);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Do Other Things!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DoSomeThing</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DoSomeThing</span><span class="params">(<span class="built_in">string</span> strInfo)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            _strInfo = strInfo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoOtherThing</span> :</span> RunInter</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;The Water is Boiled!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如何调用</span></span><br><span class="line">BoilWater boilWater = <span class="keyword">new</span> BoilWater();</span><br><span class="line"></span><br><span class="line">boilWater.AddObserve(<span class="keyword">new</span> DoSomeThing());</span><br><span class="line">boilWater.AddObserve(<span class="keyword">new</span> DoOtherThing());</span><br><span class="line"></span><br><span class="line">boilWater.AddObserve(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;注册事件 - 1&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">boilWater.AddObserve(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;注册事件 - 2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">boilWater.Boil();</span><br></pre></td></tr></table></figure><p>中介者模式：</p><pre><code>注重封装对象间的交互，通过封装一系列对象之间的复杂交互，使他们不需要显式相互引用，实现解耦。</code></pre><p>状态模式：</p><pre><code>注重封装与状态相关的行为，支持状态的变化，通过封装对象状态，从而在其内部状态改变时改变它的行为。</code></pre><p>策略模式：</p><pre><code>注重封装算法，支持算法的变化，通过封装一系列算法，从而可以随时独立于客户替换算法。</code></pre><p>责任链模式：</p><pre><code>注重封装对象责任，支持责任的变化，通过动态构建职责链，实现事务处理。</code></pre><p>访问者模式：</p><pre><code>注重封装对象操作变化，支持在运行时为类结构添加新的操作，在类层次结构中，在不改变各类的前提下定义作用于这些类实例的新的操作。</code></pre><p>解释器模式：</p><pre><code>注重封装特定领域变化，支持领域问题的频繁变化，将特定领域的问题表达为某种语法规则下的句子，然后构建一个解释器来解释这样的句子，从而达到解决问题的目的。</code></pre><p>备忘录模式：</p><pre><code>注重封装对象状态变化，支持状态保存、恢复。</code></pre><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 观察者，外观模式</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">PluginGeneralDelegate</span><span class="params">(<span class="built_in">string</span> name, object[] parameters, </span></span></span><br><span class="line"><span class="function"><span class="params">ref object result)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> delegate <span class="keyword">void</span> <span class="title">PluginSiskinIndicatorDelegate</span><span class="params">(<span class="built_in">string</span> name, object[] parameters, </span></span></span><br><span class="line"><span class="function"><span class="params">ref object result)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PluginGlobalEvents</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> event PluginGeneralDelegate PluginGeneralInvoked;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// &lt;param name=&quot;name&quot;&gt;方法名&lt;/param&gt;</span></span><br><span class="line">  <span class="comment">/// &lt;param name=&quot;parameters&quot;&gt;入参&lt;/param&gt;</span></span><br><span class="line">  <span class="comment">/// &lt;returns&gt;返回值&lt;/returns&gt;</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> object <span class="title">PluginInvokeGeneral</span><span class="params">(<span class="built_in">string</span> name, object[] parameters)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    object result = null;</span><br><span class="line">    <span class="keyword">if</span> (PluginGeneralInvoked != null)</span><br><span class="line">      PluginGeneralInvoked(name, parameters, ref result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> event PluginSiskinIndicatorDelegate PluginSiskinIndicatorInvoked;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// &lt;param name=&quot;name&quot;&gt;方法名&lt;/param&gt;</span></span><br><span class="line">  <span class="comment">/// &lt;param name=&quot;parameters&quot;&gt;入参&lt;/param&gt;</span></span><br><span class="line">  <span class="comment">/// &lt;returns&gt;返回值&lt;/returns&gt;</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> object <span class="title">PluginSiskinIndicator</span><span class="params">(<span class="built_in">string</span> name, object[] parameters)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    object result = null;</span><br><span class="line">    <span class="keyword">if</span> (PluginSiskinIndicatorInvoked != null)</span><br><span class="line">      PluginSiskinIndicatorInvoked(name, parameters, ref result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">/// 注册接口事件</span></span><br><span class="line"><span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RegisterSiskinIndicatorEvens</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  PluginGlobalEvents.PluginSiskinIndicatorInvoked += <span class="keyword">new</span> PluginSiskinIndicatorDelegate(</span><br><span class="line">    delegate (<span class="built_in">string</span> name, object[] parameters, ref object result)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">switch</span> (name)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;GetFileContent&quot;</span>:</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="built_in">string</span> strDirectory = parameters[<span class="number">0</span>] as <span class="built_in">string</span>;</span><br><span class="line">                <span class="built_in">string</span> strSubDirectory = parameters[<span class="number">1</span>] as <span class="built_in">string</span>;</span><br><span class="line">                <span class="built_in">string</span> strFileName = parameters[<span class="number">2</span>] as <span class="built_in">string</span>;</span><br><span class="line">                result = GetFileContent(strDirectory, strSubDirectory, strFileName);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;SystemDateTime&quot;</span>:</span><br><span class="line">              &#123;</span><br><span class="line">                result = SystemDateTime;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;GetSubDirectories&quot;</span>:</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">string</span> strDirectory = parameters[<span class="number">0</span>] as <span class="built_in">string</span>;</span><br><span class="line">              result = GetSubDirectories(strDirectory);</span><br><span class="line">            &#125;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FlexPaper</title>
      <link href="2019/08/13/FlexPaper/"/>
      <url>2019/08/13/FlexPaper/</url>
      
        <content type="html"><![CDATA[<h4 id="文件转换"><a href="#文件转换" class="headerlink" title="文件转换"></a>文件转换</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> DataResult <span class="title">TransformFile</span><span class="params">(<span class="built_in">string</span> filename)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(filename))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataResult(<span class="literal">false</span>, ErrorMsg: <span class="string">&quot;文件名称为空!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        Office2Pdf office2pdf = <span class="keyword">new</span> Office2Pdf();</span><br><span class="line">        <span class="built_in">string</span> savePath = Sys.Common.Environment.SysEnvironment.GetBaseDirectory();</span><br><span class="line">        <span class="built_in">string</span> sourcePath = savePath + filename;</span><br><span class="line">        <span class="built_in">string</span> a = System.IO.Path.GetExtension(sourcePath);            <span class="comment">//后缀名</span></span><br><span class="line">        <span class="built_in">string</span> folder = System.IO.Path.GetDirectoryName(sourcePath);   <span class="comment">//目录</span></span><br><span class="line">        <span class="built_in">string</span> fname = System.IO.Path.GetFileNameWithoutExtension(sourcePath);</span><br><span class="line">        <span class="built_in">string</span> pdf_targetPath = folder+<span class="string">&quot;\\&quot;</span>+fname + <span class="string">&quot;.pdf&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="string">&quot;.doc&quot;</span> || a == <span class="string">&quot;.docx&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!office2pdf.DOCConvertToPDF(sourcePath, pdf_targetPath))</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="string">&quot;.ppt&quot;</span> || a == <span class="string">&quot;.pptx&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!office2pdf.PPTConvertToPDF(sourcePath, pdf_targetPath))</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="string">&quot;.xlsx&quot;</span> || a == <span class="string">&quot;.xls&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!office2pdf.XLSConvertToPDF(sourcePath, pdf_targetPath))</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (flag)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//return new DataResult &#123; IsSuccess = true, InfoMsg = &quot;转换成功！&quot; &#125;;</span></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//转flash</span></span><br><span class="line">                <span class="built_in">string</span> cmdStr = HttpContext.Current.Server.MapPath(<span class="string">&quot;~/tools/pdf2swf.exe&quot;</span>);</span><br><span class="line">                <span class="built_in">string</span> pdf_sourcePath = pdf_targetPath;</span><br><span class="line">                <span class="built_in">string</span> swf_targetPath =  folder+<span class="string">&quot;\\&quot;</span>+fname + <span class="string">&quot;.swf&quot;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">string</span> argsStr = <span class="string">&quot;  -t &quot;</span> + pdf_sourcePath + <span class="string">&quot; -s flashversion=9 -o &quot;</span> + swf_targetPath;</span><br><span class="line">                ExcutedCmd(cmdStr, argsStr);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> DataResult &#123; IsSuccess = <span class="literal">true</span>, InfoMsg = <span class="string">&quot;附件预览完成转换！&quot;</span> &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception e1)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> DataResult &#123; IsSuccess = <span class="literal">false</span>, ErrorMsg = <span class="string">&quot;转换swf失败！&quot;</span>+e1.StackTrace &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> DataResult &#123; IsSuccess = <span class="literal">false</span>, ErrorMsg = <span class="string">&quot;转换pdf失败！&quot;</span> &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ee)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataResult &#123; IsSuccess=<span class="literal">false</span>, ErrorMsg=ee.StackTrace &#125;;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="转Flash"><a href="#转Flash" class="headerlink" title="转Flash"></a>转Flash</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExcutedCmd</span><span class="params">(<span class="built_in">string</span> cmd, <span class="built_in">string</span> args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> (Process p = <span class="keyword">new</span> Process())</span><br><span class="line">    &#123;</span><br><span class="line">        ProcessStartInfo psi = <span class="keyword">new</span> ProcessStartInfo(cmd, args);</span><br><span class="line">        p.StartInfo = psi;</span><br><span class="line">        p.Start();</span><br><span class="line">        p.WaitForExit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Js"><a href="#Js" class="headerlink" title="Js"></a>Js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fp = <span class="keyword">new</span> FlexPaperViewer(     </span><br><span class="line">         <span class="string">&#x27;FlexPaperViewer&#x27;</span>,  </span><br><span class="line">         <span class="string">&#x27;viewerPlaceHolder&#x27;</span>, &#123; </span><br><span class="line">config : &#123;  </span><br><span class="line">         SwfFile : <span class="built_in">escape</span>(<span class="string">&#x27;&lt;%=swfFilePath%&gt;&#x27;</span>),  </span><br><span class="line">         Scale : <span class="number">0.6</span>,   </span><br><span class="line">         ZoomTransition : <span class="string">&#x27;easeOut&#x27;</span>,  </span><br><span class="line">         ZoomTime : <span class="number">0.5</span>,  </span><br><span class="line">         ZoomInterval : <span class="number">0.2</span>,  </span><br><span class="line">         FitPageOnLoad : <span class="literal">true</span>,  </span><br><span class="line">         FitWidthOnLoad : <span class="literal">false</span>,  </span><br><span class="line">         FullScreenAsMaxWindow : <span class="literal">false</span>,  </span><br><span class="line">         ProgressiveLoading : <span class="literal">false</span>,  </span><br><span class="line">         MinZoomSize : <span class="number">0.2</span>,  </span><br><span class="line">         MaxZoomSize : <span class="number">5</span>,  </span><br><span class="line">         SearchMatchAll : <span class="literal">false</span>,  </span><br><span class="line">         InitViewMode : <span class="string">&#x27;SinglePage&#x27;</span>,  </span><br><span class="line">           </span><br><span class="line">         ViewModeToolsVisible : <span class="literal">true</span>,  </span><br><span class="line">         ZoomToolsVisible : <span class="literal">true</span>,  </span><br><span class="line">         NavToolsVisible : <span class="literal">true</span>,  </span><br><span class="line">         CursorToolsVisible : <span class="literal">true</span>,  </span><br><span class="line">         SearchToolsVisible : <span class="literal">true</span>,  </span><br><span class="line">          </span><br><span class="line">         localeChain: <span class="string">&#x27;zh_CN&#x27;</span>  </span><br><span class="line">&#125;</span><br><span class="line">&#125;);  </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FlexPaper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>log4net</title>
      <link href="2019/08/13/Csharp/log4net/"/>
      <url>2019/08/13/Csharp/log4net/</url>
      
        <content type="html"><![CDATA[<h4 id="实现的输出方式"><a href="#实现的输出方式" class="headerlink" title="实现的输出方式"></a>实现的输出方式</h4><ul><li><p>AdoNetAppender 将日志记录到数据库中。可以采用SQL和存储过程两种方式。</p></li><li><p>AnsiColorTerminalAppender 将日志高亮输出到ANSI终端。</p></li><li><p>AspNetTraceAppender  能用asp.net中Trace的方式查看记录的日志。</p></li><li><p>BufferingForwardingAppender 在输出到子Appenders之前先缓存日志事件。</p></li><li><p>ConsoleAppender 将日志输出到应用程序控制台。</p></li><li><p>EventLogAppender 将日志写到Windows Event Log。</p></li><li><p>FileAppender 将日志输出到文件。</p></li><li><p>ForwardingAppender 发送日志事件到子Appenders。</p></li><li><p>LocalSyslogAppender 将日志写到local syslog service (仅用于UNIX环境下)。</p></li><li><p>MemoryAppender 将日志存到内存缓冲区。</p></li><li><p>NetSendAppender 将日志输出到Windows Messenger service.这些日志信息将在用户终端的对话框中显示。</p></li><li><p>OutputDebugStringAppender 将日志输出到Debuger，如果程序没有Debuger，就输出到系统Debuger。如果系统Debuger也不可用，将忽略消息。</p></li><li><p>RemoteSyslogAppender 通过UDP网络协议将日志写到Remote syslog service。</p></li><li><p>RemotingAppender 通过.NET Remoting将日志写到远程接收端。</p></li><li><p>RollingFileAppender 将日志以回滚文件的形式写到文件中。</p></li><li><p>SmtpAppender 将日志写到邮件中。</p></li><li><p>SmtpPickupDirAppender 将消息以文件的方式放入一个目录中，像IIS SMTP agent这样的SMTP代理就可以阅读或发送它们。</p></li><li><p>TelnetAppender 客户端通过Telnet来接受日志事件。</p></li><li><p>TraceAppender 将日志写到.NET trace 系统。</p></li><li><p>UdpAppender 将日志以无连接UDP数据报的形式送到远程宿主或用UdpClient的形式广播。</p></li></ul><h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><ul><li><p>DenyAllFilter 阻止所有的日志事件被记录</p></li><li><p>LevelMatchFilter 只有指定等级的日志事件才被记录</p></li><li><p>LevelRangeFilter 日志等级在指定范围内的事件才被记录</p></li><li><p>LoggerMatchFilter 与Logger名称匹配，才记录</p></li><li><p>PropertyFilter 消息匹配指定的属性值时才被记录</p></li><li><p>StringMathFilter 消息匹配指定的字符串才被记录</p></li></ul><h4 id="日志的等级"><a href="#日志的等级" class="headerlink" title="日志的等级"></a>日志的等级</h4><blockquote><p>OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG  &gt; ALL </p></blockquote><h4 id="常用配置方式"><a href="#常用配置方式" class="headerlink" title="常用配置方式"></a>常用配置方式</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;configSections&gt;</span><br><span class="line">    <span class="comment">/*log4net的定义*/</span></span><br><span class="line">    &lt;section name=<span class="string">&quot;log4net&quot;</span> type=<span class="string">&quot;log4net.Config.Log4NetConfigurationSectionHandler, log4net&quot;</span> /&gt;</span><br><span class="line">  &lt;/configSections&gt;</span><br><span class="line">  &lt;log4net&gt;</span><br><span class="line">    <span class="comment">/*主业务日志  serviceTest*/</span></span><br><span class="line">    &lt;logger name=<span class="string">&quot;serviceTest&quot;</span> additivity=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">      &lt;level value=<span class="string">&quot;DEBUG&quot;</span> /&gt;</span><br><span class="line">      &lt;appender-ref ref=<span class="string">&quot;RollingFileRuleLog&quot;</span> /&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;RollingFileRuleLog&quot;</span> type=<span class="string">&quot;log4net.Appender.RollingFileAppender,log4net&quot;</span> &gt;</span><br><span class="line">      <span class="comment">/*为了达到根据GetLogger的参数，分不同文件夹输出日志的效果，这里/log前的文件夹名要和这个logger的name一样 */</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;File&quot;</span> type=<span class="string">&quot;&quot;</span> value=<span class="string">&quot;./logs/serviceTest/serviceTest.log&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*记录日志写入文件时，不锁定文本文件，防止多线程时不能写Log,官方说线程非安全*/</span></span><br><span class="line">      &lt;LockingModel type=<span class="string">&quot;log4net.Appender.FileAppender+MinimalLock&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*是否追加到文件*/</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;AppendToFile&quot;</span> value=<span class="string">&quot;true&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*使用Unicode编码*/</span></span><br><span class="line">      <span class="comment">/*&lt;Encoding value=&quot;UTF-8&quot; /&gt;*/</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">/*按照何种方式产生多个日志文件(日期[Date],文件大小[Size],混合[Composite])*/</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;RollingStyle&quot;</span> value=<span class="string">&quot;size&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*每个文件的大小。只在混合方式与文件大小方式下使用。超出大小后在所有文件名后自动增加正整数重新命名，数字最大的最早写入。可用的单位:KB|MB|GB。不要使用小数,否则会一直写入当前日志*/</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;maximumFileSize&quot;</span> value=<span class="string">&quot;10MB&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*最多产生的日志文件数，超过则只保留最新的n个。设定值value=&quot;－1&quot;为不限文件数*/</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;MaxSizeRollBackups&quot;</span> value=<span class="string">&quot;10&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*是否只写到一个文件中*/</span></span><br><span class="line">      &lt;param name=<span class="string">&quot;StaticLogFileName&quot;</span> value=<span class="string">&quot;false&quot;</span> /&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout,log4net&quot;</span>&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;ConversionPattern&quot;</span> value=<span class="string">&quot;%d [%t] %-5p %l- %m%n%exception&quot;</span> /&gt;</span><br><span class="line">      &lt;/layout&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    <span class="comment">/*默认日志*/</span></span><br><span class="line">    &lt;root&gt;</span><br><span class="line">      &lt;level value=<span class="string">&quot;Info&quot;</span> /&gt;</span><br><span class="line">      &lt;appender-ref ref=<span class="string">&quot;RootRollingFile&quot;</span> /&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;RootRollingFile&quot;</span> type=<span class="string">&quot;log4net.Appender.RollingFileAppender,log4net&quot;</span> &gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;File&quot;</span> type=<span class="string">&quot;&quot;</span> value=<span class="string">&quot;./logs/Common/CommonLog.TXT&quot;</span> /&gt;</span><br><span class="line">      &lt;LockingModel type=<span class="string">&quot;log4net.Appender.FileAppender+MinimalLock&quot;</span> /&gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;AppendToFile&quot;</span> value=<span class="string">&quot;true&quot;</span> /&gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;RollingStyle&quot;</span> value=<span class="string">&quot;size&quot;</span> /&gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;maximumFileSize&quot;</span> value=<span class="string">&quot;10MB&quot;</span> /&gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;MaxSizeRollBackups&quot;</span> value=<span class="string">&quot;10&quot;</span> /&gt;</span><br><span class="line">      &lt;param name=<span class="string">&quot;StaticLogFileName&quot;</span> value=<span class="string">&quot;false&quot;</span> /&gt;</span><br><span class="line">      &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout,log4net&quot;</span>&gt;</span><br><span class="line">        &lt;param name=<span class="string">&quot;ConversionPattern&quot;</span> value=<span class="string">&quot;%d [%t] %-5p %l- %m%n%exception%n&quot;</span> /&gt;</span><br><span class="line">      &lt;/layout&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">  &lt;/log4net&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="写数据库配置"><a href="#写数据库配置" class="headerlink" title="写数据库配置"></a>写数据库配置</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE [Log] (</span><br><span class="line">[ID] [<span class="keyword">int</span>] IDENTITY (<span class="number">1</span>, <span class="number">1</span>) NOT <span class="literal">NULL</span> ,</span><br><span class="line">[Date] [datetime] NOT <span class="literal">NULL</span> ,</span><br><span class="line">[Thread] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Level] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Logger] [varchar] (<span class="number">200</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Operator] [<span class="keyword">int</span>] <span class="literal">NULL</span> ,</span><br><span class="line">[Message] [text] COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[ActionType] [<span class="keyword">int</span>] <span class="literal">NULL</span> ,</span><br><span class="line">[Operand] [varchar] (<span class="number">300</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[IP] [varchar] (<span class="number">20</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[MachineName] [varchar] (<span class="number">100</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Browser] [varchar] (<span class="number">50</span>) COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Location] [text] COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span> ,</span><br><span class="line">[Exception] [text] COLLATE Chinese_PRC_CI_AS <span class="literal">NULL</span></span><br><span class="line">)</span><br><span class="line">&lt;appender name=<span class="string">&quot;ADONetAppender&quot;</span> type=<span class="string">&quot;log4net.Appender.ADONetAppender,log4net&quot;</span>&gt;</span><br><span class="line"><span class="comment">/*BufferSize为缓冲区大小，只有日志记录超设定值才会一块写入到数据库*/</span></span><br><span class="line">&lt;bufferSize value=<span class="string">&quot;10&quot;</span> /&gt;&lt;!—或写为&lt;param name=<span class="string">&quot;BufferSize&quot;</span> value=<span class="string">&quot;10&quot;</span> /&gt;--&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*引用*/</span></span><br><span class="line">&lt;connectionType value=<span class="string">&quot;System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*连接数据库字符串*/</span></span><br><span class="line">&lt;connectionString value=<span class="string">&quot;data source=.;initial catalog=Test;integrated security=false;persist security info=True;User ID=sa;Password=;&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*插入到表Log*/</span></span><br><span class="line">&lt;commandText value=<span class="string">&quot;INSERT INTO Log ([Date],[Thread],[Level],[Logger],[Operator],[Message],[ActionType],[Operand],[IP],[MachineName],[Browser],[Location],[Exception]) VALUES (@log_date, @thread, @log_level, @logger,@operator, @message,@action_type,@operand,@ip,@machineName,@browser,@location,@exception)&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*日志记录时间，RawTimeStampLayout为默认的时间输出格式*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@log_date&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;DateTime&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.RawTimeStampLayout&quot;</span> /&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*线程号*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@thread&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line"><span class="comment">/*长度不可以省略，否则不会输出*/</span></span><br><span class="line">        &lt;size value=<span class="string">&quot;100&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%thread&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/*日志等级*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@log_level&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;100&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%level&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*日志记录类名称*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@logger&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;200&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%logger&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*操作者。这个是自定义的输出字段，使用重新实现的布局器ReflectionLayout*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@operator&quot;</span> /&gt;</span><br><span class="line">    <span class="comment">/*设置为Int32时只有bufferSize的 value&lt;=&quot;1&quot;才正确输出，没有找出原因。*/</span></span><br><span class="line">        &lt;dbType value=<span class="string">&quot;Int16&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;Operator&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*操作对象*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@operand&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;300&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;Operand&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*IP地址*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@ip&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;20&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;IP&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*机器名*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@machineName&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;100&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;MachineName&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*浏览器*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@browser&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;50&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;Browser&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*日志消息*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@message&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;3000&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;Message&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*动作类型*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@action_type&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;Int16&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;TGLog.ExpandLayout2.ReflectionLayout,TGLog&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%property&#123;ActionType&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*记录日志的位置*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@location&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;2000&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.PatternLayout&quot;</span>&gt;</span><br><span class="line">          &lt;conversionPattern value=<span class="string">&quot;%location&quot;</span> /&gt;</span><br><span class="line">        &lt;/layout&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/*异常信息。ExceptionLayout 为异常输出的默认格式*/</span></span><br><span class="line">      &lt;parameter&gt;</span><br><span class="line">        &lt;parameterName value=<span class="string">&quot;@exception&quot;</span> /&gt;</span><br><span class="line">        &lt;dbType value=<span class="string">&quot;String&quot;</span> /&gt;</span><br><span class="line">        &lt;size value=<span class="string">&quot;4000&quot;</span> /&gt;</span><br><span class="line">        &lt;layout type=<span class="string">&quot;log4net.Layout.ExceptionLayout&quot;</span> /&gt;</span><br><span class="line">      &lt;/parameter&gt;</span><br><span class="line">&lt;/appender&gt;</span><br></pre></td></tr></table></figure><h4 id="关联配置文件"><a href="#关联配置文件" class="headerlink" title="关联配置文件"></a>关联配置文件</h4><ul><li><p>项目的AssemblyInfo.cs</p><p>  [assembly: log4net. Config.XmlConfigurator(ConfigFileExtension = “log4net”, Watch = true)]</p></li></ul><ul><li><p>根目录的Program.cs中的Main方法</p></li><li><p>根目录的Global.asax.cs（没有新建一个）中的Application_Start方法</p><p>  log4net.Config.XmlConfigurator.Configure();</p></li></ul><h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><pre><code>log4net.ILog log = log4net.LogManager.GetLogger(&quot;ReflectionLayout&quot;);</code></pre>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log4net </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原型和继承</title>
      <link href="2019/08/13/Javascript/%E5%8E%9F%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF/"/>
      <url>2019/08/13/Javascript/%E5%8E%9F%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF/</url>
      
        <content type="html"><![CDATA[<h4 id="对象解析"><a href="#对象解析" class="headerlink" title="对象解析"></a>对象解析</h4><p>javascript 本质没有 Class, 原型继承<br>javascript 对象：实例对象、函数对象、原型对象</p><blockquote><p>实例对象</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> people = <span class="keyword">new</span> Student()</span><br><span class="line"></span><br><span class="line"><span class="comment">// people --&gt; 实例对象</span></span><br><span class="line"><span class="comment">// Student -&gt; 构造函数</span></span><br></pre></td></tr></table></figure><p>构造函数在实例对象创建后进行调用，作用是对实例对象进行初始化操作</p><p>原型对象：实例对象和函数对象的父对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">people</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">     <span class="built_in">this</span>.name=name;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> student=<span class="keyword">new</span> people(<span class="string">&quot;咸鱼&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// student --&gt; 实例对象</span></span><br><span class="line"><span class="comment">// people  --&gt; 构造函数</span></span><br><span class="line"><span class="comment">// 实例对象和构造函数的关系</span></span><br><span class="line">student.constructor==people;</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">student <span class="keyword">instanceof</span> people</span><br><span class="line"><span class="comment">// true 检查对象是否是构造函数的实例对象</span></span><br></pre></td></tr></table></figure><h4 id="proto"><a href="#proto" class="headerlink" title="proto"></a><strong>proto</strong></h4><p>表示：实例对象通过 <code>__proto__</code> 直接访问原型对象<br>除了 null undefined，javascript 中所有对象、原始类型都有 <strong>proto</strong> 属性</p><pre><code>通过 __proto__ 属性修改对象的原型：非常慢且影响性能ECMAScript 2015 规范中被准确的定义</code></pre><blockquote><p>获取、设置对象的原型</p></blockquote><p>Object.getPrototypeOf、setPrototypeOf<br>Reflect.getPrototypeOf、setPrototypeOf</p><h4 id="prototype"><a href="#prototype" class="headerlink" title="prototype"></a>prototype</h4><p>表示：构造函数通过 <code>prototype</code> 直接访问原型对象<br>构造函数都包含该属性（<code>new 操作符生成的对象</code>），指向原型对象</p><pre><code>实例对象（__proto__） === 构造函数（prototype）</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为Object是一个函数，函数的构造器都是Function</span></span><br><span class="line"><span class="built_in">Object</span>.__proto__ === <span class="built_in">Function</span>.prototype <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过函数字面量定义的函数的__proto__属性都指向Function.prototype</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).__proto__ === <span class="built_in">Function</span>.prototype <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过对象字面量定义的对象的__proto__属性都是指向Object.prototype</span></span><br><span class="line">(&#123;&#125;).__proto__ === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object函数的原型的__proto__属性指向null</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.__proto__ === <span class="literal">null</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 因为Function本身也是一个函数，所以Function函数的__proto__属性指向它自身的prototype</span></span><br><span class="line"><span class="built_in">Function</span>.__proto__ === <span class="built_in">Function</span>.prototype <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 因为Function的prototype是一个对象，所以Function.prototype的__proto__属性指向Object.prototype</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.__proto__ === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h4><p>原型对象的属性，指向构造函数</p><h4 id="关系图"><a href="#关系图" class="headerlink" title="关系图"></a>关系图</h4><p><a href="https://img2018.cnblogs.com/blog/1650307/201909/1650307-20190907150646374-478328059.png"><img src='/images/1650307-20190907150646374-478328059.png'></a></p><h4 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h4><p>实例对象.<strong>proto</strong>.<strong>proto</strong>.<strong>proto</strong>.null</p><h4 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h4><div class="console"></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">  showInfo(<span class="string">&#x27;基类构造函数...&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.SayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  showInfo(<span class="string">&#x27;基类构造函数的prototype方法...&#x27;</span>)</span><br><span class="line">  showInfo(<span class="string">`Hello，I&#x27;m <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Employee</span>(<span class="params">name, salary</span>)</span>&#123;</span><br><span class="line">  showInfo(<span class="string">&#x27;子类构造函数...&#x27;</span>)</span><br><span class="line">  Person.call(<span class="built_in">this</span>, name)</span><br><span class="line">  <span class="built_in">this</span>.salary = salary</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Employee.prototype = <span class="keyword">new</span> Person(<span class="string">&#x27;employee.prototype&#x27;</span>)</span><br><span class="line">Employee.prototype.ShowMetheMoney = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  showInfo(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span> $ <span class="subst">$&#123;<span class="built_in">this</span>.salary&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Person(<span class="string">&#x27;Bill&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Employee(<span class="string">&#x27;Steve&#x27;</span>, <span class="number">1333</span>)</span><br><span class="line"></span><br><span class="line">a.SayHello()</span><br><span class="line">b.SayHello()</span><br><span class="line"><span class="built_in">console</span>.log(a.SayHello == b.SayHello)</span><br><span class="line"></span><br><span class="line"><span class="comment">// a.ShowMetheMoney()</span></span><br><span class="line">b.ShowMetheMoney()</span><br><span class="line"></span><br><span class="line">showInfo(<span class="built_in">JSON</span>.stringify(a))</span><br><span class="line">showInfo(<span class="built_in">JSON</span>.stringify(b))</span><br></pre></td></tr></table></figure><script>let showInfo = function(msg){  var res = document.getElementsByClassName('console')[0].innerHTML    document.getElementsByClassName('console')[0].innerHTML = `${res} <br/>` + msg}function Person(name){  this.name = name  showInfo('基类构造函数...')}Person.prototype.SayHello = function() {  showInfo('基类构造函数的prototype方法...')  showInfo(`Hello，I'm ${this.name}`)}function Employee(name, salary){  showInfo('子类构造函数...')  Person.call(this, name)  this.salary = salary}Employee.prototype = new Person('employee.prototype')Employee.prototype.ShowMetheMoney = function() {  showInfo(`${this.name} $ ${this.salary}`)}let a = new Person('Bill')let b = new Employee('Steve', 1333)a.SayHello()b.SayHello()console.log(a.SayHello == b.SayHello)// a.ShowMetheMoney()b.ShowMetheMoney()showInfo(JSON.stringify(a))showInfo(JSON.stringify(b))console.log(a)console.log(b)</script><h4 id="New-原理"><a href="#New-原理" class="headerlink" title="New 原理"></a>New 原理</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">New</span>(<span class="params">Fn</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 创建一个空对象</span></span><br><span class="line">    <span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    <span class="comment">// 将新对象的原型指针指向构造函数的原型</span></span><br><span class="line">    obj.__proto__ = Fn.prototype</span><br><span class="line">    <span class="comment">// 处理参数</span></span><br><span class="line">    <span class="keyword">let</span> result = Fn.apply(obj, [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> result === <span class="string">&quot;object&quot;</span> ? result || obj : obj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>创建一个新对象</li><li>将构造函数的作用域赋给新对象（this 指向新对象）</li><li>执行构造函数中的代码（为新对象添加属性）</li><li>返回新对象</li></ol><blockquote><p>演示示例</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = &#123;</span><br><span class="line">  Create: <span class="function"><span class="keyword">function</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">    <span class="built_in">this</span>.age = age</span><br><span class="line">  &#125;,</span><br><span class="line">  SayHello: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`hello, i&#x27;m <span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span>`</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  HowOld: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.name&#125;</span> is <span class="subst">$&#123;<span class="built_in">this</span>.age&#125;</span> years old.`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anyfun</span>(<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&#x27;anyfun...&#x27;</span>)&#125;</span><br><span class="line">anyfun.prototype = Person</span><br><span class="line"><span class="keyword">var</span> BillGates = <span class="keyword">new</span> anyfun()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DBHelper 使用</title>
      <link href="2019/08/13/%E6%95%B0%E6%8D%AE%E5%BA%93/DBHelper%20%E4%BD%BF%E7%94%A8%20/"/>
      <url>2019/08/13/%E6%95%B0%E6%8D%AE%E5%BA%93/DBHelper%20%E4%BD%BF%E7%94%A8%20/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">string</span> sql = <span class="string">&quot;select * from RoomType&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> sql = <span class="built_in">string</span>.Format(<span class="string">&quot;select * from RoomType where TypeId=&#123;0&#125;&quot;</span>, TypeId);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* @参数 */</span></span><br><span class="line"><span class="built_in">string</span> sql = <span class="string">&quot;select * from RoomType where TypeName=@TypeName&quot;</span>;</span><br><span class="line">DBHelper.CreateParameters(<span class="number">1</span>);</span><br><span class="line">DBHelper.AddParameters(<span class="number">0</span>, <span class="string">&quot;@TypeName&quot;</span>, typeName);</span><br><span class="line"></span><br><span class="line">IDataReader reader = DBHelper.ExecuteReader(sql);</span><br><span class="line"><span class="keyword">while</span>(reader.Read())</span><br><span class="line">&#123;</span><br><span class="line">  Console.WriteLine(reader[<span class="string">&quot;TypeName&quot;</span>].ToString());</span><br><span class="line">&#125;</span><br><span class="line">DBHelper.Close();</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DBHelper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Weex框架</title>
      <link href="2019/08/06/Weex%E6%A1%86%E6%9E%B6/"/>
      <url>2019/08/06/Weex%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>1、Node.js 安装<br>2、npm install -g weex-toolkit<br>3、weex -v  //查看 weex 版本<br>4、weex //查看帮助<br>5、weex create 项目名（项目名只能小写，安装过程类似 Webpack 安装 Vue 项目奖）<br>6、添加 Android 或 iOS 平台：weex platform add android 或 weex platform add ios<br>7、weex run android/ios<br>8、weex debug 调试<br>9、weex playground app 扫描二维码</p><h4 id="weex-组成"><a href="#weex-组成" class="headerlink" title="weex 组成"></a>weex 组成</h4><blockquote><p>Weex由多个关键模块组成，分别是DSL transformer、JS Framework、HTML5/iOS/Android Renderer和工具链 </p></blockquote><h4 id="transformer"><a href="#transformer" class="headerlink" title="transformer"></a>transformer</h4><ul><li>HTML 解析工具：<a href="https://yq.aliyun.com/go/articleRenderRedirect?spm=a2c4e.11153940.0.0.53a125f8SSBRdL&url=https://www.npmjs.org/package/htmlparser">htmlparser</a></li><li>CSS 解析工具：<a href="https://yq.aliyun.com/go/articleRenderRedirect?spm=a2c4e.11153940.0.0.53a125f8SSBRdL&url=https://www.npmjs.org/package/cssom">cssom</a></li><li>JavaScript 解析工具：<a href="https://yq.aliyun.com/go/articleRenderRedirect?spm=a2c4e.11153940.0.0.53a125f8SSBRdL&url=https://www.npmjs.org/package/uglify-js">uglify-js</a></li></ul><h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><p><a href="https://yq.aliyun.com/articles/57554">项目集成</a></p><p><a href="https://blog.csdn.net/xingxtao/article/details/79505997">Weex 扩展</a></p>]]></content>
      
      
      <categories>
          
          <category> Week </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Week </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javascript 设计模式</title>
      <link href="2019/08/06/Javascript/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>2019/08/06/Javascript/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h4 id="克隆的原型模式"><a href="#克隆的原型模式" class="headerlink" title="克隆的原型模式"></a>克隆的原型模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Plane = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.blood = <span class="number">100</span>;</span><br><span class="line">  <span class="built_in">this</span>.attackLevel = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">this</span>.defensLevel = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> plane = <span class="keyword">new</span> Plane();</span><br><span class="line"></span><br><span class="line">plane.blood = <span class="number">500</span>;</span><br><span class="line">plane.attackLevel = <span class="number">10</span>;</span><br><span class="line">plane.defensLevel = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> clonePlane = <span class="built_in">Object</span>.create(plane);</span><br><span class="line"></span><br><span class="line">clonePlane.blood = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(plane + <span class="string">&quot; ... &quot;</span> + clonePlane);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//输出结果</span></span><br><span class="line">Plane &#123;<span class="attr">blood</span>: <span class="number">500</span>, <span class="attr">attackLevel</span>: <span class="number">10</span>, <span class="attr">defensLevel</span>: <span class="number">8</span>&#125;</span><br><span class="line">attackLevel: <span class="number">10</span></span><br><span class="line">blood: <span class="number">500</span></span><br><span class="line">defensLevel: <span class="number">8</span></span><br><span class="line">__proto__: <span class="built_in">Object</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Plane &#123;<span class="attr">blood</span>: <span class="number">1000</span>&#125;</span><br><span class="line">blood: <span class="number">1000</span></span><br><span class="line">__proto__: Plane</span><br></pre></td></tr></table></figure><script>    var Plane = function(){      this.blood = 100;      this.attackLevel = 1;      this.defensLevel = 1;    }    var plane = new Plane();    plane.blood = 500;    plane.attackLevel = 10;    plane.defensLevel = 8;    var clonePlane = Object.create(plane);    clonePlane.blood = 1000;    console.log(plane);    console.log(clonePlane);</script><blockquote><p>拷贝扩展</p></blockquote><p>如果只是拷贝自身可枚举属性，就可以只用 Object.assign 方法；<br>如果是要拷贝原型上的属性，就需要 Object.assign , Object.create, Object.getPrototypeOf 方法结合使用<br>如果是拷贝get/set 属性，就需要结合 Ojbect.getOwnPropertyDescriptors 方法</p><p><em>基于原型链的委托机制就是原型继承的本质</em></p><p>javascript 根对象 Object.prototype</p><h4 id="惰性加载"><a href="#惰性加载" class="headerlink" title="惰性加载"></a>惰性加载</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> addEvent = <span class="function"><span class="keyword">function</span>(<span class="params">elem,type,handler</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">window</span>.addEventListener)&#123;</span><br><span class="line">    addEvent = <span class="function"><span class="keyword">function</span>(<span class="params">elem,type,handler</span>)</span>&#123;</span><br><span class="line">      elem.addEventListener(type,handler,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.attendEvent)&#123;</span><br><span class="line">    addEvent = <span class="function"><span class="keyword">function</span>(<span class="params">elem,type,handler</span>)</span>&#123;</span><br><span class="line">      elem.attendEvent(<span class="string">&#x27;on&#x27;</span> + type,handler);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  addEvent(elem,type,handler);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> div= <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">addEvent(div, <span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  div.getElementsByTagName(<span class="string">&quot;span&quot;</span>)[<span class="number">0</span>].innerHTML = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">&#125;)</span><br><span class="line">addEvent(div, <span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  div.getElementsByTagName(<span class="string">&quot;span&quot;</span>)[<span class="number">0</span>].innerHTML += <span class="string">&quot;2&quot;</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><div id="test1" style=" padding-bottom:1rem;">测试惰性加载 <span></span></div><script>var addEvent = function(elem,type,handler){  if(window.addEventListener){    addEvent = function(elem,type,handler){      elem.addEventListener(type,handler,false);    }  }else if(window.attendEvent){    addEvent = function(elem,type,handler){      elem.attendEvent('on' + type,handler);    }  }  addEvent(elem,type,handler);}var div= document.getElementById('test1');addEvent(div, 'click', function(){  div.getElementsByTagName("span")[0].innerHTML = "1";})addEvent(div, 'click', function(){  div.getElementsByTagName("span")[0].innerHTML += "2";})</script><h4 id="透明的单例模式"><a href="#透明的单例模式" class="headerlink" title="透明的单例模式"></a>透明的单例模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> CreateDiv = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> instance;</span><br><span class="line">  <span class="keyword">var</span> CreateDiv= <span class="function"><span class="keyword">function</span>(<span class="params">html</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance)&#123;</span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">this</span>.html = html;</span><br><span class="line"><span class="built_in">this</span>.init();</span><br><span class="line"><span class="keyword">return</span> instance = <span class="built_in">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  CreateDiv.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.innerHTML = <span class="built_in">this</span>.html;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;test2&#x27;</span>).appendChild(div);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> CreateDiv;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> CreateDiv(<span class="string">&#x27;svenOne&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> CreateDiv(<span class="string">&#x27;svenTwo&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><div id="test2" style=" padding-bottom:1rem;">透明的单例模式 </div><script>var CreateDiv = (function(){  var instance;  var CreateDiv= function(html){    if(instance){      return instance;    }    this.html = html;    this.init();    return instance = this;  }  CreateDiv.prototype.init = function(){    var div = document.createElement('div');    div.innerHTML = this.html;    document.getElementById('test2').appendChild(div);  }  return CreateDiv;})();var a = new CreateDiv('svenOne');var b = new CreateDiv('svenTwo');</script><h4 id="代理实现单例"><a href="#代理实现单例" class="headerlink" title="代理实现单例"></a>代理实现单例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> CreateDiv= <span class="function"><span class="keyword">function</span>(<span class="params">html</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.html = html;</span><br><span class="line">  <span class="built_in">this</span>.init();</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">CreateDiv.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  div.innerHTML = <span class="built_in">this</span>.html;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ProxySingletonCreateDiv = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> instance;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">html</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!instance)&#123;</span><br><span class="line">  instance = <span class="keyword">new</span> CreateDiv(html);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> ProxySingletonCreateDiv(<span class="string">&#x27;svenOne&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> ProxySingletonCreateDiv(<span class="string">&#x27;svenTwo&#x27;</span>);</span><br></pre></td></tr></table></figure><p><em>单例模式的核心是确保只有一个实例，并提供全局访问</em></p><p>1、使用命名空间<br>2、使用闭包封装私有变量</p><h4 id="通用惰性单例"><a href="#通用惰性单例" class="headerlink" title="通用惰性单例"></a>通用惰性单例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getSingle = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> result || (result = fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h4><p><em>核心思想：定义一系列算法,规则，把它们封装起来，并使它们可以互相替换</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> strategies = &#123;</span><br><span class="line">  <span class="string">&quot;s&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">4</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">3</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;b&quot;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary*<span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> calcBonus = <span class="function"><span class="keyword">function</span>(<span class="params">level, salary</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> strategies[level](salary);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test3&#x27;</span>).appendChild(imgNode);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    setSrc: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">      imgNode.src = src;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> img = <span class="keyword">new</span> Image;</span><br><span class="line">  img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    myImage.setSrc(<span class="built_in">this</span>.src);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    setSrc: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">      myImage.setSrc(<span class="string">&#x27;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565173670729&amp;di=07d74096a6b6f920de7dda6357ac6e00&amp;imgtype=0&amp;src=http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F005Yxgwijw1fa0o6vvr5eg30m80go0st.gif&#x27;</span>);</span><br><span class="line">      img.src = src;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">proxyImage.setSrc(<span class="string">&quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565173348965&amp;di=e55e9ac7b8eaf92a2d53eb45175f8ed9&amp;imgtype=0&amp;src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20170722%2Fbe087a0f5b434ffdb57df04115cfc0d1_th.jpg&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><div id="test3" style=" padding:0 0 1rem;">代理模式 <p></p></div><script>var myImage = (function(){  var imgNode = document.createElement('img');  document.getElementById('test3').appendChild(imgNode);  return {    setSrc: function(src){      imgNode.src = src;    }  }})();var proxyImage = (function(){  var img = new Image;  img.onload = function(){    myImage.setSrc(this.src);  }  return {    setSrc: function(src){      myImage.setSrc('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1565173670729&di=07d74096a6b6f920de7dda6357ac6e00&imgtype=0&src=http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2F005Yxgwijw1fa0o6vvr5eg30m80go0st.gif');      img.src = src;    }  }})();proxyImage.setSrc("https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1565173348965&di=e55e9ac7b8eaf92a2d53eb45175f8ed9&imgtype=0&src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20170722%2Fbe087a0f5b434ffdb57df04115cfc0d1_th.jpg");</script><h4 id="迭代器模型"><a href="#迭代器模型" class="headerlink" title="迭代器模型"></a>迭代器模型</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> each = <span class="function"><span class="keyword">function</span>(<span class="params">ary, callback</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>, l = ary.length; i&lt;l; i++)&#123;</span><br><span class="line">    callback.call(ary[i], i, ary[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">each([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">i,n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> p = <span class="built_in">document</span>.createElement(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">      p.innerHTML = <span class="string">&quot;i: &quot;</span> + i + <span class="string">&quot; n: &quot;</span> + n;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test4&#x27;</span>).appendChild(p);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div id="test4" style=" padding:0 0 1rem;">内部迭代器模型 <p></p></div><script>  var each = function(ary, callback){    for(var i =0, l = ary.length; i<l; i++){      callback.call(ary[i], i, ary[i]);    }  }  each([1,2,3], function(i,n){    var p = document.createElement('p');        p.innerHTML = "i: " + i + "&nbsp; n: " + n;    document.getElementById('test4').appendChild(p);  });</script><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//外部迭代器</span></span><br><span class="line"><span class="keyword">var</span> Iterator = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> current = <span class="number">0</span>,</span><br><span class="line">      next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        current += <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      isDone = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> current &gt;= obj.length;</span><br><span class="line">      &#125;,</span><br><span class="line">      getCurrItem = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> obj[current];</span><br><span class="line">      &#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span>&#123;</span><br><span class="line">    next: next,</span><br><span class="line">    isDone: isDone,</span><br><span class="line">    getCurrItem: getCurrItem,</span><br><span class="line">    length: obj.length,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> compare = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.length !== b.length)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;a 和 b 不相等！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(!a.isDone() &amp;&amp; !b.isDone())&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.getCurrItem() !== b.getCurrItem())&#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;a 和 b 不相等！&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    a.next();</span><br><span class="line">    b.next();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;a 和 b 相等！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">``</span></span><br><span class="line"></span><br><span class="line">#### 发布-订阅模式</span><br><span class="line"></span><br><span class="line"><span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string">var event = &#123;</span></span><br><span class="line"><span class="string">  clientList: &#123;&#125;,</span></span><br><span class="line"><span class="string">  listen: function(key, fn)&#123;</span></span><br><span class="line"><span class="string">    if(!this.clientList[key])&#123;</span></span><br><span class="line"><span class="string">      this.clientList[key] = [];</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">      this.clientList[key].push(fn);</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  trigger: function()&#123;</span></span><br><span class="line"><span class="string">    var key = [].shift.call(arguments),</span></span><br><span class="line"><span class="string">        fns = this.clientList[key];</span></span><br><span class="line"><span class="string">    if(!fns || fns.length ===0)&#123;</span></span><br><span class="line"><span class="string">      return false;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    for(var i = 0, fn; fn=fns[i++])&#123;</span></span><br><span class="line"><span class="string">      fn.apply(this, arguments);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var installEvent = function(obj)&#123;</span></span><br><span class="line"><span class="string">  for(var i in event)&#123;</span></span><br><span class="line"><span class="string">    obj[i] = event[i];</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MenuBar = &#123;</span><br><span class="line">  refresh: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;刷新操作！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> RefreshMenuBarCommand = <span class="function"><span class="keyword">function</span>(<span class="params">receiver</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      receiver.refresh();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> SetCommand = <span class="function"><span class="title">funciton</span>(<span class="params">btn, command</span>)</span>&#123;</span><br><span class="line">  btn.onclick = <span class="function"><span class="title">funciton</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    command.execute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> r = RefreshMenuBarCommand(MenuBar);</span><br><span class="line">SetCommand(btn, r);</span><br></pre></td></tr></table></figure><h4 id="宏命令"><a href="#宏命令" class="headerlink" title="宏命令"></a>宏命令</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  exec: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;执行 a 命令！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = &#123;</span><br><span class="line">  exec: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;执行 b 命令！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = &#123;</span><br><span class="line">  exec: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;执行 c 命令！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    commLists:[],</span><br><span class="line">    add: <span class="function"><span class="keyword">function</span>(<span class="params">command</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.commLists.push(command);</span><br><span class="line">    &#125;,</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>, command; command= <span class="built_in">this</span>.commLists[i++])&#123;</span><br><span class="line">        command.exec();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> m = MacroCommand();</span><br><span class="line">m.add(a);</span><br><span class="line">m.add(b);</span><br><span class="line">m.add(c);</span><br><span class="line"></span><br><span class="line">m.execute();</span><br></pre></td></tr></table></figure><h4 id="模板方式模式"><a href="#模板方式模式" class="headerlink" title="模板方式模式"></a>模板方式模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">Beverage.prototype.boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;把水煮沸！&quot;</span>)</span><br><span class="line">&#125;;</span><br><span class="line">Beverage.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">Beverage.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">Beverage.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//钩子方法</span></span><br><span class="line">Beverage.prototype.customerWantsCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverage.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.boilWater();</span><br><span class="line">  <span class="built_in">this</span>.brew();</span><br><span class="line">  <span class="built_in">this</span>.pourInCup();</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">this</span>.customerWantsCondiments)&#123;</span><br><span class="line">    <span class="built_in">this</span>.addCondiments();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Coffee = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">Coffee.prototype = <span class="keyword">new</span> Beverage();</span><br><span class="line">Coffee.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Coffee.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Coffee.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Coffee.prototype.customerWantsCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.confirm(<span class="string">&quot;请问需要调料吗？&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coffee = <span class="keyword">new</span> Coffee();</span><br><span class="line">coffee.init();</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params">param</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;把水煮沸！&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> brew = param.brew || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;必须传递方法！&quot;</span>)&#125;</span><br><span class="line">  <span class="keyword">var</span> pourInCup = param.pourInCup || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;必须传递方法！&quot;</span>)&#125;</span><br><span class="line">  <span class="keyword">var</span> addCondiments = param.addCondiments || <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;必须传递方法！&quot;</span>)&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> F= <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">  F.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    boilWater();</span><br><span class="line">    brew();</span><br><span class="line">    pourInCup();</span><br><span class="line">    addCondiments();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> F;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Coffee = Beverage(&#123;</span><br><span class="line">  brew:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  pourInCup:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  addCondiments:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Model = <span class="function"><span class="keyword">function</span>(<span class="params">sex</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line">Model.prototype.takePhoto = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;sex: &#x27;</span> + <span class="built_in">this</span>.sex + <span class="string">&#x27; underwear: &#x27;</span> + <span class="built_in">this</span>.underwear);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> male = <span class="keyword">new</span> Model(<span class="string">&#x27;male&#x27;</span>),</span><br><span class="line">    female = <span class="keyword">new</span> Model(<span class="string">&#x27;female&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;=<span class="number">50</span>; i++)&#123;</span><br><span class="line">  male.underwear = <span class="string">&#x27;underwear&#x27;</span> + i;</span><br><span class="line">  female.underwear = <span class="string">&#x27;underwear&#x27;</span> + i;</span><br><span class="line">  </span><br><span class="line">  male.takePhoto();</span><br><span class="line">  female.takePhoto();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象池</span></span><br><span class="line"><span class="keyword">var</span> objFactory = <span class="function"><span class="keyword">function</span>(<span class="params">createOjFn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> objPool =[];</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> obj = objPool.length === <span class="number">0</span>?</span><br><span class="line">          createOjFn.apply(<span class="built_in">this</span>,<span class="built_in">arguments</span>):objPool.shift();</span><br><span class="line">      <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;,</span><br><span class="line">    recover: <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">      objPool.push(obj);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iframeFactory = objFactory(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">&#x27;iframe&#x27;</span>);</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test5&#x27;</span>).appendChild(iframe);</span><br><span class="line"></span><br><span class="line">  iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    iframe.onload = <span class="literal">null</span>;</span><br><span class="line">    iframeFactory.recover(iframe);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> iframe;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iframe1 = iframeFactory.create();</span><br><span class="line">    iframe1.src = <span class="string">&#x27;https://www.baidu.com&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><div id="test5" style=" padding:0 0 1rem;">对象池 <p></p></div><script>var objFactory = function(createOjFn){  var objPool =[];  return {    create: function(){      var obj = objPool.length === 0?          createOjFn.apply(this,arguments):objPool.shift();      return obj;    },    recover: function(obj){      objPool.push(obj);    }  }}var iframeFactory = objFactory(function(){  var iframe = document.createElement('iframe');      document.getElementById('test5').appendChild(iframe);  iframe.onload = function(){    iframe.onload = null;    iframeFactory.recover(iframe);  }  return iframe;});var iframe1 = iframeFactory.create();    iframe1.src = 'http://pic37.nipic.com/20140102/11797992_154747473137_2.png';    iframe1.frameBorder  = 0;</script><h4 id="职责链模式"><a href="#职责链模式" class="headerlink" title="职责链模式"></a>职责链模式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> order1 = <span class="function"><span class="keyword">function</span>(<span class="params">type,pay,stock</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(type===<span class="number">1</span> &amp;&amp; pay)&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;执行 1...&quot;</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccessor&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> order2 = <span class="function"><span class="keyword">function</span>(<span class="params">type,pay,stock</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(type===<span class="number">2</span> &amp;&amp; pay)&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;执行 2...&quot;</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccessor&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderNormal = <span class="function"><span class="keyword">function</span>(<span class="params">type,pay,stock</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(stock&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;执行默认...&quot;</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;未执行...&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Chain = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.fn = fn;</span><br><span class="line">  <span class="built_in">this</span>.successor = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Chain.prototype.setNextSuccessor = <span class="function"><span class="keyword">function</span>(<span class="params">successor</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.successor = successor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Chain.prototype.passRequest = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ret = <span class="built_in">this</span>.fn.apply(<span class="built_in">this</span>,<span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(ret === <span class="string">&#x27;nextSuccessor&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.successor &amp;&amp; <span class="built_in">this</span>.successor.passRequest.apply(<span class="built_in">this</span>.successor, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Chain.prototype.next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.successor &amp;&amp; <span class="built_in">this</span>.successor.passRequest.apply(<span class="built_in">this</span>.successor, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> chain1 = <span class="keyword">new</span> Chain(order1);</span><br><span class="line"><span class="keyword">var</span> chain2 = <span class="keyword">new</span> Chain(order2);</span><br><span class="line"><span class="keyword">var</span> chainNormal = <span class="keyword">new</span> Chain(orderNormal);</span><br><span class="line"></span><br><span class="line">chain1.setNextSuccessor(chain2);</span><br><span class="line">chain2.setNextSuccessor(chainNormal);</span><br><span class="line"></span><br><span class="line">chain1.passRequest(<span class="number">1</span>,<span class="literal">true</span>, <span class="number">500</span>);</span><br><span class="line">chain1.passRequest(<span class="number">2</span>,<span class="literal">true</span>, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//异步责任链</span></span><br><span class="line"><span class="keyword">var</span> fn1 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;nextSuccessor&#x27;</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span> =(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    self.next();</span><br><span class="line">  &#125;,<span class="number">1000</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> fn3 = <span class="keyword">new</span> Chain(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;3&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fn1.setNextSuccessor(fn2).setNextSuccessor(fn3);</span><br><span class="line">fn1.passRequest();</span><br><span class="line"></span><br><span class="line"><span class="comment">//AOP 责任链</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.afterFn = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">if</span>(ret)&#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><style>.toc{  font-size:12px;  line-height:1.25rem;}</style>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 常见问题</title>
      <link href="2019/08/06/Vue/Vue%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%20/"/>
      <url>2019/08/06/Vue/Vue%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%20/</url>
      
        <content type="html"><![CDATA[<h4 id="vue开发多语言项目"><a href="#vue开发多语言项目" class="headerlink" title="vue开发多语言项目"></a>vue开发多语言项目</h4><p>1、npm install i18n<br>2、main.js 引用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> VueI18n <span class="keyword">from</span> <span class="string">&#x27;vue-i18n&#x27;</span></span><br><span class="line">Vue.use(VueI18n)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 多语言实例</span></span><br><span class="line"><span class="keyword">const</span> i18n = <span class="keyword">new</span> VueI18n(&#123;</span><br><span class="line">  locale: (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;lang&#x27;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">localStorage</span>.getItem(<span class="string">&#x27;lang&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;zh&#x27;</span></span><br><span class="line">  &#125;()),</span><br><span class="line"></span><br><span class="line">  <span class="comment">//建立语言包</span></span><br><span class="line">  messages: &#123;</span><br><span class="line">    <span class="string">&#x27;zh&#x27;</span>: <span class="built_in">require</span>(<span class="string">&#x27;./assets/i18n/zh&#x27;</span>),   <span class="comment">// 中文语言包</span></span><br><span class="line">    <span class="string">&#x27;en&#x27;</span>: <span class="built_in">require</span>(<span class="string">&#x27;./assets/i18n/en&#x27;</span>)    <span class="comment">// 英文语言包 </span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  i18n,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: <span class="string">&#x27;&lt;App/&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>3、语言切换方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">Language</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.$i18n.locale === <span class="string">&#x27;zh&#x27;</span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.$i18n.locale = <span class="string">&#x27;en&#x27;</span></span><br><span class="line">        <span class="built_in">localStorage</span>.setItem(<span class="string">&#x27;lang&#x27;</span>,<span class="string">&#x27;en&#x27;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.$i18n.locale = <span class="string">&#x27;zh&#x27;</span></span><br><span class="line">        <span class="built_in">localStorage</span>.setItem(<span class="string">&#x27;lang&#x27;</span>,<span class="string">&#x27;zh&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="属性，方法同名"><a href="#属性，方法同名" class="headerlink" title="属性，方法同名"></a>属性，方法同名</h4><blockquote><p>使用计算属性的时，函数名和data数据源中的数据可以同名吗?<br>vue中data的属性可以和methods中的方法同名吗?</p></blockquote><pre><code>不能</code></pre><h4 id="vue定义全局"><a href="#vue定义全局" class="headerlink" title="vue定义全局"></a>vue定义全局</h4><ul><li>全局引入文件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、先定义共用组件</span><br><span class="line"><span class="comment">//定义一些公共的属性和方法</span></span><br><span class="line"><span class="keyword">const</span> httpUrl = <span class="string">&#x27;http://39.105.17.99:8080/&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">commonFun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;公共方法&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//暴露出这些属性和方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    httpUrl,</span><br><span class="line">    commonFun</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、在需要使用的地方导入</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">global</span> <span class="keyword">from</span> <span class="string">&#x27;./common.vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      username: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      password: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="comment">// 赋值使用</span></span><br><span class="line">      globalHttpUrl: <span class="built_in">global</span>.httpUrl</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">｝</span><br></pre></td></tr></table></figure><ul><li>main.js中引入全局变量和方法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入共用组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="built_in">global</span> <span class="keyword">from</span> <span class="string">&#x27;./common.vue&#x27;</span></span><br><span class="line">Vue.prototype.COMMON = <span class="built_in">global</span></span><br></pre></td></tr></table></figure><h4 id="v-html-过滤器"><a href="#v-html-过滤器" class="headerlink" title="v-html 过滤器"></a>v-html 过滤器</h4><blockquote><p>vue2.0不再支持v-html中使用过滤器</p></blockquote><p>1：全局方法（推荐）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.msg = <span class="function"><span class="keyword">function</span>（<span class="title">msg</span>）</span>&#123;</span><br><span class="line">　<span class="keyword">return</span> msg.replace（<span class="string">&quot;\n&quot;</span>，<span class="string">&quot;&lt;br&gt;&quot;</span>）</span><br><span class="line">&#125;；</span><br><span class="line"></span><br><span class="line">&lt;div v-html=<span class="string">&quot;msg(content)&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>2：computed 属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> appMain = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">　　data:&#123;</span><br><span class="line">　　　　content：<span class="string">&quot;XXX&quot;</span></span><br><span class="line">　　&#125;，</span><br><span class="line">　　el：<span class="string">&quot;#appMain&quot;</span>，</span><br><span class="line">　　computed：&#123;</span><br><span class="line">　　　　content：<span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">　　　　　　<span class="keyword">return</span> msg.replace(<span class="string">&quot;\n&quot;</span>，<span class="string">&quot;&lt;br&gt;&quot;</span>)</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;div&gt;&#123;&#123;content&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>3：$options.filters（推荐）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> appMain = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">　　el：<span class="string">&quot;#appMain&quot;</span>，</span><br><span class="line">　　filters：&#123;</span><br><span class="line">　　　　msg：<span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">　　　　　　<span class="keyword">return</span> msg.replace(<span class="regexp">/\n/g</span>，<span class="string">&quot;&lt;br&gt;&quot;</span>)</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;，</span><br><span class="line">　　data：&#123;</span><br><span class="line">　　　　content：<span class="string">&quot;XXXX&quot;</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;div v-html=<span class="string">&quot;$options.filters.msg(content)&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><h4 id="静态资源图片失效"><a href="#静态资源图片失效" class="headerlink" title="静态资源图片失效"></a>静态资源图片失效</h4><p>1、config-&gt;index.js</p><pre><code>//build:&#123;&#125;assetspublicPath:&#39;./&#39;</code></pre><p>2、build-&gt;utils.js</p><pre><code>//ExtractTextPlugin.extractpublicPath:&#39;../../&#39;</code></pre><p><em>publicPath 属性值为打包后的 app.css文件至index.html文件的相对路径</em></p><h4 id="动态img的src无效"><a href="#动态img的src无效" class="headerlink" title="动态img的src无效"></a>动态img的src无效</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置 require</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&quot;HelloWorld&quot;</span>,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      logo:<span class="built_in">require</span>(<span class="string">&quot;./../assets/images/logo.png&quot;</span>),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&lt;img :src=<span class="string">&quot;require(&#x27;../assets/images/&#x27;+imgsrc+&#x27;.png&#x27;)&quot;</span>/&gt;</span><br></pre></td></tr></table></figure><h4 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h4><p>1.activated：页面第一次进入的时候，钩子触发的顺序是created-&gt;mounted-&gt;activated<br>2.deactivated ：页面退出的时候会触发deactivated，当再次前进或者后退的时候只触发activated</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.meta: &#123;</span><br><span class="line">  keepAlive: <span class="literal">true</span> <span class="comment">// 需要被缓存</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Vue-IE兼容"><a href="#Vue-IE兼容" class="headerlink" title="Vue IE兼容"></a>Vue IE兼容</h4><p>1、cnpm install babel-polyfill –save-dev  //ES6的转码，IE的兼容<br>2、main.js -&gt; import ‘babel-polyfill’<br>3、webpack 文件修改</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: [<span class="string">&#x27;babel-polyfill&#x27;</span>, <span class="string">&#x27;./src/main.js&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="重置-data"><a href="#重置-data" class="headerlink" title="重置 data"></a>重置 data</h4><pre><code>Object.assign(this.$data, this.$options.data())</code></pre><h4 id="vue的错误处理"><a href="#vue的错误处理" class="headerlink" title="vue的错误处理"></a>vue的错误处理</h4><pre><code>errorCaptured是组件内部钩子，可捕捉本组件与子孙组件抛出的错误，接收error、vm、info三个参数，return false后可以阻止错误继续向上抛出。errorHandler为全局钩子，使用Vue.config.errorHandler配置，接收参数与errorCaptured一致，2.6后可捕捉v-on与promise链的错误，可用于统一错误处理与错误兜底。</code></pre><h4 id="强制刷新组件"><a href="#强制刷新组件" class="headerlink" title="强制刷新组件"></a>强制刷新组件</h4><pre><code>1、this.$forceUpdate强制重新渲染2、v-if指令，修改指令绑定值，实现强制重新渲染</code></pre><h4 id="扩展现有组件"><a href="#扩展现有组件" class="headerlink" title="扩展现有组件"></a>扩展现有组件</h4><pre><code>使用Vue.extend直接扩展使用Vue.mixin全局混入HOC封装可以加slot扩展</code></pre><h4 id="父子、根访问"><a href="#父子、根访问" class="headerlink" title="父子、根访问"></a>父子、根访问</h4><pre><code>this.$refs    //子组件的实例this.$parent  //父组件的实例this.$root    //根实例</code></pre><h4 id="vue-router导航钩子"><a href="#vue-router导航钩子" class="headerlink" title="vue-router导航钩子"></a>vue-router导航钩子</h4><pre><code>一种是全局导航钩子：router.beforeEach(to,from,next)，作用：跳转前进行判断拦截。第二种：组件内的钩子；第三种：单独路由独享组件</code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 生命周期</title>
      <link href="2019/08/06/Vue/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
      <url>2019/08/06/Vue/Vue%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<p>生命周期函数：就是vue在某个时间段会自动执行的函数<br>1.beforeCreate(){}在执行的时候，<code>data</code>还有<code>methods</code>都<code>没有被初始化</code></p><p>2.created(){} data还有methods都被初始化好了，如果要调用methods方法或者操作data里面的数据，最早只能在created里面进行操作。</p><p>3.beforeMount(){} 表示模板已经在内存中编辑完成了，但是尚未渲染到模板页面中。即页面中的元素，没有被真正的替换过来，只是之前写的一些模板字符串。</p><p>4.mounted(){} 表示内存中模板已经真实的挂载到页面中去了，用户可以看到渲染好的界面了</p><p>   <code>注意</code>这是一个<code>生命周期函数</code>的<code>最后一个函数</code>了，执行完这个函数表示 整个vue实例已经初始化完成了，组件脱离了创建阶段，进入运行阶段。</p><p>下面是运行期间的两个生命周期函数的钩子：</p><p>5.beforeUpdate(){}  表示我们的界面还没更新 但是data里面的数据是最新的。即页面尚未和最新的data里面的数据包同步。</p><p>6.update(){} 表示页面和data里面的数据已经同步了 都是最新的。</p><p>7.beforeDestory(){}  当执行这个生命周期钩子的时候 vue的实例从运行阶段进入销毁阶段 此时实例身上的data 还有 methods处于可用的状态。</p><p>8.Destoryed(){} 表示组件已经完全被销毁了 组件中所有的实例方法都是不能用了</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 风格指南</title>
      <link href="2019/08/06/Vue/Vue%20%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/"/>
      <url>2019/08/06/Vue/Vue%20%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h4 id="官推风格"><a href="#官推风格" class="headerlink" title="官推风格"></a>官推风格</h4><ul><li>优先级A：必要的。为了规避错误，这种代码风格是必须的</li><li>优先级B：强烈推荐。增加项目的可读性和开发体验</li><li>优先级C：推荐。有时可能同时有几种不错的选择。需要注意：前后一致、理由充分</li><li>优先级D：谨慎使用。为了该有潜在风险的代码敲个警钟。</li></ul><h4 id="Level-A"><a href="#Level-A" class="headerlink" title="Level A"></a>Level A</h4><blockquote><p>1.vue组件名称推荐由多个单词构成</p></blockquote><pre><code>避免vue组件名和未来html元素的名称重复</code></pre><blockquote><p>2.组件data数据推荐用函数return</p></blockquote><pre><code>保持每个组件的data都应该是独立的状态</code></pre><blockquote><p>3.props推荐用更加详细的定义</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">  name : &#123;</span><br><span class="line">type: <span class="built_in">String</span>,</span><br><span class="line"><span class="keyword">default</span>: <span class="string">&#x27;ziwei&#x27;</span>,</span><br><span class="line">required: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>4.v-for推荐配套的:key</p></blockquote><pre><code>通过唯一的:key复用之前的dom的话，性能更好</code></pre><blockquote><p>5.v-for和v-if避免使用在同一个组件里</p></blockquote><pre><code>v-for和v-if同时出现的话，先v-for，后v-if</code></pre><blockquote><p>6.vue组件样式推荐设置作用域</p></blockquote><pre><code>scoped被设计的初衷是不能让当前组件的样式，影响其他组件的样式。所以你写组件库，不要用scopedcss moudle是利用命名空间和hash来保证作用域</code></pre><blockquote><p>7.自定义的私有属性，推荐$_ + 命名空间作为前缀</p></blockquote><h4 id="Level-B"><a href="#Level-B" class="headerlink" title="Level B"></a>Level B</h4><blockquote><p>1.能用.vue写的组件，尽量不同vue.component</p></blockquote><blockquote><p>2.vue组件名称，用PascalCase或者短横线，风格保持统一</p></blockquote><blockquote><p>3.基础组件命名，以Base前缀开头，以显示其通用性</p></blockquote><blockquote><p>4.单例组件命名，以The前缀开头，以显示其独特性</p></blockquote><pre><code>某个组件只是在每个页面最多用了一次，并且没有props。就是不可复用组件，用The前缀命名</code></pre><blockquote><p>5.紧密耦合的组件命名。比如紧密耦合的父子组件，子组件以父组件名称为前缀</p></blockquote><blockquote><p>6.组件命名单词的顺序。先名词后形容词</p></blockquote><blockquote><p>7.自闭合组件的写法。</p></blockquote><blockquote><p>8.不同模板中vue命名大小写。如果有编译器的话PascalCase,否则用短横线命名</p></blockquote><pre><code>如果是没有编译器的vue版本，在html里大小写不敏感，你只能用短横线命名。</code></pre><blockquote><p>9.JS/JSX中始终用PascalCase组件命名</p></blockquote><blockquote><p>10.组件命名单词应该是完整的单词</p></blockquote><blockquote><p>11.props的命名方式</p></blockquote><pre><code>JS里用驼峰命名，html里用短横线</code></pre><blockquote><p>12.vue组件有多个属性，分多行来写更加清晰易读</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyComponent</span><br><span class="line">  foo=&quot;a&quot;</span><br><span class="line">  bar=&quot;b&quot;</span><br><span class="line">  baz=&quot;c&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><blockquote><p>13.模板里复杂逻辑用计算属性或者method</p></blockquote><blockquote><p>14.复杂的计算属性或者method，拆分成多个</p></blockquote><blockquote><p>15.html模板的属性推荐用双引号的</p></blockquote><blockquote><p>16.指令缩写要么不写，要么都用缩写</p></blockquote><h4 id="Level-C-常用"><a href="#Level-C-常用" class="headerlink" title="Level C (常用)"></a>Level C (常用)</h4><blockquote><p>1.组件实例选项的顺序</p></blockquote><pre><code>- el- name- components- filters- data- compouted- watch- 所有的生命周期钩子- methods- template/render- renderError</code></pre><blockquote><p>2.元素特性的顺序</p></blockquote><pre><code>- v-for- v-if / v-show- id- ref / key / slot- v-model- v-on</code></pre><blockquote><p>3.组件实例选项之间，建议加一个空格</p></blockquote><blockquote><p>4.单文件组件，顶级元素的顺序</p></blockquote><pre><code>&lt;template&gt;&lt;script&gt;&lt;style&gt;*注意style只能在最下面，script和template至少要有一个*</code></pre><h4 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h4><blockquote><p>scoped 中的元素选择器</p></blockquote><pre><code>大量使用scoped里的元素 + 自定义属性选择器，性能会慢，尽量用class</code></pre><blockquote><p>隐性的父子组件通信</p></blockquote><pre><code>优先通过 prop 和事件进行父子组件之间的通信，而不是 this.$parent 或改变 prop</code></pre><blockquote><p>非 Flux 的全局状态管理</p></blockquote><pre><code>推荐用vuex，而不是eventbus</code></pre><h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.cnblogs.com/cangshuchirou/p/9236459.html">Vue风格指南总结</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Aspose OfficeToPDF</title>
      <link href="2019/08/01/Csharp/Aspose%20OfficeToPDF/"/>
      <url>2019/08/01/Csharp/Aspose%20OfficeToPDF/</url>
      
        <content type="html"><![CDATA[<h4 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sourceFolder  源目录</span></span><br><span class="line"><span class="comment">//destinationFolder 目标目录</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> basePath = AppDomain.CurrentDomain.BaseDirectory;</span><br><span class="line"><span class="built_in">string</span> outputFileName = destinationFolder + <span class="string">&quot;\\&quot;</span> + Path.GetFileName(inputFile).Replace(Path.GetExtension(inputFile), <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> inputFileFullPath = basePath + sourceFolder + <span class="string">&quot;\\&quot;</span> + inputFile;</span><br><span class="line"><span class="built_in">string</span> outputFileFullPath = basePath + outputFileName;</span><br></pre></td></tr></table></figure><h4 id="ConvertWordToPdf"><a href="#ConvertWordToPdf" class="headerlink" title="ConvertWordToPdf"></a>ConvertWordToPdf</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Document wordDoc = <span class="keyword">new</span> Document(inputFileFullPath);</span><br><span class="line">wordDoc.Save(outputFileFullPath, Aspose.Words.SaveFormat.Pdf);</span><br></pre></td></tr></table></figure><h4 id="ConvertExcelToPdf"><a href="#ConvertExcelToPdf" class="headerlink" title="ConvertExcelToPdf"></a>ConvertExcelToPdf</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Workbook excel = <span class="keyword">new</span> Workbook(inputFileFullPath);</span><br><span class="line">PdfSaveOptions saveOptions = <span class="keyword">new</span> PdfSaveOptions(Aspose.Cells.SaveFormat.Pdf);</span><br><span class="line">saveOptions.OnePagePerSheet = <span class="literal">true</span>;</span><br><span class="line">saveOptions.PrintingPageType = PrintingPageType.Default;</span><br><span class="line">saveOptions.AllColumnsInOnePagePerSheet = <span class="literal">true</span>;</span><br><span class="line">excel.Save(outputFileFullPath, saveOptions);</span><br></pre></td></tr></table></figure><h4 id="PowerPointToPdf"><a href="#PowerPointToPdf" class="headerlink" title="PowerPointToPdf"></a>PowerPointToPdf</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Presentation ppt = <span class="keyword">new</span> Presentation(inputFileFullPath);</span><br><span class="line">ppt.Save(outputFileFullPath, Aspose.Slides.Export.SaveFormat.Pdf);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Aspose </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.Net Code + Vue 环境搭建</title>
      <link href="2019/07/18/Net%20Code%20+%20Vue%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>2019/07/18/Net%20Code%20+%20Vue%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="SDK-安装"><a href="#SDK-安装" class="headerlink" title="SDK 安装"></a>SDK 安装</h4><p><a href="https://dotnet.microsoft.com/download">下载 SDK 地址</a></p><ul><li>判断是否安装成功？<blockquote><p>Win + R =&gt; cmd =&gt; dotnet<br>Options:<br> -h | –help<br> …</p><p> 看到这样的结果，证明成功了。</p></blockquote></li></ul><h4 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h4><ul><li><p>文件 =&gt; 项目 选择.Net Core 版本和项目类型 ASP.NET Core 2.0，选择 API 的项目类型</p><p>目录说明<br>Dependencies (依赖项)<br>Properties (设置文件)<br>Controllers (Code)<br>Program.cs (入口地址)  <strong>重要</strong><br>StartUp.cs (项目启动设置)   <strong>重要</strong></p></li></ul><ul><li><p>调试方法<br>1、通过IIS调试</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//launthSettings.json </span></span><br><span class="line"><span class="string">&quot;IIS Express&quot;</span>: &#123;</span><br><span class="line">     <span class="string">&quot;commandName&quot;</span>: <span class="string">&quot;IISExpress&quot;</span>,</span><br><span class="line">     <span class="string">&quot;launchBrowser&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">     <span class="string">&quot;launchUrl&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">     <span class="string">&quot;environmentVariables&quot;</span>: &#123;</span><br><span class="line">       <span class="string">&quot;ASPNETCORE_ENVIRONMENT&quot;</span>: <span class="string">&quot;Development&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure><p>2、Kestrel web应用调式</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//launthSettings.json </span></span><br><span class="line"><span class="string">&quot;项目名称&quot;</span>: &#123;</span><br><span class="line">     <span class="string">&quot;commandName&quot;</span>: <span class="string">&quot;Project&quot;</span>,</span><br><span class="line">     <span class="string">&quot;launchBrowser&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">     <span class="string">&quot;launchUrl&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">     <span class="string">&quot;environmentVariables&quot;</span>: &#123;</span><br><span class="line">       <span class="string">&quot;ASPNETCORE_ENVIRONMENT&quot;</span>: <span class="string">&quot;Development&quot;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="string">&quot;applicationUrl&quot;</span>: <span class="string">&quot;http://localhost:58224/&quot;</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li><li><p>核心</p><p>  1、Routing 路由</p><p>  Convention-based (按约定), attribute-based(基于路由属性配置)<br>  Web api 推荐使用 attribute-based</p>  <BR/><p>  常用的Http Method有:</p><p>  Get, 查询, Attribute: HttpGet</p><p>  POST, 创建, HttpPost</p><p>  PUT 整体修改更新 HttpPut</p><p>  PATCH 部分更新, HttpPatch</p><p>  DELETE 删除, HttpDelete</p>  <BR/><p>  2、内容协商 Content Negotiation</p><p>  例如: application/json, application/xml 等<br>  .Net Core 默认提供的是 json 格式</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果想输出 xml 格式，就在 Startup.cs 配置这里：</span></span><br><span class="line">services.AddMvc(</span><br><span class="line">options =&gt; &#123;</span><br><span class="line">options.ReturnHttpNotAcceptable = <span class="literal">true</span>;</span><br><span class="line">options.OutputFormatters.Add(<span class="keyword">new</span> XmlDataContractSerializerOutputFormatter())</span><br><span class="line">&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>   3、创建Post Action</p><p>   4、Validation 验证</p><p>   5、PUT请求</p></li></ul><h4 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h4><ul><li>引用 Nuget 包<br>右键项目中的 Dependencies (依赖项) – &gt; Manage Nuget Packags (管理Nuget程序包) –&gt; Browse (浏览) –&gt; Search (搜索) “Swashbuckle.AspNetCore” –&gt; Install (安装)</li></ul><ul><li><p>配置服务</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//class Startup</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span><span class="params">(IServiceCollection services)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          services.AddMvc(); <span class="comment">// 注册MVC到Container</span></span><br><span class="line"></span><br><span class="line">          <span class="meta">#region Swagger</span></span><br><span class="line">          services.AddSwaggerGen(c =&gt;</span><br><span class="line">          &#123;</span><br><span class="line">              c.SwaggerDoc(<span class="string">&quot;v1&quot;</span>, <span class="keyword">new</span> Swashbuckle.AspNetCore.Swagger.Info</span><br><span class="line">              &#123;</span><br><span class="line">                  Version = <span class="string">&quot;v0.1.0&quot;</span>,</span><br><span class="line">                  Title = <span class="string">&quot;MResManager API&quot;</span>,</span><br><span class="line">                  Description = <span class="string">&quot;框架说明文档&quot;</span>,</span><br><span class="line">                  TermsOfService = <span class="string">&quot;None&quot;</span>,</span><br><span class="line">                  Contact = <span class="keyword">new</span> Swashbuckle.AspNetCore.Swagger.Contact &#123; Name = <span class="string">&quot;MResManager&quot;</span>, Email = <span class="string">&quot;&quot;</span>, Url = <span class="string">&quot;&quot;</span> &#125;</span><br><span class="line">              &#125;);</span><br><span class="line"></span><br><span class="line">              var basePath = PlatformServices.Default.Application.ApplicationBasePath;</span><br><span class="line">              var xmlPath = Path.Combine(basePath, <span class="string">&quot;MResManager.xml&quot;</span>); <span class="comment">//这个就是MResManager的xml文件名</span></span><br><span class="line">              c.IncludeXmlComments(xmlPath, <span class="literal">true</span>); <span class="comment">//默认的第二个参数是false，这个是controller的注释，记得修改</span></span><br><span class="line"></span><br><span class="line">              var xmlModelPath = Path.Combine(basePath, <span class="string">&quot;MResManager.Model.xml&quot;</span>); <span class="comment">//这个就是Model层的xml文件名</span></span><br><span class="line"></span><br><span class="line">              c.IncludeXmlComments(xmlModelPath);</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">          <span class="meta">#endregion</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>启动Http中间件</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//class Startup</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span><span class="params">(IApplicationBuilder app, IHostingEnvironment env)</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="comment">//判断是否是环境变量</span></span><br><span class="line">          <span class="keyword">if</span> (env.IsDevelopment())</span><br><span class="line">          &#123;</span><br><span class="line">              app.UseDeveloperExceptionPage();</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="meta">#region Swagger</span></span><br><span class="line">          app.UseSwagger();</span><br><span class="line">          app.UseSwaggerUI(c =&gt;</span><br><span class="line">          &#123;</span><br><span class="line">              c.SwaggerEndpoint(<span class="string">&quot;/swagger/v1/swagger.json&quot;</span>, <span class="string">&quot;ApiHelp V1&quot;</span>);</span><br><span class="line">              c.RoutePrefix = <span class="string">&quot;&quot;</span>;<span class="comment">//路径配置，设置为空，表示直接访问该文件，</span></span><br><span class="line">                                 <span class="comment">//路径配置，设置为空，表示直接在根域名（localhost:8001）访问该文件,注意localhost:8001/swagger是访问不到的</span></span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="meta">#endregion</span></span><br><span class="line"></span><br><span class="line">app.UseMvc();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>运行项目 域名后面输入/swagger，即可看到接口文档。</p></li></ul><p><strong>注意点：</strong></p><ul><li><p>设置默认直接首页访问</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//启动Http中间件中这一段代码</span></span><br><span class="line"></span><br><span class="line">c.RoutePrefix = <span class="string">&quot;&quot;</span>;<span class="comment">//路径配置，设置为空，表示直接访问该文件，</span></span><br><span class="line">                   <span class="comment">//路径配置，设置为空，表示直接在根域名（localhost:8001）访问该文件,注意localhost:8001/swagger是访问不到的</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>  launchSettings.json 的 launchUrl：“”，这样我们无论是本地开发环境，还是生产环境，都可以默认首页加载了。</p></li></ul><ul><li><p>为接口， Model 添加注释说明</p><p>  右键项目名称 =&gt; 属性 =&gt; 生成，勾选“输出”下面的“xml文档文件”， 路径可以相对路径（../xxx/xxx.xml）。<br>  生成序列化程序集 =&gt; 自动 （指定的任务可执行文件“sgen.exe”未能运行。文件名或扩展名太长。）<br>  Errors and warnings 错误和警告 =&gt; 禁止显示警告：1701；1702；1591 （去掉Swagger警告提示）</p>  <br/><p>  Xml 文件配置好了之后, 系统启动的时候，读取文件:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置服务这一段代码</span></span><br><span class="line"></span><br><span class="line">var basePath = PlatformServices.Default.Application.ApplicationBasePath;</span><br><span class="line">var xmlPath = Path.Combine(basePath, <span class="string">&quot;MResManager.xml&quot;</span>); <span class="comment">//这个就是MResManager的xml文件名</span></span><br><span class="line">c.IncludeXmlComments(xmlPath, <span class="literal">true</span>); <span class="comment">//默认的第二个参数是false，这个是controller的注释，记得修改</span></span><br><span class="line"></span><br><span class="line">var xmlModelPath = Path.Combine(basePath, <span class="string">&quot;MResManager.Model.xml&quot;</span>); <span class="comment">//这个就是Model层的xml文件名</span></span><br><span class="line"></span><br><span class="line">c.IncludeXmlComments(xmlModelPath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h4 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h4><ul><li>官方解释： JWT（读作 [/dʒɒt/]），即JSON Web Tokens，是一种基于JSON的、用于在网络上声明某种主张的令牌（token），由三部分组成： 头信息（header）, 消息体（payload）和签名（signature）。它是一种用于双方之间传递安全信息的表述性声明规范。JWT作为一个开放的标准（RFC 7519），定义了一种简洁的、自包含的方法，从而使通信双方实现以JSON对象的形式安全的传递信息。</li></ul><blockquote><p>JWT并不是一种只能权限验证的工具，而是一种标准化的数据传输规范。所以，只要是在系统之间需要传输简短但却需要一定安全等级的数据时，都可以使用JWT规范来传输。规范不受平台限制，所以JWT做为授权验证可以跨平台。</p></blockquote><h4 id="生成-Token-令牌"><a href="#生成-Token-令牌" class="headerlink" title="生成 Token 令牌"></a>生成 Token 令牌</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtHelper</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// 颁发JWT字符串</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;param name=&quot;tokenModel&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">IssueJwt</span><span class="params">(TokenModelJwt tokenModel)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="comment">// 自己封装的 appsettign.json 操作类，看下文</span></span><br><span class="line">           <span class="built_in">string</span> iss = Appsettings.app(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Audience&quot;</span>, <span class="string">&quot;Issuer&quot;</span> &#125;);</span><br><span class="line">           <span class="built_in">string</span> aud = Appsettings.app(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Audience&quot;</span>, <span class="string">&quot;Audience&quot;</span> &#125;);</span><br><span class="line">           <span class="built_in">string</span> secret = Appsettings.app(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;Audience&quot;</span>, <span class="string">&quot;Secret&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">           <span class="comment">//var claims = new Claim[] //old</span></span><br><span class="line">           var claims = <span class="keyword">new</span> List&lt;Claim&gt;</span><br><span class="line">               &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                * 特别重要：</span></span><br><span class="line"><span class="comment">                  1、这里将用户的部分信息，比如 uid 存到了Claim 中，如果你想知道如何在其他地方将这个 uid从 Token 中取出来，请看下边的SerializeJwt() 方法，或者在整个解决方案，搜索这个方法，看哪里使用了！</span></span><br><span class="line"><span class="comment">                  2、你也可以研究下 HttpContext.User.Claims ，具体的你可以看看 Policys/PermissionHandler.cs 类中是如何使用的。</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line"></span><br><span class="line">               <span class="keyword">new</span> Claim(JwtRegisteredClaimNames.Jti, tokenModel.Uid.ToString()),</span><br><span class="line">               <span class="keyword">new</span> Claim(JwtRegisteredClaimNames.Iat, $<span class="string">&quot;&#123;new DateTimeOffset(DateTime.Now).ToUnixTimeSeconds()&#125;&quot;</span>),</span><br><span class="line">               <span class="keyword">new</span> Claim(JwtRegisteredClaimNames.Nbf,$<span class="string">&quot;&#123;new DateTimeOffset(DateTime.Now).ToUnixTimeSeconds()&#125;&quot;</span>) ,</span><br><span class="line">               <span class="comment">//这个就是过期时间，目前是过期1000秒，可自定义，注意JWT有自己的缓冲过期时间</span></span><br><span class="line">               <span class="keyword">new</span> Claim (JwtRegisteredClaimNames.Exp,$<span class="string">&quot;&#123;new DateTimeOffset(DateTime.Now.AddSeconds(1000)).ToUnixTimeSeconds()&#125;&quot;</span>),</span><br><span class="line">               <span class="keyword">new</span> Claim(JwtRegisteredClaimNames.Iss,iss),</span><br><span class="line">               <span class="keyword">new</span> Claim(JwtRegisteredClaimNames.Aud,aud),</span><br><span class="line">               </span><br><span class="line">               <span class="comment">//new Claim(ClaimTypes.Role,tokenModel.Role),//为了解决一个用户多个角色(比如：Admin,System)，用下边的方法</span></span><br><span class="line">              &#125;;</span><br><span class="line"></span><br><span class="line">           <span class="comment">// 可以将一个用户的多个角色全部赋予；</span></span><br><span class="line">           <span class="comment">// 作者：DX 提供技术支持；</span></span><br><span class="line">           claims.AddRange(tokenModel.Role.Split(<span class="string">&#x27;,&#x27;</span>).Select(s =&gt; <span class="keyword">new</span> Claim(ClaimTypes.Role, s)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">           <span class="comment">//秘钥 (SymmetricSecurityKey 对安全性的要求，密钥的长度太短会报出异常)</span></span><br><span class="line">           var key = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(secret));</span><br><span class="line">           var creds = <span class="keyword">new</span> SigningCredentials(key, SecurityAlgorithms.HmacSha256);</span><br><span class="line"></span><br><span class="line">           var jwt = <span class="keyword">new</span> JwtSecurityToken(</span><br><span class="line">               issuer: iss,</span><br><span class="line">               claims: claims,</span><br><span class="line">               signingCredentials: creds);</span><br><span class="line"></span><br><span class="line">           var jwtHandler = <span class="keyword">new</span> JwtSecurityTokenHandler();</span><br><span class="line">           var encodedJwt = jwtHandler.WriteToken(jwt);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> encodedJwt;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// 解析</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;param name=&quot;jwtStr&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TokenModelJwt <span class="title">SerializeJwt</span><span class="params">(<span class="built_in">string</span> jwtStr)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           var jwtHandler = <span class="keyword">new</span> JwtSecurityTokenHandler();</span><br><span class="line">           JwtSecurityToken jwtToken = jwtHandler.ReadJwtToken(jwtStr);</span><br><span class="line">           object role;</span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               jwtToken.Payload.TryGetValue(ClaimTypes.Role, out role);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">catch</span> (Exception e)</span><br><span class="line">           &#123;</span><br><span class="line">               Console.WriteLine(e);</span><br><span class="line">               <span class="keyword">throw</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           var tm = <span class="keyword">new</span> TokenModelJwt</span><br><span class="line">           &#123;</span><br><span class="line">               Uid = (jwtToken.Id).ObjToInt(),</span><br><span class="line">               Role = role != null ? role.ObjToString() : <span class="string">&quot;&quot;</span>,</span><br><span class="line">           &#125;;</span><br><span class="line">           <span class="keyword">return</span> tm;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">   <span class="comment">/// 令牌</span></span><br><span class="line">   <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenModelJwt</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// Id</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">long</span> Uid &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// 角色</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="keyword">public</span> <span class="built_in">string</span> Role &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// 职能</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="keyword">public</span> <span class="built_in">string</span> Work &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Appsettings —— appsetting.json 操作类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Appsettings</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line">       <span class="keyword">static</span> IConfiguration Configuration &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//static Appsettings()</span></span><br><span class="line">       <span class="comment">//&#123;</span></span><br><span class="line">       <span class="comment">//    //ReloadOnChange = true 当appsettings.json被修改时重新加载</span></span><br><span class="line">       <span class="comment">//    Configuration = new ConfigurationBuilder()</span></span><br><span class="line">       <span class="comment">//    .Add(new JsonConfigurationSource &#123; Path = &quot;appsettings.json&quot;, ReloadOnChange = true &#125;)//请注意要把当前appsetting.json 文件-&gt;右键-&gt;属性-&gt;复制到输出目录-&gt;始终复制</span></span><br><span class="line">       <span class="comment">//    .Build();</span></span><br><span class="line">       <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">static</span> <span class="title">Appsettings</span><span class="params">()</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="built_in">string</span> Path = <span class="string">&quot;appsettings.json&quot;</span>;</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="comment">//如果你把配置文件 是 根据环境变量来分开了，可以这样写</span></span><br><span class="line">               <span class="comment">//Path = $&quot;appsettings.&#123;Environment.GetEnvironmentVariable(&quot;ASPNETCORE_ENVIRONMENT&quot;)&#125;.json&quot;;</span></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="comment">//Configuration = new ConfigurationBuilder()</span></span><br><span class="line">           <span class="comment">//.Add(new JsonConfigurationSource &#123; Path = Path, ReloadOnChange = true &#125;)//请注意要把当前appsetting.json 文件-&gt;右键-&gt;属性-&gt;复制到输出目录-&gt;始终复制</span></span><br><span class="line">           <span class="comment">//.Build();</span></span><br><span class="line"></span><br><span class="line">           Configuration = <span class="keyword">new</span> ConfigurationBuilder()</span><br><span class="line">              .SetBasePath(Directory.GetCurrentDirectory())</span><br><span class="line">              .Add(<span class="keyword">new</span> JsonConfigurationSource &#123; Path = Path, Optional = <span class="literal">false</span>, ReloadOnChange = <span class="literal">true</span> &#125;)<span class="comment">//这样的话，可以直接读目录里的json文件，而不是 bin 文件夹下的，所以不用修改复制属性</span></span><br><span class="line">              .Build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/// &lt;summary&gt;</span></span><br><span class="line">       <span class="comment">/// 封装要操作的字符</span></span><br><span class="line">       <span class="comment">/// &lt;/summary&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;param name=&quot;sections&quot;&gt;&lt;/param&gt;</span></span><br><span class="line">       <span class="comment">/// &lt;returns&gt;&lt;/returns&gt;</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">app</span><span class="params">(params <span class="built_in">string</span>[] sections)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               var val = <span class="built_in">string</span>.Empty;</span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sections.Length; i++)</span><br><span class="line">               &#123;</span><br><span class="line">                   val += sections[i] + <span class="string">&quot;:&quot;</span>;</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">               <span class="keyword">return</span> Configuration[val.TrimEnd(<span class="string">&#x27;:&#x27;</span>)];</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">catch</span> (Exception)</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//登录的时候使用</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> async Task&lt;object&gt; <span class="title">GetJwtStr</span><span class="params">(<span class="built_in">string</span> name, <span class="built_in">string</span> pass)</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="built_in">string</span> jwtStr = <span class="built_in">string</span>.Empty;</span><br><span class="line">       <span class="keyword">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 获取用户的角色名，请暂时忽略其内部是如何获取的，可以直接用 var userRole=&quot;Admin&quot;; 来代替更好理解。</span></span><br><span class="line">       var userRole = await _sysUserInfoServices.GetUserRoleNameStr(name, pass);</span><br><span class="line">　　　　　　  <span class="keyword">if</span> (userRole != null)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="comment">// 将用户id和角色名，作为单独的自定义变量封装进 token 字符串中。</span></span><br><span class="line">           TokenModelJwt tokenModel = <span class="keyword">new</span> TokenModelJwt &#123;Uid = <span class="number">1</span>, Role = userRole&#125;;</span><br><span class="line">           jwtStr = JwtHelper.IssueJwt(tokenModel);<span class="comment">//登录，获取到一定规则的 Token 令牌</span></span><br><span class="line">           suc = <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       &#123;</span><br><span class="line">           jwtStr = <span class="string">&quot;login fail!!!&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> Ok(<span class="keyword">new</span></span><br><span class="line">       &#123;</span><br><span class="line">           success = suc,</span><br><span class="line">           token = jwtStr</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="JWT-授权认证"><a href="#JWT-授权认证" class="headerlink" title="JWT 授权认证"></a>JWT 授权认证</h4><p>Swagger 已经帮我们实现了录入 Token 令牌的功能:<br>ConfigureServices  -&gt; AddSwaggerGen 服务中, 增加如下代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#region Token绑定到ConfigureServices</span></span><br><span class="line">       <span class="comment">//添加header验证信息</span></span><br><span class="line">       <span class="comment">//c.OperationFilter&lt;SwaggerHeader&gt;();</span></span><br><span class="line">       var security = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, IEnumerable&lt;<span class="built_in">string</span>&gt;&gt; &#123; &#123; <span class="string">&quot;MResManager&quot;</span>, <span class="keyword">new</span> <span class="built_in">string</span>[] &#123; &#125; &#125;, &#125;;</span><br><span class="line">       c.AddSecurityRequirement(security);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//方案名称“MResManager”可自定义，上下一致即可</span></span><br><span class="line">       c.AddSecurityDefinition(<span class="string">&quot;MResManager&quot;</span>, <span class="keyword">new</span> ApiKeyScheme</span><br><span class="line">       &#123;</span><br><span class="line">           Description = <span class="string">&quot;JWT授权(数据将在请求头中进行传输) 直接在下框中输入Bearer &#123;token&#125;（注意两者之间是一个空格）&quot;</span>,</span><br><span class="line">           Name = <span class="string">&quot;Authorization&quot;</span>, <span class="comment">//jwt默认的参数名称</span></span><br><span class="line">           In = <span class="string">&quot;header&quot;</span>,          <span class="comment">//jwt默认存放Authorization信息的位置(请求头中)</span></span><br><span class="line">           Type = <span class="string">&quot;apiKey&quot;</span></span><br><span class="line">       &#125;);</span><br><span class="line">   <span class="meta">#endregion</span></span><br></pre></td></tr></table></figure><p>运行项目，swagger/index.html 页面里看到这个Token入口： Authorize， 点击按钮，输入框输入 Bearer xxxxxxxxxxxxx<br><strong>注意 Bearer 后面是一个空格，如果使用中间件 app.UseMiddleware<JwtTokenAuth>() ，要是使用 Bearer xxxxxxxxxxxxx 传值的时候，在中间件的方法中，把Token的 “Bearer 空格” 字符给截取掉</strong></p><p>1、API 接口授权策略</p><p>直接接口上，设置该接口对应的角色权限    </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[HttpPost]</span><br><span class="line">   [Authorize(Roles = <span class="string">&quot;Admin&quot;</span>)]</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Post</span><span class="params">([FromBody]<span class="built_in">string</span> value)</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>ConfigureService 中设置：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">services.AddAuthorization(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.AddPolicy(<span class="string">&quot;Client&quot;</span>, policy =&gt; policy.RequireRole(<span class="string">&quot;Client&quot;</span>).Build());</span><br><span class="line">    options.AddPolicy(<span class="string">&quot;Admin&quot;</span>, policy =&gt; policy.RequireRole(<span class="string">&quot;Admin&quot;</span>).Build());</span><br><span class="line">    options.AddPolicy(<span class="string">&quot;SystemOrAdmin&quot;</span>, policy =&gt; policy.RequireRole(<span class="string">&quot;Admin&quot;</span>, <span class="string">&quot;System&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// controller 或者 action 上，直接写策略名</span></span><br><span class="line">[HttpGet]</span><br><span class="line">[Authorize(Policy = <span class="string">&quot;SystemOrAdmin&quot;</span>)]</span><br><span class="line"><span class="keyword">public</span> ActionResult&lt;IEnumerable&lt;<span class="built_in">string</span>&gt;&gt; Get()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;value1&quot;</span>, <span class="string">&quot;value2&quot;</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//官方认证配置</span></span><br><span class="line">services.AddAuthentication(x =&gt;</span><br><span class="line"> &#123;</span><br><span class="line">     x.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;</span><br><span class="line">     x.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;</span><br><span class="line"> &#125;)</span><br><span class="line">  .AddJwtBearer(o =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">      o.TokenValidationParameters = <span class="keyword">new</span> TokenValidationParameters</span><br><span class="line">      &#123;</span><br><span class="line">          ValidateIssuerSigningKey = <span class="literal">true</span>,</span><br><span class="line">          IssuerSigningKey = signingKey,</span><br><span class="line">          ValidateIssuer = <span class="literal">true</span>,</span><br><span class="line">          ValidIssuer = audienceConfig[<span class="string">&quot;Issuer&quot;</span>],<span class="comment">//发行人</span></span><br><span class="line">          ValidateAudience = <span class="literal">true</span>,</span><br><span class="line">          ValidAudience = audienceConfig[<span class="string">&quot;Audience&quot;</span>],<span class="comment">//订阅人</span></span><br><span class="line">          ValidateLifetime = <span class="literal">true</span>,</span><br><span class="line">          ClockSkew = TimeSpan.Zero,</span><br><span class="line">          RequireExpirationTime = <span class="literal">true</span>,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>2、自定义认证之身份验证</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtTokenAuth</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line">       <span class="comment">// 中间件一定要有一个next，将管道可以正常的走下去</span></span><br><span class="line">       <span class="keyword">private</span> readonly RequestDelegate _next;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="title">JwtTokenAuth</span><span class="params">(RequestDelegate next)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           _next = next;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> Task <span class="title">Invoke</span><span class="params">(HttpContext httpContext)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line"></span><br><span class="line">           <span class="comment">//检测是否包含&#x27;Authorization&#x27;请求头</span></span><br><span class="line">           <span class="keyword">if</span> (!httpContext.Request.Headers.ContainsKey(<span class="string">&quot;Authorization&quot;</span>))</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="keyword">return</span> _next(httpContext);</span><br><span class="line">           &#125;</span><br><span class="line">           var tokenHeader = httpContext.Request.Headers[<span class="string">&quot;Authorization&quot;</span>].ToString().Replace(<span class="string">&quot;Bearer &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               <span class="keyword">if</span> (tokenHeader.Length &gt;= <span class="number">128</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   TokenModelJwt tm = JwtHelper.SerializeJwt(tokenHeader);</span><br><span class="line"></span><br><span class="line">                   <span class="comment">//授权 Claim 关键</span></span><br><span class="line">                   var claimList = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">                   var claim = <span class="keyword">new</span> Claim(ClaimTypes.Role, tm.Role);</span><br><span class="line">                   claimList.Add(claim);</span><br><span class="line">                   var identity = <span class="keyword">new</span> ClaimsIdentity(claimList);</span><br><span class="line">                   var principal = <span class="keyword">new</span> ClaimsPrincipal(identity);</span><br><span class="line">                   httpContext.User = principal;</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">catch</span> (Exception e)</span><br><span class="line">           &#123;</span><br><span class="line">               Console.WriteLine($<span class="string">&quot;&#123;DateTime.Now&#125; middleware wrong:&#123;e.Message&#125;&quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> _next(httpContext);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 这里定义一个中间件Helper，主要作用就是给当前模块的中间件取一个别名</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MiddlewareHelpers</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IApplicationBuilder <span class="title">UseJwtTokenAuth</span><span class="params">(<span class="keyword">this</span> IApplicationBuilder app)</span></span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> app.UseMiddleware&lt;JwtTokenAuth&gt;();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>3、开启中间件</p><p>startup.cs -&gt; Configure 中配置认证中间件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义认证中间件</span></span><br><span class="line">app.UseJwtTokenAuth(); <span class="comment">//也可以app.UseMiddleware&lt;JwtTokenAuth&gt;();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//官方认证中间件</span></span><br><span class="line">app.UseAuthentication();</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/laozhang-is-phi/p/9511869.html">JWT知识点</a></p>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> .Net </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IoC 核心</title>
      <link href="2019/07/16/Csharp/IoC%20%20%E6%A0%B8%E5%BF%83/"/>
      <url>2019/07/16/Csharp/IoC%20%20%E6%A0%B8%E5%BF%83/</url>
      
        <content type="html"><![CDATA[<h4 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h4><ul><li><p>IoC(控制反转) 、DI(依赖注入)</p></li><li><p>作用：借助于“第三方”实现具有依赖关系的对象之间的解耦，即通过引入 IoC 容器，利用依赖关系注入的方式，实现对象之间的解耦。</p></li></ul><h4 id="基本技术"><a href="#基本技术" class="headerlink" title="基本技术"></a>基本技术</h4><blockquote><p>反射(Reflection)</p></blockquote><h4 id="Ioc-产品"><a href="#Ioc-产品" class="headerlink" title="Ioc 产品"></a>Ioc 产品</h4><ul><li>.Net IOC容器：Spring.Net、Castle</li><li>Sun ONE IoC容器：Spring、Guice、Pico Container、Avalon、HiveMind；EJB；</li></ul><h4 id="Spring-Net-过程阶段"><a href="#Spring-Net-过程阶段" class="headerlink" title="Spring.Net 过程阶段"></a>Spring.Net 过程阶段</h4><ul><li>容器启动阶段</li><li>Bean实例化阶段</li></ul><h4 id="Spring-Net-实现方式"><a href="#Spring-Net-实现方式" class="headerlink" title="Spring.Net 实现方式"></a>Spring.Net 实现方式</h4><ul><li><p>接口注入<br>缺点：强制被注入对象实现不必要的接口</p></li><li><p>构造方法注入<br>缺点：参数列表维护</p></li><li><p>setter方法注入<br>推荐方法</p></li></ul><h4 id="Spring-Net-IoC-容器"><a href="#Spring-Net-IoC-容器" class="headerlink" title="Spring.Net IoC 容器"></a>Spring.Net IoC 容器</h4><ul><li>BeanFactory</li><li>ApplicationContext</li></ul><h4 id="对象依赖信息"><a href="#对象依赖信息" class="headerlink" title="对象依赖信息"></a>对象依赖信息</h4><ul><li>通过最基本的文本文件来记录被注入对象和其依赖对象之间的对应关系</li><li>通过描述性较强的XML文件格式来记录对应信息</li><li>通过编写代码的方式来注册这些对应信息</li><li>通过注解方式来注册这些对应信息</li></ul>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IoC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ORM 详解</title>
      <link href="2019/07/16/Csharp/ORM%20%E8%AF%A6%E8%A7%A3/"/>
      <url>2019/07/16/Csharp/ORM%20%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h4 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h4><ul><li><p>持久化、持久层</p></li><li><p>Object-Relationl Mapping 作用：在关系型数据库和对象之间作一个映射，将复杂的业务逻辑和数据逻辑分离，达到解耦的目的。</p></li></ul><h4 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h4><blockquote><p>简单：以最基本的形式建模数据。 </p></blockquote><blockquote><p>传达性：数据库结构被任何人都能理解的语言文档化。 </p></blockquote><blockquote><p>精确性：基于数据模型创建正确标准化了的结构。 </p></blockquote><h4 id="NET主流-ORM"><a href="#NET主流-ORM" class="headerlink" title=".NET主流 ORM"></a>.NET主流 ORM</h4><ul><li><p>SqlSugar (国内)</p></li><li><p>Dos.ORM (国内)</p></li><li><p>Chloe (国内)</p></li><li><p>StackExchange/Dapper (国外)</p></li><li><p>Entity Framework (EF) (国外)</p></li><li><p>NHibernate (国外)</p></li><li><p>ServiceStack/ServiceStack.OrmLite (国外)</p></li><li><p>linq2db (国外)</p></li><li><p>Massive (国外)</p></li><li><p>PetaPoco (国外)</p></li><li><p>SqlSugar</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> .Net </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ORM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 内置组件</title>
      <link href="2019/07/16/Vue/Vue%20%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6/"/>
      <url>2019/07/16/Vue/Vue%20%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h4><blockquote><p>component 接收名为 is 的属性，is 的值为父组件中注册过的组件名称。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;someView&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="插槽分发内容"><a href="#插槽分发内容" class="headerlink" title="插槽分发内容"></a>插槽分发内容</h4><blockquote><p>slot 多个插槽，通过 name 属性区分，如未指定 name 属性，则所有的插槽内容置于默认插槽 default 中。</p></blockquote><h4 id="组件的缓存"><a href="#组件的缓存" class="headerlink" title="组件的缓存"></a>组件的缓存</h4><blockquote><p>keep-alive 接收 include和exclude 两个 props 属性</p></blockquote><p><strong>当组件在 keep-alive 内被切换时，它的 activated 和 deactivated 这两个生命周期钩子函数会被执行。</strong></p><h4 id="过渡效果"><a href="#过渡效果" class="headerlink" title="过渡效果"></a>过渡效果</h4><blockquote><p>transition<br>transition-group</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 进阶</title>
      <link href="2019/07/16/Vue/Vue%20%E8%BF%9B%E9%98%B6/"/>
      <url>2019/07/16/Vue/Vue%20%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="指定被挂载元素"><a href="#指定被挂载元素" class="headerlink" title="指定被挂载元素"></a>指定被挂载元素</h4><blockquote><p>el 选项指定 Vue 实例的挂载目标，属性值仅限于 CSS 选择器或者 DOM 节点对象<br>$mount 挂载实例</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line"><span class="comment">// 选择器</span></span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>, </span><br><span class="line"></span><br><span class="line"><span class="comment">// HTMLElement</span></span><br><span class="line">el: <span class="built_in">document</span>.getElementById(<span class="string">&#x27;app&#x27;</span>), </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">something...</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//$mount 挂载实例</span></span><br><span class="line"><span class="keyword">let</span> handleMount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">vm.$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h4><blockquote><p>template 选项</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">template: <span class="string">&#x27;&lt;div&gt;some template&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="渲染函数"><a href="#渲染函数" class="headerlink" title="渲染函数"></a>渲染函数</h4><blockquote><p>渲染函数（render）用于渲染视图，提供回调方法 createElement</p></blockquote><h4 id="选项的优先级"><a href="#选项的优先级" class="headerlink" title="选项的优先级"></a>选项的优先级</h4><blockquote><p>render &gt; template &gt; el</p></blockquote><h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><blockquote><p>双括号插值绑定中，“|”分割表达式：  msg | filter1 | filter2 </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msg: <span class="string">&#x27;Test#%%for%#%Filter.&#x27;</span></span><br><span class="line"></span><br><span class="line">filters:&#123;</span><br><span class="line">filter1 (val)&#123;</span><br><span class="line"><span class="keyword">return</span> val.replace(<span class="regexp">/#/g</span>, <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">&#125;,</span><br><span class="line">filter2 (val)&#123;</span><br><span class="line"><span class="keyword">return</span> val.replace(<span class="regexp">/%/g</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h4><p><strong>自定义指令被申明在 directives 选项中</strong></p><blockquote><p>钩子函数</p></blockquote><ul><li>bind</li><li>inserted</li><li>update</li><li>componentUpdated</li><li>unbind</li></ul><blockquote><p>钩子函数接受参数</p></blockquote><ul><li>el</li><li>binding</li></ul><blockquote><p>binding 包含属性</p></blockquote><ul><li>name</li><li>value</li><li>oldValue 仅在 update 时使用</li><li>expression</li><li>arg</li><li>modifiers</li><li>vnode</li><li>oldNode 仅在 update 时使用</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-some.upper</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-some.lower</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-style</span>=<span class="string">&quot;style&quot;</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">directives:&#123;</span><br><span class="line">style:&#123;</span><br><span class="line">bind (el, binding, vnode)&#123;</span><br><span class="line"><span class="comment">//doSomeThing...</span></span><br><span class="line">&#125;,</span><br><span class="line">update (el, binding, vnode, oldVnode)&#123;</span><br><span class="line"><span class="comment">//doSomeThing...</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">some (el, binding)&#123;</span><br><span class="line"><span class="keyword">let</span> text = el.innerText;</span><br><span class="line"><span class="keyword">let</span> modifiers = binding.modifiers;</span><br><span class="line"><span class="keyword">if</span>(modifiers.upper)&#123;</span><br><span class="line">el.innerText = text.toUpperCase();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(modifiers.lower)&#123;</span><br><span class="line">el.innerText = text.toLowerCase();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="组件的注册"><a href="#组件的注册" class="headerlink" title="组件的注册"></a>组件的注册</h4><blockquote><p>components 选项用于为组件注册从外部引入的组件，子组件并非全局定义，因此不可以直接在父组件作用域内使用，常用场景引入第三方库组件和自定义组件等。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> eTitle = &#123;</span><br><span class="line">name: <span class="string">&#x27;eTitle&#x27;</span>,</span><br><span class="line">template:<span class="string">&#x27;&lt;p&gt;title&lt;/p&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> eMotto = &#123;</span><br><span class="line">name: <span class="string">&#x27;eMotto&#x27;</span>,</span><br><span class="line">template:<span class="string">&#x27;&lt;p&gt;motto&lt;/p&gt;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">components:&#123;eTitle, eMotto&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="混入"><a href="#混入" class="headerlink" title="混入"></a>混入</h4><blockquote><p>mixins </p></blockquote><p>混入Vue实例的方法（局部混入、全局混入）</p><blockquote><p>冲突默认策略：</p></blockquote><ul><li> data： 合并，优先采用组件的数据</li><li> mounted 等钩子函数： 混合为数组，全部调用，优先调用 mixins</li><li> methods/components/directives等： 混为同一对象，优先采用组件键值对</li><li> watch： 混为数组，全部调用，优先调用 mixins</li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 选项</title>
      <link href="2019/07/16/Vue/Vue%20%E9%80%89%E9%A1%B9/"/>
      <url>2019/07/16/Vue/Vue%20%E9%80%89%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<h4 id="数据选项"><a href="#数据选项" class="headerlink" title="数据选项"></a>数据选项</h4><ul><li>数据（Data）选项可接受类型：对象和函数，组件只能使用函数类型</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象类型</span></span><br><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="function"><span class="title">Vue</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">data:&#123;</span><br><span class="line">title:<span class="string">&#x27;Vue Projects&#x27;</span>,</span><br><span class="line">obj:&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数类型</span></span><br><span class="line">Vue.component(<span class="string">&#x27;buttonCounter&#x27;</span>,&#123;</span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">counter:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">template:<span class="string">&#x27;&lt;button @click=&quot;counter++&quot;&gt;clicked &#123;&#123;counter&#125;&#125; times&lt;/button&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>  <strong>注意点：Vue会递归的将 data 数据加入响应式系统，但这些<span style="color:red;">数据应该在声明时即存在</span>，也就是说需要在实例中被观察的对象预先在 data 选项中声明。</strong></p><ul><li>$set，Object.assign 方法为 data 选项动态绑定数据，但是也无法挂载响应式数据到 $data 根节点。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$set(<span class="built_in">this</span>.obj, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;This is a Vue App.&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.assign(<span class="built_in">this</span>.obj, &#123;<span class="attr">profile</span>: <span class="string">&#x27;This is a Vue App.&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure><h4 id="属性选项"><a href="#属性选项" class="headerlink" title="属性选项"></a>属性选项</h4><blockquote><p>为组件注册动态特性，处理业务间的差异。使代码可以复用相似的应用场景</p></blockquote><ul><li>属性（props）选项可接受类型：数组和对象，用于接收父组件传递过来的参数，并允许为其设置默认值、类型检查和校验规则等。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">&#x27;colorText&#x27;</span>,&#123;</span><br><span class="line">props:&#123;</span><br><span class="line">text:<span class="built_in">String</span>,</span><br><span class="line">color:&#123;</span><br><span class="line">type:<span class="string">&#x27;String&#x27;</span>,</span><br><span class="line"><span class="keyword">default</span>:<span class="string">&#x27;#000&#x27;</span>,</span><br><span class="line">required:<span class="literal">true</span>,</span><br><span class="line"><span class="function"><span class="title">validator</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="regexp">/^#([0-9a-fA-F]&#123;6&#125;|[0-6a-fA-F]&#123;3&#125;)$/</span>.test(value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">template:<span class="string">&#x27;&lt;span :style=&quot;&#123;color: color&#125;&quot;&gt;&#123;&#123;text&#125;&#125;&lt;/span&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="方法选项"><a href="#方法选项" class="headerlink" title="方法选项"></a>方法选项</h4><p><strong>不要用箭头函数（=&gt;）声明 methods 中的方法</strong></p><h4 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h4><blockquote><p>减轻模板上的业务负担，是代码更易维护</p></blockquote><p>//未使用computed</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;message&#125;&#125; .<span class="symbol">&amp;nbsp;</span> 我看到的是车还是猫。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;message.replace(/\s/g,&#x27;&#x27;)&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;message.replace(/\s/g,&#x27;&#x27;).split(&#x27; &#x27;).reverse().join(&#x27; &#x27;)&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="function"><span class="title">Vue</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span>&#123;</span><br><span class="line">message:<span class="string">&#x27;Was it a car or a cat i saw&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>//使用computed</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;message&#125;&#125; .<span class="symbol">&amp;nbsp;</span> 我看到的是车还是猫。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;noSpaceMsg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;palindromeMsg&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="function"><span class="title">Vue</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span>&#123;</span><br><span class="line">message:<span class="string">&#x27;Was it a car or a cat i saw&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">computed:&#123;</span><br><span class="line"><span class="function"><span class="title">noSpaceMsg</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.message.replace(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">palindromeMsg</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.message.replace(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27; &#x27;</span>).reverse().join(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>computed 不能用箭头函数（=&gt;）声明，混入Vue 实例，可以被 this 调用。</strong></p><h4 id="侦听属性"><a href="#侦听属性" class="headerlink" title="侦听属性"></a>侦听属性</h4><blockquote><p>为实例添加被观察对象，并在对象被修改时调用自定义方法。<br>注重于处理数据变化时的业务逻辑。<br>可以异步修改数据。<br>丰富的声明方式</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line"><span class="function"><span class="title">msg</span>(<span class="params">newVal, oldVal</span>)</span>&#123;</span><br><span class="line"><span class="built_in">this</span>.noSpaceMsg = <span class="built_in">this</span>.message.replace(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">watch:&#123;</span><br><span class="line"><span class="function"><span class="title">msg</span>(<span class="params">newVal, oldVal</span>)</span>&#123;</span><br><span class="line">axios(&#123;</span><br><span class="line">method: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">url: <span class="string">&#x27;/url&#x27;</span>,</span><br><span class="line">params:&#123; <span class="attr">msg</span>:newVal&#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.someMsg = res.data.message</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 项目化</title>
      <link href="2019/07/16/Vue/Vue%20%E9%A1%B9%E7%9B%AE%E5%8C%96/"/>
      <url>2019/07/16/Vue/Vue%20%E9%A1%B9%E7%9B%AE%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="完成的前端开发环境"><a href="#完成的前端开发环境" class="headerlink" title="完成的前端开发环境"></a>完成的前端开发环境</h4><ul><li>预编译模板</li><li>注入依赖</li><li>合并压缩资源</li><li>分离开发</li><li>生产环境</li><li>模拟的服务端环境等</li></ul><h4 id="Vue项目快速构建工具"><a href="#Vue项目快速构建工具" class="headerlink" title="Vue项目快速构建工具"></a>Vue项目快速构建工具</h4><blockquote><p>Vue CLI</p></blockquote><p>关于怎么用Vue CLI创建项目，<a href="../../../07/12/Vue%20%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80">Vue 入门基础</a> 已经提及。</p><ul><li>项目初始目录</li></ul><div class="tableWrap"><table><thead><tr><th align="right">名称</th><th align="left">描述</th></tr></thead><tbody><tr><td align="right">build</td><td align="left">开发和生产版本的构建脚本</td></tr><tr><td align="right">config</td><td align="left">开发和生产版本的部分构建配置</td></tr><tr><td align="right">dist</td><td align="left">npm run build 生成，项目的生产版本，交付物</td></tr><tr><td align="right">src</td><td align="left">关键资源和主要工作空间</td></tr><tr><td align="right">static</td><td align="left">静态资源</td></tr><tr><td align="right">.babelrc</td><td align="left">js 预编译器的配置文件</td></tr><tr><td align="right">.eslintignore</td><td align="left">代码语法检查，应忽略的</td></tr><tr><td align="right">.eslintrc.js</td><td align="left">代码语法检查，应规范的</td></tr><tr><td align="right">.gitignore</td><td align="left">Git 忽略项配置</td></tr><tr><td align="right">index.html</td><td align="left">应被 Webpack 注入资源的模板HTML文件</td></tr></tbody></table></div><style>    .tableWrap table,.tableWrap table th,.tableWrap table td{        padding:.5rem .8rem;        border:1px solid #cdcdcd;    }    .tableWrap table{        border-collapse:collapse;        margin-bottom:1rem;    }</style><ul><li>src 目录</li></ul><blockquote><p>assets ： 存放图片，音频，视频等资源<br>components ： 存放单文件组件<br>router/index.js ： 配置项目的前端路由<br>App.vue ： 默认项目根组件<br>main.js ： webpack的入口文件</p></blockquote><h4 id="前端路由"><a href="#前端路由" class="headerlink" title="前端路由"></a>前端路由</h4><blockquote><p>核心</p></blockquote><ul><li>需要监听浏览器地址的变化</li><li>需要动态加载视图</li></ul><p>1、基础路由<br>2、动态路由<br>3、潜逃路由<br>4、编程式路由</p><h4 id="状态管理器-Vuex"><a href="#状态管理器-Vuex" class="headerlink" title="状态管理器 Vuex"></a>状态管理器 Vuex</h4><blockquote><p>重要概念：State, Getter, Mutation, Action, Module</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue-router钩子函数实现路由守卫</title>
      <link href="2019/07/16/Vue/vue-router%20%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%E5%AE%9E%E7%8E%B0%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB/"/>
      <url>2019/07/16/Vue/vue-router%20%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%E5%AE%9E%E7%8E%B0%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB/</url>
      
        <content type="html"><![CDATA[<h4 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h4><ol><li><p>全局钩子函数</p><p> beforeEach、afterEach</p></li><li><p>路由独享的钩子函数</p><p> beforeEnter</p></li><li><p>组件内钩子函数</p><p> beforeRouterEnter、beforeRouterUpdate、beforeRouterLeave</p></li></ol><h4 id="全局钩子函数"><a href="#全局钩子函数" class="headerlink" title="全局钩子函数"></a>全局钩子函数</h4><blockquote><p>beforeEach</p></blockquote><p>参数：</p><pre><code>to：即将进入的路由对象from：正要离开的路由对象next：路由的控制参数</code></pre><p>next() 调用方式：</p><ol><li><p>next() </p><p> 一切正常调用进入下一个钩子</p></li><li><p>next(false)</p><p> 取消路由导航，返回正要离开的路由地址</p></li><li><p>next(‘/path’)</p><p> 当前路由终止，页面重定向</p></li><li><p>next(error)</p><p> 路由导航终止并且错误会被传递到 router.onError() 注册过的回调中</p></li></ol><p>应用场景：登录权限，页面权限</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 进入路由前钩子</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    to 目标路由</span></span><br><span class="line"><span class="comment">    from 源路由</span></span><br><span class="line"><span class="comment">    next 跳转到下一个路由</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.localstorange.getItem(<span class="string">&quot;token&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果存在，则直接跳转到对应路由</span></span><br><span class="line">     next();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果不存在，则跳转到登录页</span></span><br><span class="line">    next(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>afterEach</p></blockquote><p>参数：</p><pre><code>to：即将进入的路由对象from：正要离开的路由对象</code></pre><p>应用场景：</p><pre><code>重置页面滚动条位置</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.afterEach(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//将滚动条恢复到最顶端</span></span><br><span class="line">  <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="路由独享的钩子函数"><a href="#路由独享的钩子函数" class="headerlink" title="路由独享的钩子函数"></a>路由独享的钩子函数</h4><blockquote><p>beforeEneter</p></blockquote><pre><code>在路由配置中添加key—value</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes=[</span><br><span class="line">&#123;</span><br><span class="line">  path:<span class="string">&#x27;/path&#x27;</span>,</span><br><span class="line">  component:page1,</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">//路由独享的钩子函数</span></span><br><span class="line">  beforeEnter:<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(to);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">from</span>);</span><br><span class="line">    next(<span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="组件内钩子函数"><a href="#组件内钩子函数" class="headerlink" title="组件内钩子函数"></a>组件内钩子函数</h4><blockquote><p>beforeRouteEnter(to,from,next)</p></blockquote><p>路由进入前调用，此时 Vue 实例未创建，所有唯一不能使用 this 的钩子函数</p><blockquote><p>beforeRouteUpdate(to,from,next)</p></blockquote><p>路由发生修改的时候进行调用</p><blockquote><p>beforeRouteLeave(to,from,next)</p></blockquote><p>路由离开该组件时调用</p><p>使用方法：</p><pre><code>组件中添加 `方法`</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">//路由进入前调用</span></span><br><span class="line">  beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    next();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//路由修改时调用</span></span><br><span class="line">  <span class="function"><span class="title">beforeRouteUpdate</span>(<span class="params">to,<span class="keyword">from</span>,next</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//路由离开时调用</span></span><br><span class="line">  <span class="function"><span class="title">beforeRouteLeave</span>(<span class="params">to,<span class="keyword">from</span>,next</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      msg: <span class="string">&quot;我是组件&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS3 单位区别</title>
      <link href="2019/07/12/Css/Css3%20%E5%8D%95%E4%BD%8D%E5%8C%BA%E5%88%AB/"/>
      <url>2019/07/12/Css/Css3%20%E5%8D%95%E4%BD%8D%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h4 id="常用单位"><a href="#常用单位" class="headerlink" title="常用单位"></a>常用单位</h4><p>1、px：绝对单位，页面按精确像素展示</p><p>2、em：相对单位，基准点为父节点字体的大小，如果自身定义了font-size按自身来计算，整个页面内1em不是一个固定的值。</p><p>3、rem：相对单位，可理解为”root em”, 相对根节点html的字体大小来计算。</p><p>4、vw、vh、vmin、vmax （窗单位，也是相对单位。它相对的不是父节点或者页面的根节点。而是由视窗（Viewport）大小来决定的，单位 1，代表类似于 1%。）</p><ul><li>vw：视窗宽度的百分比（1vw 代表视窗的宽度为 1%）</li><li>vh：视窗高度的百分比</li><li>vmin：当前 vw 和 vh 中较小的一个值</li><li>vmax：当前 vw 和 vh 中较大的一个值</li></ul><p>5、%：相对于父元素的大小设定的比率</p><h4 id="效果演示"><a href="#效果演示" class="headerlink" title="效果演示"></a>效果演示</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>container<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>wrap<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>parent<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>child<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line"><span class="selector-class">.container</span>&#123; <span class="attribute">width</span>:<span class="number">100%</span>; <span class="attribute">background</span>:<span class="number">#cdcdcd</span>; <span class="attribute">overflow</span>:auto;&#125;</span><br><span class="line"><span class="selector-class">.wrap</span> *&#123; <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> .<span class="number">8rem</span>; <span class="attribute">padding</span>:<span class="number">0</span>;&#125;</span><br><span class="line"><span class="selector-class">.wrap</span>,<span class="selector-class">.parent</span>,<span class="selector-class">.child</span>&#123;</span><br><span class="line"><span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line"><span class="attribute">padding</span>:<span class="number">1rem</span>;</span><br><span class="line"><span class="attribute">box-sizing</span>:border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span>&#123; <span class="attribute">margin-bottom</span>:<span class="number">0</span>; <span class="attribute">font-size</span>:<span class="number">15px</span>; <span class="attribute">background</span>:lemonchiffon;&#125;</span><br><span class="line"><span class="selector-class">.parent</span>&#123; <span class="attribute">font-size</span>:<span class="number">12px</span>; <span class="attribute">background</span>:palegreen&#125;</span><br><span class="line"><span class="selector-class">.child</span>&#123; <span class="attribute">font-size</span>:<span class="number">18px</span>; <span class="attribute">background</span>:navajowhite&#125;</span><br><span class="line">&lt;/<span class="selector-tag">style</span>&gt;</span><br></pre></td></tr></table></figure><style>    .container{ width:100%; padding:.8rem 0 0; text-indent:1rem; background:#efefef; overflow:auto;}    .container *{ margin:0 0 .8rem; padding:0; box-sizing:border-box;}    .wrap,.parent,.child{        width:100%;        padding:1rem;    }    .wrap{ font-size:15px; background:lemonchiffon;}    .parent{ font-size:12px; background:palegreen}    .child{ font-size:18px; background:navajowhite}</style><div class="container">    <p>container</p>    <div class="wrap">        <p>wrap</p>        <div class="parent">            <p>parent</p>            <div class="child">                <p>child</p>            </div>        </div>    </div></div><ul><li><p>单位选择</p><div class="company"><span>px</span><span>em</span><span>rem</span><span>vmin</span><span>vmax</span></div></li><li><p>宽度调整</p><div class="slide wrapSlide"><i></i> <em>0</em></div><div class="slide parentSlide"><i></i> <em>0<em></div><div class="slide childSlide"><i></i> <em>0<em></div></li></ul><style>    .slide{position:relative; display:inline-block; width:50%; height:8px; border-radius:4px; background:tomato}    .slide i{        position:absolute;        top:0; left:0; width:0; height:8px; border-radius:4px;      }    .slide em{        position:absolute; top:-.6rem; right:-2rem; font-style:normal;    }    .wrapSlide i{ background:lemonchiffon}    .parentSlide i{ background:palegreen}    .childSlide i{ background:navajowhite}    .company span{ display:inline-block; margin:0 .8rem .5rem; border-bottom:1px dashed #cdcdcd; cursor:pointer;}    .company span:hover,.company span.active{ color:#0092db;}</style><script>    var d = document,        companyWrap = d.getElementsByClassName('company')[0],        companys = companyWrap.children,        companyActive = companyWrap.getElementsByClassName("active"),        slides = d.getElementsByClassName('slide'),        containers = ["wrap","parent","child"],        containerW = {};    for(let i =0; i<slides.length; i++){        slides[i].addEventListener("click",function(e){            //console.log(e);            !companyActive.length && companys[0].classList.add("active");            var currCompany = companyActive[0].innerHTML;            console.log(currCompany);            slides[i].children[0].style.width = e.offsetX + 'px';            var slideW = slides[i].style.width || slides[i].clientWidth,                cW = Math.round(e.offsetX/slideW*100);            containerW[containers[i]] = cW;            slides[i].children[1].textContent = cW;            d.getElementsByClassName(containers[i])[0].style.width = cW + currCompany;        })    }    for(let i =0; i<companys.length; i++){        companys[i].addEventListener("click",function(e){            companyActive.length && companyActive[0].classList.remove("active");            companys[i].classList.add("active");            var currCompany = companyActive[0].innerHTML;            for(let i =0; i<slides.length; i++){                var currCompany = companyActive[0].innerHTML;                d.getElementsByClassName(containers[i])[0].style.width = containerW[containers[i]] + currCompany;            }        })    }    function formatStyleKey(str){        var final = "",            strArr = str.toLowerCase().split('-');        for(var i=0; i<strArr.length; i++){            !i ? final+=strArr[i]:final+=strArr[i].slice(0, 1).toUpperCase() + strArr[i].slice(1);        }        return final;    }</script>]]></content>
      
      
      <categories>
          
          <category> CSS3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 入门基础</title>
      <link href="2019/07/12/Vue/Vue%20%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/"/>
      <url>2019/07/12/Vue/Vue%20%E5%85%A5%E9%97%A8%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="vue-devtools安装"><a href="#vue-devtools安装" class="headerlink" title="vue-devtools安装"></a>vue-devtools安装</h4><ul><li><p>git clone <a href="https://github.com/vuejs/vue-devtools.git">https://github.com/vuejs/vue-devtools.git</a></p></li><li><p>npm install</p></li><li><p>npm run build</p></li><li><p>游览器输入地址“chrome://extensions/”进入扩展程序页面，点击“加载已解压的扩展程序…”按钮，选择vue-devtools&gt;shells下的chrome文件夹。</p></li></ul><p> <strong>如果看不见“加载已解压的扩展程序…”按钮，则需要勾选“开发者模式”。</strong></p><ul><li>添加成功后，浏览器调试工具，会增加Vue调试选项。</li></ul><h4 id="项目创建"><a href="#项目创建" class="headerlink" title="项目创建"></a>项目创建</h4><ul><li><p>node -v</p></li><li><p>npm -v<br><strong>查看node.js 是否安装</strong></p></li><li><p>npm install -g vue-cli</p></li><li><p>npm install -g webpack</p></li><li><p>vue init webpack myVue （myVue 项目名称）<br><strong>Use ESLint to lint your code? (Y/n)：是否使用EsLint编码，选择N，其他默认</strong></p></li><li><p>npm install （未自动安装依赖，进入项目目录，手动安装依赖项） </p></li><li><p>npm run dev （启动项目）</p></li></ul><h4 id="本地引用"><a href="#本地引用" class="headerlink" title="本地引用"></a>本地引用</h4><ul><li><a href="https://vuejs.org/js/vue.js">https://vuejs.org/js/vue.js</a> 开发版本，包含完整的警告和调试模式</li></ul><h4 id="vue-语法"><a href="#vue-语法" class="headerlink" title="vue 语法"></a>vue 语法</h4><blockquote><p>插值绑定</p></blockquote><pre><code>&#123;&#123;num&#125;&#125;注意点：  html代码（表达式） 和 html代码（变量），前者优先解释Dom节点，插值语法无效，‘&#123;&#123;’，‘&#125;&#125;’被当作节点文本内容解析。</code></pre><blockquote><p>Html 插值</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">&quot;DOM&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>属性绑定 （v-bind：/：）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;className&quot;</span> <span class="attr">v-bind:title</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind:type</span>=<span class="string">&quot;&#x27;text&#x27;&quot;</span> <span class="attr">v-bind:placeholder</span>=<span class="string">&quot;true?&#x27;请输入&#x27;:&#x27;请录入&#x27;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>类名绑定 （：class）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#x27;color-gray size-18 style-italic&#x27;&quot;</span>&gt;</span>字符串拼接<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;color-gray&#x27;,&#x27;size-18&#x27;,&#x27;style-italic&#x27;]&quot;</span>&gt;</span>数组<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;&#x27;color-gray&#x27;:true, &#x27;size-18&#x27;:true, &#x27;style-italic&#x27;:true&#125;&quot;</span>&gt;</span>对象<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>样式绑定 （：style）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#x27;color:gray; font-size:18px; font-style:italic;&#x27;&quot;</span>&gt;</span>字符串拼接<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;color&#x27;:&#x27;gray&#x27;, &#x27;font-size&#x27;:&#x27;18px&#x27;, &#x27;font-style&#x27;:&#x27;italic&#x27;&#125;&quot;</span>&gt;</span>对象<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>事件绑定 （v-on：/@）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:click</span>=<span class="string">&quot;function()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;function()&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><pre><code>+ 常用事件修饰符.stop | .prevent | .capture | .self | .once | .passive.delete/.8/.46 | .tab/.9 | .enter/.13 | .esc/.27 | .space/.32 .left/.37 | .up/.38 | .right/.39 | .down/.40 .ctrl | .alt | .shift | .meta</code></pre><blockquote><p>双向绑定 （v-model）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;className&quot;</span> <span class="attr">v-bind:title</span>=<span class="string">&quot;c_title&quot;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind:type</span>=<span class="string">&quot;&#x27;text&#x27;&quot;</span> <span class="attr">v-bind:placeholder</span>=<span class="string">&quot;true?&#x27;请输入&#x27;:&#x27;请录入&#x27;&quot;</span> <span class="attr">v-model</span>=<span class="string">&#x27;name&#x27;</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>条件渲染 （v-if/v-else-if/v-else）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;order === 0&quot;</span>&gt;</span>v-if<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">&quot;order === 1&quot;</span>&gt;</span>v-else-if<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else</span>&gt;</span>v-else<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>切换元素的CSS属性：display （v-show）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-show</span>=<span class="string">&quot;visible&quot;</span>&gt;</span>v-show，visible = true<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-show</span>=<span class="string">&quot;!visible&quot;</span>&gt;</span>v-show，visible = false<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>列表渲染，可以渲染数组、对象 （v-for）</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in users&quot;</span>&gt;</span>&#123;&#123;index&#125;&#125; <span class="symbol">&amp;nbsp;</span> &#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(user, index) in users&quot;</span>&gt;</span></span><br><span class="line">    用户 &#123;&#123;index + 1&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(val, key) in user&quot;</span>&gt;</span>&#123;&#123;key&#125;&#125; —— &#123;&#123;val&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Css3 双螺旋</title>
      <link href="2019/07/12/Css/Css3%20%E5%8F%8C%E8%9E%BA%E6%97%8B/"/>
      <url>2019/07/12/Css/Css3%20%E5%8F%8C%E8%9E%BA%E6%97%8B/</url>
      
        <content type="html"><![CDATA[<style>.animiateWrap,.helix{    -webkit-perspective: 1500px;    perspective: 1500px;}.animiateWrap ul,.helix ul,.animiateWrap ul li,.helix ul li{    list-style:none;    margin:0;    padding:0;}.animiateWrap ul{    display:flex;    flex-flow:row nowrap;    height:18rem;    margin-bottom:3rem;    justify-content: center;      align-items: center;    background:#666;}/* 节点 */ul.a li{    position:relative;    width:.8rem;    height:10rem;        margin:1rem .5rem;    flex: 0 0 auto;    transform-style: preserve-3d;    animation: grow 8s linear infinite; /* 动画 */}/*  延时动画 */ul.a li:nth-child(1),ul.a li:nth-child(1) i,ul.a li:nth-child(1):before,ul.a li:nth-child(1):after,ul.a li:nth-child(1) i:before,ul.a li:nth-child(1) i:after{    animation-delay: -.4s;}ul.a li:nth-child(2),ul.a li:nth-child(2):before,ul.a li:nth-child(2):after,ul.a li:nth-child(2) i:before,ul.a li:nth-child(2) i:after{    animation-delay: -.8s;}ul.a li:nth-child(3),ul.a li:nth-child(3):before,ul.a li:nth-child(3):after,ul.a li:nth-child(3) i:before,ul.a li:nth-child(3) i:after{    animation-delay: -1.2s;}ul.a li:nth-child(4),ul.a li:nth-child(4):before,ul.a li:nth-child(4):after,ul.a li:nth-child(4) i:before,ul.a li:nth-child(4) i:after{    animation-delay: -1.6s;}ul.a li:nth-child(5),ul.a li:nth-child(5):before,ul.a li:nth-child(5):after,ul.a li:nth-child(5) i:before,ul.a li:nth-child(5) i:after{    animation-delay: -2.0s;}ul.a li:nth-child(6),ul.a li:nth-child(6):before,ul.a li:nth-child(6):after,ul.a li:nth-child(6) i:before,ul.a li:nth-child(6) i:after{    animation-delay: -2.4s;}ul.a li:nth-child(7),ul.a li:nth-child(7):before,ul.a li:nth-child(7):after,ul.a li:nth-child(7) i:before,ul.a li:nth-child(7) i:after{    animation-delay: -2.8s;}ul.a li:nth-child(8),ul.a li:nth-child(8):before,ul.a li:nth-child(8):after,ul.a li:nth-child(8) i:before,ul.a li:nth-child(8) i:after{    animation-delay: -3.2s;}ul.a li:nth-child(9),ul.a li:nth-child(9):before,ul.a li:nth-child(9):after,ul.a li:nth-child(9) i:before,ul.a li:nth-child(9) i:after{    animation-delay: -3.6s;}ul.a li:nth-child(10),ul.a li:nth-child(10):before,ul.a li:nth-child(10):after,ul.a li:nth-child(10) i:before,ul.a li:nth-child(10) i:after{    animation-delay: -4.0s;}ul.a li:nth-child(11),ul.a li:nth-child(11):before,ul.a li:nth-child(11):after,ul.a li:nth-child(11) i:before,ul.a li:nth-child(11) i:after{    animation-delay: -4.4s;}ul.a li:nth-child(12),ul.a li:nth-child(12):before,ul.a li:nth-child(12):after,ul.a li:nth-child(12) i:before,ul.a li:nth-child(12) i:after{    animation-delay: -4.8s;}ul.a li:nth-child(13),ul.a li:nth-child(13):before,ul.a li:nth-child(13):after,ul.a li:nth-child(13) i:before,ul.a li:nth-child(13) i:after{    animation-delay: -5.2s;}ul.a li:nth-child(14),ul.a li:nth-child(14):before,ul.a li:nth-child(14):after,ul.a li:nth-child(14) i:before,ul.a li:nth-child(14) i:after{    animation-delay: -5.6s;}ul.a li:nth-child(15),ul.a li:nth-child(15):before,ul.a li:nth-child(15):after,ul.a li:nth-child(15) i:before,ul.a li:nth-child(15) i:after{    animation-delay: -6.0s;}ul.a li:nth-child(16),ul.a li:nth-child(16):before,ul.a li:nth-child(16):after,ul.a li:nth-child(16) i:before,ul.a li:nth-child(16) i:after{    animation-delay: -6.4s;}ul.a li:nth-child(17),ul.a li:nth-child(17):before,ul.a li:nth-child(17):after,ul.a li:nth-child(17) i:before,ul.a li:nth-child(17) i:after{    animation-delay: -6.8s;}ul.a li:nth-child(18),ul.a li:nth-child(18):before,ul.a li:nth-child(18):after,ul.a li:nth-child(18) i:before,ul.a li:nth-child(18) i:after{    animation-delay: -7.2s;}ul.a li:nth-child(19),ul.a li:nth-child(19):before,ul.a li:nth-child(19):after,ul.a li:nth-child(19) i:before,ul.a li:nth-child(19) i:after{    animation-delay: -7.6s;}ul.a li:nth-child(20),ul.a li:nth-child(20):before,ul.a li:nth-child(20):after,ul.a li:nth-child(20) i:before,ul.a li:nth-child(20) i:after{    animation-delay: -8.0s;}ul.a li:before,ul.a li:after,ul.a li i:before,ul.a li i:after{    content:'';    position:absolute;    display:block;}/* 圆点 */ul.a li:before,ul.a li:after{    left:0;    width:.8rem;    height:.8rem;    border-radius:50%;    background:#fff;    box-shadow: 0 0 0 2px #fff;    animation: shrink 8s linear infinite; /* 动画 */}ul.a li:before{    top:-1.5rem;}ul.a li:after{    bottom:-1.5rem;}/* 线条 */ul.a li i{    display:inline-flex;    justify-content: center;      align-items: center;    width:30%;    height:90%;    background:#fff;    z-index:-1;    transform:translate(100%,5%);}/* 方块 */ul.a li i:before,ul.a li i:after{    width:.6rem;    height:.6rem;    left:50%;    background:#fff;}ul.a li i:before{    top:0;    transform:translate(-50%,-50%);    animation: shrinkb 8s linear infinite; /* 动画 */}ul.a li i:after{    bottom:0;    transform:translate(-50%,50%);    animation: shrinka 8s linear infinite; /* 动画 */}@keyframes animate{    100%{        transform: rotateX(360deg) rotateY(360deg);        }}@keyframes grow{    100%{        transform: rotateX(360deg);    }}@keyframes shrink{    100%{        transform: rotateX(-360deg);    }}@keyframes shrinkb{    100%{        transform:translate(-50%,-50%) rotateX(-360deg);    }}@keyframes shrinka{    100%{        transform:translate(-50%,50%) rotateX(-360deg);    }}.helix{    background:#666;    width:100%;    height: 45vmin;    margin-bottom:3rem;}.helix ul{  position: absolute;  top: 50%;  left: 50%;  -webkit-transform: translateX(-50%) translateY(-50%);          transform: translateX(-50%) translateY(-50%);  height: 40vmin;  width: 40vmin;  border-radius: 50%;}@keyframes update-z-index {  0% {    z-index: 1;  }  49% {    z-index: 1;  }  50% {    z-index: -1;  }  100% {    z-index: -1;  }}@keyframes helix{    0% {    -webkit-transform: translateY(-50%) translateX(0) scale(1);            transform: translateY(-50%) translateX(0) scale(1);    -webkit-animation-timing-function: ease-in;            animation-timing-function: ease-in;  }  25% {    -webkit-transform: translateY(-50%) translateX(3.75vmin) scale(1.3);            transform: translateY(-50%) translateX(3.75vmin) scale(1.3);    -webkit-animation-timing-function: ease-out;            animation-timing-function: ease-out;  }  50% {    -webkit-transform: translateY(-50%) translateX(7.5vmin) scale(1);            transform: translateY(-50%) translateX(7.5vmin) scale(1);    -webkit-animation-timing-function: ease-in;            animation-timing-function: ease-in;  }  75% {    -webkit-transform: translateY(-50%) translateX(3.75vmin) scale(0.5);            transform: translateY(-50%) translateX(3.75vmin) scale(0.5);    -webkit-animation-timing-function: ease-out;            animation-timing-function: ease-out;  }  100% {    -webkit-transform: translateY(-50%) translateX(0) scale(1);            transform: translateY(-50%) translateX(0) scale(1);  }}.helix > ul li {  position: absolute;  left: 0;  top: calc(50% - 60vmin / 20);  height: 6vmin;  width: 50%;  -webkit-transform-origin: 100% 50%;  transform-origin: 100% 50%;  -webkit-backface-visibility: hidden;  backface-visibility: hidden;  -webkit-animation: update-z-index 2s linear infinite;  animation: update-z-index 2s linear infinite;  text-indent:-9999px;}/* 白圈 */.helix > ul li:nth-of-type(1) {  -webkit-transform: rotate(10deg);          transform: rotate(10deg);}.helix > ul li:nth-of-type(1)::after {  background: #fff;}.helix > ul li:nth-of-type(1),.helix > ul li:nth-of-type(1)::after {  -webkit-animation-delay: -0.33333333s;          animation-delay: -0.33333333s;}.helix > ul li:nth-of-type(2) {  -webkit-transform: rotate(20deg);          transform: rotate(20deg);}.helix > ul li:nth-of-type(2)::after {  background: #fff;}.helix > ul li:nth-of-type(2),.helix > ul li:nth-of-type(2)::after {  -webkit-animation-delay: -0.66666667s;          animation-delay: -0.66666667s;}.helix > ul li:nth-of-type(3) {  -webkit-transform: rotate(30deg);          transform: rotate(30deg);}.helix > ul li:nth-of-type(3)::after {  background: #fff;}.helix > ul li:nth-of-type(3),.helix > ul li:nth-of-type(3)::after {  -webkit-animation-delay: -1s;          animation-delay: -1s;}.helix > ul li:nth-of-type(4) {  -webkit-transform: rotate(40deg);          transform: rotate(40deg);}.helix > ul li:nth-of-type(4)::after {  background: #fff;}.helix > ul li:nth-of-type(4),.helix > ul li:nth-of-type(4)::after {  -webkit-animation-delay: -1.33333333s;          animation-delay: -1.33333333s;}.helix > ul li:nth-of-type(5) {  -webkit-transform: rotate(50deg);          transform: rotate(50deg);}.helix > ul li:nth-of-type(5)::after {  background: #fff;}.helix > ul li:nth-of-type(5),.helix > ul li:nth-of-type(5)::after {  -webkit-animation-delay: -1.66666667s;          animation-delay: -1.66666667s;}.helix > ul li:nth-of-type(6) {  -webkit-transform: rotate(60deg);          transform: rotate(60deg);}.helix > ul li:nth-of-type(6)::after {  background: #fff;}.helix > ul li:nth-of-type(6),.helix > ul li:nth-of-type(6)::after {  -webkit-animation-delay: -2s;          animation-delay: -2s;}.helix > ul li:nth-of-type(7) {  -webkit-transform: rotate(70deg);          transform: rotate(70deg);}.helix > ul li:nth-of-type(7)::after {  background: #fff;}.helix > ul li:nth-of-type(7),.helix > ul li:nth-of-type(7)::after {  -webkit-animation-delay: -2.33333333s;          animation-delay: -2.33333333s;}.helix > ul li:nth-of-type(8) {  -webkit-transform: rotate(80deg);          transform: rotate(80deg);}.helix > ul li:nth-of-type(8)::after {  background: #fff;}.helix > ul li:nth-of-type(8),.helix > ul li:nth-of-type(8)::after {  -webkit-animation-delay: -2.66666667s;          animation-delay: -2.66666667s;}.helix > ul li:nth-of-type(9) {  -webkit-transform: rotate(90deg);          transform: rotate(90deg);}.helix > ul li:nth-of-type(9)::after {  background: #fff;}.helix > ul li:nth-of-type(9),.helix > ul li:nth-of-type(9)::after {  -webkit-animation-delay: -3s;          animation-delay: -3s;}.helix > ul li:nth-of-type(10) {  -webkit-transform: rotate(100deg);          transform: rotate(100deg);}.helix > ul li:nth-of-type(10)::after {  background: #fff;}.helix > ul li:nth-of-type(10),.helix > ul li:nth-of-type(10)::after {  -webkit-animation-delay: -3.33333333s;          animation-delay: -3.33333333s;}.helix > ul li:nth-of-type(11) {  -webkit-transform: rotate(110deg);          transform: rotate(110deg);}.helix > ul li:nth-of-type(11)::after {  background: #fff;}.helix > ul li:nth-of-type(11),.helix > ul li:nth-of-type(11)::after {  -webkit-animation-delay: -3.66666667s;          animation-delay: -3.66666667s;}.helix > ul li:nth-of-type(12) {  -webkit-transform: rotate(120deg);          transform: rotate(120deg);}.helix > ul li:nth-of-type(12)::after {  background: #fff;}.helix > ul li:nth-of-type(12),.helix > ul li:nth-of-type(12)::after {  -webkit-animation-delay: -4s;          animation-delay: -4s;}.helix > ul li:nth-of-type(13) {  -webkit-transform: rotate(130deg);          transform: rotate(130deg);}.helix > ul li:nth-of-type(13)::after {  background: #fff;}.helix > ul li:nth-of-type(13),.helix > ul li:nth-of-type(13)::after {  -webkit-animation-delay: -4.33333333s;          animation-delay: -4.33333333s;}.helix > ul li:nth-of-type(14) {  -webkit-transform: rotate(140deg);          transform: rotate(140deg);}.helix > ul li:nth-of-type(14)::after {  background: #fff;}.helix > ul li:nth-of-type(14),.helix > ul li:nth-of-type(14)::after {  -webkit-animation-delay: -4.66666667s;          animation-delay: -4.66666667s;}.helix > ul li:nth-of-type(15) {  -webkit-transform: rotate(150deg);          transform: rotate(150deg);}.helix > ul li:nth-of-type(15)::after {  background: #fff;}.helix > ul li:nth-of-type(15),.helix > ul li:nth-of-type(15)::after {  -webkit-animation-delay: -5s;          animation-delay: -5s;}.helix > ul li:nth-of-type(16) {  -webkit-transform: rotate(160deg);          transform: rotate(160deg);}.helix > ul li:nth-of-type(16)::after {  background: #fff;}.helix > ul li:nth-of-type(16),.helix > ul li:nth-of-type(16)::after {  -webkit-animation-delay: -5.33333333s;          animation-delay: -5.33333333s;}.helix > ul li:nth-of-type(17) {  -webkit-transform: rotate(170deg);          transform: rotate(170deg);}.helix > ul li:nth-of-type(17)::after {  background: #fff;}.helix > ul li:nth-of-type(17),.helix > ul li:nth-of-type(17)::after {  -webkit-animation-delay: -5.66666667s;          animation-delay: -5.66666667s;}.helix > ul li:nth-of-type(18) {  -webkit-transform: rotate(180deg);          transform: rotate(180deg);}.helix > ul li:nth-of-type(18)::after {  background: #fff;}.helix > ul li:nth-of-type(18),.helix > ul li:nth-of-type(18)::after {  -webkit-animation-delay: -6s;          animation-delay: -6s;}.helix > ul li:nth-of-type(19) {  -webkit-transform: rotate(190deg);          transform: rotate(190deg);}.helix > ul li:nth-of-type(19)::after {  background: #fff;}.helix > ul li:nth-of-type(19),.helix > ul li:nth-of-type(19)::after {  -webkit-animation-delay: -6.33333333s;          animation-delay: -6.33333333s;}.helix > ul li:nth-of-type(20) {  -webkit-transform: rotate(200deg);          transform: rotate(200deg);}.helix > ul li:nth-of-type(20)::after {  background: #fff;}.helix > ul li:nth-of-type(20),.helix > ul li:nth-of-type(20)::after {  -webkit-animation-delay: -6.66666667s;          animation-delay: -6.66666667s;}.helix > ul li:nth-of-type(21) {  -webkit-transform: rotate(210deg);          transform: rotate(210deg);}.helix > ul li:nth-of-type(21)::after {  background: #fff;}.helix > ul li:nth-of-type(21),.helix > ul li:nth-of-type(21)::after {  -webkit-animation-delay: -7s;          animation-delay: -7s;}.helix > ul li:nth-of-type(22) {  -webkit-transform: rotate(220deg);          transform: rotate(220deg);}.helix > ul li:nth-of-type(22)::after {  background: #fff;}.helix > ul li:nth-of-type(22),.helix > ul li:nth-of-type(22)::after {  -webkit-animation-delay: -7.33333333s;          animation-delay: -7.33333333s;}.helix > ul li:nth-of-type(23) {  -webkit-transform: rotate(230deg);          transform: rotate(230deg);}.helix > ul li:nth-of-type(23)::after {  background: #fff;}.helix > ul li:nth-of-type(23),.helix > ul li:nth-of-type(23)::after {  -webkit-animation-delay: -7.66666667s;          animation-delay: -7.66666667s;}.helix > ul li:nth-of-type(24) {  -webkit-transform: rotate(240deg);          transform: rotate(240deg);}.helix > ul li:nth-of-type(24)::after {  background: #fff;}.helix > ul li:nth-of-type(24),.helix > ul li:nth-of-type(24)::after {  -webkit-animation-delay: -8s;          animation-delay: -8s;}.helix > ul li:nth-of-type(25) {  -webkit-transform: rotate(250deg);          transform: rotate(250deg);}.helix > ul li:nth-of-type(25)::after {  background: #fff;}.helix > ul li:nth-of-type(25),.helix > ul li:nth-of-type(25)::after {  -webkit-animation-delay: -8.33333333s;          animation-delay: -8.33333333s;}.helix > ul li:nth-of-type(26) {  -webkit-transform: rotate(260deg);          transform: rotate(260deg);}.helix > ul li:nth-of-type(26)::after {  background: #fff;}.helix > ul li:nth-of-type(26),.helix > ul li:nth-of-type(26)::after {  -webkit-animation-delay: -8.66666667s;          animation-delay: -8.66666667s;}.helix > ul li:nth-of-type(27) {  -webkit-transform: rotate(270deg);          transform: rotate(270deg);}.helix > ul li:nth-of-type(27)::after {  background: #fff;}.helix > ul li:nth-of-type(27),.helix > ul li:nth-of-type(27)::after {  -webkit-animation-delay: -9s;          animation-delay: -9s;}.helix > ul li:nth-of-type(28) {  -webkit-transform: rotate(280deg);          transform: rotate(280deg);}.helix > ul li:nth-of-type(28)::after {  background: #fff;}.helix > ul li:nth-of-type(28),.helix > ul li:nth-of-type(28)::after {  -webkit-animation-delay: -9.33333333s;          animation-delay: -9.33333333s;}.helix > ul li:nth-of-type(29) {  -webkit-transform: rotate(290deg);          transform: rotate(290deg);}.helix > ul li:nth-of-type(29)::after {  background: #fff;}.helix > ul li:nth-of-type(29),.helix > ul li:nth-of-type(29)::after {  -webkit-animation-delay: -9.66666667s;          animation-delay: -9.66666667s;}.helix > ul li:nth-of-type(30) {  -webkit-transform: rotate(300deg);          transform: rotate(300deg);}.helix > ul li:nth-of-type(30)::after {  background: #fff;}.helix > ul li:nth-of-type(30),.helix > ul li:nth-of-type(30)::after {  -webkit-animation-delay: -10s;          animation-delay: -10s;}.helix > ul li:nth-of-type(31) {  -webkit-transform: rotate(310deg);          transform: rotate(310deg);}.helix > ul li:nth-of-type(31)::after {  background: #fff;}.helix > ul li:nth-of-type(31),.helix > ul li:nth-of-type(31)::after {  -webkit-animation-delay: -10.33333333s;          animation-delay: -10.33333333s;}.helix > ul li:nth-of-type(32) {  -webkit-transform: rotate(320deg);          transform: rotate(320deg);}.helix > ul li:nth-of-type(32)::after {  background: #fff;}.helix > ul li:nth-of-type(32),.helix > ul li:nth-of-type(32)::after {  -webkit-animation-delay: -10.66666667s;          animation-delay: -10.66666667s;}.helix > ul li:nth-of-type(33) {  -webkit-transform: rotate(330deg);          transform: rotate(330deg);}.helix > ul li:nth-of-type(33)::after {  background: #fff;}.helix > ul li:nth-of-type(33),.helix > ul li:nth-of-type(33)::after {  -webkit-animation-delay: -11s;          animation-delay: -11s;}.helix > ul li:nth-of-type(34) {  -webkit-transform: rotate(340deg);          transform: rotate(340deg);}.helix > ul li:nth-of-type(34)::after {  background: #fff;}.helix > ul li:nth-of-type(34),.helix > ul li:nth-of-type(34)::after {  -webkit-animation-delay: -11.33333333s;          animation-delay: -11.33333333s;}.helix > ul li:nth-of-type(35) {  -webkit-transform: rotate(350deg);          transform: rotate(350deg);}.helix > ul li:nth-of-type(35)::after {  background: #fff;}.helix > ul li:nth-of-type(35),.helix > ul li:nth-of-type(35)::after {  -webkit-animation-delay: -11.66666667s;          animation-delay: -11.66666667s;}.helix > ul li:nth-of-type(36) {  -webkit-transform: rotate(360deg);          transform: rotate(360deg);}.helix > ul li:nth-of-type(36)::after {  background: #fff;}.helix > ul li:nth-of-type(36),.helix > ul li:nth-of-type(36)::after {  -webkit-animation-delay: -12s;          animation-delay: -12s;}/* 蓝圈 */.helix > ul li:nth-of-type(37) {  -webkit-transform: rotate(410deg);          transform: rotate(410deg);}.helix > ul li:nth-of-type(37)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(37),.helix > ul li:nth-of-type(37)::after {  -webkit-animation-delay: -12.33333333s;          animation-delay: -12.33333333s;}.helix > ul li:nth-of-type(38) {  -webkit-transform: rotate(420deg);          transform: rotate(420deg);}.helix > ul li:nth-of-type(38)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(38),.helix > ul li:nth-of-type(38)::after {  -webkit-animation-delay: -12.66666667s;          animation-delay: -12.66666667s;}.helix > ul li:nth-of-type(39) {  -webkit-transform: rotate(430deg);          transform: rotate(430deg);}.helix > ul li:nth-of-type(39)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(39),.helix > ul li:nth-of-type(39)::after {  -webkit-animation-delay: -13s;          animation-delay: -13s;}.helix > ul li:nth-of-type(40) {  -webkit-transform: rotate(440deg);          transform: rotate(440deg);}.helix > ul li:nth-of-type(40)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(40),.helix > ul li:nth-of-type(40)::after {  -webkit-animation-delay: -13.33333333s;          animation-delay: -13.33333333s;}.helix > ul li:nth-of-type(41) {  -webkit-transform: rotate(450deg);          transform: rotate(450deg);}.helix > ul li:nth-of-type(41)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(41),.helix > ul li:nth-of-type(41)::after {  -webkit-animation-delay: -13.66666667s;          animation-delay: -13.66666667s;}.helix > ul li:nth-of-type(42) {  -webkit-transform: rotate(460deg);          transform: rotate(460deg);}.helix > ul li:nth-of-type(42)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(42),.helix > ul li:nth-of-type(42)::after {  -webkit-animation-delay: -14s;          animation-delay: -14s;}.helix > ul li:nth-of-type(43) {  -webkit-transform: rotate(470deg);          transform: rotate(470deg);}.helix > ul li:nth-of-type(43)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(43),.helix > ul li:nth-of-type(43)::after {  -webkit-animation-delay: -14.33333333s;          animation-delay: -14.33333333s;}.helix > ul li:nth-of-type(44) {  -webkit-transform: rotate(480deg);          transform: rotate(480deg);}.helix > ul li:nth-of-type(44)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(44),.helix > ul li:nth-of-type(44)::after {  -webkit-animation-delay: -14.66666667s;          animation-delay: -14.66666667s;}.helix > ul li:nth-of-type(45) {  -webkit-transform: rotate(490deg);          transform: rotate(490deg);}.helix > ul li:nth-of-type(45)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(45),.helix > ul li:nth-of-type(45)::after {  -webkit-animation-delay: -15s;          animation-delay: -15s;}.helix > ul li:nth-of-type(46) {  -webkit-transform: rotate(500deg);          transform: rotate(500deg);}.helix > ul li:nth-of-type(46)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(46),.helix > ul li:nth-of-type(46)::after {  -webkit-animation-delay: -15.33333333s;          animation-delay: -15.33333333s;}.helix > ul li:nth-of-type(47) {  -webkit-transform: rotate(510deg);          transform: rotate(510deg);}.helix > ul li:nth-of-type(47)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(47),.helix > ul li:nth-of-type(47)::after {  -webkit-animation-delay: -15.66666667s;          animation-delay: -15.66666667s;}.helix > ul li:nth-of-type(48) {  -webkit-transform: rotate(520deg);          transform: rotate(520deg);}.helix > ul li:nth-of-type(48)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(48),.helix > ul li:nth-of-type(48)::after {  -webkit-animation-delay: -16s;          animation-delay: -16s;}.helix > ul li:nth-of-type(49) {  -webkit-transform: rotate(530deg);          transform: rotate(530deg);}.helix > ul li:nth-of-type(49)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(49),.helix > ul li:nth-of-type(49)::after {  -webkit-animation-delay: -16.33333333s;          animation-delay: -16.33333333s;}.helix > ul li:nth-of-type(50) {  -webkit-transform: rotate(540deg);          transform: rotate(540deg);}.helix > ul li:nth-of-type(50)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(50),.helix > ul li:nth-of-type(50)::after {  -webkit-animation-delay: -16.66666667s;          animation-delay: -16.66666667s;}.helix > ul li:nth-of-type(51) {  -webkit-transform: rotate(550deg);          transform: rotate(550deg);}.helix > ul li:nth-of-type(51)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(51),.helix > ul li:nth-of-type(51)::after {  -webkit-animation-delay: -17s;          animation-delay: -17s;}.helix > ul li:nth-of-type(52) {  -webkit-transform: rotate(560deg);          transform: rotate(560deg);}.helix > ul li:nth-of-type(52)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(52),.helix > ul li:nth-of-type(52)::after {  -webkit-animation-delay: -17.33333333s;          animation-delay: -17.33333333s;}.helix > ul li:nth-of-type(53) {  -webkit-transform: rotate(570deg);          transform: rotate(570deg);}.helix > ul li:nth-of-type(53)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(53),.helix > ul li:nth-of-type(53)::after {  -webkit-animation-delay: -17.66666667s;          animation-delay: -17.66666667s;}.helix > ul li:nth-of-type(54) {  -webkit-transform: rotate(580deg);          transform: rotate(580deg);}.helix > ul li:nth-of-type(54)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(54),.helix > ul li:nth-of-type(54)::after {  -webkit-animation-delay: -18s;          animation-delay: -18s;}.helix > ul li:nth-of-type(55) {  -webkit-transform: rotate(590deg);          transform: rotate(590deg);}.helix > ul li:nth-of-type(55)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(55),.helix > ul li:nth-of-type(55)::after {  -webkit-animation-delay: -18.33333333s;          animation-delay: -18.33333333s;}.helix > ul li:nth-of-type(56) {  -webkit-transform: rotate(600deg);          transform: rotate(600deg);}.helix > ul li:nth-of-type(56)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(56),.helix > ul li:nth-of-type(56)::after {  -webkit-animation-delay: -18.66666667s;          animation-delay: -18.66666667s;}.helix > ul li:nth-of-type(57) {  -webkit-transform: rotate(610deg);          transform: rotate(610deg);}.helix > ul li:nth-of-type(57)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(57),.helix > ul li:nth-of-type(57)::after {  -webkit-animation-delay: -19s;          animation-delay: -19s;}.helix > ul li:nth-of-type(58) {  -webkit-transform: rotate(620deg);          transform: rotate(620deg);}.helix > ul li:nth-of-type(58)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(58),.helix > ul li:nth-of-type(58)::after {  -webkit-animation-delay: -19.33333333s;          animation-delay: -19.33333333s;}.helix > ul li:nth-of-type(59) {  -webkit-transform: rotate(630deg);          transform: rotate(630deg);}.helix > ul li:nth-of-type(59)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(59),.helix > ul li:nth-of-type(59)::after {  -webkit-animation-delay: -19.66666667s;          animation-delay: -19.66666667s;}.helix > ul li:nth-of-type(60) {  -webkit-transform: rotate(640deg);          transform: rotate(640deg);}.helix > ul li:nth-of-type(60)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(60),.helix > ul li:nth-of-type(60)::after {  -webkit-animation-delay: -20s;          animation-delay: -20s;}.helix > ul li:nth-of-type(61) {  -webkit-transform: rotate(650deg);          transform: rotate(650deg);}.helix > ul li:nth-of-type(61)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(61),.helix > ul li:nth-of-type(61)::after {  -webkit-animation-delay: -20.33333333s;          animation-delay: -20.33333333s;}.helix > ul li:nth-of-type(62) {  -webkit-transform: rotate(660deg);          transform: rotate(660deg);}.helix > ul li:nth-of-type(62)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(62),.helix > ul li:nth-of-type(62)::after {  -webkit-animation-delay: -20.66666667s;          animation-delay: -20.66666667s;}.helix > ul li:nth-of-type(63) {  -webkit-transform: rotate(670deg);          transform: rotate(670deg);}.helix > ul li:nth-of-type(63)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(63),.helix > ul li:nth-of-type(63)::after {  -webkit-animation-delay: -21s;          animation-delay: -21s;}.helix > ul li:nth-of-type(64) {  -webkit-transform: rotate(680deg);          transform: rotate(680deg);}.helix > ul li:nth-of-type(64)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(64),.helix > ul li:nth-of-type(64)::after {  -webkit-animation-delay: -21.33333333s;          animation-delay: -21.33333333s;}.helix > ul li:nth-of-type(65) {  -webkit-transform: rotate(690deg);          transform: rotate(690deg);}.helix > ul li:nth-of-type(65)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(65),.helix > ul li:nth-of-type(65)::after {  -webkit-animation-delay: -21.66666667s;          animation-delay: -21.66666667s;}.helix > ul li:nth-of-type(66) {  -webkit-transform: rotate(700deg);          transform: rotate(700deg);}.helix > ul li:nth-of-type(66)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(66),.helix > ul li:nth-of-type(66)::after {  -webkit-animation-delay: -22s;          animation-delay: -22s;}.helix > ul li:nth-of-type(67) {  -webkit-transform: rotate(710deg);          transform: rotate(710deg);}.helix > ul li:nth-of-type(67)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(67),.helix > ul li:nth-of-type(67)::after {  -webkit-animation-delay: -22.33333333s;          animation-delay: -22.33333333s;}.helix > ul li:nth-of-type(68) {  -webkit-transform: rotate(720deg);          transform: rotate(720deg);}.helix > ul li:nth-of-type(68)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(68),.helix > ul li:nth-of-type(68)::after {  -webkit-animation-delay: -22.66666667s;          animation-delay: -22.66666667s;}.helix > ul li:nth-of-type(69) {  -webkit-transform: rotate(730deg);          transform: rotate(730deg);}.helix > ul li:nth-of-type(69)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(69),.helix > ul li:nth-of-type(69)::after {  -webkit-animation-delay: -23s;          animation-delay: -23s;}.helix > ul li:nth-of-type(70) {  -webkit-transform: rotate(740deg);          transform: rotate(740deg);}.helix > ul li:nth-of-type(70)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(70),.helix > ul li:nth-of-type(70)::after {  -webkit-animation-delay: -23.33333333s;          animation-delay: -23.33333333s;}.helix > ul li:nth-of-type(71) {  -webkit-transform: rotate(750deg);          transform: rotate(750deg);}.helix > ul li:nth-of-type(71)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(71),.helix > ul li:nth-of-type(71)::after {  -webkit-animation-delay: -23.66666667s;          animation-delay: -23.66666667s;}.helix > ul li:nth-of-type(72) {  -webkit-transform: rotate(760deg);          transform: rotate(760deg);}.helix > ul li:nth-of-type(72)::after {  background: #66c7f4;}.helix > ul li:nth-of-type(72),.helix > ul li:nth-of-type(72)::after {  -webkit-animation-delay: -24s;          animation-delay: -24s;}.helix > ul li::after {  content: '';  display: block;  height: 2vmin;  width: 2vmin;  position: absolute;  top: 50%;  left: 0;  -webkit-transform: translateY(-50%);  transform: translateY(-50%);  border-radius: 50%;  -webkit-animation: helix 2s linear infinite;  animation: helix 2s linear infinite;}</style><h4 id="DNA"><a href="#DNA" class="headerlink" title="DNA"></a>DNA</h4><div class="animiateWrap">    <ul class="a">        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>        <li><i></i></li>    </ul></div><h4 id="双螺旋"><a href="#双螺旋" class="headerlink" title="双螺旋"></a>双螺旋</h4><div class="helix">    <ul class="b">        <li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li>        <li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li>        <li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li>        <li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li>        <li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li>        <li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li>        <li>37</li><li>38</li><li>39</li><li>40</li><li>41</li><li>42</li>        <li>43</li><li>44</li><li>45</li><li>46</li><li>47</li><li>48</li>        <li>49</li><li>50</li><li>51</li><li>52</li><li>53</li><li>54</li>        <li>55</li><li>56</li><li>57</li><li>58</li><li>59</li><li>60</li>        <li>61</li><li>62</li><li>63</li><li>64</li><li>65</li><li>66</li>        <li>67</li><li>68</li><li>69</li><li>70</li><li>71</li><li>72</li>    </ul></div><h4 id="实现分解"><a href="#实现分解" class="headerlink" title="实现分解"></a>实现分解</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;helix&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;b&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>7<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>8<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>9<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>10<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>13<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>14<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>15<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>16<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>17<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>18<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>19<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>20<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>21<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>23<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>24<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>25<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>26<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>27<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>28<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>29<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>31<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>32<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>33<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>34<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>35<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>36<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>37<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>38<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>39<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>40<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>41<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>42<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>43<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>44<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>45<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>46<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>47<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>48<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>49<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>50<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>51<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>52<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>53<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>54<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>55<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>56<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>57<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>58<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>59<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>60<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>61<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>62<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>63<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>64<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>65<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>66<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>67<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>68<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>69<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>70<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>71<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>72<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="主要布局样式"><a href="#主要布局样式" class="headerlink" title="主要布局样式"></a>主要布局样式</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 光点主体 */</span></span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2vmin</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2vmin</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="attribute">-webkit-animation</span>: helix <span class="number">2s</span> linear infinite;</span><br><span class="line">  <span class="attribute">animation</span>: helix <span class="number">2s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1-36 旋转间隔 10deg 背景色 #fff 动画延迟 0.3s */</span></span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(1)</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(<span class="number">10deg</span>);</span><br><span class="line">          <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">10deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(1)</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(1)</span>,</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(1)</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">0.33333333s</span>;</span><br><span class="line">          <span class="attribute">animation-delay</span>: -<span class="number">0.33333333s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 37-72 旋转间隔 10deg 背景色 #66c7f4 动画延迟 0.3s */</span></span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(37)</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(<span class="number">410deg</span>);</span><br><span class="line">          <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">410deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(37)</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#66c7f4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(37)</span>,</span><br><span class="line"><span class="selector-class">.helix</span> &gt; <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-of-type(37)</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-animation-delay</span>: -<span class="number">12.33333333s</span>;</span><br><span class="line">          <span class="attribute">animation-delay</span>: -<span class="number">12.33333333s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>注意事项<blockquote><p>1-36 旋转间隔 10deg, 第36个 li 旋转角度是 360deg, 第37个 li 旋转角度应该是 370deg,<br>为什么现在样式布局，第37个 li 旋转角度是 410deg ？</p><p>答案：错位，偏移量</p></blockquote></li></ul><h4 id="主要动画样式"><a href="#主要动画样式" class="headerlink" title="主要动画样式"></a>主要动画样式</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*白色、蓝色光点交替时的遮罩问题*/</span></span><br><span class="line"><span class="keyword">@keyframes</span> update-z-index &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  49% &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  50% &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*螺旋动画*/</span></span><br><span class="line"><span class="keyword">@keyframes</span> helix&#123;</span><br><span class="line">0% &#123;</span><br><span class="line"><span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line"><span class="attribute">-webkit-animation-timing-function</span>: ease-in;</span><br><span class="line">        <span class="attribute">animation-timing-function</span>: ease-in;</span><br><span class="line">  &#125;</span><br><span class="line">  25% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">3.75vmin</span>) <span class="built_in">scale</span>(<span class="number">1.3</span>);</span><br><span class="line">            <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">3.75vmin</span>) <span class="built_in">scale</span>(<span class="number">1.3</span>);</span><br><span class="line">    <span class="attribute">-webkit-animation-timing-function</span>: ease-out;</span><br><span class="line">            <span class="attribute">animation-timing-function</span>: ease-out;</span><br><span class="line">  &#125;</span><br><span class="line">  50% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">7.5vmin</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">7.5vmin</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="attribute">-webkit-animation-timing-function</span>: ease-in;</span><br><span class="line">            <span class="attribute">animation-timing-function</span>: ease-in;</span><br><span class="line">  &#125;</span><br><span class="line">  75% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">3.75vmin</span>) <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">            <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">3.75vmin</span>) <span class="built_in">scale</span>(<span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">-webkit-animation-timing-function</span>: ease-out;</span><br><span class="line">            <span class="attribute">animation-timing-function</span>: ease-out;</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>) <span class="built_in">translateX</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><style>    .helix ul.d{        transform:translate(-50%, -50%) rotateZ(30deg);        top:50%;        left:50%;    }    .helix ul.d li:after{        background:#66c7f4;    }}</style><div class="helix">    <ul class="c">        <li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li>        <li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li>        <li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li>        <li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li>        <li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li>        <li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li>    </ul>    <ul class="d">        <li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li>        <li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li>        <li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li>        <li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li>        <li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li>        <li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li>    </ul></div><h4 id="对比布局"><a href="#对比布局" class="headerlink" title="对比布局"></a>对比布局</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;helix&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;c&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>7<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>8<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>9<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>10<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>13<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>14<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>15<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>16<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>17<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>18<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>19<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>20<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>21<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>23<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>24<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>25<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>26<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>27<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>28<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>29<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>31<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>32<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>33<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>34<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>35<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>36<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;d&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>7<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>8<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>9<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>10<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>13<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>14<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>15<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>16<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>17<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>18<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>19<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>20<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>21<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>23<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>24<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>25<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>26<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>27<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>28<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>29<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>31<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>32<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>33<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>34<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>35<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span>36<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="优缺点分析"><a href="#优缺点分析" class="headerlink" title="优缺点分析"></a>优缺点分析</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.helix</span> <span class="selector-tag">ul</span><span class="selector-class">.d</span>&#123;</span><br><span class="line"><span class="attribute">transform</span>:<span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>) <span class="built_in">rotateZ</span>(<span class="number">30deg</span>);</span><br><span class="line"></span><br><span class="line"><span class="attribute">top</span>:<span class="number">50%</span>;</span><br><span class="line"><span class="attribute">left</span>:<span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.helix</span> <span class="selector-tag">ul</span><span class="selector-class">.d</span> <span class="selector-tag">li</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line"><span class="attribute">background</span>:<span class="number">#66c7f4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>对比布局，上面这一段样式，可以减少第37-72个 li 的旋转，颜色，延迟样式，减少几百行样式代码。</li><li>错位，偏移量通过调整 transform:translate(-50%, -50%) rotateZ(<span style="color:red;">30deg</span>) 即可实现。无需修改第37-72个 li 的旋转角度。</li></ul><blockquote><p>但是也发现了一个问题：光点交替时候的遮罩问题</p></blockquote><h4 id="关于CSS3-动画"><a href="#关于CSS3-动画" class="headerlink" title="关于CSS3 动画"></a>关于CSS3 动画</h4><style>    .animationVal table{        border-collapse:collapse;        margin-bottom:2rem;        width:100%;    }    .animationVal table,.animationVal table th,.animationVal table td{        border:1px solid #cdcdcd;    }    .animationVal table tr:first-child th:first-child{ width:150px;}    .animationVal table th,.animationVal table td{ padding:.25rem .8rem;}</style><div class="animationVal"><table><thead><tr><th align="right">值</th><th>描述</th></tr></thead><tbody><tr><td align="right">animation:</td><td>name duration timing-function delay iteration-count direction;</td></tr><tr><td align="right">name</td><td>选择器的 keyframe 名称</td></tr><tr><td align="right">duration</td><td>完成动画所花费的时间，以秒或毫秒计</td></tr><tr><td align="right">timing-function</td><td>动画的速度曲线</td></tr><tr><td align="right">delay</td><td>动画开始之前的延迟</td></tr><tr><td align="right">iteration-count</td><td>动画应该播放的次数</td></tr><tr><td align="right">direction</td><td>是否应该轮流反向播放动画</td></tr></tbody></table><table><thead><tr><th align="right">值</th><th>描述</th></tr></thead><tbody><tr><td align="right">transform:</td><td>none transform-functions</td></tr><tr><td align="right">matrix(n,n,n,n,n,n)</td><td>定义 2D 转换，使用六个值的矩阵</td></tr><tr><td align="right">translate(x,y)</td><td>2D 位移</td></tr><tr><td align="right">translate(x,y,z)</td><td>3D 位移</td></tr><tr><td align="right">scale(x,y)</td><td>2D 缩放</td></tr><tr><td align="right">scale(x,y,z)</td><td>3D 缩放</td></tr><tr><td align="right">rotate(x,y)</td><td>2D 旋转</td></tr><tr><td align="right">rotate(x,y,z)</td><td>3D 旋转</td></tr><tr><td align="right">transform-origin</td><td>改变被转换元素的位置</td></tr><tr><td align="right">transform-style</td><td>被嵌套元素如何在 3D 空间中显示</td></tr><tr><td align="right">perspective</td><td>为 3D 转换元素定义透视视图</td></tr><tr><td align="right">perspective-origin</td><td>规定 3D 元素的底部位置</td></tr><tr><td align="right">backface-visibility</td><td>元素在不面对屏幕时是否可见</td></tr></tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> CSS3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Css3 动画</title>
      <link href="2019/07/10/Css/Css3%20%E5%8A%A8%E7%94%BB/"/>
      <url>2019/07/10/Css/Css3%20%E5%8A%A8%E7%94%BB/</url>
      
        <content type="html"><![CDATA[<h4 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h4><style>.animateWrap{    background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);    height:30rem;    font-family: 'Anton', sans-serif;    position: relative;    overflow: hidden;    -webkit-perspective: 1500px;    perspective: 1500px;     justify-content: center;    align-items: center;}.photos{    width:180px;    height:100px;    position:absolute;    top: calc(50% - 50px);    left: calc(50% - 90px);    transform-style: preserve-3d;    transform:rotateX(-20deg);    animation:photo 12s linear infinite;    z-index:9999;}.photos:hover{    animation:photo 12s linear infinite paused;}/* 照片 */.photos img{    position:absolute;    transition: all 1s;    border:1px solid #fff;    cursor:pointer;}.photos img{    width:180px;    height:100px;}.photos img:nth-child(1){    transform: rotateY(60deg) translateZ(160px) scale(.8);    z-index:9999;}.photos img:nth-child(2){    transform: rotateY(120deg) translateZ(160px) scale(.8);}.photos img:nth-child(3){    transform: rotateY(180deg) translateZ(160px) scale(.8);}.photos img:nth-child(4){    transform: rotateY(240deg) translateZ(160px) scale(.8);}.photos img:nth-child(5){    transform: rotateY(300deg) translateZ(160px) scale(.8);}.photos img:nth-child(6){    transform: rotateY(360deg) translateZ(160px) scale(.8);}/* 照片动画 */@keyframes photo{    0%{        transform: rotateX(-20deg) rotateY(0deg);    }    100%{        transform: rotateX(-20deg) rotateY(360deg);    }}/* 流星 */.stars {  position: relative;  width: 100%;  height: 100%;  -webkit-transform: rotateZ(45deg);          transform: rotateZ(45deg);  -webkit-animation: sky 200s linear infinite;          animation: sky 200s linear infinite;}.stars i {  position: absolute;  left: 50%;  top: 50%;  width:30px;  height: 2px;  background: linear-gradient(-45deg, #5f91ff, rgba(0, 0, 255, 0));  border-radius: 100%;  -webkit-filter: drop-shadow(0 0 6px #699bff);          filter: drop-shadow(0 0 6px #699bff);  -webkit-animation: tail 3000ms ease-in-out infinite, shooting 3000ms ease-in-out infinite;          animation: tail 3000ms ease-in-out infinite, shooting 3000ms ease-in-out infinite;}/* 闪烁星星 */.stars i::before, .stars i::after {  content: '';  position: absolute;  top: calc(50% - 1px);  right: 0;  height: 2px;  background: linear-gradient(-45deg, rgba(0, 0, 255, 0), #5f91ff, rgba(0, 0, 255, 0));  -webkit-transform: translateX(50%) rotateZ(45deg);          transform: translateX(50%) rotateZ(45deg);  border-radius: 100%;  -webkit-animation: shining 3000ms ease-in-out infinite;          animation: shining 3000ms ease-in-out infinite;}.stars i::after {  -webkit-transform: translateX(50%) rotateZ(-45deg);          transform: translateX(50%) rotateZ(-45deg);}.stars i:nth-child(1) {  top: calc(50% - 185px);  left: calc(50% - 150px);  -webkit-animation-delay: 8971ms;          animation-delay: 8971ms;}.stars i:nth-child(1)::before, .stars i:nth-child(1)::after {  -webkit-animation-delay: 8971ms;          animation-delay: 8971ms;}.stars i:nth-child(2) {  top: calc(50% - 50px);  left: calc(50% - -190px);  -webkit-animation-delay: 9256ms;          animation-delay: 9256ms;}.stars i:nth-child(2)::before, .stars i:nth-child(2)::after {  -webkit-animation-delay: 9256ms;          animation-delay: 9256ms;}.stars i:nth-child(3) {  top: calc(50% - -146px);  left: calc(50% - 135px);  -webkit-animation-delay: 8700ms;          animation-delay: 8700ms;}.stars i:nth-child(3)::before, .stars i:nth-child(3)::after {  -webkit-animation-delay: 8700ms;          animation-delay: 8700ms;}.stars i:nth-child(4) {  top: calc(50% - -77px);  left: calc(50% - 157px);  -webkit-animation-delay: 3147ms;          animation-delay: 3147ms;}.stars i:nth-child(4)::before, .stars i:nth-child(4)::after {  -webkit-animation-delay: 3147ms;          animation-delay: 3147ms;}.stars i:nth-child(5) {  top: calc(50% - -183px);  left: calc(50% - 8px);  -webkit-animation-delay: 6588ms;          animation-delay: 6588ms;}.stars i:nth-child(5)::before, .stars i:nth-child(5)::after {  -webkit-animation-delay: 6588ms;          animation-delay: 6588ms;}.stars i:nth-child(6) {  top: calc(50% - -129px);  left: calc(50% - 95px);  -webkit-animation-delay: 8009ms;          animation-delay: 8009ms;}.stars i:nth-child(6)::before, .stars i:nth-child(6)::after {  -webkit-animation-delay: 8009ms;          animation-delay: 8009ms;}.stars i:nth-child(7) {  top: calc(50% - 195px);  left: calc(50% - 69px);  -webkit-animation-delay: 5420ms;          animation-delay: 5420ms;}.stars i:nth-child(7)::before, .stars i:nth-child(7)::after {  -webkit-animation-delay: 5420ms;          animation-delay: 5420ms;}.stars i:nth-child(8) {  top: calc(50% - -159px);  left: calc(50% - 170px);  -webkit-animation-delay: 9378ms;          animation-delay: 9378ms;}.stars i:nth-child(8)::before, .stars i:nth-child(8)::after {  -webkit-animation-delay: 9378ms;          animation-delay: 9378ms;}@keyframes tail {  0% {    width: 0;  }  30% {    width: 100px;  }  100% {    width: 0;  }}@keyframes shooting {  0% {    -webkit-transform: translateX(0);            transform: translateX(0);  }  100% {    -webkit-transform: translateX(300px);            transform: translateX(300px);  }}@keyframes shining {  0% {    width: 0;  }  50% {    width: 30px;  }  100% {    width: 0;  }}@keyframes sky {  0% {    -webkit-transform: rotate(45deg);            transform: rotate(45deg);  }  100% {    -webkit-transform: rotate(405deg);            transform: rotate(405deg);  }}</style><div class="animateWrap">    <!-- 流星 -->    <div class="stars">        <i></i> <i></i> <i></i> <i></i> <i></i> <i></i> <i></i> <i></i>    </div>    <!-- 影集 -->    <div class="photos">        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6e8aa06f.jpg"/>        <img src="http://www.yucai.net.cn/zhantiehua/UploadFiles_5386/201505/2015050521443897.jpg"/>        <img src="http://i9.download.fd.pchome.net/t_720x360/g1/M00/11/1C/ooYBAFYvFOyIMbBqAAQe6isTNRkAACv8gGj3DIABB8C140.jpg"/>        <img src="http://www.99danji.com/upload/20133/2013032955174093.jpg"/>        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6ee38cb5.jpg"/>        <img src="http://photocdn.sohu.com/20111123/Img326646156.jpg"/>    </div></div><h4 id="正方形"><a href="#正方形" class="headerlink" title="正方形"></a>正方形</h4><style>.squareWrap{    height:10rem;    padding:0 2rem;}.square{    position:relative;    top:0;    left:5%;    width:80px;    height:80px;    transform-style: preserve-3d;    animation: move 12s linear infinite;}.squareT{    position:relative;    top:-75px;    left:30%;}.square img{    position:absolute;    left:0%;    top:10%;    width:80px;    height:80px;    background:#fff;}.square img:nth-child(1){    transform: translateX(-20px) rotateY(90deg);    background:red;}.square img:nth-child(2){    transform: translateZ(20px);    background:green;}.square img:nth-child(3){    transform: translateX(20px) rotateY(90deg);    background:red;}.square img:nth-child(4){    transform: translateZ(-20px);    background:green;}.square img:nth-child(5){    transform: translateY(-20px) rotateX(90deg);    background:blue;}.square img:nth-child(6){    transform: translateY(20px) rotateX(90deg);    background:blue;}@keyframes move{    0%{ transform: rotateX(40deg) rotateY(40deg)}    100%{ transform: rotateX(405deg) rotateY(405deg)}}.squareT img:nth-child(1){    transform: translateX(-40px) rotateY(90deg);}.squareT img:nth-child(2){    transform: translateZ(40px);}.squareT img:nth-child(3){    transform: translateX(40px) rotateY(90deg);}.squareT img:nth-child(4){    transform: translateZ(-40px);}.squareT img:nth-child(5){    transform: translateY(-40px) rotateX(90deg);}.squareT img:nth-child(6){    transform: translateY(40px) rotateX(90deg);}.squareT:hover{    animation: move 12s linear infinite paused;    cursor:pointer;}.squareT:hover img:nth-child(1){    transform: translateX(-60px) rotateY(90deg);}.squareT:hover img:nth-child(2){    transform: translateZ(60px);}.squareT:hover img:nth-child(3){    transform: translateX(60px) rotateY(90deg);}.squareT:hover img:nth-child(4){    transform: translateZ(-60px);}.squareT:hover img:nth-child(5){    transform: translateY(-60px) rotateX(90deg);}.squareT:hover img:nth-child(6){    transform: translateY(60px) rotateX(90deg);}</style><!-- 正方形 --><div class="squareWrap">    <div class="square">        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6e8aa06f.jpg"/>        <img src="http://www.yucai.net.cn/zhantiehua/UploadFiles_5386/201505/2015050521443897.jpg"/>        <img src="http://i9.download.fd.pchome.net/t_720x360/g1/M00/11/1C/ooYBAFYvFOyIMbBqAAQe6isTNRkAACv8gGj3DIABB8C140.jpg"/>        <img src="http://www.99danji.com/upload/20133/2013032955174093.jpg"/>        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6ee38cb5.jpg"/>        <img src="http://photocdn.sohu.com/20111123/Img326646156.jpg"/>    </div>    <div class="square squareT">        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6e8aa06f.jpg"/>        <img src="http://www.yucai.net.cn/zhantiehua/UploadFiles_5386/201505/2015050521443897.jpg"/>        <img src="http://i9.download.fd.pchome.net/t_720x360/g1/M00/11/1C/ooYBAFYvFOyIMbBqAAQe6isTNRkAACv8gGj3DIABB8C140.jpg"/>        <img src="http://www.99danji.com/upload/20133/2013032955174093.jpg"/>        <img src="http://pic1.win4000.com/wallpaper/a/57c3d6ee38cb5.jpg"/>        <img src="http://photocdn.sohu.com/20111123/Img326646156.jpg"/>    </div></div>]]></content>
      
      
      <categories>
          
          <category> CSS3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Css3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flex 弹性布局</title>
      <link href="2019/07/09/Css/Flex%20%E5%BC%B9%E6%80%A7%E5%B8%83%E5%B1%80/"/>
      <url>2019/07/09/Css/Flex%20%E5%BC%B9%E6%80%A7%E5%B8%83%E5%B1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="布局格式"><a href="#布局格式" class="headerlink" title="布局格式"></a>布局格式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">//<span class="selector-tag">Webkit</span> 内核的浏览器，必须加上<span class="selector-tag">-webkit</span>前缀。</span><br><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-flex;  <span class="comment">/* Safari */</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">15rem</span>;</span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> dashed <span class="number">#c60</span>;</span><br><span class="line">  <span class="attribute">overflow</span>:auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;  <span class="comment">/*行内弹性布局*/</span></span><br><span class="line">  <span class="attribute">width</span>:<span class="number">8rem</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">5rem</span>;</span><br><span class="line">  <span class="attribute">margin</span>:.<span class="number">8rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>:.<span class="number">8rem</span>;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background</span>:<span class="number">#c60</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#c60</span>;</span><br><span class="line">  <span class="attribute">background-clip</span>:content-box;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*行内弹性布局，text-align 无效*/</span></span><br><span class="line">  <span class="attribute">text-align</span>:right;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*行内弹性布局，对齐方式*/</span></span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child(3)</span>&#123; <span class="attribute">height</span>:<span class="number">8rem</span>;&#125;</span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child(7)</span>&#123; <span class="attribute">height</span>:<span class="number">3rem</span>;&#125;</span><br><span class="line"><span class="selector-class">.event</span>,<span class="selector-class">.clearStyles</span>&#123;</span><br><span class="line">  <span class="attribute">cursor</span>:pointer;</span><br><span class="line">  <span class="attribute">border-bottom</span>:<span class="number">1px</span> dashed <span class="number">#cdcdcd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.event</span><span class="selector-pseudo">:hover</span>,<span class="selector-class">.currStyle</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#0092db</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearStyles</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#c60</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><ul><li>设为 Flex 布局以后，子元素的float、clear和vertical-align属性将失效。</li></ul><h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><style>.box{  display: -webkit-flex; /* Safari */  display: flex;  height:15rem;  border:1px dashed #c60;  overflow:auto;}.item{  display: inline-flex;  width:8rem;  height:5rem;  margin:.8rem;  padding:.8rem;  color:#fff;  background:#c60;  box-sizing: border-box;  border: 1px solid #c60;  background-clip:content-box;  /*行内弹性布局，text-align 无效*/  text-align:right;  /*行内弹性布局，对齐方式*/  justify-content: center;  align-items: center;}.item:nth-child(3){ height:8rem;}.item:nth-child(7){ height:3rem;}.event,.clearStyles{  cursor:pointer;  border-bottom:1px dashed #cdcdcd;}.event:hover,.currStyle{  color:#0092db}.clearStyles{  color:#c60}</style><div class="box">    <div class="item">1</div>    <div class="item">2</div>    <div class="item">3</div>    <div class="item">4</div>    <div class="item">5</div>    <div class="item">6</div>    <div class="item">7</div>    <div class="item">8</div>    <div class="item">9</div></div><h4 id="box-容器属性"><a href="#box-容器属性" class="headerlink" title="box 容器属性"></a>box 容器属性</h4><blockquote><p>点击属性值，查看效果  <span class="clearStyles">[清空样式]</span></p></blockquote><div class="eventWrap"><ul><li><p>flex-direction：<br><span class="event">row</span> | <span class="event">row-reverse</span> | <span class="event">column</span> | <span class="event">column-reverse</span>;</p></li><li><p>flex-wrap：<br><span class="event">nowrap</span> | <span class="event">wrap</span> | <span class="event">wrap-reverse</span></p></li><li><p>flex-flow： [&lt;flex-direction&gt; || &lt;flex-wrap&gt;]<br>（默认值：row nowrap）</p></li><li><p>justify-content：<br><span class="event">flex-start</span> | <span class="event">flex-end</span> | <span class="event">center</span> | <span class="event">space-between</span> | <span class="event">space-around</span>;</p></li><li><p>align-items：<br><span class="event">flex-start</span> | <span class="event">flex-end</span> | <span class="event">center</span> | <span class="event">baseline</span> | <span class="event">stretch</span>;</p></li><li><p>align-content：<br><span class="event">flex-start</span> | <span class="event">flex-end</span> | <span class="event">center</span> | <span class="event">space-between</span> | <span class="event">space-around</span> | <span class="event">stretch</span>;</p></li></ul></div><h4 id="item-项目属性"><a href="#item-项目属性" class="headerlink" title="item 项目属性"></a>item 项目属性</h4><ul><li>order ： 定义项目的排列顺序。数值越小，排列越靠前，默认为0。</li><li>flex-grow ： 定义项目的放大比例，默认为0，即如果存在剩余空间，也不放大。</li><li>flex-shrink ： 定义了项目的缩小比例，默认为1，即如果空间不足，该项目将缩小。</li><li>flex-basis</li><li>flex ： none | [ &lt;flex-grow&gt; &lt;flex-shrink&gt; || &lt;flex-basis&gt; ]</li></ul><blockquote><p>快捷设置 : auto (1 1 auto) 和 none (0 0 auto)</p></blockquote><ul><li>align-self : 允许单个项目有与其他项目不一样的对齐方式</li></ul><script>    var d = document,        box = d.getElementsByClassName('box');    d.getElementsByClassName('eventWrap')[0].addEventListener("click",function(e){        if(e.target.className.indexOf('event')!= -1){            var currStyle = e.target.parentNode.textContent.split('：')[0];            var currVal = e.target.textContent;            console.log(currStyle + ":" + currVal);            e.target.parentNode.getElementsByClassName('currStyle')[0] && (e.target.parentNode.getElementsByClassName('currStyle')[0].className = 'event');            e.target.className += ' currStyle';            box[0].style[formatStyleKey(currStyle)] = currVal;        }    })    d.getElementsByClassName('clearStyles')[0].addEventListener("click",function(e){        var styles = d.getElementsByClassName('eventWrap')[0].getElementsByClassName('currStyle');        for(var i=styles.length-1; i>=0; i--){            styles[i].className = 'event';        }        box[0].removeAttribute('style');    })    function formatStyleKey(str){        var final = "",            strArr = str.toLowerCase().split('-');        for(var i=0; i<strArr.length; i++){            !i ? final+=strArr[i]:final+=strArr[i].slice(0, 1).toUpperCase() + strArr[i].slice(1);        }        return final;    }</script>]]></content>
      
      
      <categories>
          
          <category> HTML5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grid 网格布局</title>
      <link href="2019/07/09/Css/Grid%20%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80/"/>
      <url>2019/07/09/Css/Grid%20%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80/</url>
      
        <content type="html"><![CDATA[<h4 id="Grid-Container-属性"><a href="#Grid-Container-属性" class="headerlink" title="Grid Container 属性"></a>Grid Container 属性</h4><ul><li>display</li><li>grid-template-columns</li><li>grid-template-rows</li><li>grid-template-areas</li><li>grid-template： &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt;</li><li>grid-column-gap</li><li>grid-row-gap</li><li>grid-gap</li><li>justify-items： start | end | center | stretch;</li><li>align-items： start | end | center | stretch;</li><li>place-items： &lt;align-items&gt; &lt;justify-items&gt;</li><li>justify-content：start | end | center | stretch | space-around | space-between | space-evenly;    </li><li>align-content：start | end | center | stretch | space-around | space-between | space-evenly;  </li><li>place-content：&lt;align-content&gt; &lt;justify-content&gt;</li><li>grid-auto-columns</li><li>grid-auto-rows</li><li>grid-auto-flow</li><li>grid</li></ul><h4 id="Grid-Items-属性"><a href="#Grid-Items-属性" class="headerlink" title="Grid Items 属性"></a>Grid Items 属性</h4><ul><li>grid-column-start</li><li>grid-column-end</li><li>grid-row-start</li><li>grid-row-end</li><li>grid-column</li><li>grid-row</li><li>grid-area</li><li>justify-self</li><li>align-self</li><li>place-self</li></ul><h4 id="页面布局"><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;Container&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-a&quot;</span>&gt;</span>header a<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-b&quot;</span>&gt;</span>main b<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-c&quot;</span>&gt;</span>sidebar c<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-d&quot;</span>&gt;</span>footer d<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item item-e&quot;</span>&gt;</span>隐式 e<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">20rem</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 3*4的网格 */</span></span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">20%</span> <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">25%</span> auto <span class="number">100px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">grid-template-areas</span>: </span><br><span class="line">    <span class="string">&quot;header header header header&quot;</span></span><br><span class="line">    <span class="string">&quot;main main . sidebar&quot;</span></span><br><span class="line">    <span class="string">&quot;footer footer footer footer&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 网格间距，等价于 grid-gap: 10px 10px; 等价于 grid-gap: 10px;*/</span></span><br><span class="line">  <span class="attribute">grid-column-gap</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">grid-row-gap</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 指定隐式轨道的大小 */</span></span><br><span class="line">  <span class="attribute">grid-auto-columns</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">grid-auto-rows</span>: <span class="number">60px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item</span>&#123; <span class="attribute">line-height</span>:<span class="number">2.5rem</span>; <span class="attribute">text-indent</span>:.<span class="number">5rem</span>; <span class="attribute">border</span>:<span class="number">5px</span> solid <span class="number">#cdcdcd</span>;&#125;</span><br><span class="line"><span class="selector-class">.item-a</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: header;</span><br><span class="line">  <span class="attribute">background</span>:moccasin;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item-b</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">3rem</span>;</span><br><span class="line">  <span class="attribute">grid-area</span>: main;</span><br><span class="line">  <span class="attribute">background</span>:mediumspringgreen;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item-c</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: sidebar;</span><br><span class="line">  <span class="attribute">background</span>:wheat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item-d</span> &#123;</span><br><span class="line">  <span class="attribute">grid-area</span>: footer;</span><br><span class="line">  <span class="attribute">background</span>:salmon;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item-e</span> &#123;</span><br><span class="line">  <span class="attribute">grid-column</span>: <span class="number">7</span> /  span <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">grid-row</span>: <span class="number">3</span> / <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><style>.Container {  display: grid;  height:20rem;  /* 3*4的网格 */      grid-template-columns: 1fr 20% 1fr 1fr;  grid-template-rows: 25% auto 100px;  grid-template-areas:     "header header header header"    "main main . sidebar"    "footer footer footer footer";  /* 网格间距，等价于 grid-gap: 10px 10px; 等价于 grid-gap: 10px;*/  grid-column-gap: 10px;  grid-row-gap: 10px;  /* 指定隐式轨道的大小 */  grid-auto-columns: 60px;  grid-auto-rows: 60px;}.item{ line-height:2.5rem; text-indent:.5rem; border:5px solid #cdcdcd;}.item-a {  grid-area: header;  background:moccasin;}.item-b {  height:3rem;  grid-area: main;  background:mediumspringgreen;}.item-c {  grid-area: sidebar;  background:wheat;}.item-d {  grid-area: footer;  background:salmon;}.item-e {  grid-column: 7 / span 2;  grid-row: 3 / 4;}.Box{  display:grid;  height:20rem;  grid:    "header header header header"   25%        "main main . sidebar"           auto        "footer footer footer footer"   100px        / 1fr 20% 1fr 1fr;  grid-gap: 10px;  grid-auto-columns: 60px;  grid-auto-rows: 60px;</style><div class="Container">    <div class="item item-a">header a</div>    <div class="item item-b">main b</div>    <div class="item item-c">sidebar c</div>    <div class="item item-d">footer d</div>    <div class="item item-e">隐式 e</div></div><h4 id="网格图解"><a href="#网格图解" class="headerlink" title="网格图解"></a>网格图解</h4><p><img src="/images/grid.png" alt="网格图解"></p><h4 id="grid-template"><a href="#grid-template" class="headerlink" title="grid-template"></a>grid-template</h4><ul><li><p>可以给网格线命名</p><blockquote><p>grid-template-columns: [first] 40px [line2] 50px [line3] auto [col4-start] 50px [five] 40px [end];</p><p>grid-template-rows: [row1-start] 25% [row1-end] 100px [third-line] auto [last-line];</p></blockquote></li><li><p>同一个网格线，可以存在多个命名</p><blockquote><p>grid-template-rows: [row1-start] 25% [row1-end row2-start] 25% [row2-end];</p></blockquote></li><li><p>重复值，可以使用 repeat() 来简化定义，如下定义等价</p><blockquote><p>grid-template-columns: repeat(3, 20px [col-start]);<br>等价于<br>grid-template-columns: 20px [col-start] 20px [col-start] 20px [col-start];</p></blockquote></li><li><p>fr 均分网格容器剩余空间 </p><blockquote><p>grid-template-columns: 1fr 1fr 1fr;<br>grid-template-columns: 1fr 50px 1fr 1fr;</p></blockquote></li></ul><h4 id="示例-Container-缩写"><a href="#示例-Container-缩写" class="headerlink" title="示例 Container 缩写"></a>示例 Container 缩写</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Box</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:grid;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">20rem</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">grid</span>:<span class="string">&quot;header header header header&quot;</span>   <span class="number">25%</span></span><br><span class="line">    <span class="string">&quot;main main . sidebar&quot;</span>           auto</span><br><span class="line">    <span class="string">&quot;footer footer footer footer&quot;</span>   <span class="number">100px</span></span><br><span class="line">        / <span class="number">1</span>fr <span class="number">20%</span> <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">grid-gap</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="Box">    <div class="item item-a">header a</div>    <div class="item item-b">main b</div>    <div class="item item-c">sidebar c</div>    <div class="item item-d">footer d</div>    <div class="item item-e">隐式 e</div></div><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://www.html.cn/archives/8510">完全指南</a></p>]]></content>
      
      
      <categories>
          
          <category> HTML5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Grid </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grunt 自动化部署</title>
      <link href="2019/07/08/Grunt%20%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/"/>
      <url>2019/07/08/Grunt%20%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><pre><code>npm i -g grunt-clinpm i grunt --save-devnpm i grunt-contrib-watch --save-devnpm i grunt-contrib-stylus --save-dev</code></pre><h4 id="必备文件"><a href="#必备文件" class="headerlink" title="必备文件"></a>必备文件</h4><blockquote><p>package.json：用于保存项目元数据。<br>Gruntfile.js : 用于配置或定义任务、加载 Grunt 插件。</p></blockquote><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">grunt</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 任务配置,所有插件的配置信息</span></span><br><span class="line">    grunt.initConfig(&#123;</span><br><span class="line">        pkg: grunt.file.readJSON(<span class="string">&#x27;package.json&#x27;</span>),</span><br><span class="line">        stylus:&#123;</span><br><span class="line">            compile: &#123;</span><br><span class="line">                options: &#123;</span><br><span class="line">      linenos: <span class="literal">false</span>,</span><br><span class="line">      compress: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">      relativeDest: <span class="string">&#x27;build&#x27;</span>,</span><br><span class="line"></span><br><span class="line">      banner: <span class="string">&#x27;\/** \n * &lt;%= pkg.name %&gt;\n * version &lt;%= pkg.version %&gt; \n </span></span><br><span class="line"><span class="string">* author &lt;%= pkg.author %&gt; \n * date &lt;%= grunt.template.today() %&gt; \n**/\n&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                files: &#123;</span><br><span class="line">                    <span class="string">&#x27;main.css&#x27;</span>: [<span class="string">&#x27;css/main.styl&#x27;</span>],</span><br><span class="line">      <span class="string">&#x27;search.css&#x27;</span>: [<span class="string">&#x27;css/search.styl&#x27;</span>],</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// watch插件的配置信息</span></span><br><span class="line">        watch: &#123;</span><br><span class="line">      files: [<span class="string">&#x27;css/*.styl&#x27;</span>],</span><br><span class="line">      tasks: [<span class="string">&#x27;stylus&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用插件</span></span><br><span class="line">grunt.loadNpmTasks(<span class="string">&#x27;grunt-contrib-stylus&#x27;</span>);</span><br><span class="line">grunt.loadNpmTasks(<span class="string">&#x27;grunt-contrib-watch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在终端中输入grunt时需要做些什么</span></span><br><span class="line">grunt.registerTask(<span class="string">&#x27;default&#x27;</span>, [<span class="string">&#x27;stylus&#x27;</span>,<span class="string">&#x27;watch&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="常用模块"><a href="#常用模块" class="headerlink" title="常用模块"></a>常用模块</h4><pre><code>grunt-contrib-clean：删除文件。grunt-contrib-compass：使用compass编译sass文件。grunt-contrib-concat：合并文件。grunt-contrib-copy：复制文件。grunt-contrib-cssmin：压缩以及合并CSS文件。grunt-contrib-imagemin：图像压缩模块。grunt-contrib-jshint：检查JavaScript语法。grunt-contrib-uglify：压缩以及合并JavaScript文件。grunt-contrib-watch：监视文件变动，做出相应动作。grunt-contrib-stylus：stylus编写styl输出css。</code></pre><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://tgideas.qq.com/webplat/info/news_version3/804/808/811/m579/201307/216460.shtml">Grunt打造前端自动化工作流</a></p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Grunt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo主题修改和自定义</title>
      <link href="2019/07/06/Hexo%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89/"/>
      <url>2019/07/06/Hexo%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89/</url>
      
        <content type="html"><![CDATA[<h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><blockquote><p>MARKSZのBloG - <a href="https://molunerfinn.com/make-a-hexo-theme">https://molunerfinn.com/make-a-hexo-theme</a><br>Hexo 辅助函数 - <a href="https://hexo.io/zh-cn/docs/helpers">https://hexo.io/zh-cn/docs/helpers</a><br>Pug 语法 - <a href="https://pugjs.org/language/attributes.html">https://pugjs.org/language/attributes.html</a><br>Stylus 语法- <a href="http://stylus-lang.com/">http://stylus-lang.com</a></p></blockquote><h4 id="文档结构"><a href="#文档结构" class="headerlink" title="文档结构"></a>文档结构</h4><ul><li>Hexo 主题, layout 目录需要包括如下几个页面：</li></ul><blockquote><p>首页 Home<br>归档页 Archive<br>标签页 Tag<br>分类页 Category<br>文章页 Post<br>页面详情页 Page</p></blockquote><ul><li>source 目录, 通常存放资源文件</li></ul><blockquote><p>CSS，JS，IMG</p></blockquote><h4 id="搭建书写主题的舒适环境"><a href="#搭建书写主题的舒适环境" class="headerlink" title="搭建书写主题的舒适环境"></a>搭建书写主题的舒适环境</h4><p><strong>能看到这篇文章，你应该已经搭建好了 Hexo 的博客环境，默认主题 landspace。通常我们不会在 landspace 上修改，而是下载个新主题，二次开发，或者撰写自己的主题。</strong></p><ul><li>为了更好的编写主题，我们需要安装：</li></ul><blockquote><p>hexo-browsersync</p><p>pug</p><p>stylus</p></blockquote><pre><code>npm install hexo-server hexo-browsersync hexo-renderer-jade hexo-renderer-stylus --save-dev根据情况选择安装，无需硬搬，可能会安装失败，报错</code></pre><ul><li>Bug以及解决</li></ul><blockquote><p>安装了 hexo-browsersync 之后也不能实现修改 pug 文件之后刷新出修改后的结果。只能实现自动刷新，但是刷新了之后还是修改前的页面。</p></blockquote><pre><code>你的 node_modules 文件夹里找到 hexo-renderer-jade 的文件夹，然后将里面 lib/pug.js（jade同理）的其中一行代码注释掉：// pugRender.compile = pugCompile</code></pre><blockquote><p>以上是亲踩坑，如遇到其他BUG，参照 <a href="https://molunerfinn.com/make-a-hexo-theme">MARKSZのBloG</a></p></blockquote><h4 id="用-Yeoman-来生成主题结构"><a href="#用-Yeoman-来生成主题结构" class="headerlink" title="用 Yeoman 来生成主题结构"></a>用 Yeoman 来生成主题结构</h4><blockquote><p>npm install yo -g</p><p>npm install generator-hexo-theme -g</p></blockquote><p><strong>可能安装不成功，清理后，多试几次</strong></p><blockquote><p>进入 Hexo -&gt; themes</p><p>yo hexo-theme</p><p>选择 pug 和 stylus, 给主题命名 temp</p></blockquote><pre><code>生成的项目结构├── _config.yml # 主题配置文件├── layout # 布局文件夹│   ├── archive.pug # 归档页│   ├── category.pug # 分类页│   ├── includes # 复用的公共页│   │   ├── layout.pug # 页面布局│   │   ├── pagination.pug # 翻页模板│   │   └── recent-posts.pug # 文章列表模板│   ├── index.pug # 主页│   ├── page.pug # 页面详情页│   ├── post.pug # 文章详情页│   └── tag.pug # 标签页└── source # 资源文件夹    ├── css # CSS    │   └── temp.styl    ├── favicon.ico # 站点图标    └── js # JS        └── temp.js</code></pre><blockquote><p>站点 _config.yml -&gt; theme: landsacpe 改成： theme: temp(你的主题名)<br>hexo s 查看效果</p></blockquote><h4 id="主题配置，修改"><a href="#主题配置，修改" class="headerlink" title="主题配置，修改"></a>主题配置，修改</h4><pre><code>常用变量config、theme、site、page 常用辅助函数url_for(link)is_home、is_post、is_tag、is_category、is_current等几个判断当前文章类型的函数date、time等时间字符串处理函数list_categories、list_tags、tagcloud等生成分类列表、标签列表、标签云等函数toc 生成文章目录paginator 生成页面页码常用主题配置，修改temp.ymlmenu:  Home: /  Archives: /archives  Tags: /tags  Categories: /categories  **自定义添加  About: /about  Links: /links  Search: /search数据查看与填充- console.log(site.pages) **亲测未成功，有成功的，麻烦告知下编码示例# 注意首页也是一个page，它包含的 posts 只包括了首页会显示出来的文章。each article in page.posts.data   .recent-post-item    - var link = article.link || article.path      a.article-title(href=url_for(link))= article.title || &#39;no_title&#39;    .content!= article.excerpt     # excerpt是 post 的一个变量，只会显示文章的摘要部分    a.more(href=url_for(link) + &#39;#more&#39;) 阅读更多# 获取标签列表if (site.tags.length)  .widget-wrap    .widget!= list_tags(&#123;show_count:true&#125;)# 获取标签云if (site.tags.length)  .widget-wrap    .widget.tagcloud!= tagcloud()** = != 输出变量的两种方式，前者直接“字符串”输出，后者页面“代码”输出# 侧边栏目录# 如果是文章页面if(is_post())  # 给 toc 传入当前页面的内容用于生成目录结构  .sidebar-toc!= toc(page.content)# pug 写 scriptscript.  var GLOBAL = &#123;     algolia: !&#123;algolia&#125;,  &#125;</code></pre><h4 id="常用功能添加"><a href="#常用功能添加" class="headerlink" title="常用功能添加"></a>常用功能添加</h4><ul><li>不蒜子</li></ul><pre><code>.busuanzi-count    script(src= url_for(&quot;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;))&amp;attributes(async)    span.site-uv        i.fa.fa-user        span.busuanzi-value#busuanzi_value_site_uv    span.site-uv        i.fa.fa-eye        span.busuanzi-value#busuanzi_value_site_pv</code></pre><ul><li> 评论功能 (推荐)</li></ul><blockquote><p><a href="https://baijiahao.baidu.com/s?id=1608153490321015332&wfr=spider&for=pc">Valine</a></p><p><a href="https://www.jianshu.com/p/61abc6c43220">Livere</a></p></blockquote><ul><li>添加搜索功能</li></ul><blockquote><p><a href="https://www.jianshu.com/p/685bf59cde5e">本地搜索引擎</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MarkDown 基本语法</title>
      <link href="2019/07/01/Markdown/"/>
      <url>2019/07/01/Markdown/</url>
      
        <content type="html"><![CDATA[<style>    table{ border-collapse: collapse;}    table,th,td{border:1px solid #cdcdcd;}    th,td{ padding:.5rem 1rem;}</style><h4 id="兼容HTML"><a href="#兼容HTML" class="headerlink" title="兼容HTML"></a>兼容HTML</h4><pre><code>&lt;table&gt;    &lt;tr&gt;        &lt;th&gt;列一&lt;/th&gt;&lt;th&gt;列二&lt;/th&gt;&lt;th&gt;列三&lt;/th&gt;    &lt;/tr&gt;    &lt;tr&gt;        &lt;td&gt;苹果&lt;/td&gt;&lt;td&gt;香蕉&lt;/td&gt;&lt;td&gt;橘子&lt;/td&gt;    &lt;/tr&gt;&lt;/table&gt;</code></pre><table>    <tr>        <th>列一</th><th>列二</th><th>列三</th>    </tr>    <tr>        <td>苹果</td><td>香蕉</td><td>橘子</td>    </tr></table><pre><code>标题===</code></pre><h1 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h1><pre><code>标题---</code></pre><h2 id="标题-1"><a href="#标题-1" class="headerlink" title="标题"></a>标题</h2><pre><code># h1## h2### h3#### h4##### h5###### h6</code></pre><h4 id="区块引用-Blockquotes"><a href="#区块引用-Blockquotes" class="headerlink" title="区块引用 Blockquotes"></a>区块引用 Blockquotes</h4><pre><code>&gt; This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet,consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus.&gt;&gt;Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.&gt;&gt; Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisseid sem consectetuer libero luctus adipiscing.</code></pre><blockquote><p>This is a blockquote with two paragraphs. Lorem ipsum dolor sit amet,<br>consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus.</p><blockquote><p>Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.</p></blockquote><p>Donec sit amet nisl. Aliquam semper ipsum sit amet velit. Suspendisse<br>id sem consectetuer libero luctus adipiscing.</p></blockquote><h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><pre><code>*  苹果*  香蕉*  橘子</code></pre><ul><li> 苹果</li><li> 香蕉</li><li> 橘子</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>橘子<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>苹果</li><li>香蕉</li><li>橘子</li></ol><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><pre><code>populationPersonalInfoDO.Idcard = persoanlInfoDTO.sfz;populationPersonalInfoDO.Xm = persoanlInfoDTO.xm;</code></pre><h4 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h4><pre><code>This is [an example](http://example.com &quot;Title&quot;) inline link.[This link](http://example.net) has no title attribute.</code></pre><p>This is <a href="http://example.com/" title="Title">an example</a> inline link.<br><a href="http://example.net/">This link</a> has no title attribute.</p><h4 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h4><pre><code>![网络图片](http://www.ghost64.com/qqtupian/zixunImg/local/2017/03/22/14901643813113.jpg)&lt;img src=&quot;http://www.ghost64.com/qqtupian/zixunImg/local/2017/03/22/14901643813113.jpg&quot;/&gt;</code></pre><p><img src="http://www.ghost64.com/qqtupian/zixunImg/local/2017/03/22/14901643813113.jpg" alt="网络图片"></p><img src="http://www.ghost64.com/qqtupian/zixunImg/local/2017/03/22/14901643813113.jpg"/><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><strong><a href="https://www.appinn.com/markdown/index.html">https://www.appinn.com/markdown/index.html</a></strong></p><h4 id="邮箱"><a href="#邮箱" class="headerlink" title="邮箱"></a>邮箱</h4><p><a href="mailto:&#x53;&#111;&#x61;&#114;&#x33;&#x36;&#48;&#64;&#x6c;&#x69;&#x76;&#101;&#46;&#x63;&#111;&#x6d;">&#x53;&#111;&#x61;&#114;&#x33;&#x36;&#48;&#64;&#x6c;&#x69;&#x76;&#101;&#46;&#x63;&#111;&#x6d;</a></p><h4 id="授权秘钥"><a href="#授权秘钥" class="headerlink" title="授权秘钥"></a>授权秘钥</h4><p style="word-break:break-all">GBPduHjWfJU1mZqcPM3BikjYKF6xKhlKIys3i1MU2eJHqWGImDHzWdD6xhMNLGVpbP2M5SN6bnxn2kSE8qHqNY5QaaRxmO3YSMHxlv2EYpjdwLcPwfeTG7kUdnhKE0vVy4RidP6Y2wZ0q74f47fzsZo45JE2hfQBFi2O9Jldjp1mW8HUpTtLA2a5/sQytXJUQl/QKO0jUQY4pa5CCx20sV1ClOTZtAGngSOJtIOFXK599sBr5aIEFyH0K7H4BoNMiiDMnxt1rD8Vb/ikJdhGMMQr0R4B+L3nWU97eaVPTRKfWGDE8/eAgKzpGwrQQoDh+nzX1xoVQ8NAuH+s4UcSeQ==<p>]]></content>
      
      
      <categories>
          
          <category> 语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 环境搭建，部署 Github</title>
      <link href="2018/07/01/HexoToGithub/"/>
      <url>2018/07/01/HexoToGithub/</url>
      
        <content type="html"><![CDATA[<h4 id="mailchen-github-io"><a href="#mailchen-github-io" class="headerlink" title="mailchen.github.io"></a>mailchen.github.io</h4><ul><li><a href="https://github.com/coreybutler/nvm-windows/releases">nvm-setup.zip</a> </li><li><a href="https://hexo.io/zh-cn/">hexo 官网</a></li><li><a href="https://blog.csdn.net/sinat_37781304/article/details/82729029">环境搭建</a></li></ul><h4 id="nvm-安装，配置"><a href="#nvm-安装，配置" class="headerlink" title="nvm 安装，配置"></a>nvm 安装，配置</h4><blockquote><p>打开nvm文件下settings文件，添加下载镜像指向淘宝</p><p>arch: 64 </p><p>proxy: none</p><p>node_mirror: <a href="http://npm.taobao.org/mirrors/node/">http://npm.taobao.org/mirrors/node/</a></p><p>npm_mirror: <a href="https://npm.taobao.org/mirrors/npm/">https://npm.taobao.org/mirrors/npm/</a></p></blockquote><h4 id="安装nodejs-nvm-install-latest"><a href="#安装nodejs-nvm-install-latest" class="headerlink" title="安装nodejs: nvm install latest"></a>安装nodejs: nvm install latest</h4><h4 id="查看列表-nvm-list"><a href="#查看列表-nvm-list" class="headerlink" title="查看列表: nvm list"></a>查看列表: nvm list</h4><h4 id="切换版本-nvm-use-版本号"><a href="#切换版本-nvm-use-版本号" class="headerlink" title="切换版本: nvm use 版本号"></a>切换版本: nvm use 版本号</h4><h4 id="查看版本号"><a href="#查看版本号" class="headerlink" title="查看版本号:"></a>查看版本号:</h4><blockquote><p>nvm -v </p><p>node -v</p><p>npm -v</p></blockquote><h4 id="安装-hexo-npm-install-g-hexo-cli"><a href="#安装-hexo-npm-install-g-hexo-cli" class="headerlink" title="安装 hexo: npm install -g hexo-cli"></a>安装 hexo: npm install -g hexo-cli</h4><h4 id="初始化-myBlog-hexo-init"><a href="#初始化-myBlog-hexo-init" class="headerlink" title="初始化 myBlog: hexo init"></a>初始化 myBlog: hexo init</h4><h4 id="配置-config-yml"><a href="#配置-config-yml" class="headerlink" title="配置 _config.yml"></a>配置 _config.yml</h4><blockquote><p>deploy:</p><p>type: git</p><p>repo: <a href="https://github.com/YourgithubName/YourgithubName.github.io.git">https://github.com/YourgithubName/YourgithubName.github.io.git</a></p><p>branch: master</p></blockquote><h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line">hexo generate</span><br><span class="line"></span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><h4 id="hexo-上传-github"><a href="#hexo-上传-github" class="headerlink" title="hexo 上传 github"></a>hexo 上传 github</h4><blockquote><p>npm install hexo-deployer-git -save。</p></blockquote><blockquote><p>hexo g -d</p></blockquote><h4 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h4><p><a href="https://hexo.io/themes/">hexo themes</a></p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 环境搭建，部署 Github</title>
      <link href="2018/07/01/serverless/HexoToGithub/"/>
      <url>2018/07/01/serverless/HexoToGithub/</url>
      
        <content type="html"><![CDATA[<h4 id="mailchen-github-io"><a href="#mailchen-github-io" class="headerlink" title="mailchen.github.io"></a>mailchen.github.io</h4><ul><li><a href="https://github.com/coreybutler/nvm-windows/releases">nvm-setup.zip</a> </li><li><a href="https://hexo.io/zh-cn/">hexo 官网</a></li><li><a href="https://blog.csdn.net/sinat_37781304/article/details/82729029">环境搭建</a></li></ul><h4 id="nvm-安装，配置"><a href="#nvm-安装，配置" class="headerlink" title="nvm 安装，配置"></a>nvm 安装，配置</h4><blockquote><p>打开nvm文件下settings文件，添加下载镜像指向淘宝</p><p>arch: 64 </p><p>proxy: none</p><p>node_mirror: <a href="http://npm.taobao.org/mirrors/node/">http://npm.taobao.org/mirrors/node/</a></p><p>npm_mirror: <a href="https://npm.taobao.org/mirrors/npm/">https://npm.taobao.org/mirrors/npm/</a></p></blockquote><h4 id="安装nodejs-nvm-install-latest"><a href="#安装nodejs-nvm-install-latest" class="headerlink" title="安装nodejs: nvm install latest"></a>安装nodejs: nvm install latest</h4><h4 id="查看列表-nvm-list"><a href="#查看列表-nvm-list" class="headerlink" title="查看列表: nvm list"></a>查看列表: nvm list</h4><h4 id="切换版本-nvm-use-版本号"><a href="#切换版本-nvm-use-版本号" class="headerlink" title="切换版本: nvm use 版本号"></a>切换版本: nvm use 版本号</h4><h4 id="查看版本号"><a href="#查看版本号" class="headerlink" title="查看版本号:"></a>查看版本号:</h4><blockquote><p>nvm -v </p><p>node -v</p><p>npm -v</p></blockquote><h4 id="安装-hexo-npm-install-g-hexo-cli"><a href="#安装-hexo-npm-install-g-hexo-cli" class="headerlink" title="安装 hexo: npm install -g hexo-cli"></a>安装 hexo: npm install -g hexo-cli</h4><h4 id="初始化-myBlog-hexo-init"><a href="#初始化-myBlog-hexo-init" class="headerlink" title="初始化 myBlog: hexo init"></a>初始化 myBlog: hexo init</h4><h4 id="配置-config-yml"><a href="#配置-config-yml" class="headerlink" title="配置 _config.yml"></a>配置 _config.yml</h4><blockquote><p>deploy:</p><p>type: git</p><p>repo: <a href="https://github.com/YourgithubName/YourgithubName.github.io.git">https://github.com/YourgithubName/YourgithubName.github.io.git</a></p><p>branch: master</p></blockquote><h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line">hexo generate</span><br><span class="line"></span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><h4 id="hexo-上传-github"><a href="#hexo-上传-github" class="headerlink" title="hexo 上传 github"></a>hexo 上传 github</h4><blockquote><p>npm install hexo-deployer-git -save。</p></blockquote><blockquote><p>hexo g -d</p></blockquote><h4 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h4><p><a href="https://hexo.io/themes/">hexo themes</a></p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Handsontable 常用配置和方法</title>
      <link href="2016/07/01/Javascript/Handsontable/"/>
      <url>2016/07/01/Javascript/Handsontable/</url>
      
        <content type="html"><![CDATA[<h4 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h4><ul><li>1、固定行列位置</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fixedRowsTop:行数       &#x2F;&#x2F;固定顶部多少行不能垂直滚动</span><br><span class="line">fixedColumnsLeft:列数   &#x2F;&#x2F;固定左侧多少列不能水平滚动</span><br></pre></td></tr></table></figure><ul><li>2、拖拽行头或列头改变行或列的大小</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true时，允许拖动，当为false时禁止拖动</span><br><span class="line">manualColumnResize:true&#x2F;false</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;当值为true时，允许拖动，当为false时禁止拖动</span><br><span class="line">manualRowResize:true&#x2F;false</span><br></pre></td></tr></table></figure><ul><li>3、延伸列的宽度</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;last:延伸最后一列,all:延伸所有列,none默认不延伸。</span><br><span class="line">stretchH：last&#x2F;all&#x2F;none</span><br></pre></td></tr></table></figure><ul><li>4、拖动行或列到某一行或列之后 </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">当值为true时，列可拖拽移动到指定列</span><br><span class="line">manualColumnMove：true&#x2F;false </span><br><span class="line"></span><br><span class="line">当值为true时，行可拖拽至指定行</span><br><span class="line">manualRowMove:true&#x2F;false </span><br><span class="line"></span><br><span class="line">移动的时候鼠标需选中行线或列线才行。</span><br></pre></td></tr></table></figure><ul><li>5、设置当前行或列的样式</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">currentRowClassName：当前行样式的名称</span><br><span class="line"></span><br><span class="line">currentColClassName：当前列样式的名称</span><br></pre></td></tr></table></figure><ul><li>6、行分组或列分组</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groups:[&#123;cols:[0,2]&#125;,&#123;cols:[3,5]&#125;,&#123;rows:[0,4]&#125;,&#123;rows:[5,7]&#125;]</span><br><span class="line"></span><br><span class="line">上面的例子介绍了4个分组，第0-2列为一组，第3-5列为第二组，第0-4行为一组，第5-7列为第二组。分组可在行头或列头看见，分组可被展开或隐藏。</span><br></pre></td></tr></table></figure><ul><li>7、允许排序</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">columnSorting：true&#x2F;false&#x2F;对象 &#x2F;&#x2F;当值为true时，表示启用排序插件</span><br><span class="line"></span><br><span class="line">当值为true时，排序插件的使用可通过点击列头文字实现。当值为false时表示禁用排序。当值为对象时，该对象包含两个属性：column：列数。sortOrder：true&#x2F;false，升序或降序，true为升序排列。当用对象启动插件后可用如下方式禁用插件：</span><br><span class="line"></span><br><span class="line">hot.updateSettings(&#123;</span><br><span class="line">    columnSorting:false</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">排序的使用也可已直接调用sort()方法实现。如下操作：</span><br><span class="line"></span><br><span class="line">if(hot.sortingEnabled)&#123;</span><br><span class="line">    hot.sort(行数，true&#x2F;false); &#x2F;&#x2F;true为升序，false为降序</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>8、数据显示</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data：[[第一行数据],[第二行数据],...[第n行数据]]&#x2F;对象数组</span><br><span class="line"></span><br><span class="line">获取数据的方法：hot.getData()。</span><br><span class="line"></span><br><span class="line">加载数据的方法：hot.loadData(data)。</span><br></pre></td></tr></table></figure><ul><li>9、右键菜单展示</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true时，启用右键菜单，为false时禁用</span><br><span class="line">contextMenu：true&#x2F;false&#x2F;自定义数组 </span><br></pre></td></tr></table></figure><ul><li>10、自适应列大小</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;当值为true且列宽未设置时，自适应列大小</span><br><span class="line">autoColumnSize：true&#x2F;false </span><br></pre></td></tr></table></figure><ul><li>11、最小，最大设置</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">minCols：最小列数</span><br><span class="line">minRows：最小行数</span><br><span class="line">minSpareCols：最小列空间，不足则添加空列</span><br><span class="line">maxCols：最大列数</span><br><span class="line">maxRows：最大行数</span><br><span class="line">minSpareRows：最小行空间，不足则添加空行</span><br></pre></td></tr></table></figure><ul><li>12、自定义边框设置，可以进行初始化配置，如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">customBorder:true;</span><br><span class="line">customBorders:[&#123;range:&#123;from:&#123;row:行数,col:列数&#125;,to:&#123;row:行数,col:列数&#125;,上下左右设置&#125;]</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">hot = Handsontable(container, &#123;</span><br><span class="line">    data: Handsontable.helper.createSpreadsheetData(<span class="number">200</span>, <span class="number">20</span>),</span><br><span class="line">    rowHeaders: <span class="literal">true</span>,</span><br><span class="line">    fixedColumnsLeft: <span class="number">2</span>,</span><br><span class="line">    fixedRowsTop: <span class="number">2</span>,</span><br><span class="line">    colHeaders: <span class="literal">true</span>,</span><br><span class="line">    customBorders: [</span><br><span class="line">      &#123;</span><br><span class="line">        range: &#123;<span class="comment">//多个单元格</span></span><br><span class="line">          <span class="keyword">from</span>: &#123;<span class="comment">//起始位置</span></span><br><span class="line">            row: <span class="number">1</span>,</span><br><span class="line">            col: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          to: &#123;</span><br><span class="line">            row: <span class="number">3</span>,</span><br><span class="line">            col: <span class="number">4</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        top: &#123;<span class="comment">//结束位置</span></span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;#5292F7&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        left: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;orange&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        bottom: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;red&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        right: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;magenta&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;<span class="comment">//单一单元格</span></span><br><span class="line">        row: <span class="number">2</span>,</span><br><span class="line">        col: <span class="number">2</span>,</span><br><span class="line">        left: &#123;</span><br><span class="line">          width: <span class="number">2</span>,</span><br><span class="line">          color: <span class="string">&#x27;red&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        right: &#123;</span><br><span class="line">          width: <span class="number">1</span>,</span><br><span class="line">          color: <span class="string">&#x27;green&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>13、单元格合并配置，如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mergeCells:true</span><br><span class="line">mergeCells: [&#123;row: 起始行数, col: 起始列数, rowspan: 合并行数, colspan:合并列数 &#125;,...]</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(key == <span class="string">&quot;merge&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(hot.mergeCells.mergedCellInfoCollection.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>; k&lt;hot.mergeCells.mergedCellInfoCollection.length; k++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(hot.mergeCells.mergedCellInfoCollection[k].row == row &amp;&amp;</span><br><span class="line">                hot.mergeCells.mergedCellInfoCollection[k].col == col) &#123;</span><br><span class="line">                    hot.mergeCells.mergedCellInfoCollection.splice(k,<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    hot.mergeCells.mergedCellInfoCollection.push(&#123;<span class="string">&quot;row&quot;</span>: row, <span class="string">&quot;col&quot;</span>: col, </span><br><span class="line">                    <span class="string">&quot;rowspan&quot;</span>: rowspan, <span class="string">&quot;colspan&quot;</span>: colspan&#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hot.mergeCells.mergedCellInfoCollection.push(&#123;<span class="string">&quot;row&quot;</span>: row, <span class="string">&quot;col&quot;</span>: col, <span class="string">&quot;rowspan&quot;</span>: rowspan, <span class="string">&quot;colspan&quot;</span>: colspan&#125;);</span><br><span class="line">｝</span><br></pre></td></tr></table></figure><h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><blockquote><p>怎样获得行标题和列标题的名称？</p><blockquote><p>getRowHeader</p><p>getColHeader</p></blockquote></blockquote><blockquote><p>怎么根据列名称得到列索引，根据列索引得到列名称？</p><blockquote><p>propToCol</p><p>colToProp</p></blockquote></blockquote><blockquote><p>表格的行数和列数？</p><blockquote><p>countRows</p><p>countCols</p></blockquote></blockquote><blockquote><p>操作单元格？</p><blockquote><p>getCell(1,1)  //获得单元格对象</p><p>selectCell(2,2)</p><p>getSelected() //返回坐标，如2,2,2,2</p></blockquote></blockquote><blockquote><p>获得表格中某个范围range的数据？</p><blockquote><p>getData(0,4)</p><p>getData(1,1,2,2)</p><p>getDataAtCell(1,3)    </p><p>getDataAtRow(row)</p><p>getDataAtCol(col)</p><p>getDataAtRowProp(row, name)</p><p>setDataAtCell(row, col, val)</p><p>getActiveEditor</p></blockquote></blockquote><blockquote><p>复制，粘贴？</p><blockquote><p>getCopyableData</p><p>copyPaste.triggerPaste(event, val)</p></blockquote></blockquote><blockquote><p>其他    </p><blockquote><p>$(‘#id’).handsontable(‘getInstance’);</p><p>$(‘#id’).handsontable(‘getData’);</p><p>$(‘#id’).handsontable(‘loadData’, data);</p><p>$(‘#id’).handsontable(‘destroy’);</p></blockquote></blockquote><blockquote><p><strong>specialSettings.afterGetColHeader</strong></p><p>var finialSettings = $.extend(true, initialSettings, specialSettings);</p><p>$(‘#id’).handsontable(finialSettings);</p><p><strong>beforeChange: function (changes, source) {}</strong></p><p><strong>beforeKeyDown: function(event, coords, td){}</strong></p><p><strong>afterOnCellMouseDown: function(event, coords, td){}</strong></p><p><strong>afterRender: function(isForced) {}</strong></p></blockquote><h4 id="自定义插件"><a href="#自定义插件" class="headerlink" title="自定义插件"></a>自定义插件</h4><ol><li>初始化时绑定自定义插件</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">columnShift.data = data;</span><br><span class="line">columnShift.renderer = <span class="string">&#x27;html&#x27;</span>;</span><br><span class="line">columnShift.editor = <span class="string">&#x27;ShiftEditor&#x27;</span>; </span><br><span class="line">columnShift.shiftTypes = shiftTypesDictionary;</span><br><span class="line">columnShift.shiftMarks = shiftMarkInfo;</span><br><span class="line">columnShift.specialSchedule = specialScheduleNames;</span><br><span class="line">columnsDataBinding.push(columnShift);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> specialSettings = &#123;</span><br><span class="line">    colHeaders: colHeaders,</span><br><span class="line">    autoRowSize: <span class="literal">true</span>,</span><br><span class="line">    mergeCells: <span class="literal">true</span>,</span><br><span class="line">    columns: columnsDataBinding</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ol start="2"><li>自定义插件配置</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">Handsontable</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ShiftEditor = Handsontable.editors.BaseEditor.prototype.extend();</span><br><span class="line">    <span class="keyword">var</span> filter = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    ShiftEditor.prototype.init = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.rootElement = <span class="built_in">document</span>.createElement(<span class="string">&#x27;DIV&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.rootElement.className = <span class="string">&#x27;shiftEditorRoot&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement = <span class="built_in">document</span>.createElement(<span class="string">&#x27;TABLE&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.ULElement.className = <span class="string">&#x27;ShiftEditor&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.top = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.left = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.listStyle = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.instance.rootElement.appendChild(<span class="built_in">this</span>.ULElement);</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    ShiftEditor.prototype.prepare = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> filterWord = filter;</span><br><span class="line">        Handsontable.editors.BaseEditor.prototype.prepare.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> handsontableInstance = $(<span class="string">&#x27;#handsontable&#x27;</span>).handsontable(<span class="string">&#x27;getInstance&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> empType = handsontableInstance.getDataAtRowProp(<span class="built_in">arguments</span>[<span class="number">0</span>], <span class="string">&#x27;EmployeeWorkIdentity&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        shiftTypes = <span class="built_in">this</span>.cellProperties.shiftTypes[empType] == <span class="literal">undefined</span> ? <span class="built_in">this</span>.cellProperties.shiftTypes[<span class="string">&#x27;公共&#x27;</span>] : <span class="built_in">this</span>.cellProperties.shiftTypes[empType];</span><br><span class="line">        shiftMarks = <span class="built_in">this</span>.cellProperties.shiftMarks;</span><br><span class="line"></span><br><span class="line">        Handsontable.Dom.empty(<span class="built_in">this</span>.ULElement);</span><br><span class="line">### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.getValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> returnString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">### //dosomething</span><br><span class="line"><span class="keyword">return</span> returnString;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.saveValue = <span class="function"><span class="keyword">function</span> (<span class="params">val, ctrlDown</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.instance.setDataAtCell(<span class="built_in">this</span>.row, <span class="built_in">this</span>.col, val);</span><br><span class="line">    &#125;;</span><br><span class="line">    ShiftEditor.prototype.setValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> orgVal = <span class="built_in">this</span>.originalValue;</span><br><span class="line">### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.finishEditing = <span class="function"><span class="keyword">function</span> (<span class="params">restoreOriginalValue, ctrlDown, callback</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.state == Handsontable.EditorState.EDITING) &#123;</span><br><span class="line">            <span class="keyword">if</span> (restoreOriginalValue) &#123;</span><br><span class="line">                <span class="built_in">this</span>.cancelChanges();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> val = <span class="built_in">this</span>.getValue();</span><br><span class="line">            <span class="built_in">this</span>.state = Handsontable.EditorState.WAITING;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">this</span>.saveValue(val, ctrlDown);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.instance.getCellValidator(<span class="built_in">this</span>.cellProperties)) &#123;</span><br><span class="line">                <span class="keyword">var</span> that = <span class="built_in">this</span>;</span><br><span class="line">                <span class="built_in">this</span>.instance.addHookOnce(<span class="string">&#x27;afterValidate&#x27;</span>,</span><br><span class="line">                    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">                        that.state = Handsontable.EditorState.FINISHED;</span><br><span class="line">                        that.discardEditor(result);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>.state = Handsontable.EditorState.FINISHED;</span><br><span class="line">                <span class="built_in">this</span>.discardEditor(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.focus = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">### //dosomething</span><br><span class="line">    &#125;;</span><br><span class="line">   </span><br><span class="line">    ShiftEditor.prototype.open = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">### //dosomething</span><br><span class="line">        <span class="comment">//this.refreshDimensions();</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ShiftEditor.prototype.close = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.ULElement.style.display = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Handsontable.editors.ShiftEditor = ShiftEditor;</span><br><span class="line">    Handsontable.editors.registerEditor(<span class="string">&#x27;ShiftEditor&#x27;</span>, ShiftEditor);</span><br><span class="line"></span><br><span class="line">&#125;)(Handsontable);</span><br></pre></td></tr></table></figure><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><strong><a href="https://www.jianshu.com/p/924481947c30">https://www.jianshu.com/p/924481947c30</a></strong></p><p><strong><a href="https://www.cnblogs.com/cosyer/p/6741546.html?utm_source=itdadao&utm_medium=referral">https://www.cnblogs.com/cosyer/p/6741546.html?utm_source=itdadao&amp;utm_medium=referral</a></strong></p>]]></content>
      
      
      <categories>
          
          <category> 框架 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle 表空间和模式对象</title>
      <link href="2013/07/05/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle%20%E8%A1%A8%E7%A9%BA%E9%97%B4%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%B1%A1/"/>
      <url>2013/07/05/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle%20%E8%A1%A8%E7%A9%BA%E9%97%B4%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h4 id="Sql-Plus"><a href="#Sql-Plus" class="headerlink" title="Sql Plus"></a>Sql Plus</h4><ul><li><p>cmd 启动</p><p>  Win + R -&gt; sqlplus username/password@数据库名</p></li><li><p>不退出 Sql Plus 断开与数据路服务器的链接</p><p>  DISCONNECT</p></li><li><p>重新链接或切换用户</p><p>  CONNECT username/password as sysdba</p></li></ul><blockquote><p>命令</p></blockquote><pre><code>*当前登录数据库用户*show user *sql plus 所有设置信息*show all*显示数据库服务器参数设置信息*show parameter 参数名*临时修改环境变量值*set sys_option value执行缓存区内容 run | /编辑 edit | ed显示 list追加 append | input清除 del读写 @ | get | save变量 &amp; | define key=val&amp;&amp;</code></pre><h4 id="表空间、数据文件"><a href="#表空间、数据文件" class="headerlink" title="表空间、数据文件"></a>表空间、数据文件</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建永久表空间*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">size</span> <span class="number">20</span>M <span class="keyword">extent</span> <span class="keyword">management</span> <span class="keyword">local</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">size</span> <span class="number">20</span>M <span class="keyword">extent</span> <span class="keyword">management</span> <span class="keyword">local</span> <span class="keyword">uniform</span> <span class="keyword">size</span> <span class="number">1</span>M;</span><br><span class="line">*自动分配*</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">size</span> <span class="number">20</span>M </span><br><span class="line"><span class="keyword">autoextend</span> <span class="keyword">on</span> <span class="keyword">next</span> <span class="number">5</span>M</span><br><span class="line"><span class="keyword">maxsize</span> <span class="number">100</span>M</span><br><span class="line"><span class="keyword">extent</span> <span class="keyword">management</span> <span class="keyword">local</span></span><br><span class="line"><span class="keyword">autoallocate</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*创建临时表空间*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">tablespace</span> my_temp_tb tempfile <span class="string">&#x27;d\my_temp_tb\1.dbf&#x27;</span> <span class="keyword">size</span> <span class="number">20</span>M <span class="keyword">extent</span> <span class="keyword">management</span> <span class="keyword">local</span> <span class="keyword">uniform</span> <span class="keyword">size</span> <span class="number">1</span>M;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*重命名表空间*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">rename</span> <span class="keyword">to</span> myTBspace</span><br><span class="line"></span><br><span class="line"><span class="comment">/*重命名数据文件*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">offline</span> <span class="keyword">normal</span>;</span><br><span class="line">1、host <span class="keyword">rename</span> d\my_tb\<span class="number">1.</span>dbf <span class="number">1</span>_1.dbf;</span><br><span class="line">2、<span class="keyword">alter</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">rename</span> <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">to</span> <span class="string">&#x27;d\my_tb\1_1.dbf&#x27;</span></span><br><span class="line">alert <span class="keyword">tablespace</span> my_tb <span class="keyword">online</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*数据文件脱机状态*/</span></span><br><span class="line">shutdwon immediate;</span><br><span class="line">startup mount;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">archivelog</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">offline</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置默认表空间，临时表空间*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">default</span> <span class="keyword">tablespace</span> my_tb;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">default</span> <span class="keyword">temporary</span> <span class="keyword">tablespace</span> my_temp_tb;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*扩展表空间*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">add</span> <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">size</span> <span class="number">100</span>M;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span> <span class="keyword">resize</span> <span class="number">100</span>M;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*删除表空间*/</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">including</span> <span class="keyword">contents</span> <span class="keyword">and</span> <span class="keyword">datafiles</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*删除数据文件*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> my_tb <span class="keyword">drop</span> <span class="keyword">datafile</span> <span class="string">&#x27;d\my_tb\1.dbf&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="表"><a href="#表" class="headerlink" title="表"></a>表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建表*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">  sno <span class="built_in">char</span>(<span class="number">10</span>),</span><br><span class="line">  sname <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">  ssex <span class="built_in">char</span>(<span class="number">2</span>),</span><br><span class="line">  sbirthday <span class="built_in">date</span>,</span><br><span class="line">  sdept <span class="built_in">varchar2</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*子查询建表*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp_tem(</span><br><span class="line">  emp_no,emp_name,dept_no</span><br><span class="line">)</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> empno,ename,deptno, <span class="keyword">from</span> emp <span class="keyword">where</span> sal &gt; <span class="number">2000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*增加字段*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span>(</span><br><span class="line">  sphone <span class="built_in">char</span>(<span class="number">11</span>),</span><br><span class="line">  seamil <span class="built_in">varchar2</span>(<span class="number">60</span>),</span><br><span class="line">  saddress <span class="built_in">varchar2</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*修改字段*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">rename</span> <span class="keyword">column</span> sdept <span class="keyword">to</span> sdepartment</span><br><span class="line"></span><br><span class="line"><span class="comment">/*修改类型*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">modify</span> sno <span class="built_in">number</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*删除字段*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">column</span> saddress;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">column</span> (sphone,seamil);</span><br><span class="line">alter table student set unused (sphone,seamil); *逻辑删除*</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">unused</span> <span class="keyword">column</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*重命名表*/</span></span><br><span class="line"><span class="keyword">rename</span> student <span class="keyword">to</span> student_Table;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*移动表*/</span></span><br><span class="line">*确认当前表所在表空间*</span><br><span class="line"><span class="keyword">select</span> table_name,tablespace_name <span class="keyword">from</span> user_tables <span class="keyword">where</span> table_name = <span class="string">&#x27;student&#x27;</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">move</span> <span class="keyword">tablespace</span> <span class="keyword">users</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*清空数据*/</span></span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*删除表*/</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="表约束"><a href="#表约束" class="headerlink" title="表约束"></a>表约束</h4><blockquote><p>作用域<br>    表级约束<br>    字段约束</p></blockquote><blockquote><p>用途<br>    NOT NULL<br>    UNIQUE<br>    PRIMARY KEY<br>    FOREIGN KEY<br>    CHECK</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*设置约束条件*/</span></span><br><span class="line">*NOT NULL*</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">modify</span> sname <span class="keyword">constraint</span> sname_notnull <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line">*UNIQUE*</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> sname <span class="keyword">constraint</span> sname_unique <span class="keyword">unique</span> (sname);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> (sname);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">constraint</span> sname_unique;</span><br><span class="line">*PRIMARY KEY*</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> sname <span class="keyword">constraint</span> sname_primarykey primary <span class="keyword">key</span> (sname);</span><br><span class="line">*FOREIGN KEY*</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">class</span>(</span><br><span class="line">  classid <span class="built_in">number</span>(<span class="number">10</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">  classname <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">  classcount <span class="built_in">char</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line">  sno <span class="built_in">char</span>(<span class="number">10</span>),</span><br><span class="line">  sname <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">  ssex <span class="built_in">char</span>(<span class="number">2</span>),</span><br><span class="line">  sbirthday <span class="built_in">date</span>,</span><br><span class="line">  sdept <span class="built_in">varchar2</span>(<span class="number">30</span>),</span><br><span class="line">  classid <span class="built_in">number</span>(<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">constraint</span> studentForeign <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (classid)，</span><br><span class="line">  <span class="keyword">reference</span> <span class="keyword">class</span> (classid)，</span><br><span class="line">  <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span>，</span><br><span class="line">  <span class="keyword">constraint</span> sexCheck <span class="keyword">CHECK</span> (ssex <span class="keyword">in</span> (<span class="string">&#x27;男&#x27;</span>，<span class="string">&#x27;女&#x27;</span>));</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建视图*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view </span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> empno,ename,sal </span><br><span class="line"><span class="keyword">from</span> emp <span class="keyword">where</span> deptno = <span class="number">30</span>;</span><br><span class="line"><span class="comment">/*复杂视图*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view </span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> empno,ename,sal*<span class="number">1.25</span> new_sal </span><br><span class="line"><span class="keyword">from</span> emp <span class="keyword">where</span> sal*<span class="number">1.25</span> &gt; <span class="number">2000</span>;</span><br><span class="line"><span class="comment">/*多表视图*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> emp_view </span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,dname </span><br><span class="line"><span class="keyword">from</span> emp,dept </span><br><span class="line"><span class="keyword">where</span> emp.deptno =dept.deptno;</span><br><span class="line"><span class="comment">/*修改视图*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> || <span class="keyword">replace</span> <span class="keyword">view</span> 重新同名创建</span><br><span class="line"><span class="comment">/*删除视图*/</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> emp_view</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><blockquote><p>类型<br>    B树索引<br>    位图索引<br>    函数索引<br>    簇索引<br>    散裂簇索引<br>    反序索引<br>    位图连接索引</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*B树索引*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> sname_index</span><br><span class="line"><span class="keyword">on</span> student (sname)</span><br><span class="line"><span class="keyword">tablespace</span> myspace;</span><br><span class="line"><span class="comment">/*函数索引*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> sname_index</span><br><span class="line"><span class="keyword">on</span> student (<span class="keyword">LOWER</span>(sname))</span><br><span class="line"><span class="keyword">tablespace</span> myspace;</span><br><span class="line"><span class="comment">/*位图索引*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">bitmap</span> <span class="keyword">index</span> sname_index</span><br><span class="line"><span class="keyword">on</span> student (ssex)</span><br><span class="line"><span class="keyword">tablespace</span> myspace;</span><br><span class="line"><span class="comment">/*重命名*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">index</span> index_name <span class="keyword">rename</span> <span class="keyword">to</span> indexName;</span><br><span class="line"><span class="comment">/*合并索引*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">index</span> index_name <span class="keyword">coalesce</span>;</span><br><span class="line"><span class="comment">/*重建索引*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">index</span> sname_index <span class="keyword">rebuild</span> <span class="keyword">tablespace</span> myspace;</span><br><span class="line"><span class="comment">/*监视索引*/</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">index</span> index_name <span class="keyword">monitoring</span> <span class="keyword">usage</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">index</span> index_name <span class="keyword">nomonitoring</span> <span class="keyword">usage</span>;</span><br><span class="line"><span class="comment">/*删除索引*/</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> index_name;</span><br></pre></td></tr></table></figure><h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cerate sequence student_sequence</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">20190809</span></span><br><span class="line"><span class="keyword">increment</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">nocycle</span></span><br><span class="line"><span class="keyword">order</span></span><br><span class="line">nocache;</span><br></pre></td></tr></table></figure><h4 id="同义词"><a href="#同义词" class="headerlink" title="同义词"></a>同义词</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cerate public synonym scores for scott.scores_2014_2015_1;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">synonym</span> scores;</span><br></pre></td></tr></table></figure><h4 id="SQL-分类"><a href="#SQL-分类" class="headerlink" title="SQL 分类"></a>SQL 分类</h4><ul><li>数据操纵语言、数据定义语言、数据控制语言、事务控制语言</li><li>DML：增、删、改、查</li><li>DDL：创建、修改、删除、更新数据结构</li><li>DCL：设置或更改数据库用户角色权限</li><li>TCL：协调相同数据的多个访问的同步</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*去重*/</span></span><br><span class="line"><span class="keyword">select</span> dinstinct deptno <span class="keyword">from</span> scott</span><br><span class="line"><span class="comment">/*汇总*/</span></span><br><span class="line"><span class="keyword">select</span> job,<span class="keyword">count</span>(*) <span class="keyword">as</span> 人数 <span class="keyword">from</span> scott <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br><span class="line"><span class="comment">/*where -&gt; group by -&gt; having*/</span></span><br><span class="line"><span class="keyword">select</span> deptno <span class="keyword">as</span> 部门编号, <span class="keyword">count</span>(*) <span class="keyword">as</span> 人数 <span class="keyword">from</span> scott <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(*) &gt; <span class="number">3</span>;</span><br><span class="line"><span class="comment">/*设置别名*/</span></span><br><span class="line"><span class="keyword">select</span> empno,ename,sal,e.deptno,d.deptno,dname <span class="keyword">from</span> scott.emp e,scott.dept d</span><br><span class="line"><span class="keyword">where</span> e.deptno = d.deptno;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github 常见问题和操作命令</title>
      <link href="2013/07/01/Github/"/>
      <url>2013/07/01/Github/</url>
      
        <content type="html"><![CDATA[<h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><p><strong>fatal: unable to access’<a href="https://github.com/xxx/xxx.git/&#39;:Failed">https://github.com/xxx/xxx.git/&#39;:Failed</a> connect to github.com:xxx;</strong></p><ul><li><p>解决方法：</p><p>  git config –global http.proxy </p><p>  git config –global –unset http.proxy </p><p>  查询到当前设置了代理，取消这个设置即可。 </p></li></ul><p><strong>如果在git push -u origin master时出现以下错误，证明电脑没有修改远程仓库的公钥</strong></p><pre><code>Permission denied (publickey).fatal: Could not read from remote repository.Please make sure you have the correct access rightsand the repository exists.</code></pre><ul><li>解决方法：</li></ul><ol><li>在github上点击Edit profile –&gt; SSH and GPG keys –&gt; new SSH key 添加SHH公钥</li><li>打开id_rsa.pub文件（C:/Users/Administrator/.ssh/id.rsa.pub）</li><li>将id_rsa.pub文件内容拷贝到key就可以了，title随便填。</li></ol><h4 id="github-仓库克隆到本地"><a href="#github-仓库克隆到本地" class="headerlink" title="github 仓库克隆到本地"></a>github 仓库克隆到本地</h4><pre><code>git clone https://github.com/xxx/xxx.git</code></pre><h4 id="本地仓库创建"><a href="#本地仓库创建" class="headerlink" title="本地仓库创建"></a>本地仓库创建</h4><pre><code>git init</code></pre><h4 id="本地代码提交仓库"><a href="#本地代码提交仓库" class="headerlink" title="本地代码提交仓库"></a>本地代码提交仓库</h4><pre><code>1）更新全部文件：git add .2）输入修改信息：git commit -m &#39;修改信息&#39;3）push到github上：git push -u origin master</code></pre><h4 id="分支合并到master分支上"><a href="#分支合并到master分支上" class="headerlink" title="分支合并到master分支上"></a>分支合并到master分支上</h4><pre><code>1）git checkout master：将master分支拉取下来2）git merge origin/xxx：将master分支和xxx做一个合并3）git push 将合并后的代码提交到master中</code></pre><h4 id="拉取最新分支"><a href="#拉取最新分支" class="headerlink" title="拉取最新分支"></a>拉取最新分支</h4><pre><code>1）git pull2）git checkout &#39;分支名&#39;</code></pre><h4 id="查看仓库状态"><a href="#查看仓库状态" class="headerlink" title="查看仓库状态"></a>查看仓库状态</h4><pre><code>git status</code></pre><h4 id="查看分支"><a href="#查看分支" class="headerlink" title="查看分支"></a>查看分支</h4><pre><code>git branch</code></pre><h4 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h4><pre><code>git merge xxx</code></pre><h4 id="同步本地仓库和远程仓库"><a href="#同步本地仓库和远程仓库" class="headerlink" title="同步本地仓库和远程仓库"></a>同步本地仓库和远程仓库</h4><pre><code>git pull --rebase origin master</code></pre><h4 id="查看历史版本"><a href="#查看历史版本" class="headerlink" title="查看历史版本"></a>查看历史版本</h4><pre><code>git loggit log --pretty=oneline</code></pre><h4 id="回退到版本"><a href="#回退到版本" class="headerlink" title="回退到版本"></a>回退到版本</h4><pre><code>*回退到上一个版本*git reset --hard HEAD^     *回退到上100个版本*git reset --hard HEAD~100  *回退到该ID版本*git reset --hard 038491dda6a7982ae02bbb1c85908c4eabf0f639  </code></pre><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><strong><a href="https://segmentfault.com/a/1190000019419170?utm_source=tag-newest">https://segmentfault.com/a/1190000019419170?utm_source=tag-newest</a></strong></p>]]></content>
      
      
      <categories>
          
          <category> 版本控制 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SVN 版本控制</title>
      <link href="2013/07/01/SVN%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
      <url>2013/07/01/SVN%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>VisualSVN server 服务端<br>TortoiseSVN客户端</p><blockquote><p>注意事项：</p></blockquote><p>.svn 隐藏目录记录两项关键信息</p><ol><li>工作文件的基准版本</li><li>一个本地副本最后更新的时间戳</li></ol><h4 id="常用功能"><a href="#常用功能" class="headerlink" title="常用功能"></a>常用功能</h4><ol><li><p>SVN 检出</p></li><li><p>添加</p></li><li><p>删除</p></li><li><p>改名</p></li><li><p>还原</p></li><li><p>检查更新（Check for modifications）</p><p> 显示你所做的修改有哪些还没有提交的，此功能不光能看到对文件的修改变化，所有的变化都能看到，包括增加文件或者目录，删除文件或者目录，移动文件或者目录等，如果你点击了检查版本库，那你还可以看到版本库里的改动，既别人提交了哪些文件的改动，你还没更新到本地</p></li><li><p>提交</p></li><li><p>显示日志</p></li><li><p>版本库浏览</p></li></ol><blockquote><p>分支管理</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 版本控制 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SVN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle 数据库体系</title>
      <link href="2013/07/01/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%93%E7%B3%BB/"/>
      <url>2013/07/01/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle%20%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%93%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<h4 id="服务启动、关闭"><a href="#服务启动、关闭" class="headerlink" title="服务启动、关闭"></a>服务启动、关闭</h4><ul><li>startup open</li><li>shutdown immediate</li></ul><h4 id="默认密码"><a href="#默认密码" class="headerlink" title="默认密码"></a>默认密码</h4><ul><li>sys change_on_install</li><li>system manager</li></ul><h4 id="服务启动问题"><a href="#服务启动问题" class="headerlink" title="服务启动问题"></a>服务启动问题</h4><ul><li>安装目录 -&gt; Network -&gt; ADMIN -&gt; listener.ora \ tnsnames.ora</li></ul><h4 id="7-天口令过期"><a href="#7-天口令过期" class="headerlink" title="7 天口令过期"></a>7 天口令过期</h4><ul><li>select username,PROFILE from dab_users;</li><li>select * from dba_profile s where s.profile =’DEFAULT’ and resource_name =’PASSWORD_LIFE_TIME’;</li><li>alter PROFILE DEFAULT limit PASSWORD_LIFE_TIME UNLIMITED</li></ul><h4 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h4><ul><li>sqlplus / as sysdba</li><li>alter user wapgw identified by &lt;密码&gt;</li></ul><h4 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h4><ul><li><p>存储结构</p><blockquote><p>物理存储结构<br>逻辑存储结构<br>控制文件 .ctl，数据文件 .dbf，日志文件n .log</p></blockquote></li><li><p>内存结构 </p><blockquote><p>系统全局区 SGA<br>数据高速缓存、日志高速缓存、共享池、大型池<br>程序全局区 PGA<br>服务进程、排序区、堆栈区、会话区</p></blockquote></li><li><p>进程结构</p><blockquote><p>前台进程<br>后台进程<br>DBWR \ PMON \ SNPn \ RECO \ LGWR \ SMON \ CKPT \ ARCH </p></blockquote></li></ul><h4 id="物理存储结构"><a href="#物理存储结构" class="headerlink" title="物理存储结构"></a>物理存储结构</h4><blockquote><p>数据文件</p></blockquote><pre><code>//使用 dba_data_files 查看表空间 SYSTEM 对应的数据文件部分信息Win + R -&gt; cmd -&gt; sqlplus /nolog -&gt; conn /as sysdbaSQL&gt; COLUMN file_name FORMAT A60SQL&gt; COLUMN tablespace_name FORMAT A20SQL&gt; select file_name,tablespace_name from dba_data_files2  where tablespace_name = &#39;SYSTEM&#39;;// 使用 v$datafile 查看数据库文件动态信息SQL&gt; COLUMN name FORMAT A60SQL&gt; SELECT file#,name,checkpoint_change#2  from v$datafile;    </code></pre><blockquote><p>查看控制文件</p></blockquote><pre><code>//使用 v$controlfile 查看控制文件的名称和存储路径SQL&gt; COLUMN name FORMAT A60SQL&gt; SELECT name2  FROM v$controlfile;</code></pre><blockquote><p>日志文件 （v$logfile \ v$log）</p></blockquote><blockquote><p>其它文件</p></blockquote><pre><code>参数文件 PFILE -&gt; init&lt;SID&gt;.ora SPFILE -&gt; spfile&lt;SID&gt;.ora口令文件、跟踪文件、报警文件</code></pre><h4 id="逻辑存储结构"><a href="#逻辑存储结构" class="headerlink" title="逻辑存储结构"></a>逻辑存储结构</h4><ul><li>表空间 -&gt; n 段 -&gt; n 区 -&gt; n 块</li></ul><blockquote><p>查看系统所有表空间</p></blockquote><pre><code>//使用 dba_tablespaces 查看系统所有表空间 select tablespace_name from dba_tablespaces;TABLESPACE_NAME--------------------SYSTEMSYSAUXUNDOTBS1TEMPUSERS*Oracle 自动创建的表空间*</code></pre><ul><li><p>段：数据段、索引段、临时段、回滚段</p></li><li><p>区：初始区、增量区</p></li></ul><h4 id="进程结构"><a href="#进程结构" class="headerlink" title="进程结构"></a>进程结构</h4><ul><li><p>必备后台进程</p><p>  DBWRn \ PMON \ CKRT \ LGWR \ SMON</p></li><li><p>可选进程</p><p>  ARCn \ REDO</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用数据库连接串</title>
      <link href="2013/07/01/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E4%B8%B2/"/>
      <url>2013/07/01/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h4 id="Oracle-连接字符串"><a href="#Oracle-连接字符串" class="headerlink" title="Oracle 连接字符串"></a>Oracle 连接字符串</h4><blockquote><p>Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.115.33) (PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=testDemo))); User Id=oracle_test; Password=oracle</p></blockquote><h4 id="Oracle-本机连接串"><a href="#Oracle-本机连接串" class="headerlink" title="Oracle 本机连接串"></a>Oracle 本机连接串</h4><blockquote><p>Data Source=orcl; User ID=demooauser; Password=demooapassword;</p></blockquote><h4 id="SQL-Server-连接串"><a href="#SQL-Server-连接串" class="headerlink" title="SQL Server 连接串"></a>SQL Server 连接串</h4><blockquote><p>Data Source=192.168.11.31; Integrated Security=false; Initial Catalog=gdoa_db; User Id = username; Password = userpass;</p></blockquote><h4 id="MySQL-连接串"><a href="#MySQL-连接串" class="headerlink" title="MySQL 连接串"></a>MySQL 连接串</h4><blockquote><p>Data Source=127.0.0.1; Database=china_weather_air; User Id=root; Password=root; SSL Mode=None; charset=utf8;</p></blockquote><h4 id="Access-连接串"><a href="#Access-连接串" class="headerlink" title="Access 连接串"></a>Access 连接串</h4><blockquote><p>Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\mydatabase.mdb; User Id=用户名; Password=密码;<br>  Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\mydatabase.mdb; Jet OLEDB:Database Password=密码;</p></blockquote><h4 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h4><blockquote><p>Provider=Microsoft.jet.oledb.4.0; Data Source=d:\myExcel.xls; Extended Properties=Excel8.0</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
